(()=>{"use strict";var e,t={63663:(e,t,n)=>{var r;e=n.nmd(e);var a=n(92915),i=n(69159),o=n(67986),u=n(13037),l=n(29689),s=n(38468),d=s(n(88225)),c=s(n(79302)),f=s(n(75356)),h=s(n(40756)),p=s(n(7401)),v=s(n(16825)),y=s(n(20794)),m=s(n(92915)),g=s(n(31920)),_=s(n(68190)),w=s(n(47053)),k=s(n(45446)),b=s(n(76607)),S=s(n(42601)),I=s(n(95753)),x=s(n(58831)),T=s(n(54558)),M=s(n(27316)),E=s(n(73035));function C(e,t){var n=void 0!==o&&u(e)||e["@@iterator"];if(!n){if(l(e)||(n=function(e,t){var n;if(!e)return;if("string"==typeof e)return A(e,t);var r=a(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return i(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return A(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,s=function(){};return{s,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var d,c=!0,f=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){f=!0,d=e},f:function(){try{c||null==n.return||n.return()}finally{if(f)throw d}}}}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var D,z=(D="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,function(e){var t,n,r,a;(e=void 0!==(e=e||{})?e:{}).ready=new c.default((function(e,t){r=e,a=t}));var i,o={};for(i in e)e.hasOwnProperty(i)&&(o[i]=e[i]);var u,l,s=[],A=function(e,t){throw t},z="";document.currentScript&&(z=document.currentScript.src),D&&(z=D),z=0!==(0,f.default)(z).call(z,"blob:")?z.substr(0,(0,h.default)(z).call(z,"/")+1):"",u=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText};var P=e.print||(0,p.default)(t=console.log).call(t,console),R=e.printErr||(0,p.default)(n=console.warn).call(n,console);for(i in o)o.hasOwnProperty(i)&&(e[i]=o[i]);o=null,e.arguments&&(s=e.arguments),e.thisProgram&&e.thisProgram,e.quit&&(A=e.quit);var L,F,W,B={"f64-rem":function(e,t){return e%t},debugger:function(){}};new Array(0),e.wasmBinary&&(L=e.wasmBinary),e.noExitRuntime&&(F=e.noExitRuntime),"object"!==("undefined"==typeof WebAssembly?"undefined":(0,d.default)(WebAssembly))&&we("no native wasm support detected");var N=new WebAssembly.Table({initial:50,maximum:50,element:"anyfunc"}),U=!1;function H(e,t){e||we("Assertion failed: "+t)}function O(t){var n=e["_"+t];return H(n,"Cannot call unknown function "+t+", make sure it is exported"),n}function Z(e,t,n,r,a){var i={string:function(e){var t=0;if(null!=e&&0!==e){var n=1+(e.length<<2);ee(e,t=Ve(n),n)}return t},array:function(e){var t=Ve(e.length);return function(e,t){V.set(e,t)}(e,t),t}},o=O(e),u=[],l=0;if(r)for(var s=0;s<r.length;s++){var d=i[n[s]];d?(0===l&&(l=Ge()),u[s]=d(r[s])):u[s]=r[s]}var c=o.apply(null,u);return c=function(e){return"string"===t?K(e):"boolean"===t?Boolean(e):e}(c),0!==l&&Je(l),c}function q(e,t,n,r){n=n||[];var a=(0,v.default)(n).call(n,(function(e){return"number"===e}));return"string"!==t&&a&&!r?O(e):function(){return Z(e,t,n,arguments)}}var X,V,J,G,Y,j="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function Q(e,t,n){for(var r=t+n,a=t;e[a]&&!(a>=r);)++a;if(a-t>16&&e.subarray&&j)return j.decode(e.subarray(t,a));for(var i="";t<a;){var o=e[t++];if(128&o){var u=63&e[t++];if(192!=(224&o)){var l=63&e[t++];if((o=224==(240&o)?(15&o)<<12|u<<6|l:(7&o)<<18|u<<12|l<<6|63&e[t++])<65536)i+=String.fromCharCode(o);else{var s=o-65536;i+=String.fromCharCode(55296|s>>10,56320|1023&s)}}else i+=String.fromCharCode((31&o)<<6|u)}else i+=String.fromCharCode(o)}return i}function K(e,t){return e?Q(J,e,t):""}function $(e,t,n,r){if(!(r>0))return 0;for(var a=n,i=n+r-1,o=0;o<e.length;++o){var u=e.charCodeAt(o);if(u>=55296&&u<=57343&&(u=65536+((1023&u)<<10)|1023&e.charCodeAt(++o)),u<=127){if(n>=i)break;t[n++]=u}else if(u<=2047){if(n+1>=i)break;t[n++]=192|u>>6,t[n++]=128|63&u}else if(u<=65535){if(n+2>=i)break;t[n++]=224|u>>12,t[n++]=128|u>>6&63,t[n++]=128|63&u}else{if(n+3>=i)break;t[n++]=240|u>>18,t[n++]=128|u>>12&63,t[n++]=128|u>>6&63,t[n++]=128|63&u}}return t[n]=0,n-a}function ee(e,t,n){return $(e,J,t,n)}function te(e){for(var t=0,n=0;n<e.length;++n){var r=e.charCodeAt(n);r>=55296&&r<=57343&&(r=65536+((1023&r)<<10)|1023&e.charCodeAt(++n)),r<=127?++t:t+=r<=2047?2:r<=65535?3:4}return t}function ne(t){X=t,e.HEAP8=V=new Int8Array(t),e.HEAP16=G=new Int16Array(t),e.HEAP32=Y=new Int32Array(t),e.HEAPU8=J=new Uint8Array(t),e.HEAPU16=new Uint16Array(t),e.HEAPU32=new Uint32Array(t),e.HEAPF32=new Float32Array(t),e.HEAPF64=new Float64Array(t)}var re=37600,ae=e.INITIAL_MEMORY||16777216;function ie(t){for(;t.length>0;){var n=t.shift();if("function"!=typeof n){var r=n.func;"number"==typeof r?void 0===n.arg?e.dynCall_v(r):e.dynCall_vi(r,n.arg):r(void 0===n.arg?null:n.arg)}else n(e)}}(W=e.wasmMemory?e.wasmMemory:new WebAssembly.Memory({initial:ae/65536,maximum:32768}))&&(X=W.buffer),ae=X.byteLength,ne(X),Y[re>>2]=5280688;var oe=[],ue=[],le=[],se=[],de=!1,ce=Math.abs,fe=Math.ceil,he=Math.floor,pe=Math.min,ve=0,ye=null,me=null;function ge(t){ve++,e.monitorRunDependencies&&e.monitorRunDependencies(ve)}function _e(t){if(ve--,e.monitorRunDependencies&&e.monitorRunDependencies(ve),0==ve&&(null!==ye&&(clearInterval(ye),ye=null),me)){var n=me;me=null,n()}}function we(t){e.onAbort&&e.onAbort(t),R(t+=""),U=!0,t="abort("+t+"). Build with -s ASSERTIONS=1 for more info.";var n=new WebAssembly.RuntimeError(t);throw a(n),n}function ke(e){return t=e,n="data:application/octet-stream;base64,",(0,y.default)(String.prototype)?(0,y.default)(t).call(t,n):0===(0,f.default)(t).call(t,n);var t,n}e.preloadedImages={},e.preloadedAudios={};var be,Se,Ie,xe="helpdeco.wasm";function Te(){try{if(L)return new Uint8Array(L);if(l)return l(xe);throw"both async and sync fetching of the wasm failed"}catch(e){we(e)}}function Me(){var t=function(){var e=new Error;if(!e.stack){try{throw new Error}catch(t){e=t}if(!e.stack)return"(no stack trace available)"}return e.stack.toString()}();return e.extraStackTrace&&(t+="\n"+e.extraStackTrace()),t.replace(/\b__Z[\w\d_]+/g,(function(e){return e==e?e:e+" ["+e+"]"}))}function Ee(e){return Y[qe()>>2]=e,e}ke(xe)||(be=xe,xe=e.locateFile?e.locateFile(be,z):z+be),e.asm=function(){var t={env:Oe,wasi_snapshot_preview1:Oe,global:{NaN:NaN,Infinity:1/0},"global.Math":Math,asm2wasm:B};function n(t,n){var r=t.exports;e.asm=r,_e()}function r(e){n(e.instance)}function a(e){return(L||"function"!=typeof fetch?new c.default((function(e,t){e(Te())})):fetch(xe,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+xe+"'";return e.arrayBuffer()})).catch((function(){return Te()}))).then((function(e){return WebAssembly.instantiate(e,t)})).then(e,(function(e){R("failed to asynchronously prepare wasm: "+e),we(e)}))}if(ge(),e.instantiateWasm)try{return e.instantiateWasm(t,n)}catch(e){return R("Module.instantiateWasm callback failed with error: "+e),!1}return function(){if(L||"function"!=typeof WebAssembly.instantiateStreaming||ke(xe)||"function"!=typeof fetch)return a(r);fetch(xe,{credentials:"same-origin"}).then((function(e){return WebAssembly.instantiateStreaming(e,t).then(r,(function(e){return R("wasm streaming compile failed: "+e),R("falling back to ArrayBuffer instantiation"),a(r)}))}))}(),{}},ue.push({func:function(){Ze()}});var Ce={splitPath:function(e){var t;return(0,m.default)(t=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(e)).call(t,1)},normalizeArray:function(e,t){for(var n=0,r=e.length-1;r>=0;r--){var a=e[r];"."===a?(0,g.default)(e).call(e,r,1):".."===a?((0,g.default)(e).call(e,r,1),n++):n&&((0,g.default)(e).call(e,r,1),n--)}if(t)for(;n;n--)e.unshift("..");return e},normalize:function(e){var t,n="/"===e.charAt(0),r="/"===e.substr(-1);return(e=Ce.normalizeArray((0,_.default)(t=e.split("/")).call(t,(function(e){return!!e})),!n).join("/"))||n||(e="."),e&&r&&(e+="/"),(n?"/":"")+e},dirname:function(e){var t=Ce.splitPath(e),n=t[0],r=t[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},basename:function(e){if("/"===e)return"/";var t=(0,h.default)(e).call(e,"/");return-1===t?e:e.substr(t+1)},extname:function(e){return Ce.splitPath(e)[3]},join:function(){var e=(0,m.default)(Array.prototype).call(arguments,0);return Ce.normalize(e.join("/"))},join2:function(e,t){return Ce.normalize(e+"/"+t)}},Ae={resolve:function(){for(var e,t="",n=!1,r=arguments.length-1;r>=-1&&!n;r--){var a=r>=0?arguments[r]:Pe.cwd();if("string"!=typeof a)throw new TypeError("Arguments to path.resolve must be strings");if(!a)return"";t=a+"/"+t,n="/"===a.charAt(0)}return(n?"/":"")+(t=Ce.normalizeArray((0,_.default)(e=t.split("/")).call(e,(function(e){return!!e})),!n).join("/"))||"."},relative:function(e,t){function n(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;n>=0&&""===e[n];n--);return t>n?[]:(0,m.default)(e).call(e,t,n-t+1)}e=Ae.resolve(e).substr(1),t=Ae.resolve(t).substr(1);for(var r=n(e.split("/")),a=n(t.split("/")),i=Math.min(r.length,a.length),o=i,u=0;u<i;u++)if(r[u]!==a[u]){o=u;break}var l=[];for(u=o;u<r.length;u++)l.push("..");return(l=(0,w.default)(l).call(l,(0,m.default)(a).call(a,o))).join("/")}},De={ttys:[],init:function(){},shutdown:function(){},register:function(e,t){De.ttys[e]={input:[],output:[],ops:t},Pe.registerDevice(e,De.stream_ops)},stream_ops:{open:function(e){var t=De.ttys[e.node.rdev];if(!t)throw new Pe.ErrnoError(43);e.tty=t,e.seekable=!1},close:function(e){e.tty.ops.flush(e.tty)},flush:function(e){e.tty.ops.flush(e.tty)},read:function(e,t,n,r,a){if(!e.tty||!e.tty.ops.get_char)throw new Pe.ErrnoError(60);for(var i=0,o=0;o<r;o++){var u;try{u=e.tty.ops.get_char(e.tty)}catch(e){throw new Pe.ErrnoError(29)}if(void 0===u&&0===i)throw new Pe.ErrnoError(6);if(null==u)break;i++,t[n+o]=u}return i&&(e.node.timestamp=(0,k.default)()),i},write:function(e,t,n,r,a){if(!e.tty||!e.tty.ops.put_char)throw new Pe.ErrnoError(60);try{for(var i=0;i<r;i++)e.tty.ops.put_char(e.tty,t[n+i])}catch(e){throw new Pe.ErrnoError(29)}return r&&(e.node.timestamp=(0,k.default)()),i}},default_tty_ops:{get_char:function(e){if(!e.input.length){var t=null;if("undefined"!=typeof window&&"function"==typeof window.prompt?null!==(t=window.prompt("Input: "))&&(t+="\n"):"function"==typeof readline&&null!==(t=readline())&&(t+="\n"),!t)return null;e.input=Ue(t,!0)}return e.input.shift()},put_char:function(e,t){null===t||10===t?(P(Q(e.output,0)),e.output=[]):0!=t&&e.output.push(t)},flush:function(e){e.output&&e.output.length>0&&(P(Q(e.output,0)),e.output=[])}},default_tty1_ops:{put_char:function(e,t){null===t||10===t?(R(Q(e.output,0)),e.output=[]):0!=t&&e.output.push(t)},flush:function(e){e.output&&e.output.length>0&&(R(Q(e.output,0)),e.output=[])}}},ze={ops_table:null,mount:function(e){return ze.createNode(null,"/",16895,0)},createNode:function(e,t,n,r){if(Pe.isBlkdev(n)||Pe.isFIFO(n))throw new Pe.ErrnoError(63);ze.ops_table||(ze.ops_table={dir:{node:{getattr:ze.node_ops.getattr,setattr:ze.node_ops.setattr,lookup:ze.node_ops.lookup,mknod:ze.node_ops.mknod,rename:ze.node_ops.rename,unlink:ze.node_ops.unlink,rmdir:ze.node_ops.rmdir,readdir:ze.node_ops.readdir,symlink:ze.node_ops.symlink},stream:{llseek:ze.stream_ops.llseek}},file:{node:{getattr:ze.node_ops.getattr,setattr:ze.node_ops.setattr},stream:{llseek:ze.stream_ops.llseek,read:ze.stream_ops.read,write:ze.stream_ops.write,allocate:ze.stream_ops.allocate,mmap:ze.stream_ops.mmap,msync:ze.stream_ops.msync}},link:{node:{getattr:ze.node_ops.getattr,setattr:ze.node_ops.setattr,readlink:ze.node_ops.readlink},stream:{}},chrdev:{node:{getattr:ze.node_ops.getattr,setattr:ze.node_ops.setattr},stream:Pe.chrdev_stream_ops}});var a=Pe.createNode(e,t,n,r);return Pe.isDir(a.mode)?(a.node_ops=ze.ops_table.dir.node,a.stream_ops=ze.ops_table.dir.stream,a.contents={}):Pe.isFile(a.mode)?(a.node_ops=ze.ops_table.file.node,a.stream_ops=ze.ops_table.file.stream,a.usedBytes=0,a.contents=null):Pe.isLink(a.mode)?(a.node_ops=ze.ops_table.link.node,a.stream_ops=ze.ops_table.link.stream):Pe.isChrdev(a.mode)&&(a.node_ops=ze.ops_table.chrdev.node,a.stream_ops=ze.ops_table.chrdev.stream),a.timestamp=(0,k.default)(),e&&(e.contents[t]=a),a},getFileDataAsRegularArray:function(e){if(e.contents&&e.contents.subarray){for(var t=[],n=0;n<e.usedBytes;++n)t.push(e.contents[n]);return t}return e.contents},getFileDataAsTypedArray:function(e){return e.contents?e.contents.subarray?e.contents.subarray(0,e.usedBytes):new Uint8Array(e.contents):new Uint8Array(0)},expandFileStorage:function(e,t){var n=e.contents?e.contents.length:0;if(!(n>=t)){t=Math.max(t,n*(n<1048576?2:1.125)>>>0),0!=n&&(t=Math.max(t,256));var r=e.contents;e.contents=new Uint8Array(t),e.usedBytes>0&&e.contents.set(r.subarray(0,e.usedBytes),0)}},resizeFileStorage:function(e,t){if(e.usedBytes!=t){if(0==t)return e.contents=null,void(e.usedBytes=0);if(!e.contents||e.contents.subarray){var n=e.contents;return e.contents=new Uint8Array(t),n&&e.contents.set(n.subarray(0,Math.min(t,e.usedBytes))),void(e.usedBytes=t)}if(e.contents||(e.contents=[]),e.contents.length>t)e.contents.length=t;else for(;e.contents.length<t;)e.contents.push(0);e.usedBytes=t}},node_ops:{getattr:function(e){var t={};return t.dev=Pe.isChrdev(e.mode)?e.id:1,t.ino=e.id,t.mode=e.mode,t.nlink=1,t.uid=0,t.gid=0,t.rdev=e.rdev,Pe.isDir(e.mode)?t.size=4096:Pe.isFile(e.mode)?t.size=e.usedBytes:Pe.isLink(e.mode)?t.size=e.link.length:t.size=0,t.atime=new Date(e.timestamp),t.mtime=new Date(e.timestamp),t.ctime=new Date(e.timestamp),t.blksize=4096,t.blocks=Math.ceil(t.size/t.blksize),t},setattr:function(e,t){void 0!==t.mode&&(e.mode=t.mode),void 0!==t.timestamp&&(e.timestamp=t.timestamp),void 0!==t.size&&ze.resizeFileStorage(e,t.size)},lookup:function(e,t){throw Pe.genericErrors[44]},mknod:function(e,t,n,r){return ze.createNode(e,t,n,r)},rename:function(e,t,n){if(Pe.isDir(e.mode)){var r;try{r=Pe.lookupNode(t,n)}catch(e){}if(r)for(var a in r.contents)throw new Pe.ErrnoError(55)}delete e.parent.contents[e.name],e.name=n,t.contents[n]=e,e.parent=t},unlink:function(e,t){delete e.contents[t]},rmdir:function(e,t){var n=Pe.lookupNode(e,t);for(var r in n.contents)throw new Pe.ErrnoError(55);delete e.contents[t]},readdir:function(e){var t=[".",".."];for(var n in e.contents)e.contents.hasOwnProperty(n)&&t.push(n);return t},symlink:function(e,t,n){var r=ze.createNode(e,t,41471,0);return r.link=n,r},readlink:function(e){if(!Pe.isLink(e.mode))throw new Pe.ErrnoError(28);return e.link}},stream_ops:{read:function(e,t,n,r,a){var i=e.node.contents;if(a>=e.node.usedBytes)return 0;var o=Math.min(e.node.usedBytes-a,r);if(o>8&&i.subarray)t.set(i.subarray(a,a+o),n);else for(var u=0;u<o;u++)t[n+u]=i[a+u];return o},write:function(e,t,n,r,a,i){if(t.buffer===V.buffer&&(i=!1),!r)return 0;var o=e.node;if(o.timestamp=(0,k.default)(),t.subarray&&(!o.contents||o.contents.subarray)){if(i)return o.contents=t.subarray(n,n+r),o.usedBytes=r,r;if(0===o.usedBytes&&0===a)return o.contents=(0,m.default)(t).call(t,n,n+r),o.usedBytes=r,r;if(a+r<=o.usedBytes)return o.contents.set(t.subarray(n,n+r),a),r}if(ze.expandFileStorage(o,a+r),o.contents.subarray&&t.subarray)o.contents.set(t.subarray(n,n+r),a);else for(var u=0;u<r;u++)o.contents[a+u]=t[n+u];return o.usedBytes=Math.max(o.usedBytes,a+r),r},llseek:function(e,t,n){var r=t;if(1===n?r+=e.position:2===n&&Pe.isFile(e.node.mode)&&(r+=e.node.usedBytes),r<0)throw new Pe.ErrnoError(28);return r},allocate:function(e,t,n){ze.expandFileStorage(e.node,t+n),e.node.usedBytes=Math.max(e.node.usedBytes,t+n)},mmap:function(e,t,n,r,a,i){if(H(0===t),!Pe.isFile(e.node.mode))throw new Pe.ErrnoError(43);var o,u,l=e.node.contents;if(2&i||l.buffer!==X){if((r>0||r+n<l.length)&&(l=l.subarray?l.subarray(r,r+n):(0,m.default)(Array.prototype).call(l,r,r+n)),u=!0,!(o=Pe.mmapAlloc(n)))throw new Pe.ErrnoError(48);V.set(l,o)}else u=!1,o=l.byteOffset;return{ptr:o,allocated:u}},msync:function(e,t,n,r,a){if(!Pe.isFile(e.node.mode))throw new Pe.ErrnoError(43);return 2&a||ze.stream_ops.write(e,t,0,r,n,!1),0}}},Pe={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,trackingDelegate:{},tracking:{openFlags:{READ:1,WRITE:2}},ErrnoError:null,genericErrors:{},filesystems:null,syncFSRequests:0,handleFSError:function(e){if(!(e instanceof Pe.ErrnoError))throw e+" : "+Me();return Ee(e.errno)},lookupPath:function(e,t){var n;if(t=t||{},!(e=Ae.resolve(Pe.cwd(),e)))return{path:"",node:null};var r={follow_mount:!0,recurse_count:0};for(var a in r)void 0===t[a]&&(t[a]=r[a]);if(t.recurse_count>8)throw new Pe.ErrnoError(32);for(var i=Ce.normalizeArray((0,_.default)(n=e.split("/")).call(n,(function(e){return!!e})),!1),o=Pe.root,u="/",l=0;l<i.length;l++){var s=l===i.length-1;if(s&&t.parent)break;if(o=Pe.lookupNode(o,i[l]),u=Ce.join2(u,i[l]),Pe.isMountpoint(o)&&(!s||s&&t.follow_mount)&&(o=o.mounted.root),!s||t.follow)for(var d=0;Pe.isLink(o.mode);){var c=Pe.readlink(u);if(u=Ae.resolve(Ce.dirname(u),c),o=Pe.lookupPath(u,{recurse_count:t.recurse_count}).node,d++>40)throw new Pe.ErrnoError(32)}}return{path:u,node:o}},getPath:function(e){for(var t;;){if(Pe.isRoot(e)){var n=e.mount.mountpoint;return t?"/"!==n[n.length-1]?n+"/"+t:n+t:n}t=t?e.name+"/"+t:e.name,e=e.parent}},hashName:function(e,t){for(var n=0,r=0;r<t.length;r++)n=(n<<5)-n+t.charCodeAt(r)|0;return(e+n>>>0)%Pe.nameTable.length},hashAddNode:function(e){var t=Pe.hashName(e.parent.id,e.name);e.name_next=Pe.nameTable[t],Pe.nameTable[t]=e},hashRemoveNode:function(e){var t=Pe.hashName(e.parent.id,e.name);if(Pe.nameTable[t]===e)Pe.nameTable[t]=e.name_next;else for(var n=Pe.nameTable[t];n;){if(n.name_next===e){n.name_next=e.name_next;break}n=n.name_next}},lookupNode:function(e,t){var n=Pe.mayLookup(e);if(n)throw new Pe.ErrnoError(n,e);for(var r=Pe.hashName(e.id,t),a=Pe.nameTable[r];a;a=a.name_next){var i=a.name;if(a.parent.id===e.id&&i===t)return a}return Pe.lookup(e,t)},createNode:function(e,t,n,r){var a=new Pe.FSNode(e,t,n,r);return Pe.hashAddNode(a),a},destroyNode:function(e){Pe.hashRemoveNode(e)},isRoot:function(e){return e===e.parent},isMountpoint:function(e){return!!e.mounted},isFile:function(e){return 32768==(61440&e)},isDir:function(e){return 16384==(61440&e)},isLink:function(e){return 40960==(61440&e)},isChrdev:function(e){return 8192==(61440&e)},isBlkdev:function(e){return 24576==(61440&e)},isFIFO:function(e){return 4096==(61440&e)},isSocket:function(e){return 49152==(49152&e)},flagModes:{r:0,rs:1052672,"r+":2,w:577,wx:705,xw:705,"w+":578,"wx+":706,"xw+":706,a:1089,ax:1217,xa:1217,"a+":1090,"ax+":1218,"xa+":1218},modeStringToFlags:function(e){var t=Pe.flagModes[e];if(void 0===t)throw new Error("Unknown file open mode: "+e);return t},flagsToPermissionString:function(e){var t=["r","w","rw"][3&e];return 512&e&&(t+="w"),t},nodePermissions:function(e,t){return Pe.ignorePermissions||(-1===(0,f.default)(t).call(t,"r")||292&e.mode)&&(-1===(0,f.default)(t).call(t,"w")||146&e.mode)&&(-1===(0,f.default)(t).call(t,"x")||73&e.mode)?0:2},mayLookup:function(e){var t=Pe.nodePermissions(e,"x");return t||(e.node_ops.lookup?0:2)},mayCreate:function(e,t){try{return Pe.lookupNode(e,t),20}catch(e){}return Pe.nodePermissions(e,"wx")},mayDelete:function(e,t,n){var r;try{r=Pe.lookupNode(e,t)}catch(e){return e.errno}var a=Pe.nodePermissions(e,"wx");if(a)return a;if(n){if(!Pe.isDir(r.mode))return 54;if(Pe.isRoot(r)||Pe.getPath(r)===Pe.cwd())return 10}else if(Pe.isDir(r.mode))return 31;return 0},mayOpen:function(e,t){return e?Pe.isLink(e.mode)?32:Pe.isDir(e.mode)&&("r"!==Pe.flagsToPermissionString(t)||512&t)?31:Pe.nodePermissions(e,Pe.flagsToPermissionString(t)):44},MAX_OPEN_FDS:4096,nextfd:function(e,t){e=e||0,t=t||Pe.MAX_OPEN_FDS;for(var n=e;n<=t;n++)if(!Pe.streams[n])return n;throw new Pe.ErrnoError(33)},getStream:function(e){return Pe.streams[e]},createStream:function(e,t,n){Pe.FSStream||(Pe.FSStream=function(){},Pe.FSStream.prototype={object:{get:function(){return this.node},set:function(e){this.node=e}},isRead:{get:function(){return 1!=(2097155&(0,b.default)(this))}},isWrite:{get:function(){return 0!=(2097155&(0,b.default)(this))}},isAppend:{get:function(){return 1024&(0,b.default)(this)}}});var r=new Pe.FSStream;for(var a in e)r[a]=e[a];e=r;var i=Pe.nextfd(t,n);return e.fd=i,Pe.streams[i]=e,e},closeStream:function(e){Pe.streams[e]=null},chrdev_stream_ops:{open:function(e){var t=Pe.getDevice(e.node.rdev);e.stream_ops=t.stream_ops,e.stream_ops.open&&e.stream_ops.open(e)},llseek:function(){throw new Pe.ErrnoError(70)}},major:function(e){return e>>8},minor:function(e){return 255&e},makedev:function(e,t){return e<<8|t},registerDevice:function(e,t){Pe.devices[e]={stream_ops:t}},getDevice:function(e){return Pe.devices[e]},getMounts:function(e){for(var t=[],n=[e];n.length;){var r=n.pop();t.push(r),n.push.apply(n,r.mounts)}return t},syncfs:function(e,t){"function"==typeof e&&(t=e,e=!1),Pe.syncFSRequests++,Pe.syncFSRequests>1&&R("warning: "+Pe.syncFSRequests+" FS.syncfs operations in flight at once, probably just doing extra work");var n=Pe.getMounts(Pe.root.mount),r=0;function a(e){return Pe.syncFSRequests--,t(e)}function i(e){if(e)return i.errored?void 0:(i.errored=!0,a(e));++r>=n.length&&a(null)}(0,S.default)(n).call(n,(function(t){if(!t.type.syncfs)return i(null);t.type.syncfs(t,e,i)}))},mount:function(e,t,n){var r,a="/"===n,i=!n;if(a&&Pe.root)throw new Pe.ErrnoError(10);if(!a&&!i){var o=Pe.lookupPath(n,{follow_mount:!1});if(n=o.path,r=o.node,Pe.isMountpoint(r))throw new Pe.ErrnoError(10);if(!Pe.isDir(r.mode))throw new Pe.ErrnoError(54)}var u={type:e,opts:t,mountpoint:n,mounts:[]},l=e.mount(u);return l.mount=u,u.root=l,a?Pe.root=l:r&&(r.mounted=u,r.mount&&r.mount.mounts.push(u)),l},unmount:function(e){var t,n,r,a=Pe.lookupPath(e,{follow_mount:!1});if(!Pe.isMountpoint(a.node))throw new Pe.ErrnoError(28);var i=a.node,o=i.mounted,u=Pe.getMounts(o);(0,S.default)(t=(0,I.default)(Pe.nameTable)).call(t,(function(e){for(var t=Pe.nameTable[e];t;){var n=t.name_next;-1!==(0,f.default)(u).call(u,t.mount)&&Pe.destroyNode(t),t=n}})),i.mounted=null;var l=(0,f.default)(n=i.mount.mounts).call(n,o);(0,g.default)(r=i.mount.mounts).call(r,l,1)},lookup:function(e,t){return e.node_ops.lookup(e,t)},mknod:function(e,t,n){var r=Pe.lookupPath(e,{parent:!0}).node,a=Ce.basename(e);if(!a||"."===a||".."===a)throw new Pe.ErrnoError(28);var i=Pe.mayCreate(r,a);if(i)throw new Pe.ErrnoError(i);if(!r.node_ops.mknod)throw new Pe.ErrnoError(63);return r.node_ops.mknod(r,a,t,n)},create:function(e,t){return t=void 0!==t?t:438,t&=4095,t|=32768,Pe.mknod(e,t,0)},mkdir:function(e,t){return t=void 0!==t?t:511,t&=1023,t|=16384,Pe.mknod(e,t,0)},mkdirTree:function(e,t){for(var n=e.split("/"),r="",a=0;a<n.length;++a)if(n[a]){r+="/"+n[a];try{Pe.mkdir(r,t)}catch(e){if(20!=e.errno)throw e}}},mkdev:function(e,t,n){return void 0===n&&(n=t,t=438),t|=8192,Pe.mknod(e,t,n)},symlink:function(e,t){if(!Ae.resolve(e))throw new Pe.ErrnoError(44);var n=Pe.lookupPath(t,{parent:!0}).node;if(!n)throw new Pe.ErrnoError(44);var r=Ce.basename(t),a=Pe.mayCreate(n,r);if(a)throw new Pe.ErrnoError(a);if(!n.node_ops.symlink)throw new Pe.ErrnoError(63);return n.node_ops.symlink(n,r,e)},rename:function(e,t){var n,r,a=Ce.dirname(e),i=Ce.dirname(t),o=Ce.basename(e),u=Ce.basename(t);try{n=Pe.lookupPath(e,{parent:!0}).node,r=Pe.lookupPath(t,{parent:!0}).node}catch(e){throw new Pe.ErrnoError(10)}if(!n||!r)throw new Pe.ErrnoError(44);if(n.mount!==r.mount)throw new Pe.ErrnoError(75);var l,s=Pe.lookupNode(n,o),d=Ae.relative(e,i);if("."!==d.charAt(0))throw new Pe.ErrnoError(28);if("."!==(d=Ae.relative(t,a)).charAt(0))throw new Pe.ErrnoError(55);try{l=Pe.lookupNode(r,u)}catch(e){}if(s!==l){var c=Pe.isDir(s.mode),f=Pe.mayDelete(n,o,c);if(f)throw new Pe.ErrnoError(f);if(f=l?Pe.mayDelete(r,u,c):Pe.mayCreate(r,u))throw new Pe.ErrnoError(f);if(!n.node_ops.rename)throw new Pe.ErrnoError(63);if(Pe.isMountpoint(s)||l&&Pe.isMountpoint(l))throw new Pe.ErrnoError(10);if(r!==n&&(f=Pe.nodePermissions(n,"w")))throw new Pe.ErrnoError(f);try{Pe.trackingDelegate.willMovePath&&Pe.trackingDelegate.willMovePath(e,t)}catch(n){R("FS.trackingDelegate['willMovePath']('"+e+"', '"+t+"') threw an exception: "+n.message)}Pe.hashRemoveNode(s);try{n.node_ops.rename(s,r,u)}catch(e){throw e}finally{Pe.hashAddNode(s)}try{Pe.trackingDelegate.onMovePath&&Pe.trackingDelegate.onMovePath(e,t)}catch(n){R("FS.trackingDelegate['onMovePath']('"+e+"', '"+t+"') threw an exception: "+n.message)}}},rmdir:function(e){var t=Pe.lookupPath(e,{parent:!0}).node,n=Ce.basename(e),r=Pe.lookupNode(t,n),a=Pe.mayDelete(t,n,!0);if(a)throw new Pe.ErrnoError(a);if(!t.node_ops.rmdir)throw new Pe.ErrnoError(63);if(Pe.isMountpoint(r))throw new Pe.ErrnoError(10);try{Pe.trackingDelegate.willDeletePath&&Pe.trackingDelegate.willDeletePath(e)}catch(t){R("FS.trackingDelegate['willDeletePath']('"+e+"') threw an exception: "+t.message)}t.node_ops.rmdir(t,n),Pe.destroyNode(r);try{Pe.trackingDelegate.onDeletePath&&Pe.trackingDelegate.onDeletePath(e)}catch(t){R("FS.trackingDelegate['onDeletePath']('"+e+"') threw an exception: "+t.message)}},readdir:function(e){var t=Pe.lookupPath(e,{follow:!0}).node;if(!t.node_ops.readdir)throw new Pe.ErrnoError(54);return t.node_ops.readdir(t)},unlink:function(e){var t=Pe.lookupPath(e,{parent:!0}).node,n=Ce.basename(e),r=Pe.lookupNode(t,n),a=Pe.mayDelete(t,n,!1);if(a)throw new Pe.ErrnoError(a);if(!t.node_ops.unlink)throw new Pe.ErrnoError(63);if(Pe.isMountpoint(r))throw new Pe.ErrnoError(10);try{Pe.trackingDelegate.willDeletePath&&Pe.trackingDelegate.willDeletePath(e)}catch(t){R("FS.trackingDelegate['willDeletePath']('"+e+"') threw an exception: "+t.message)}t.node_ops.unlink(t,n),Pe.destroyNode(r);try{Pe.trackingDelegate.onDeletePath&&Pe.trackingDelegate.onDeletePath(e)}catch(t){R("FS.trackingDelegate['onDeletePath']('"+e+"') threw an exception: "+t.message)}},readlink:function(e){var t=Pe.lookupPath(e).node;if(!t)throw new Pe.ErrnoError(44);if(!t.node_ops.readlink)throw new Pe.ErrnoError(28);return Ae.resolve(Pe.getPath(t.parent),t.node_ops.readlink(t))},stat:function(e,t){var n=Pe.lookupPath(e,{follow:!t}).node;if(!n)throw new Pe.ErrnoError(44);if(!n.node_ops.getattr)throw new Pe.ErrnoError(63);return n.node_ops.getattr(n)},lstat:function(e){return Pe.stat(e,!0)},chmod:function(e,t,n){var r;if(!(r="string"==typeof e?Pe.lookupPath(e,{follow:!n}).node:e).node_ops.setattr)throw new Pe.ErrnoError(63);r.node_ops.setattr(r,{mode:4095&t|-4096&r.mode,timestamp:(0,k.default)()})},lchmod:function(e,t){Pe.chmod(e,t,!0)},fchmod:function(e,t){var n=Pe.getStream(e);if(!n)throw new Pe.ErrnoError(8);Pe.chmod(n.node,t)},chown:function(e,t,n,r){var a;if(!(a="string"==typeof e?Pe.lookupPath(e,{follow:!r}).node:e).node_ops.setattr)throw new Pe.ErrnoError(63);a.node_ops.setattr(a,{timestamp:(0,k.default)()})},lchown:function(e,t,n){Pe.chown(e,t,n,!0)},fchown:function(e,t,n){var r=Pe.getStream(e);if(!r)throw new Pe.ErrnoError(8);Pe.chown(r.node,t,n)},truncate:function(e,t){if(t<0)throw new Pe.ErrnoError(28);var n;if(!(n="string"==typeof e?Pe.lookupPath(e,{follow:!0}).node:e).node_ops.setattr)throw new Pe.ErrnoError(63);if(Pe.isDir(n.mode))throw new Pe.ErrnoError(31);if(!Pe.isFile(n.mode))throw new Pe.ErrnoError(28);var r=Pe.nodePermissions(n,"w");if(r)throw new Pe.ErrnoError(r);n.node_ops.setattr(n,{size:t,timestamp:(0,k.default)()})},ftruncate:function(e,t){var n=Pe.getStream(e);if(!n)throw new Pe.ErrnoError(8);if(0==(2097155&(0,b.default)(n)))throw new Pe.ErrnoError(28);Pe.truncate(n.node,t)},utime:function(e,t,n){var r=Pe.lookupPath(e,{follow:!0}).node;r.node_ops.setattr(r,{timestamp:Math.max(t,n)})},open:function(t,n,r,a,i){if(""===t)throw new Pe.ErrnoError(44);var o;if(r=void 0===r?438:r,r=64&(n="string"==typeof n?Pe.modeStringToFlags(n):n)?4095&r|32768:0,"object"===(0,d.default)(t))o=t;else{t=Ce.normalize(t);try{o=Pe.lookupPath(t,{follow:!(131072&n)}).node}catch(e){}}var u=!1;if(64&n)if(o){if(128&n)throw new Pe.ErrnoError(20)}else o=Pe.mknod(t,r,0),u=!0;if(!o)throw new Pe.ErrnoError(44);if(Pe.isChrdev(o.mode)&&(n&=-513),65536&n&&!Pe.isDir(o.mode))throw new Pe.ErrnoError(54);if(!u){var l=Pe.mayOpen(o,n);if(l)throw new Pe.ErrnoError(l)}512&n&&Pe.truncate(o,0),n&=-131713;var s=Pe.createStream({node:o,path:Pe.getPath(o),flags:n,seekable:!0,position:0,stream_ops:o.stream_ops,ungotten:[],error:!1},a,i);s.stream_ops.open&&s.stream_ops.open(s),!e.logReadFiles||1&n||(Pe.readFiles||(Pe.readFiles={}),t in Pe.readFiles||(Pe.readFiles[t]=1,R("FS.trackingDelegate error on read file: "+t)));try{if(Pe.trackingDelegate.onOpenFile){var c=0;1!=(2097155&n)&&(c|=Pe.tracking.openFlags.READ),0!=(2097155&n)&&(c|=Pe.tracking.openFlags.WRITE),Pe.trackingDelegate.onOpenFile(t,c)}}catch(e){R("FS.trackingDelegate['onOpenFile']('"+t+"', flags) threw an exception: "+e.message)}return s},close:function(e){if(Pe.isClosed(e))throw new Pe.ErrnoError(8);e.getdents&&(e.getdents=null);try{e.stream_ops.close&&e.stream_ops.close(e)}catch(e){throw e}finally{Pe.closeStream(e.fd)}e.fd=null},isClosed:function(e){return null===e.fd},llseek:function(e,t,n){if(Pe.isClosed(e))throw new Pe.ErrnoError(8);if(!e.seekable||!e.stream_ops.llseek)throw new Pe.ErrnoError(70);if(0!=n&&1!=n&&2!=n)throw new Pe.ErrnoError(28);return e.position=e.stream_ops.llseek(e,t,n),e.ungotten=[],e.position},read:function(e,t,n,r,a){if(r<0||a<0)throw new Pe.ErrnoError(28);if(Pe.isClosed(e))throw new Pe.ErrnoError(8);if(1==(2097155&(0,b.default)(e)))throw new Pe.ErrnoError(8);if(Pe.isDir(e.node.mode))throw new Pe.ErrnoError(31);if(!e.stream_ops.read)throw new Pe.ErrnoError(28);var i=void 0!==a;if(i){if(!e.seekable)throw new Pe.ErrnoError(70)}else a=e.position;var o=e.stream_ops.read(e,t,n,r,a);return i||(e.position+=o),o},write:function(e,t,n,r,a,i){if(r<0||a<0)throw new Pe.ErrnoError(28);if(Pe.isClosed(e))throw new Pe.ErrnoError(8);if(0==(2097155&(0,b.default)(e)))throw new Pe.ErrnoError(8);if(Pe.isDir(e.node.mode))throw new Pe.ErrnoError(31);if(!e.stream_ops.write)throw new Pe.ErrnoError(28);e.seekable&&1024&(0,b.default)(e)&&Pe.llseek(e,0,2);var o=void 0!==a;if(o){if(!e.seekable)throw new Pe.ErrnoError(70)}else a=e.position;var u=e.stream_ops.write(e,t,n,r,a,i);o||(e.position+=u);try{e.path&&Pe.trackingDelegate.onWriteToFile&&Pe.trackingDelegate.onWriteToFile(e.path)}catch(t){R("FS.trackingDelegate['onWriteToFile']('"+e.path+"') threw an exception: "+t.message)}return u},allocate:function(e,t,n){if(Pe.isClosed(e))throw new Pe.ErrnoError(8);if(t<0||n<=0)throw new Pe.ErrnoError(28);if(0==(2097155&(0,b.default)(e)))throw new Pe.ErrnoError(8);if(!Pe.isFile(e.node.mode)&&!Pe.isDir(e.node.mode))throw new Pe.ErrnoError(43);if(!e.stream_ops.allocate)throw new Pe.ErrnoError(138);e.stream_ops.allocate(e,t,n)},mmap:function(e,t,n,r,a,i){if(0!=(2&a)&&0==(2&i)&&2!=(2097155&(0,b.default)(e)))throw new Pe.ErrnoError(2);if(1==(2097155&(0,b.default)(e)))throw new Pe.ErrnoError(2);if(!e.stream_ops.mmap)throw new Pe.ErrnoError(43);return e.stream_ops.mmap(e,t,n,r,a,i)},msync:function(e,t,n,r,a){return e&&e.stream_ops.msync?e.stream_ops.msync(e,t,n,r,a):0},munmap:function(e){return 0},ioctl:function(e,t,n){if(!e.stream_ops.ioctl)throw new Pe.ErrnoError(59);return e.stream_ops.ioctl(e,t,n)},readFile:function(e,t){if((t=t||{}).flags=(0,b.default)(t)||"r",t.encoding=t.encoding||"binary","utf8"!==t.encoding&&"binary"!==t.encoding)throw new Error('Invalid encoding type "'+t.encoding+'"');var n,r=Pe.open(e,(0,b.default)(t)),a=Pe.stat(e).size,i=new Uint8Array(a);return Pe.read(r,i,0,a,0),"utf8"===t.encoding?n=Q(i,0):"binary"===t.encoding&&(n=i),Pe.close(r),n},writeFile:function(e,t,n){(n=n||{}).flags=(0,b.default)(n)||"w";var r=Pe.open(e,(0,b.default)(n),n.mode);if("string"==typeof t){var a=new Uint8Array(te(t)+1),i=$(t,a,0,a.length);Pe.write(r,a,0,i,void 0,n.canOwn)}else{if(!ArrayBuffer.isView(t))throw new Error("Unsupported data type");Pe.write(r,t,0,t.byteLength,void 0,n.canOwn)}Pe.close(r)},cwd:function(){return Pe.currentPath},chdir:function(e){var t=Pe.lookupPath(e,{follow:!0});if(null===t.node)throw new Pe.ErrnoError(44);if(!Pe.isDir(t.node.mode))throw new Pe.ErrnoError(54);var n=Pe.nodePermissions(t.node,"x");if(n)throw new Pe.ErrnoError(n);Pe.currentPath=t.path},createDefaultDirectories:function(){Pe.mkdir("/tmp"),Pe.mkdir("/home"),Pe.mkdir("/home/web_user")},createDefaultDevices:function(){var e;if(Pe.mkdir("/dev"),Pe.registerDevice(Pe.makedev(1,3),{read:function(){return 0},write:function(e,t,n,r,a){return r}}),Pe.mkdev("/dev/null",Pe.makedev(1,3)),De.register(Pe.makedev(5,0),De.default_tty_ops),De.register(Pe.makedev(6,0),De.default_tty1_ops),Pe.mkdev("/dev/tty",Pe.makedev(5,0)),Pe.mkdev("/dev/tty1",Pe.makedev(6,0)),"object"===("undefined"==typeof crypto?"undefined":(0,d.default)(crypto))&&"function"==typeof crypto.getRandomValues){var t=new Uint8Array(1);e=function(){return crypto.getRandomValues(t),t[0]}}e||(e=function(){we("random_device")}),Pe.createDevice("/dev","random",e),Pe.createDevice("/dev","urandom",e),Pe.mkdir("/dev/shm"),Pe.mkdir("/dev/shm/tmp")},createSpecialDirectories:function(){Pe.mkdir("/proc"),Pe.mkdir("/proc/self"),Pe.mkdir("/proc/self/fd"),Pe.mount({mount:function(){var e=Pe.createNode("/proc/self","fd",16895,73);return e.node_ops={lookup:function(e,t){var n=+t,r=Pe.getStream(n);if(!r)throw new Pe.ErrnoError(8);var a={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:function(){return r.path}}};return a.parent=a,a}},e}},{},"/proc/self/fd")},createStandardStreams:function(){e.stdin?Pe.createDevice("/dev","stdin",e.stdin):Pe.symlink("/dev/tty","/dev/stdin"),e.stdout?Pe.createDevice("/dev","stdout",null,e.stdout):Pe.symlink("/dev/tty","/dev/stdout"),e.stderr?Pe.createDevice("/dev","stderr",null,e.stderr):Pe.symlink("/dev/tty1","/dev/stderr"),Pe.open("/dev/stdin","r"),Pe.open("/dev/stdout","w"),Pe.open("/dev/stderr","w")},ensureErrnoError:function(){var e;Pe.ErrnoError||(Pe.ErrnoError=function(e,t){this.node=t,this.setErrno=function(e){this.errno=e},this.setErrno(e),this.message="FS error"},Pe.ErrnoError.prototype=new Error,Pe.ErrnoError.prototype.constructor=Pe.ErrnoError,(0,S.default)(e=[44]).call(e,(function(e){Pe.genericErrors[e]=new Pe.ErrnoError(e),Pe.genericErrors[e].stack="<generic error, no stack>"})))},staticInit:function(){Pe.ensureErrnoError(),Pe.nameTable=new Array(4096),Pe.mount(ze,{},"/"),Pe.createDefaultDirectories(),Pe.createDefaultDevices(),Pe.createSpecialDirectories(),Pe.filesystems={MEMFS:ze}},init:function(t,n,r){Pe.init.initialized=!0,Pe.ensureErrnoError(),e.stdin=t||e.stdin,e.stdout=n||e.stdout,e.stderr=r||e.stderr,Pe.createStandardStreams()},quit:function(){Pe.init.initialized=!1;var t=e._fflush;t&&t(0);for(var n=0;n<Pe.streams.length;n++){var r=Pe.streams[n];r&&Pe.close(r)}},getMode:function(e,t){var n=0;return e&&(n|=365),t&&(n|=146),n},joinPath:function(e,t){var n=Ce.join.apply(null,e);return t&&"/"==n[0]&&(n=n.substr(1)),n},absolutePath:function(e,t){return Ae.resolve(t,e)},standardizePath:function(e){return Ce.normalize(e)},findObject:function(e,t){var n=Pe.analyzePath(e,t);return n.exists?n.object:(Ee(n.error),null)},analyzePath:function(e,t){try{e=(r=Pe.lookupPath(e,{follow:!t})).path}catch(e){}var n={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var r=Pe.lookupPath(e,{parent:!0});n.parentExists=!0,n.parentPath=r.path,n.parentObject=r.node,n.name=Ce.basename(e),r=Pe.lookupPath(e,{follow:!t}),n.exists=!0,n.path=r.path,n.object=r.node,n.name=r.node.name,n.isRoot="/"===r.path}catch(e){n.error=e.errno}return n},createFolder:function(e,t,n,r){var a=Ce.join2("string"==typeof e?e:Pe.getPath(e),t),i=Pe.getMode(n,r);return Pe.mkdir(a,i)},createPath:function(e,t,n,r){var a;e="string"==typeof e?e:Pe.getPath(e);for(var i=(0,x.default)(a=t.split("/")).call(a);i.length;){var o=i.pop();if(o){var u=Ce.join2(e,o);try{Pe.mkdir(u)}catch(e){}e=u}}return u},createFile:function(e,t,n,r,a){var i=Ce.join2("string"==typeof e?e:Pe.getPath(e),t),o=Pe.getMode(r,a);return Pe.create(i,o)},createDataFile:function(e,t,n,r,a,i){var o=t?Ce.join2("string"==typeof e?e:Pe.getPath(e),t):e,u=Pe.getMode(r,a),l=Pe.create(o,u);if(n){if("string"==typeof n){for(var s=new Array(n.length),d=0,c=n.length;d<c;++d)s[d]=n.charCodeAt(d);n=s}Pe.chmod(l,146|u);var f=Pe.open(l,"w");Pe.write(f,n,0,n.length,0,i),Pe.close(f),Pe.chmod(l,u)}return l},createDevice:function(e,t,n,r){var a=Ce.join2("string"==typeof e?e:Pe.getPath(e),t),i=Pe.getMode(!!n,!!r);Pe.createDevice.major||(Pe.createDevice.major=64);var o=Pe.makedev(Pe.createDevice.major++,0);return Pe.registerDevice(o,{open:function(e){e.seekable=!1},close:function(e){r&&r.buffer&&r.buffer.length&&r(10)},read:function(e,t,r,a,i){for(var o=0,u=0;u<a;u++){var l;try{l=n()}catch(e){throw new Pe.ErrnoError(29)}if(void 0===l&&0===o)throw new Pe.ErrnoError(6);if(null==l)break;o++,t[r+u]=l}return o&&(e.node.timestamp=(0,k.default)()),o},write:function(e,t,n,a,i){for(var o=0;o<a;o++)try{r(t[n+o])}catch(e){throw new Pe.ErrnoError(29)}return a&&(e.node.timestamp=(0,k.default)()),o}}),Pe.mkdev(a,i,o)},createLink:function(e,t,n,r,a){var i=Ce.join2("string"==typeof e?e:Pe.getPath(e),t);return Pe.symlink(n,i)},forceLoadFile:function(e){if(e.isDevice||e.isFolder||e.link||e.contents)return!0;var t=!0;if("undefined"!=typeof XMLHttpRequest)throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(!u)throw new Error("Cannot load without read() or XMLHttpRequest.");try{e.contents=Ue(u(e.url),!0),e.usedBytes=e.contents.length}catch(e){t=!1}return t||Ee(29),t},createLazyFile:function(e,t,n,r,a){function i(){this.lengthKnown=!1,this.chunks=[]}if(i.prototype.get=function(e){if(!(e>this.length-1||e<0)){var t=e%this.chunkSize,n=e/this.chunkSize|0;return this.getter(n)[t]}},i.prototype.setDataGetter=function(e){this.getter=e},i.prototype.cacheLength=function(){var e=new XMLHttpRequest;if(e.open("HEAD",n,!1),e.send(null),!(e.status>=200&&e.status<300||304===e.status))throw new Error("Couldn't load "+n+". Status: "+e.status);var t,r=Number(e.getResponseHeader("Content-length")),a=(t=e.getResponseHeader("Accept-Ranges"))&&"bytes"===t,i=(t=e.getResponseHeader("Content-Encoding"))&&"gzip"===t,o=1048576;a||(o=r);var u=this;u.setDataGetter((function(e){var t=e*o,a=(e+1)*o-1;if(a=Math.min(a,r-1),void 0===u.chunks[e]&&(u.chunks[e]=function(e,t){if(e>t)throw new Error("invalid range ("+e+", "+t+") or no bytes requested!");if(t>r-1)throw new Error("only "+r+" bytes available! programmer error!");var a=new XMLHttpRequest;if(a.open("GET",n,!1),r!==o&&a.setRequestHeader("Range","bytes="+e+"-"+t),"undefined"!=typeof Uint8Array&&(a.responseType="arraybuffer"),a.overrideMimeType&&a.overrideMimeType("text/plain; charset=x-user-defined"),a.send(null),!(a.status>=200&&a.status<300||304===a.status))throw new Error("Couldn't load "+n+". Status: "+a.status);return void 0!==a.response?new Uint8Array(a.response||[]):Ue(a.responseText||"",!0)}(t,a)),void 0===u.chunks[e])throw new Error("doXHR failed!");return u.chunks[e]})),!i&&r||(o=r=1,r=this.getter(0).length,o=r,P("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=r,this._chunkSize=o,this.lengthKnown=!0},"undefined"!=typeof XMLHttpRequest)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var o={isDevice:!1,url:n},u=Pe.createFile(e,t,o,r,a);o.contents?u.contents=o.contents:o.url&&(u.contents=null,u.url=o.url),(0,T.default)(u,{usedBytes:{get:function(){return this.contents.length}}});var l={},s=(0,I.default)(u.stream_ops);return(0,S.default)(s).call(s,(function(e){var t=u.stream_ops[e];l[e]=function(){if(!Pe.forceLoadFile(u))throw new Pe.ErrnoError(29);return t.apply(null,arguments)}})),l.read=function(e,t,n,r,a){if(!Pe.forceLoadFile(u))throw new Pe.ErrnoError(29);var i=e.node.contents;if(a>=i.length)return 0;var o=Math.min(i.length-a,r);if((0,m.default)(i))for(var l=0;l<o;l++)t[n+l]=i[a+l];else for(l=0;l<o;l++)t[n+l]=i.get(a+l);return o},u.stream_ops=l,u},createPreloadedFile:function(t,n,r,a,i,o,u,l,s,d){Browser.init();var c=n?Ae.resolve(Ce.join2(t,n)):t;function f(r){var f;function h(e){d&&d(),l||Pe.createDataFile(t,n,e,a,i,s),o&&o(),_e()}var p=!1;(0,S.default)(f=e.preloadPlugins).call(f,(function(e){p||e.canHandle(c)&&(e.handle(r,c,h,(function(){u&&u(),_e()})),p=!0)})),p||h(r)}ge(),"string"==typeof r?Browser.asyncLoad(r,(function(e){f(e)}),u):f(r)},indexedDB:function(){return window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB},DB_NAME:function(){return"EM_FS_"+window.location.pathname},DB_VERSION:20,DB_STORE_NAME:"FILE_DATA",saveFilesToDB:function(e,t,n){t=t||function(){},n=n||function(){};var r=Pe.indexedDB();try{var a=r.open(Pe.DB_NAME(),Pe.DB_VERSION)}catch(e){return n(e)}a.onupgradeneeded=function(){P("creating db"),a.result.createObjectStore(Pe.DB_STORE_NAME)},a.onsuccess=function(){var r=a.result.transaction([Pe.DB_STORE_NAME],"readwrite"),i=r.objectStore(Pe.DB_STORE_NAME),o=0,u=0,l=e.length;function s(){0==u?t():n()}(0,S.default)(e).call(e,(function(e){var t=i.put(Pe.analyzePath(e).object.contents,e);t.onsuccess=function(){++o+u==l&&s()},t.onerror=function(){u++,o+u==l&&s()}})),r.onerror=n},a.onerror=n},loadFilesFromDB:function(e,t,n){t=t||function(){},n=n||function(){};var r=Pe.indexedDB();try{var a=r.open(Pe.DB_NAME(),Pe.DB_VERSION)}catch(e){return n(e)}a.onupgradeneeded=n,a.onsuccess=function(){var r=a.result;try{var i=r.transaction([Pe.DB_STORE_NAME],"readonly")}catch(e){return void n(e)}var o=i.objectStore(Pe.DB_STORE_NAME),u=0,l=0,s=e.length;function d(){0==l?t():n()}(0,S.default)(e).call(e,(function(e){var t=o.get(e);t.onsuccess=function(){Pe.analyzePath(e).exists&&Pe.unlink(e),Pe.createDataFile(Ce.dirname(e),Ce.basename(e),t.result,!0,!0,!0),++u+l==s&&d()},t.onerror=function(){l++,u+l==s&&d()}})),i.onerror=n},a.onerror=n},mmapAlloc:function(e){for(var t=function(e,t){return t||(t=16),Math.ceil(e/t)*t}(e,16384),n=Xe(t);e<t;)V[n+e++]=0;return n}},Re={mappings:{},DEFAULT_POLLMASK:5,umask:511,calculateAt:function(e,t){if("/"!==t[0]){var n;if(-100===e)n=Pe.cwd();else{var r=Pe.getStream(e);if(!r)throw new Pe.ErrnoError(8);n=r.path}t=Ce.join2(n,t)}return t},doStat:function(e,t,n){try{var r=e(t)}catch(e){if(e&&e.node&&Ce.normalize(t)!==Ce.normalize(Pe.getPath(e.node)))return-54;throw e}return Y[n>>2]=r.dev,Y[n+4>>2]=0,Y[n+8>>2]=r.ino,Y[n+12>>2]=r.mode,Y[n+16>>2]=r.nlink,Y[n+20>>2]=r.uid,Y[n+24>>2]=r.gid,Y[n+28>>2]=r.rdev,Y[n+32>>2]=0,Ie=[r.size>>>0,(Se=r.size,+ce(Se)>=1?Se>0?(0|pe(+he(Se/4294967296),4294967295))>>>0:~~+fe((Se-+(~~Se>>>0))/4294967296)>>>0:0)],Y[n+40>>2]=Ie[0],Y[n+44>>2]=Ie[1],Y[n+48>>2]=4096,Y[n+52>>2]=r.blocks,Y[n+56>>2]=r.atime.getTime()/1e3|0,Y[n+60>>2]=0,Y[n+64>>2]=r.mtime.getTime()/1e3|0,Y[n+68>>2]=0,Y[n+72>>2]=r.ctime.getTime()/1e3|0,Y[n+76>>2]=0,Ie=[r.ino>>>0,(Se=r.ino,+ce(Se)>=1?Se>0?(0|pe(+he(Se/4294967296),4294967295))>>>0:~~+fe((Se-+(~~Se>>>0))/4294967296)>>>0:0)],Y[n+80>>2]=Ie[0],Y[n+84>>2]=Ie[1],0},doMsync:function(e,t,n,r,a){var i=(0,m.default)(J).call(J,e,e+n);Pe.msync(t,i,a,n,r)},doMkdir:function(e,t){return"/"===(e=Ce.normalize(e))[e.length-1]&&(e=e.substr(0,e.length-1)),Pe.mkdir(e,t,0),0},doMknod:function(e,t,n){switch(61440&t){case 32768:case 8192:case 24576:case 4096:case 49152:break;default:return-28}return Pe.mknod(e,t,n),0},doReadlink:function(e,t,n){if(n<=0)return-28;var r=Pe.readlink(e),a=Math.min(n,te(r)),i=V[t+a];return ee(r,t,n+1),V[t+a]=i,a},doAccess:function(e,t){if(-8&t)return-28;var n;if(!(n=Pe.lookupPath(e,{follow:!0}).node))return-44;var r="";return 4&t&&(r+="r"),2&t&&(r+="w"),1&t&&(r+="x"),r&&Pe.nodePermissions(n,r)?-2:0},doDup:function(e,t,n){var r=Pe.getStream(n);return r&&Pe.close(r),Pe.open(e,t,0,n,n).fd},doReadv:function(e,t,n,r){for(var a=0,i=0;i<n;i++){var o=Y[t+8*i>>2],u=Y[t+(8*i+4)>>2],l=Pe.read(e,V,o,u,r);if(l<0)return-1;if(a+=l,l<u)break}return a},doWritev:function(e,t,n,r){for(var a=0,i=0;i<n;i++){var o=Y[t+8*i>>2],u=Y[t+(8*i+4)>>2],l=Pe.write(e,V,o,u,r);if(l<0)return-1;a+=l}return a},varargs:void 0,get:function(){return Re.varargs+=4,Y[Re.varargs-4>>2]},getStr:function(e){return K(e)},getStreamFromFD:function(e){var t=Pe.getStream(e);if(!t)throw new Pe.ErrnoError(8);return t},get64:function(e,t){return e}};function Le(){return J.length}function Fe(e){try{return W.grow(e-X.byteLength+65535>>>16),ne(W.buffer),1}catch(e){}}var We=function(e,t,n,r){e||(e=this),this.parent=e,this.mount=e.mount,this.mounted=null,this.id=Pe.nextInode++,this.name=t,this.mode=n,this.node_ops={},this.stream_ops={},this.rdev=r},Be=365,Ne=146;function Ue(e,t,n){var r=n>0?n:te(e)+1,a=new Array(r),i=$(e,a,0,a.length);return t&&(a.length=i),a}(0,T.default)(We.prototype,{read:{get:function(){return(this.mode&Be)===Be},set:function(e){e?this.mode|=Be:this.mode&=-366}},write:{get:function(){return(this.mode&Ne)===Ne},set:function(e){e?this.mode|=Ne:this.mode&=-147}},isFolder:{get:function(){return Pe.isDir(this.mode)}},isDevice:{get:function(){return Pe.isChrdev(this.mode)}}}),Pe.FSNode=We,Pe.staticInit(),e.FS_createFolder=Pe.createFolder,e.FS_createPath=Pe.createPath,e.FS_createDataFile=Pe.createDataFile,e.FS_createPreloadedFile=Pe.createPreloadedFile,e.FS_createLazyFile=Pe.createLazyFile,e.FS_createLink=Pe.createLink,e.FS_createDevice=Pe.createDevice,e.FS_unlink=Pe.unlink;var He,Oe={e:function(e,t,n){return function(e,t,n){Re.varargs=n;try{var r=Re.getStreamFromFD(e);switch(t){case 0:return(a=Re.get())<0?-28:Pe.open(r.path,(0,b.default)(r),0,a).fd;case 1:case 2:return 0;case 3:return(0,b.default)(r);case 4:var a=Re.get();return r.flags|=a,0;case 12:return a=Re.get(),G[a+0>>1]=2,0;case 13:case 14:return 0;case 16:case 8:return-28;case 9:return Ee(28),-1;default:return-28}}catch(e){return void 0!==Pe&&e instanceof Pe.ErrnoError||we(e),-e.errno}}(e,t,n)},k:function(e,t,n){return function(e,t,n){Re.varargs=n;try{var r=Re.getStr(e),a=Re.get();return Pe.open(r,t,a).fd}catch(e){return void 0!==Pe&&e instanceof Pe.ErrnoError||we(e),-e.errno}}(e,t,n)},d:function(e,t,n){return function(e,t,n){Re.varargs=n;try{var r=Re.getStreamFromFD(e);switch(t){case 21509:case 21505:return r.tty?0:-59;case 21510:case 21511:case 21512:case 21506:case 21507:case 21508:return r.tty?0:-59;case 21519:if(!r.tty)return-59;var a=Re.get();return Y[a>>2]=0,0;case 21520:return r.tty?-28:-59;case 21531:return a=Re.get(),Pe.ioctl(r,t,a);case 21523:case 21524:return r.tty?0:-59;default:we("bad ioctl syscall "+t)}}catch(e){return void 0!==Pe&&e instanceof Pe.ErrnoError||we(e),-e.errno}}(e,t,n)},c:function(e){return function(e){try{var t=Re.getStreamFromFD(e);return Pe.close(t),0}catch(e){return void 0!==Pe&&e instanceof Pe.ErrnoError||we(e),e.errno}}(e)},j:function(e,t,n,r){return function(e,t,n,r){try{var a=Re.getStreamFromFD(e),i=Re.doReadv(a,t,n);return Y[r>>2]=i,0}catch(e){return void 0!==Pe&&e instanceof Pe.ErrnoError||we(e),e.errno}}(e,t,n,r)},l:function(e,t,n,r,a){return function(e,t,n,r,a){try{var i=Re.getStreamFromFD(e),o=4294967296*n+(t>>>0),u=9007199254740992;return o<=-u||o>=u?-61:(Pe.llseek(i,o,r),Ie=[i.position>>>0,(Se=i.position,+ce(Se)>=1?Se>0?(0|pe(+he(Se/4294967296),4294967295))>>>0:~~+fe((Se-+(~~Se>>>0))/4294967296)>>>0:0)],Y[a>>2]=Ie[0],Y[a+4>>2]=Ie[1],i.getdents&&0===o&&0===r&&(i.getdents=null),0)}catch(e){return void 0!==Pe&&e instanceof Pe.ErrnoError||we(e),e.errno}}(e,t,n,r,a)},i:function(e,t,n,r){return function(e,t,n,r){try{var a=Re.getStreamFromFD(e),i=Re.doWritev(a,t,n);return Y[r>>2]=i,0}catch(e){return void 0!==Pe&&e instanceof Pe.ErrnoError||we(e),e.errno}}(e,t,n,r)},__memory_base:1024,__table_base:0,h:Le,g:function(e,t,n){(0,M.default)(J).call(J,e,t,t+n)},f:function(e){e>>>=0;var t=Le(),n=2147483648;if(e>n)return!1;for(var r,a,i=1;i<=4;i*=2){var o=t*(1+.2/i);if(o=Math.min(o,e+100663296),Fe(Math.min(n,((r=Math.max(16777216,e,o))%(a=65536)>0&&(r+=a-r%a),r))))return!0}return!1},a:function(t){!function(t,n){n&&F&&0===t||(F||(U=!0,e.onExit&&e.onExit(t)),A(t,new Ye(t)))}(t)},b:we,memory:W,table:N},Ze=(e.asm({},Oe,X),e.__ZL22initialize_malloc_heapv=function(){return(Ze=e.__ZL22initialize_malloc_heapv=e.asm.m).apply(null,arguments)}),qe=e.___errno_location=function(){return(qe=e.___errno_location=e.asm.n).apply(null,arguments)},Xe=(e._get_version=function(){return(e._get_version=e.asm.o).apply(null,arguments)},e._malloc=function(){return(Xe=e._malloc=e.asm.p).apply(null,arguments)}),Ve=(e._render=function(){return(e._render=e.asm.q).apply(null,arguments)},e.stackAlloc=function(){return(Ve=e.stackAlloc=e.asm.r).apply(null,arguments)}),Je=e.stackRestore=function(){return(Je=e.stackRestore=e.asm.s).apply(null,arguments)},Ge=e.stackSave=function(){return(Ge=e.stackSave=e.asm.t).apply(null,arguments)};function Ye(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function je(t){function n(){He||(He=!0,e.calledRun=!0,U||(de=!0,e.noFSInit||Pe.init.initialized||Pe.init(),De.init(),ie(ue),Pe.ignorePermissions=!1,ie(le),r(e),e.onRuntimeInitialized&&e.onRuntimeInitialized(),function(){if(e.postRun)for("function"==typeof e.postRun&&(e.postRun=[e.postRun]);e.postRun.length;)t=e.postRun.shift(),se.unshift(t);var t;ie(se)}()))}t=t||s,ve>0||(function(){if(e.preRun)for("function"==typeof e.preRun&&(e.preRun=[e.preRun]);e.preRun.length;)t=e.preRun.shift(),oe.unshift(t);var t;ie(oe)}(),ve>0||(e.setStatus?(e.setStatus("Running..."),(0,E.default)((function(){(0,E.default)((function(){e.setStatus("")}),1),n()}),1)):n()))}if(e.ccall=Z,e.cwrap=q,e.getMemory=function(e){return de?Xe(e):function(e){var t=Y[re>>2],n=t+e+15&-16;return Y[re>>2]=n,t}(e)},e.addRunDependency=ge,e.removeRunDependency=_e,e.FS_createFolder=Pe.createFolder,e.FS_createPath=Pe.createPath,e.FS_createDataFile=Pe.createDataFile,e.FS_createPreloadedFile=Pe.createPreloadedFile,e.FS_createLazyFile=Pe.createLazyFile,e.FS_createLink=Pe.createLink,e.FS_createDevice=Pe.createDevice,e.FS_unlink=Pe.unlink,e.FS=Pe,me=function e(){He||je(),He||(me=e)},e.run=je,e.preInit)for("function"==typeof e.preInit&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return F=!0,je(),e.onRuntimeInitialized=function(){e.getVersion=q("get_version","string",[],[]),e.render=function(e,t){(e instanceof ArrayBuffer||e instanceof SharedArrayBuffer)&&(e=new Uint8Array(e));try{return Pe.chdir("/tmp"),Z("render","string",["array","number","string"],[e,e.byteLength,t])}finally{var n,r=C(Pe.readdir("/tmp"));try{for(r.s();!(n=r.n()).done;){var a=n.value;"."!==a&&".."!==a&&Pe.unlink(a)}}catch(e){r.e(e)}finally{r.f()}}}},e.ready});"object"===(0,d.default)(t)&&"object"===(0,d.default)(e)?e.exports=z:void 0===(r=function(){return z}.apply(t,[]))||(e.exports=r)},72875:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244));function c(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(28453);var f=n(88607),h=n(28061),p=function(e){(0,l.default)(n,e);var t=c(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments)).continuous=!0,e._value=1,e._vertical=!1,e._bar=WebFun.JSX.render("div",null),e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){(0,u.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this),this.appendChild(this._bar),this.addEventListener("mousedown",this)}},{key:"attributeValueChanged",value:function(){this.vertical=this.hasAttribute("vertical")}},{key:"handleEvent",value:function(e){"mouseup"===e.type&&document.removeEventListener("mousemove",this,{capture:!0}),"mousedown"===e.type&&(document.addEventListener("mousemove",this,{capture:!0}),document.addEventListener("mouseup",this,{once:!0,capture:!0}));var t=e.clientX,n=e.clientY,r=this.getBoundingClientRect(),a=r.left,i=r.width,o=r.bottom,u=r.height;this._vertical?this.value=(o-n)/u:this.value=(t-a)/i,(this.continuous||"mouseup"===e.type)&&this.dispatchEvent(new h.CustomEvent("change",{detail:{value:this.value}})),e.stopPropagation(),e.preventDefault()}},{key:"disconnectedCallback",value:function(){(0,u.default)((0,d.default)(n.prototype),"disconnectedCallback",this).call(this),this.removeEventListener("mouseup",this),document.removeEventListener("mousemove",this,{capture:!0}),document.removeEventListener("mouseup",this,{once:!0,capture:!0})}},{key:"vertical",get:function(){return this._vertical},set:function(e){this._vertical!==e&&(this._vertical=e,this._vertical?this.setAttribute("vertical",""):this.removeAttribute("vertical"),this._bar.style.removeProperty("width"),this._bar.style.removeProperty("height"),this.value=this._value)}},{key:"value",get:function(){return this._value},set:function(e){this._value=Math.max(Math.min(e,1),0);var t="".concat(100*this.value,"%");this._vertical?this._bar.style.height=t:this._bar.style.width=t}}]),n}(f.Component);p.tagName="wf-save-game-editor-ammo",p.observedAttributes=["vertical"],t.default=p},22232:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.ZoneView=t.WorldView=t.TransformCanvas=t.Tile=t.SectorPreview=t.Map=t.InventoryRow=t.Inventory=t.InteractiveMap=t.InteractiveHealth=t.AmmoControl=void 0;var r=n(72875);t.AmmoControl=r.default;var a=n(10946);t.InteractiveHealth=a.default;var i=n(92201);t.InteractiveMap=i.default;var o=n(12246);t.Inventory=o.default;var u=n(1164);t.InventoryRow=u.default;var l=n(94948);t.Map=l.default;var s=n(38616);t.SectorPreview=s.default;var d=n(24131);t.Tile=d.default;var c=n(11208);t.TransformCanvas=c.default;var f=n(26995);t.WorldView=f.default;var h=n(68946);t.ZoneView=h.default},10946:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(94433)),o=a(n(40361)),u=a(n(7583)),l=a(n(18582)),s=a(n(80655)),d=a(n(20497)),c=a(n(75244));function f(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,d.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(71347);var h=n(31560),p=n(17725),v=n(15695),y=function(e){(0,s.default)(n,e);var t=f(n);function n(){var e;return(0,o.default)(this,n),(e=t.apply(this,arguments)).lastAngle=null,e}return(0,u.default)(n,[{key:"connectedCallback",value:function(){(0,l.default)((0,c.default)(n.prototype),"connectedCallback",this).call(this),this.addEventListener("mousedown",this)}},{key:"handleEvent",value:function(e){"mousedown"===e.type&&(document.addEventListener("mouseup",this,{capture:!0}),document.addEventListener("mousemove",this,{capture:!0})),"mouseup"===e.type&&(document.removeEventListener("mouseup",this,{capture:!0}),document.removeEventListener("mousemove",this,{capture:!0}));var t=this.getBoundingClientRect(),n=t.left,r=t.width,a=t.top,o=t.height,u=new h.Point(n+r/2,a+o/2),l=new h.Point(e.clientX,e.clientY).subtract(u),s=h.xy2polar(l.x,l.y),d=(0,i.default)(s,2)[1],c=h.rad2deg(360-d)%360,f=100*p.ceil(this.health/100);if(null===this.lastAngle)return this.health=f-c/360*100,void(this.lastAngle=c);if(this.lastAngle!==c){var v=c-this.lastAngle;p.abs(v)>180&&(f+=100*p.sign(v)),this.health=f-c/360*100,this.lastAngle=c,this.dispatchEvent(new CustomEvent("change"))}}},{key:"disconnectedCallback",value:function(){(0,l.default)((0,c.default)(n.prototype),"disconnectedCallback",this).call(this),this.removeEventListener("mousedown",this),document.removeEventListener("mouseup",this,{capture:!0}),document.removeEventListener("mousemove",this,{capture:!0})}}]),n}(v.AbstractHealth);y.tagName="wf-save-game-editor-health",t.default=y},92201:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244));function c(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(93809);var f=n(5008),h=n(94948),p=n(31560),v=n(38616),y=function(e){(0,l.default)(n,e);var t=c(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments))._highlight=WebFun.JSX.render(v.default,null),e._highlightTile=null,e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){(0,u.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this),this._highlight.palette=this.palette,this._highlight.style.position="absolute",this._highlight.style.pointerEvents="none",this._highlight.style.zIndex="1000",this.addEventListener("mousemove",this),this.addEventListener("mouseleave",this),this.addEventListener("contextmenu",this)}},{key:"handleEvent",value:function(e){var t=e.offsetX,n=e.offsetY,r=this.tileAtPoint(new p.Point(t,n));if("contextmenu"===e.type){var a=this.getBoundingClientRect(),i=a.top,o=a.left;return this._showMenuForTile(r,new p.Point(t+o,n+i)),e.preventDefault(),void e.stopPropagation()}"mouseleave"!==e.type&&this.world.bounds.contains(r)||(r=null),this.highlightTile=r}},{key:"_showMenuForTile",value:function(e,t){var n=this,r=this.world.at(e.x,e.y);if(this.contextMenuProvider){var a=this.contextMenuProvider.contextMenuForSector(r,e,this.world,this);if(a&&0!==a.items.length){this.highlightTile=null,this.removeEventListener("mousemove",this),this.removeEventListener("mouseleave",this);var i=document.createElement(f.ContextMenu.tagName);i.menu=a,i.onclose=function(){n.addEventListener("mousemove",n),n.addEventListener("mouseleave",n)},i.show(t)}}}},{key:"disconnectedCallback",value:function(){this.removeEventListener("mousemove",this),(0,u.default)((0,d.default)(n.prototype),"disconnectedCallback",this).call(this)}},{key:"highlightTile",get:function(){return this._highlightTile},set:function(e){if(!(e===this._highlightTile||e&&e.isEqualTo(this._highlightTile)))if(this._highlightTile=e,this._highlightTile){var t=this.world.at(this._highlightTile.x,this._highlightTile.y);if(t.zone){var n=this.getBoundingClientRect(),r=n.left,a=n.top;this._highlight.sector=t,this._highlight.style.left="".concat(28*e.x+r,"px"),this._highlight.style.top="".concat(28*e.y+a,"px"),document.body.appendChild(this._highlight)}else this._highlight.remove()}else this._highlight.remove()}}]),n}(h.default);y.tagName="wf-resource-editor-map-interactive",t.default=y},1164:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244)),c=a(n(68748)),f=a(n(67093)),h=a(n(42601));function p(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,c.default)(t,"__esModule",{value:!0}),n(16407);var v=n(5008),y=n(79586),m=function(e){(0,l.default)(n,e);var t=p(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments))._icon=WebFun.JSX.render(y.default,null),e._label=WebFun.JSX.render(v.Selector,{borderless:!0,onchange:function(){var t;e.data=(0,f.default)(t=e.tiles).call(t,(function(t){return t.id===+e._label.value})),e.onchange()}}),e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){var e,t=this;((0,u.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this),this.data)?((0,h.default)(e=this.tiles).call(e,(function(e){return t._label.addOption(e.name,"".concat(e.id))})),this._label.value="".concat(this.data.id),this.appendChild(this._icon),this.appendChild(this._label),this.ondelete instanceof Function&&this._label.appendChild(WebFun.JSX.render(v.IconButton,{className:"remove",onclick:function(){return t.ondelete(t)},icon:"trash"}))):this._setupAsNewItem()}},{key:"_setupAsNewItem",value:function(){var e=this;this.appendChild(WebFun.JSX.render(v.IconButton,{className:"new",icon:"plus",onclick:function(){return e.onadd()}}))}},{key:"cloneNode",value:function(e){var t=(0,u.default)((0,d.default)(n.prototype),"cloneNode",this).call(this,e);return t.ondelete=this.ondelete,t.onchange=this.onchange,t.onadd=this.onadd,t.palette=this.palette,t.data=this.data,t.tiles=this.tiles,t}},{key:"data",get:function(){return this._tile},set:function(e){this._tile=e,this._label.value="".concat(this.data&&this.data.id),this._icon.tile=e}},{key:"palette",get:function(){return this._icon.palette},set:function(e){this._icon.palette=e}}]),n}(v.Cell);m.tagName="wf-save-game-editor-inventory-row",t.default=m},12246:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(6060)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244)),c=a(n(68748)),f=a(n(35983)),h=a(n(67093)),p=a(n(69159)),v=a(n(31920)),y=a(n(75356)),m=a(n(68190));function g(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,c.default)(t,"__esModule",{value:!0}),n(83058);var _=n(5008),w=n(1164),k=function(e){(0,l.default)(n,e);var t=g(n);function n(){var e;return(0,i.default)(this,n),(e=t.call(this)).searchDelegate=null,e.cell=WebFun.JSX.render(w.default,{ondelete:function(t){return e._removeInventoryRow(t)},onadd:function(){return e._addInventoryRow()},onchange:function(){e._reloadItemsFromCells(),e.delegate&&e.delegate.inventoryDidChangeItem((0,u.default)(e))}}),e}return(0,o.default)(n,[{key:"_reloadItemsFromCells",value:function(){var e;this._items=(0,f.default)(e=this._cells).call(e,(function(e){return e.data}))}},{key:"_addInventoryRow",value:function(){var e,t=(0,h.default)(e=this.cell.tiles).call(e,(function(e){return e.name&&0!==e.name.length})),n=(0,p.default)(this.querySelectorAll(w.default.tagName)),r=(0,f.default)(n).call(n,(function(e){return e.data}));(0,v.default)(r).call(r,r.length-1,0,t),this.items=r;var a=this.lastElementChild.lastElementChild;a.scrollIntoViewIfNeeded&&a.scrollIntoViewIfNeeded(!0),this.delegate&&this.delegate.inventoryDidAddItem(this)}},{key:"_removeInventoryRow",value:function(e){var t,n=(0,y.default)(t=this.lastElementChild.children).call(t,e);if(-1!==n){var r=(0,p.default)(this.querySelectorAll(w.default.tagName)),a=(0,f.default)(r).call(r,(function(e){return e.data}));(0,v.default)(a).call(a,n,1),this.items=a,this.delegate&&this.delegate.inventoryDidRemoveItem(this)}}},{key:"tiles",get:function(){return this.cell.tiles},set:function(e){this.cell.tiles=(0,m.default)(e).call(e,(function(e){return e.name&&e.name.length}))}},{key:"palette",get:function(){return this.cell.palette},set:function(e){this.cell.palette=e}}]),n}(_.AbstractList);k.tagName="wf-save-game-editor-inventory",t.default=k},94948:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244)),c=a(n(68748)),f=a(n(49710));function h(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,c.default)(t,"__esModule",{value:!0}),n(6165);var p=n(17766),v=n(23754),y=n(88607),m=n(79586),g=28,_=function(e){(0,l.default)(n,e);var t=h(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments)).reveal=!1,e._canvas=WebFun.JSX.render("canvas",{width:280,height:280,className:"pixelated"}),e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){(0,u.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this),this.style.backgroundColor=this.locatorTile.backgroundColor,this._here||this._buildURHere(),this._drawWorld(),this.appendChild(this._canvas),this.location&&this.appendChild(this._here),this.location&&this._buildInterval()}},{key:"disconnectedCallback",value:function(){clearInterval(this._hereInterval),(0,u.default)((0,d.default)(n.prototype),"disconnectedCallback",this).call(this)}},{key:"_buildURHere",value:function(){this.location&&(this._here=WebFun.JSX.render(m.default,{className:"here",palette:this.palette,tile:this.tiles[this.locatorTile.here]}),this._here.style.left="".concat(this.location.x*g,"px"),this._here.style.top="".concat(this.location.y*g,"px"))}},{key:"_buildInterval",value:function(){var e=this;this._hereInterval=(0,f.default)((function(){e._here.style.display="none"===e._here.style.display?"":"none",e._canvas.getBoundingClientRect()}),1e3)}},{key:"_drawWorld",value:function(){var e=this.buildWorldImage(this.world,this.palette);this._canvas.getContext("2d").putImageData(e,0,0)}},{key:"buildWorldImage",value:function(e,t){for(var n=v.default.Size.width,r=v.default.Size.height,a=new ImageData(n*g,r*g),i=a.data,o=4*n*g,u=0;u<r;u++)for(var l=0;l<n;l++){var s=e.at(l,u),d=this._tileForSector(s);if(d)for(var c=d.imageData,f=u*g*o+4*(l*g),h=0;h<g;h++){for(var y=0;y<g;y++){var m=c[h*p.Tile.WIDTH+y];0!==m&&(i[f+4*y+0]=255&t[m]>>0,i[f+4*y+1]=255&t[m]>>8,i[f+4*y+2]=255&t[m]>>16,i[f+4*y+3]=255)}f+=o}}return a}},{key:"_tileForSector",value:function(e){var t=e.visited,n=e.solved1,r=e.zone,a=this.locatorTile.forZone(r,t,this.reveal);return a?(a instanceof Array&&(a=a[n?1:0]),this.tiles[a]):null}},{key:"tileAtPoint",value:function(e){return e.dividedBy({width:g,height:g}).byFlooring()}},{key:"redraw",value:function(){this._drawWorld()}}]),n}(y.Component);_.tagName="wf-save-game-editor-map",t.default=_},38616:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244));function c(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(78581);var f=n(88607),h=n(68946),p=n(7872),v=function(e){(0,l.default)(n,e);var t=c(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments))._zonePreview=WebFun.JSX.render(h.default,null),e._sectorDetails=WebFun.JSX.render("div",null),e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){(0,u.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this),this.appendChild(this._zonePreview),this.appendChild(this._sectorDetails)}},{key:"disconnectedCallback",value:function(){this.removeChild(this._sectorDetails),this.removeChild(this._zonePreview),(0,u.default)((0,d.default)(n.prototype),"disconnectedCallback",this).call(this)}},{key:"sector",get:function(){return this._sector},set:function(e){this._sector=e,this._zonePreview.zone=this._sector.zone,this._rebuildDetails()}},{key:"_rebuildDetails",value:function(){var e=this.palette,t=this._sector,n=t.findItem,r=t.requiredItem,a=t.additionalRequiredItem,i=t.solved1,o=t.solved2,u=t.solved3,l=t.solved4,s=t.zone,d=function(t,n,r){return n?WebFun.JSX.render("div",null,WebFun.JSX.render("div",null,t),WebFun.JSX.render("div",null,WebFun.JSX.render(p.TileView,{tile:n,palette:e}),WebFun.JSX.render(p.TileView,{tile:r,palette:e}))):null},c=this._sectorDetails;this._sectorDetails=WebFun.JSX.render("div",{className:"sector-details"},WebFun.JSX.render("div",{className:"sector-solved"},WebFun.JSX.render("span",null,i?"YES":"NO"),WebFun.JSX.render("span",null,o?"YES":"NO"),WebFun.JSX.render("span",null,u?"YES":"NO"),WebFun.JSX.render("span",null,l?"YES":"NO")),d("Find",n),d("Use",r,a),WebFun.JSX.render("div",{className:"sector-solved"},WebFun.JSX.render("span",null,"".concat(s.type.name)),WebFun.JSX.render("span",null,"ctr ".concat(s.counter)),WebFun.JSX.render("span",null,"rnd ".concat(s.random)),WebFun.JSX.render("span",null,"sctr ".concat(s.sectorCounter)))),this.isConnected&&this.replaceChild(this._sectorDetails,c)}},{key:"palette",get:function(){return this._zonePreview.palette},set:function(e){this._zonePreview.palette=e}}]),n}(f.Component);v.tagName="wf-save-game-editor-sector-preview",t.default=v},24131:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244));function c(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(59184);var f=n(88607),h=n(15695),p=n(31560),v=n(17766),y=function(e){(0,l.default)(n,e);var t=c(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments))._tile=null,e._image=document.createElement("div"),e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){(0,u.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this),this.appendChild(this._image)}},{key:"tile",get:function(){return this._tile},set:function(e){if(this._tile=e,this._tile&&this._palette){var t=WebFun.JSX.render(h.PaletteView,{size:new p.Size(v.Tile.WIDTH,v.Tile.HEIGHT),palette:this.palette,image:this._tile.imageData});this._image.replaceWith(t),this._image=t}}},{key:"palette",get:function(){return this._palette},set:function(e){this._palette=e}}]),n}(f.Component);y.tagName="wf-save-game-editor-tile",t.default=y},11208:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244));function c(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(20695);var f=n(88607),h=n(31560),p=function(e){(0,l.default)(n,e);var t=c(n);function n(){var e;return(0,i.default)(this,n),(e=t.call(this))._canvas=WebFun.JSX.render("canvas",null),e.draw=function(){},e.scaleFactor=1.1,e.trackTransforms(),e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){var e=this._canvas;(0,u.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this),this.lastMouse=new h.Point(this.width/2,this.height/2),this.appendChild(this._canvas),e.addEventListener("DOMMouseScroll",this,!1),e.addEventListener("mousewheel",this,!1),e.addEventListener("mouseup",this,!1),e.addEventListener("mousemove",this,!1),e.addEventListener("mousedown",this,!1),this.redraw()}},{key:"disconnectedCallback",value:function(){var e=this._canvas;e.removeEventListener("DOMMouseScroll",this,!1),e.removeEventListener("mousewheel",this,!1),e.removeEventListener("mouseup",this,!1),e.removeEventListener("mousemove",this,!1),e.removeEventListener("mousedown",this,!1),(0,u.default)((0,d.default)(n.prototype),"disconnectedCallback",this).call(this)}},{key:"handleEvent",value:function(e){var t=this._canvas,n=this.getContext("2d");switch(e.type){case"mousewheel":case"DOMMouseScroll":var r=e.wheelDelta?e.wheelDelta/40:e.detail?-e.detail:0;r&&this.zoom(r),e.preventDefault();break;case"mousedown":document.body.style.userSelect="none",this.lastMouse=new h.Point(e.offsetX||e.pageX-t.offsetLeft,e.offsetY||e.pageY-t.offsetTop),this.dragStart=n.transformedPoint(this.lastMouse.x,this.lastMouse.y),this.dragged=!1;break;case"mousemove":if(this.lastMouse=new h.Point(e.offsetX||e.pageX-t.offsetLeft,e.offsetY||e.pageY-t.offsetTop),this.dragged=!0,this.dragStart){var a=n.transformedPoint(this.lastMouse.x,this.lastMouse.y);n.translate(a.x-this.dragStart.x,a.y-this.dragStart.y),this.redraw();break}case"mouseup":this.dragStart=null,this.dragged||this.zoom(e.shiftKey?-1:1)}}},{key:"redraw",value:function(){this.draw(this.getContext("2d"))}},{key:"zoom",value:function(e){var t=this.getContext("2d"),n=t.transformedPoint(this.lastMouse.x,this.lastMouse.y);t.translate(n.x,n.y);var r=Math.pow(this.scaleFactor,e);t.scale(r,r),t.translate(-n.x,-n.y),this.redraw()}},{key:"getContext",value:function(e){return this._canvas.getContext(e)}},{key:"trackTransforms",value:function(){var e=this.getContext("2d"),t=document.createElementNS("http://www.w3.org/2000/svg","svg"),n=t.createSVGMatrix();e.getTransform=function(){return n};var r=[],a=e.save;e.save=function(){return r.push(n.translate(0,0)),a.call(e)};var i=e.restore;e.restore=function(){return n=r.pop(),i.call(e)};var o=e.scale;e.scale=function(t,r){return n=n.scale(t,r),o.call(e,t,r)};var u=e.rotate;e.rotate=function(t){return n=n.rotate(180*t/Math.PI),u.call(e,t)};var l=e.translate;e.translate=function(t,r){return n=n.translate(t,r),l.call(e,t,r)};var s=e.transform;e.transform=function(r,a,i,o,u,l){var d=t.createSVGMatrix();return d.a=r,d.b=a,d.c=i,d.d=o,d.e=u,d.f=l,n=n.multiply(d),s.call(e,r,a,i,o,u,l)};var d=e.setTransform;e.setTransform=function(t,r,a,i,o,u){if("number"==typeof t)return n.a=t,n.b=r,n.c=a,n.d=i,n.e=o,n.f=u,d.call(e,t,r,a,i,o,u)};var c=t.createSVGPoint();e.transformedPoint=function(e,t){return c.x=e,c.y=t,c.matrixTransform(n.inverse())}}},{key:"width",get:function(){return this._canvas.width},set:function(e){this._canvas.width=e}},{key:"height",get:function(){return this._canvas.height},set:function(e){this._canvas.height=e}}]),n}(f.Component);p.tagName="wf-save-game-editor-canvas",t.default=p},26995:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(63789)),o=a(n(76108)),u=a(n(40361)),l=a(n(7583)),s=a(n(18582)),d=a(n(80655)),c=a(n(20497)),f=a(n(75244)),h=a(n(68748)),p=a(n(79302)),v=a(n(35983));function y(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,f.default)(e);if(t){var i=(0,f.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,c.default)(this,n)}}(0,h.default)(t,"__esModule",{value:!0}),n(39870);var m=n(11208),g=n(88607),_=n(23754),w=n(78160),k=function(e){(0,d.default)(r,e);var t,n=y(r);function r(){var e;return(0,u.default)(this,r),(e=n.call(this))._canvas=WebFun.JSX.render(m.default,{className:"pixelated",width:288,height:288}),e._canvas.draw=function(t){return e.draw(t)},e}return(0,l.default)(r,[{key:"connectedCallback",value:(t=(0,o.default)(i.default.mark((function e(){var t,n,a=this;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=function(e){for(var t=[],n=0;n<_.default.Size.height;n++)for(var r=0;r<_.default.Size.width;r++){var a=e.at(r,n).zone;a&&t.push(a.id)}return t},(0,s.default)((0,f.default)(r.prototype),"connectedCallback",this).call(this),e.next=4,p.default.all((0,v.default)(t=n(this.state.world)).call(t,(function(e){return w.drawZoneImageData(a.gameData.zones[e],a.palette).toImage()})));case 4:if(this._zoneImages=e.sent,this.isConnected){e.next=7;break}return e.abrupt("return");case 7:this._canvas.width=5760,this._canvas.height=5760,this._canvas.getContext("2d").imageSmoothingEnabled=!1,this.appendChild(this._canvas);case 11:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"draw",value:function(e){var t=this._canvas,n=e.transformedPoint(0,0),r=e.transformedPoint(t.width,t.height);e.clearRect(n.x,n.y,r.x-n.x,r.y-n.y),e.save(),e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,t.width,t.height),e.restore();for(var a=0;a<10;a++)for(var i=0;i<10;i++){var o=this._zoneImages[10*a+i];e.drawImage(o,576*i,576*a)}}},{key:"disconnectedCallback",value:function(){(0,s.default)((0,f.default)(r.prototype),"disconnectedCallback",this).call(this)}}]),r}(g.Component);k.tagName="wf-save-game-editor-world-view",t.default=k},68946:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244));function c(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(77079);var f=n(17766),h=n(88607),p=n(31560),v=n(78160),y=function(e){(0,l.default)(n,e);var t=c(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments)).size=new p.Size(128,128),e._canvas=WebFun.JSX.render("canvas",{className:"pixelated"}),e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){(0,u.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this),this.addEventListener("click",this),this.appendChild(this._canvas)}},{key:"handleEvent",value:function(){this.redraw()}},{key:"disconnectedCallback",value:function(){this.removeEventListener("click",this),(0,u.default)((0,d.default)(n.prototype),"disconnectedCallback",this).call(this)}},{key:"redraw",value:function(){var e=this._canvas.getContext("2d"),t=this._zone;if(t){var n=f.Tile.WIDTH,r=f.Tile.HEIGHT,a=this.size.height,i=this.size.width;this._canvas.setAttribute("width","".concat(t.size.width*n,"px")),this._canvas.setAttribute("height","".concat(t.size.height*r,"px")),this._canvas.style.width="".concat(i,"px"),this._canvas.style.height="".concat(a,"px"),this.style.width="".concat(i,"px"),this.style.height="".concat(a,"px");var o=v.drawZoneImageData(t,this.palette);e.clearRect(0,0,t.size.width*n,t.size.height*r),e.putImageData(o,0,0)}else e.clearRect(0,0,576,576)}},{key:"zone",get:function(){return this._zone},set:function(e){this._zone=e,this.redraw()}}]),n}(h.Component);y.tagName="wf-editor-zone",t.default=y},87903:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(63789)),o=a(n(61822)),u=a(n(76108)),l=a(n(40361)),s=a(n(7583)),d=a(n(18582)),c=a(n(80655)),f=a(n(20497)),h=a(n(75244)),p=a(n(68748)),v=a(n(42601)),y=a(n(69159)),m=a(n(68190)),g=a(n(47053)),_=a(n(35983));function w(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,h.default)(e);if(t){var i=(0,h.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,f.default)(this,n)}}(0,p.default)(t,"__esModule",{value:!0}),n(42937);var k=n(22232),b=n(88607),S=n(31560),I=n(5008),x=n(46e3),T=n(48387),M=n(99670),E=function(e){(0,c.default)(n,e);var t=w(n);function n(){var e;return(0,l.default)(this,n),(e=t.apply(this,arguments))._save=WebFun.JSX.render("div",{className:"save"}),e.state=new S.DiscardingStorage,e}return(0,s.default)(n,[{key:"connectedCallback",value:function(){(0,d.default)((0,h.default)(n.prototype),"connectedCallback",this).call(this),this.appendChild(this._save)}},{key:"presentState",value:function(e,t,n){this._state=e,this._gameData=t,this._palette=n;var r=this._buildNodes(e);this._save=r,this.appendChild(r)}},{key:"_showSegment",value:function(e){var t;(0,v.default)(t=(0,y.default)(this._save.querySelectorAll(".content"))).call(t,(function(e){return e.style.display="none"}));var n=this._save.querySelector(".content."+e.textContent);n||(n=this._save.querySelector(".content")),n.style.display=""}},{key:"_buildNodes",value:function(e){var t,n,r,a=this,i=this._gameData.puzzles[e.goalPuzzle].strings[2],o=this._gameData.tiles;return WebFun.JSX.render("div",{className:"save"},WebFun.JSX.render("span",{className:"seed"},WebFun.JSX.render("label",null,"Seed"),WebFun.JSX.render("input",{value:e.seed.toHex(4),onchange:function(e){var t=e.target;a._state.seed=t.value.parseInt(),t.value=a._state.seed.toHex(4)}})),WebFun.JSX.render("span",{className:"planet"},WebFun.JSX.render("label",null,"Planet"),WebFun.JSX.render("input",{value:e.planet.name})),WebFun.JSX.render("div",{className:"current-weapon"},WebFun.JSX.render(M.PopoverCharacterPicker,{palette:this._palette,characters:(0,m.default)(t=this.data.characters).call(t,(function(e){return e.isWeapon()})),character:this.data.characters[this._state.currentWeapon],onchange:function(e){return a._state.currentWeapon=e.detail.character?e.detail.character.id:-1}}),e.type===x.Yoda&&WebFun.JSX.render(k.AmmoControl,{vertical:!0,value:e.currentAmmo})),WebFun.JSX.render(k.InteractiveHealth,{health:100*(4-e.livesLost)-e.damageTaken,onchange:function(e){var t=e.target;a._state.livesLost=3-t.lives,a._state.damageTaken=t.damage}}),WebFun.JSX.render("span",{className:"mission"},i),WebFun.JSX.render(I.SegmentControl,{onsegmentchange:function(e){return a._showSegment(e)},state:this.state.prefixedWith("content")},WebFun.JSX.render(I.Segment,null,"World"),e.type===x.Yoda&&WebFun.JSX.render(I.Segment,null,"Dagobah"),WebFun.JSX.render(I.Segment,null,"Inventory"),WebFun.JSX.render(I.Segment,null,"Props")),WebFun.JSX.render(k.InteractiveMap,{className:"content World",world:e.world,location:e.onDagobah?null:e.positionOnWorld,tiles:this._gameData.tiles,zones:this._gameData.zones,palette:this._palette,locatorTile:e.type.locatorTile,reveal:!0,contextMenuProvider:this}),e.type===x.Yoda&&WebFun.JSX.render(k.InteractiveMap,{className:"content Dagobah",world:e.dagobah,location:e.onDagobah?e.positionOnWorld:null,tiles:this._gameData.tiles,zones:this._gameData.zones,palette:this._palette,locatorTile:e.type.locatorTile,reveal:!0,contextMenuProvider:this}),WebFun.JSX.render(k.Inventory,{className:"content Inventory",tiles:o,palette:this._palette,items:(0,g.default)(n=(0,_.default)(r=(0,y.default)(e.inventoryIDs)).call(r,(function(e){return o[e]}))).call(n,null),delegate:this}),this._buildProps())}},{key:"_buildProps",value:function(){var e=this;return WebFun.JSX.render("div",{className:"content Props"},WebFun.JSX.render("label",null,"onDagobah"," ",WebFun.JSX.render("input",{value:"".concat(this._state.onDagobah),onchange:function(t){return e._state.onDagobah=!!+t.target.value}})),WebFun.JSX.render("label",null,"positionOnWorld.x"," ",WebFun.JSX.render("input",{value:"".concat(this._state.positionOnWorld.x),onchange:function(t){return e._state.positionOnWorld.x=+t.target.value}})),WebFun.JSX.render("label",null,"positionOnWorld.y"," ",WebFun.JSX.render("input",{value:"".concat(this._state.positionOnWorld.y),onchange:function(t){return e._state.positionOnWorld.y=+t.target.value}})),WebFun.JSX.render("label",null,"currentZoneID"," ",WebFun.JSX.render("input",{value:"".concat(this._state.currentZoneID),onchange:function(t){return e._state.currentZoneID=+t.target.value}})),WebFun.JSX.render("label",null,"positionOnZone.x"," ",WebFun.JSX.render("input",{value:"".concat(this._state.positionOnZone.x),onchange:function(t){return e._state.positionOnZone.x=+t.target.value}})),WebFun.JSX.render("label",null,"positionOnZone.y"," ",WebFun.JSX.render("input",{value:"".concat(this._state.positionOnZone.y),onchange:function(t){return e._state.positionOnZone.y=+t.target.value}})),WebFun.JSX.render("label",null,"currentWeapon"," ",WebFun.JSX.render("input",{value:"".concat(this._state.currentWeapon),onchange:function(t){return e._state.currentWeapon=+t.target.value}})),WebFun.JSX.render("label",null,"currentAmmo"," ",WebFun.JSX.render("input",{value:"".concat(this._state.currentAmmo),onchange:function(t){return e._state.currentAmmo=+t.target.value}})),WebFun.JSX.render("label",null,"forceAmmo"," ",WebFun.JSX.render("input",{value:"".concat(this._state.forceAmmo),onchange:function(t){return e._state.forceAmmo=+t.target.value}})),WebFun.JSX.render("label",null,"blasterAmmo"," ",WebFun.JSX.render("input",{value:"".concat(this._state.blasterAmmo),onchange:function(t){return e._state.blasterAmmo=+t.target.value}})),WebFun.JSX.render("label",null,"blasterRifleAmmo"," ",WebFun.JSX.render("input",{value:"".concat(this._state.blasterRifleAmmo),onchange:function(t){return e._state.blasterRifleAmmo=+t.target.value}})),WebFun.JSX.render("label",null,"difficulty"," ",WebFun.JSX.render("input",{value:"".concat(this._state.difficulty),onchange:function(t){return e._state.difficulty=+t.target.value}})),WebFun.JSX.render("label",null,"timeElapsed"," ",WebFun.JSX.render("input",{value:"".concat(this._state.timeElapsed),onchange:function(t){return e._state.timeElapsed=+t.target.value}})),WebFun.JSX.render("label",null,"worldSize"," ",WebFun.JSX.render("input",{value:"".concat(this._state.worldSize),onchange:function(t){return e._state.worldSize=+t.target.value}})),WebFun.JSX.render("label",null,"unknownCount"," ",WebFun.JSX.render("input",{value:"".concat(this._state.unknownCount),onchange:function(t){return e._state.unknownCount=+t.target.value}})),WebFun.JSX.render("label",null,"unknownSum"," ",WebFun.JSX.render("input",{value:"".concat(this._state.unknownSum),onchange:function(t){return e._state.unknownSum=+t.target.value}})))}},{key:"saveGame",get:function(){return this._state}},{key:"data",get:function(){return this._gameData}},{key:"contextMenuForSector",value:function(e,t,n,r){var a,l,s=this;if(!e.zone)return new b.Menu([{title:"Place zone",callback:(l=(0,u.default)(i.default.mark((function t(){var n,a;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,T.ModalPrompt("New Zone ID");case 2:if(null!==(n=t.sent)){t.next=5;break}return t.abrupt("return");case 5:a=n.parseInt(),e.zone=s.data.zones[a]||null,r.redraw();case 8:case"end":return t.stop()}}),t)}))),function(){return l.apply(this,arguments)})}]);var d,c,f,h=function(){var e=(0,u.default)(i.default.mark((function e(t){var n,r,a,o,u=arguments;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=u.length>1&&void 0!==u[1]?u[1]:null,e.next=3,T.ModalPrompt(t,{defaultValue:null!==(n=null==r?void 0:r.toHex())&&void 0!==n?n:""});case 3:if(null!==(a=e.sent)){e.next=6;break}return e.abrupt("return",null);case 6:if(o=a.parseInt(),!isNaN(o)){e.next=9;break}return e.abrupt("return",null);case 9:return e.abrupt("return",o);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return new b.Menu((0,g.default)(a=[{title:"Clear",callback:function(){e.additionalGainItem=null,e.puzzleIndex=-1,e.isGoal=-1,e.findItem=null,e.npc=null,e.requiredItem=null,e.solved1=!1,e.solved2=!1,e.solved3=!1,e.solved4=!1,e.visited=!1,e.zone=null,e.additionalRequiredItem=null,r.redraw()}},{title:"Change Zone",callback:(f=(0,u.default)(i.default.mark((function t(){var n,a,o;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h("New zone id",null===(n=e.zone)||void 0===n?void 0:n.id);case 2:if(null!==(o=t.sent)){t.next=5;break}return t.abrupt("return");case 5:(null===(a=e.zone)||void 0===a?void 0:a.id)===s._state.currentZoneID&&(s._state.currentZoneID=o),e.zone=s.data.zones[o]||null,r.redraw();case 8:case"end":return t.stop()}}),t)}))),function(){return f.apply(this,arguments)})}]).call(a,(0,o.default)(e.zone.providedItems.length?[{title:"Set provided item",callback:(c=(0,u.default)(i.default.mark((function t(){var n,r;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h("Provided item id:",null===(n=e.findItem)||void 0===n?void 0:n.id);case 2:if(null!==(r=t.sent)){t.next=5;break}return t.abrupt("return");case 5:e.findItem=s.data.tiles[r];case 6:case"end":return t.stop()}}),t)}))),function(){return c.apply(this,arguments)})}]:[]),(0,o.default)(e.zone.requiredItems.length?[{title:"Set required item",callback:(d=(0,u.default)(i.default.mark((function t(){var n,r;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h("Required item id:",null===(n=e.requiredItem)||void 0===n?void 0:n.id);case 2:if(null!==(r=t.sent)){t.next=5;break}return t.abrupt("return");case 5:e.requiredItem=s.data.tiles[r];case 6:case"end":return t.stop()}}),t)}))),function(){return d.apply(this,arguments)})}]:[]),[{title:e.visited?"Mark unvisited":"Mark visited",callback:function(){e.visited=!e.visited,e.additionalRequiredItem=null,e.additionalGainItem=null,e.puzzleIndex=-1,e.isGoal=-1,e.findItem=null,e.npc=null,e.requiredItem=null,e.solved1=!!e.visited&&e.solved1,e.solved2=!!e.visited&&e.solved2,e.solved3=!!e.visited&&e.solved3,e.solved4=!!e.visited&&e.solved4,r.redraw()}}]))}},{key:"inventoryDidAddItem",value:function(e){this._updateInventory(e.items)}},{key:"inventoryDidChangeItem",value:function(e){this._updateInventory(e.items)}},{key:"inventoryDidRemoveItem",value:function(e){this._updateInventory(e.items)}},{key:"_updateInventory",value:function(e){var t;this._state.inventoryIDs=new Int16Array((0,_.default)(t=(0,m.default)(e).call(e,S.identity)).call(t,(function(e){return e.id})))}}]),n}(b.Component);E.tagName="wf-save-game-editor-view",t.default=E},31238:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(63789)),o=a(n(76108)),u=a(n(40361)),l=a(n(7583)),s=a(n(18582)),d=a(n(80655)),c=a(n(20497)),f=a(n(75244));function h(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,f.default)(e);if(t){var i=(0,f.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,c.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(60663);var p=n(5008),v=n(20779),y=n(24325),m=n(95451),g=n(17766),_=n(87903),w=n(31560),k=function(e){(0,d.default)(r,e);var t,n=h(r);function r(){var e;return(0,u.default)(this,r),(e=n.call(this))._progressIndicator=WebFun.JSX.render(p.ProgressIndicator,null),e._editorView=WebFun.JSX.render(_.default,{storage:new w.PrefixedStorage(localStorage,"save-game-editor")}),e.title="Save Game Editor",e.addTitlebarButton(WebFun.JSX.render(p.IconButton,{icon:"download",onclick:function(){return e.downloadSaveGame()}})),e}return(0,l.default)(r,[{key:"connectedCallback",value:function(){(0,s.default)((0,f.default)(r.prototype),"connectedCallback",this).call(this),this.content.appendChild(this._progressIndicator)}},{key:"loadGameFromStream",value:(t=(0,o.default)(i.default.mark((function e(t){var n,r,a,o,u,l,s;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._progressIndicator.parentElement||(this.textContent="",this.content.appendChild(this._progressIndicator)),e.prev=1,n=m.Reader.build(t),r=n.type,a=n.read,e.next=5,(new y.DataProvider).provide(r);case 5:return o=e.sent,e.next=8,(new y.PaletteProvider).provide(r);case 8:u=e.sent,(l=new v.AssetManager).populate(g.Zone,o.zones),l.populate(g.Tile,o.tiles),l.populate(g.Puzzle,o.puzzles),l.populate(g.Char,o.characters),l.populate(g.Sound,o.sounds),this._assets=l,s=a(l),this.presentSaveGame(s,o,u),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(1),console.warn(e.t0);case 23:case"end":return e.stop()}}),e,this,[[1,20]])}))),function(e){return t.apply(this,arguments)})},{key:"presentSaveGame",value:function(e,t,n){this._progressIndicator.remove(),this._editorView.presentState(e,t,n),this.content.appendChild(this._editorView)}},{key:"downloadSaveGame",value:function(){var e=this._editorView.saveGame,t=new m.Writer(this._assets),n=new w.DiscardingOutputStream;t.write(e,n);var r=new w.OutputStream(n.offset);t.write(e,r),w.download(r.buffer,"savegame.wld")}}]),r}(p.AbstractWindow);k.tagName="wf-save-game-editor-window",t.default=k},70945:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108)),o=r(n(68748)),u=r(n(79302)),l=r(n(35983));(0,o.default)(t,"__esModule",{value:!0}),t.EditorView=t.main=void 0;var s=n(87903);t.EditorView=s.default;var d=n(31238),c=n(22232),f=n(88607),h=function(){f.ComponentRegistry.sharedRegistry.registerComponents(c),f.ComponentRegistry.sharedRegistry.registerComponent(d.default),f.ComponentRegistry.sharedRegistry.registerComponent(s.default),h=function(){}};h();var p=function(){var e=(0,i.default)(a.default.mark((function e(t){var n,r;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(),r=0,e.t0=u.default,e.t1=l.default,e.next=6,f.FilePicker.Pick({allowedTypes:["wld"],allowsMultipleFiles:!0});case 6:return e.t2=n=e.sent,e.t3=(0,e.t1)(e.t2).call(n,function(){var e=(0,i.default)(a.default.mark((function e(n){var i,o;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.provideInputStream();case 2:return i=e.sent,(o=document.createElement(d.default.tagName)).title=n.name,t.showWindow(o),o.center(),o.origin=o.origin.byAdding(10*r,10*r),r++,e.next=11,o.loadGameFromStream(i);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.abrupt("return",e.t0.all.call(e.t0,e.t3));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();t.main=p},34785:(e,t,n)=>{var r=n(92915),a=n(69159),i=n(67986),o=n(13037),u=n(29689),l=n(38468),s=l(n(63789)),d=l(n(94433)),c=l(n(76108)),f=l(n(40361)),h=l(n(7583)),p=l(n(68748)),v=l(n(42601)),y=l(n(73035)),m=l(n(89292));function g(e,t){var n=void 0!==i&&o(e)||e["@@iterator"];if(!n){if(u(e)||(n=function(e,t){var n;if(!e)return;if("string"==typeof e)return _(e,t);var i=r(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return a(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return _(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var l=0,s=function(){};return{s,n:function(){return l>=e.length?{done:!0}:{done:!1,value:e[l++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var d,c=!0,f=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){f=!0,d=e},f:function(){try{c||null==n.return||n.return()}finally{if(f)throw d}}}}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}(0,p.default)(t,"__esModule",{value:!0}),n(33682);var w=n(46e3),k=n(88607),b=n(48387),S=n(53260),I=n(28061),x=n(11011),T=function(){function e(t,n){(0,f.default)(this,e),this.root=t,this.settings=n,this._windowManager=new k.WindowManager(t),e.sharedApp=this}var t,r,a,i,o;return(0,h.default)(e,[{key:"run",value:function(){this.endPreload(),this.registerServiceWorker(),this.setupSaveGameFileHandler(),this.setupTestFileHandler(),this.setupIniFileHandler(),this.createDebugGameLinks(),this.ensureAddressbarCanBeHidden(),this.enterPWA()}},{key:"endPreload",value:function(){this.root.classList.add("webfun"),this.root.classList.remove("preload"),this.root.textContent=""}},{key:"registerServiceWorker",value:function(){"serviceWorker"in I.navigator?I.navigator.serviceWorker.register("/service-worker.js").then((function(e){e.onupdatefound=function(){return console.log("[ServiceWorkerClient]","Service worker found an update",e)},console.log("[ServiceWorkerClient]","Service worker registration succeeded",e)})).catch((function(e){console.log("[ServiceWorkerClient]","Service worker registration failed:",e)})):console.log("[ServiceWorkerClient]","Service workers are not supported")}},{key:"setupSaveGameFileHandler",value:function(){var e=this;b.GlobalFileDrop.defaultHandler.addHandler("wld",(function(t){var n;return null===(n=e.defaultGameController)||void 0===n?void 0:n.load(t)}))}},{key:"setupTestFileHandler",value:(o=(0,c.default)(s.default.mark((function e(){var t,n=this;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.settings.debug){e.next=2;break}return e.abrupt("return");case 2:(t=b.GlobalFileDrop.defaultHandler).addHandler("wftest",(function(e){return n.loadTest(e)})),t.addHandler("fwftest",(function(e){return n.loadTest(e)})),t.addHandler("xwftest",(function(e){return n.loadTest(e)}));case 6:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"loadTest",value:(i=(0,c.default)(s.default.mark((function e(t){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n(38735);case 2:e.sent.default(this.defaultGameController)(t);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"setupIniFileHandler",value:(a=(0,c.default)(s.default.mark((function e(){var t=this;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:b.GlobalFileDrop.defaultHandler.addHandler("ini",(function(e){return t.loadIni(e)}));case 2:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)})},{key:"loadIni",value:(r=(0,c.default)(s.default.mark((function e(t){var n,r,a,i,o=this;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.readAsText();case 2:n=e.sent,r=new x.default,a=r.readFromString(n),console.log("contents",a),(i=function(e,t){a[t]&&("boolean"==typeof o.settings[e]&&(o.settings[e]=!!+a[t]),"number"==typeof o.settings[e]&&(o.settings[e]=+a[t]))})("playMusic","options.playMusic"),i("playEffects","options.playSound"),i("difficulty","options.difficulty"),i("tickDuration","options.gameSpeed"),i("worldSize","options.worldSize"),i("lastPlanet","options.terrain");case 13:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"createDebugGameLinks",value:function(){var e=this,t=this.loadGamesFromEnvironment();if(t.length){var n=WebFun.JSX.render("div",{className:"sources"});(0,v.default)(t).call(t,(function(t){var r=(0,d.default)(t,3),a=r[0],i=r[1],o=r[2];n.appendChild(WebFun.JSX.render("a",{onclick:function(){return e.load(i,o).then((function(e){return e.newStory()}))}},a," ")),n.appendChild(WebFun.JSX.render("br",null))})),this.root.appendChild(n)}}},{key:"loadGamesFromEnvironment",value:function(){var e,t=[],n=g(JSON.parse('[{"title":"Yoda Stories from archive.org","variant":"yoda","sfx-format":"wav","exe":"https://cors.archive.org/download/Star_Wars_-_Yoda_Stories_1997_LucasArts/Star%20Wars%20-%20Yoda%20Stories%20%281997%29%28LucasArts%29.iso/Yoda%2FYodesk.exe","sfx":"https://cors.archive.org/download/Star_Wars_-_Yoda_Stories_1997_LucasArts/Star%20Wars%20-%20Yoda%20Stories%20%281997%29%28LucasArts%29.iso/Yoda%2Fsfx%2F","data":"https://cors.archive.org/download/Star_Wars_-_Yoda_Stories_1997_LucasArts/Star%20Wars%20-%20Yoda%20Stories%20%281997%29%28LucasArts%29.iso/Yoda%2Fyodesk.dta","help":"https://cors.archive.org/download/Star_Wars_-_Yoda_Stories_1997_LucasArts/Star%20Wars%20-%20Yoda%20Stories%20%281997%29%28LucasArts%29.iso/Yoda%2FYodesk.hlp"},{"title":"Yoda Stories Demo (archive.org)","variant":"yoda-demo","sfx-format":"wav","exe":"https://cors.archive.org/download/StarWarsYodaStories_1020/YodaDemo.zip/YodaDemo%2FYodaDemo.exe","sfx":"https://archive.org/download/StarWarsYodaStories_1020/YodaDemo.zip/YodaDemo%2Fsfx%2F","data":"https://cors.archive.org/download/StarWarsYodaStories_1020/YodaDemo.zip/YodaDemo%2FYodaDemo.dta","help":"https://cors.archive.org/download/StarWarsYodaStories_1020/YodaDemo.zip/YodaDemo%2FYodaDemo.hlp"}]'));try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push([r.title,this.resolveVariantFromEnvironment(r.variant),{data:r.data,sfx:r.sfx,sfxFormat:r["sfx-format"],help:r.help,exe:r.exe,variant:r.variant}])}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"resolveVariantFromEnvironment",value:function(e){switch(e){case"indy":return w.Indy;case"indy-demo":return w.IndyDemo;case"yoda":return w.Yoda;case"yoda-demo":return w.YodaDemo;default:throw new Error('Invalid game variant "'.concat(e,'" specified'))}}},{key:"ensureAddressbarCanBeHidden",value:function(){this.settings.mobile&&(this.settings.pwa||(document.body.style.height="120vh",(0,y.default)((function(){return window.document.scrollingElement.scrollTop=0}))))}},{key:"load",value:(t=(0,c.default)(s.default.mark((function e(t,n){var r;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new S.default(t,n,this.settings),e.next=3,r.show(this._windowManager);case 3:return e.abrupt("return",r);case 4:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"enterPWA",value:function(){this.isUsingPWA()&&this.root.querySelector("a").click()}},{key:"isUsingPWA",value:function(){return"pwa"===new m.default(window.location.href).searchParams.get("source")}},{key:"windowManager",get:function(){return this.windowManager}}]),e}();t.default=T},91086:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.Mixer=void 0;var r=n(51698);t.Mixer=r.default},51698:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108)),o=r(n(40361)),u=r(n(7583)),l=r(n(68748)),s=r(n(79302));(0,l.default)(t,"__esModule",{value:!0});var d=n(78126),c=n(1799),f=function(){function e(t){(0,o.default)(this,e),this._context=new c.AudioContext,this._settings=t,this._master=this._context.createGain(),this._master.connect(this._context.destination),this._effects=this._context.createGain(),this._effects.connect(this._master),this._music=this._context.createGain(),this._music.connect(this._master)}var t;return(0,u.default)(e,[{key:"prepare",value:(t=(0,i.default)(a.default.mark((function e(t,n){var r=this;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new s.default((function(e,a){r._context.decodeAudioData(n,(function(n){t.representation=n,e()}),a)})));case 1:case"end":return e.stop()}}),e)}))),function(e,n){return t.apply(this,arguments)})},{key:"play",value:function(e,t){if(this._settings[this.settingNameForChannel(t)]){var n=e.representation,r=this.context.createBufferSource();r.buffer=n,r.connect(this.nodeForChannel(t)),r.start(0)}}},{key:"settingNameForChannel",value:function(e){switch(e){case d.Channel.Effect:return"playEffects";case d.Channel.Music:return"playMusic"}}},{key:"nodeForChannel",value:function(e){switch(e){case d.Channel.Effect:return this._effects;case d.Channel.Music:return this._music}}},{key:"stop",value:function(){}},{key:"context",get:function(){return this._context}},{key:"volume",get:function(){return this._master.gain.value},set:function(e){this._master.gain.value=e}}]),e}();t.default=f},90599:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0})},66102:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583)),o=r(n(68748)),u=r(n(92915));(0,o.default)(t,"__esModule",{value:!0});var l=n(31560),s=function(){function e(){(0,a.default)(this,e)}return(0,i.default)(e,[{key:"extractFromDataSection",value:function(e,t){var n=new Uint8Array([67,68,101,115,107,99,112,112,68,111,99,0]);return console.assert(".data"===e.name),t.seek(e.bodyOffset,l.InputStream.Seek.Set),this.extractFromMarker(n,0,t,e.bodySize)}},{key:"extractFromBinary",value:function(e){var t=new Uint8Array([115,115,115]);return e.seek(0,l.InputStream.Seek.Set),this.extractFromMarker(t,-103,e,e.length)}},{key:"extractFromMarker",value:function(e,t,n,r){var a=n.readUint8Array(r);e:for(var i=0;i<a.byteLength;i++){for(var o=0;o<e.byteLength;o++)if(a[i+o]!==e[o])continue e;return(0,u.default)(a).call(a,i+e.length+t,i+e.length+t+1024)}throw new Error("Could not find color palette in binary stream.")}}]),e}();t.default=s},53260:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(63789)),o=a(n(94433)),u=a(n(76108)),l=a(n(40361)),s=a(n(7583)),d=a(n(6060)),c=a(n(80655)),f=a(n(20497)),h=a(n(75244)),p=a(n(68748)),v=a(n(79302)),y=a(n(67093)),m=a(n(42601)),g=a(n(39907)),_=a(n(47053)),w=a(n(3350));function k(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,h.default)(e);if(t){var i=(0,h.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,f.default)(this,n)}}(0,p.default)(t,"__esModule",{value:!0}),t.Event=void 0;var b=n(15695),S=n(17766),I=n(20779),x=n(48387),T=n(31560),M=n(88607),E=n(63806),C=n(63147),A=n(82127),D=n(95451),z=n(27778),P=n(11800),R=n(41099),L=n(59376),F=n(79891),W=n(91086),B=n(87212),N=n(15695),U=n(17725),H=n(8087),O=n(301),Z=n(75235),q=n(83608),X=n(5008),V=n(36104),J=n(78256),G=n(93651),Y=n(92540),j=n(46e3);t.Event={DidLoadData:"didLoadData"};var Q=function(e){(0,c.default)(ne,e);var n,r,a,f,h,p,Q,K,$,ee,te=k(ne);function ne(e,t,n){var r;return(0,l.default)(this,ne),(r=te.call(this))._sceneView=WebFun.JSX.render(b.SceneView,null),r._engine=null,r._eventHandler=new O.default,r.variant=e,r.gameSource=t,r.settings=n,r.settings.mobile=!(!H(!1).isAndroid()&&!H(!1).isIPhone()),r._window=WebFun.JSX.render(C.MainWindow,{className:r.settings.mobile?"mobile":""}),r.setupMainMenu(),r.settings.mobile&&(r._window.classList.add("mobile"),document.body.setAttribute("wf-fullscreen-game","")),r.settings.addEventListener(T.PropertyChangeEvent.type,(0,d.default)(r)),r}return(0,s.default)(ne,[{key:"handleEvent",value:function(e){e.type!==T.PropertyChangeEvent.type||"debug"!==e.detail.property&&"mobile"!==e.detail.property?this._eventHandler.handleEvent(this.engine,this._sceneView,e):this.setupMainMenu()}},{key:"setupMainMenu",value:function(){var e=this.settings.mobile?C.MobileMainMenu:C.MainMenu;this._window.menu=new e(this,this.settings)}},{key:"_buildInterface",value:function(e){var t=this,n=new W.Mixer(this.settings),r=new z.CanvasRenderer.Renderer(this._sceneView.canvas),a=new P.InputManager(this._sceneView,new F.default(this._sceneView),this._window.content.querySelector(N.OnscreenPad.tagName),this._window.content.querySelector("".concat(N.OnscreenButton.tagName,".shoot")),this._window.content.querySelector("".concat(N.OnscreenButton.tagName,".drag"))),i=new L.default(e.exe,e.data,e.sfx,e.sfxFormat),o=new Z.default(console);return{Renderer:function(){return r},InputManager:function(){return a},SceneManager:function(){return t._sceneView.manager},ResourceManager:function(){return i},Mixer:function(){return n},Logger:function(){return o},ShowText:function(e,n){return t.showText(e,n)},ShowDebugStatusInfo:function(e){var n=document.createElement(b.CurrentStatusInfo.tagName);n.engine=e,n.onclose=function(){return e.metronome.start()},e.metronome.stop(),t.window.manager.showWindow(n),n.center()}}}},{key:"show",value:(ee=(0,u.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.showWindow(this._window),this.variant instanceof V.default&&(this._window.ammo.style.display="none"),this._window.x||this._window.y||this._window.center();case 3:case"end":return e.stop()}}),e,this)}))),function(e){return ee.apply(this,arguments)})},{key:"showText",value:function(e,t){var n=this;return new v.default((function(r){var a,i=!!(0,y.default)(a=n.engine.sceneManager.stack).call(a,(function(e){return e instanceof E.MapScene})),o=i?new T.Point(4,4):new T.Point(0,0),u=n._sceneView.effectiveTileSize.scaleBy(i?.9:1),l=i?new T.Size(10,10):new T.Size(9,9),s=new x.ModalSession;s.onend=function(){return r()};var d=n._window.getBoundingClientRect(),c=d.left,f=d.top,h=n._sceneView.getBoundingClientRect(),p=h.left,v=h.top,m=t.y<2,g=!new T.Rectangle(new T.Point(0,0),l).contains(t);t.x=U.min(U.max(0,t.x),l.width),t.y=U.min(U.max(0,t.y),l.height);var _=new T.Point(o.x+t.x*u.width+p-c+u.width/2,o.y+t.y*u.height+v-f+u.height/2+(m?1:-1)*(u.height/2-4)),w=WebFun.JSX.render(X.SpeechBubble,{text:e,onend:function(){return s.end(0)},style:{position:"absolute"},arrowStyle:g?X.SpeechBubble.ArrowStyle.None:m?X.SpeechBubble.ArrowStyle.Top:X.SpeechBubble.ArrowStyle.Bottom,origin:_});s.runForWindow(n._window),n._window.appendChild(w)}))}},{key:"newStory",value:($=(0,u.default)(i.default.mark((function e(){var t,n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,e.t0=(null===(t=this.engine)||void 0===t?void 0:t.gameState)===A.default.Running,!e.t0){e.next=8;break}return e.next=5,x.ModalConfirm("This command will discard the current world.\nBuild a new world anyway?");case 5:e.t1=e.sent,e.t2=x.ConfirmationResult.Confirmed,e.t0=e.t1!==e.t2;case 8:if(!e.t0){e.next=10;break}return e.abrupt("return");case 10:return e.next=12,this.resetEngine();case 12:return e.next=14,this.loadGameData();case 14:T.srand(U.floor(65535*U.random())),(n=this.engine.variant.createNewStory(this.engine)).generateWorld(this._engine.assets,this._engine.variant,10),this._engine.story=n,this._showSceneView(),e.next=24;break;case 21:e.prev=21,e.t3=e.catch(0),this.presentView(WebFun.JSX.render(b.ErrorView,{error:e.t3}));case 24:case"end":return e.stop()}}),e,this,[[0,21]])}))),function(){return $.apply(this,arguments)})},{key:"replayStory",value:(K=(0,u.default)(i.default.mark((function e(){var t,n,r,a,o,u;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=(null===(t=this.engine)||void 0===t?void 0:t.gameState)===A.default.Running,!e.t0){e.next=7;break}return e.next=4,x.ModalConfirm("This command will discard the current world.\nReplay anyway?");case 4:e.t1=e.sent,e.t2=x.ConfirmationResult.Confirmed,e.t0=e.t1!==e.t2;case 7:if(!e.t0){e.next=9;break}return e.abrupt("return");case 9:return n=this.engine.story,r=n.seed,a=n.planet,o=n.size,e.next=12,this.resetEngine();case 12:return e.next=14,this.loadGameData();case 14:T.srand(r),(u=new I.Story(r,a,o)).generateWorld(this._engine.assets,this._engine.variant,10),this._engine.story=u,this._showSceneView();case 19:case"end":return e.stop()}}),e,this)}))),function(){return K.apply(this,arguments)})},{key:"resetEngine",value:(Q=(0,u.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.teardownEngine();case 2:this.setupEngine();case 3:case"end":return e.stop()}}),e,this)}))),function(){return Q.apply(this,arguments)})},{key:"load",value:(p=(0,u.default)(i.default.mark((function e(){var t,n,r,a,o,u,l,s,d,c,f=arguments;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=f.length>0&&void 0!==f[0]?f[0]:null,e.t0=(null===(t=this.engine)||void 0===t?void 0:t.gameState)===A.default.Running,!e.t0){e.next=8;break}return e.next=5,x.ModalConfirm("This command will discard the current world.\nLoad anyway?");case 5:e.t1=e.sent,e.t2=x.ConfirmationResult.Confirmed,e.t0=e.t1!==e.t2;case 8:if(!e.t0){e.next=10;break}return e.abrupt("return");case 10:return e.next=12,this.pickSaveGame(r);case 12:if(a=e.sent){e.next=15;break}return e.abrupt("return");case 15:return o=D.Reader.build(a),u=o.read,e.next=18,this.resetEngine();case 18:return e.next=20,this.loadGameData();case 20:l=new I.AssetManager,this.populateAssetManager(l),s=u(l),d=this.engine,(c=new G.default(s.seed,s.planet,J.WorldSize.Medium)).goal=l.get(S.Puzzle,s.goalPuzzle),c.world=s.world,c.dagobah=s.dagobah,c.puzzles=[s.puzzleIDs1.mapArray((function(e){return l.get(S.Puzzle,e)})),s.puzzleIDs2.mapArray((function(e){return l.get(S.Puzzle,e)}))],d.story=c,d.currentZone=l.get(S.Zone,s.currentZoneID),d.currentWorld=s.onDagobah?d.dagobah:d.world,d.inventory.removeAllItems(),(0,m.default)(n=s.inventoryIDs).call(n,(function(e){return d.inventory.addItem(l.get(S.Tile,e))})),d.hero.location=s.positionOnZone,d.hero.weapon=l.get(S.Char,s.currentWeapon,Y.NullIfMissing),d.hero.setAmmoForWeapon(l.get(S.Char,j.Yoda.charIDs.TheForce),s.forceAmmo),d.hero.setAmmoForWeapon(l.get(S.Char,j.Yoda.charIDs.Blaster),s.blasterAmmo),d.hero.setAmmoForWeapon(l.get(S.Char,j.Yoda.charIDs.BlasterRifle),s.blasterRifleAmmo),d.hero.ammo=s.currentAmmo,d.hero.health=I.Hero.ConvertDamageToHealth(s.damageTaken,s.livesLost),d.totalPlayTime=s.timeElapsed,d.currentPlayStart=new Date,this._showSceneView(d.currentZone);case 44:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"pickSaveGame",value:(h=(0,u.default)(i.default.mark((function e(){var t,n,r,a,u,l=arguments;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=l.length>0&&void 0!==l[0]?l[0]:null){e.next=10;break}return(r=new M.FilePicker).allowedTypes=["*.wld"],r.allowsMultipleFiles=!1,e.next=7,r.pickFile();case 7:a=e.sent,u=(0,o.default)(a,1),n=u[0];case 10:if(n){e.next=12;break}return e.abrupt("return",null);case 12:if((0,g.default)(t=n.name).call(t,".wld")){e.next=14;break}return e.abrupt("return",null);case 14:return e.next=16,n.provideInputStream();case 16:return e.abrupt("return",e.sent);case 17:case"end":return e.stop()}}),e)}))),function(){return h.apply(this,arguments)})},{key:"save",value:(f=(0,u.default)(i.default.mark((function e(){var t,n,r,a,o;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.engine,n=t.variant.save(t),r=new D.Writer(t.assets),a=new T.DiscardingOutputStream,r.write(n,a),o=new T.OutputStream(a.offset),r.write(n,o),e.abrupt("return",T.download(o.buffer,"savegame.wld"));case 8:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"exit",value:(a=(0,u.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.teardownEngine(),this._window.close(),this.settings.removeEventListener("propertyChanged",this),document.body.removeAttribute("wf-fullscreen-game");case 4:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"setupEngine",value:function(){var e=new I.Engine(this.variant,this._buildInterface(this.gameSource));e.settings=this.settings,e.hero.addEventListener(I.Hero.Event.HealthDidChange,this),this.settings.drawDebugStats&&e.sceneManager.addOverlay(new B.default),e.camera.hero=e.hero,this._sceneView.manager.engine=e,this._window.engine=e,this._engine=e,this.settings.debug&&(window.engine=this._engine)}},{key:"teardownEngine",value:(r=(0,u.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._engine){e.next=2;break}return e.abrupt("return");case 2:return this._engine.hero.removeEventListener(I.Hero.Event.HealthDidChange,this),this._window.inventory.removeEventListener(b.Inventory.Events.ItemActivated,this),this._window.inventory.removeEventListener(b.Inventory.Events.ItemPlaced,this),this._window.engine=null,e.next=8,this._engine.metronome.stop();case 8:this._engine.teardown(),this._engine=null,this.data=null,this._sceneView.manager.clear(),window.engine===this._engine&&(window.engine=null);case 13:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"populateAssetManager",value:function(e){e.populate(S.Zone,this.data.zones),e.populate(S.Tile,this.data.tiles),e.populate(S.Puzzle,this.data.puzzles),e.populate(S.Char,this.data.characters),e.populate(S.Sound,this.data.sounds)}},{key:"_showSceneView",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,y.default)(e=this._engine.assets).call(e,S.Zone,(function(e){return e.isLoadingZone()})),r=this._engine;r.metronome.ontick=function(e){return r.update(e)},r.metronome.onrender=function(){return r.render()},r.metronome.tickDuration=r.settings.tickDuration,r.palette=new I.PaletteAnimation(this.palette,r.variant.fastColorCycles,r.variant.slowColorCycles);var a=new E.ZoneScene;a.engine=r,a.zone=n,r.currentZone=n,r.currentWorld=r.world.findLocationOfZone(n)?r.world:r.dagobah,r.hero.appearance=(0,y.default)(t=r.assets).call(t,S.Char,(function(e){return e.isHero()})),r.spu.prepareExecution(q.EvaluationMode.JustEntered,n),r.sceneManager.pushScene(a),this.presentView(this._sceneView),r.inputManager.engine=r,r.inputManager.addListeners(),this._window.inventory.addEventListener(b.Inventory.Events.ItemActivated,this),this._window.inventory.addEventListener(b.Inventory.Events.ItemPlaced,this),this._window.engine=r,this.settings.autostartEngine&&r.metronome.start(),this._engine.gameState=A.default.Running}},{key:"loadGameData",value:function(){var e=this;return new v.default((function(n,r){var a=WebFun.JSX.render(b.LoadingView,null);e.presentView(a),e.engine||e.setupEngine();var i=e.engine,u=new R.default(i.resources,i.mixer,i.variant,(function(){for(var e,t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(e=console).log.apply(e,(0,_.default)(t=["[Loader]"]).call(t,r))}));u.onfail=function(e){return r(e)},u.onprogress=function(e){var t=e.detail.progress;return a.progress=t},u.onloadsetupimage=function(t){var n=t.detail,r=n.pixels,i=n.palette;a.palette=i,a.image=r,e._window.inventory.palette=i,e._window.weapon.palette=i,e.palette=i},u.onloadstrings=function(t){for(var n=t.detail.strings,r=0,a=(0,w.default)(n);r<a.length;r++){var i=(0,o.default)(a[r],2),u=i[0],l=i[1];e.engine.assets.set(String,String(l),+u)}},u.onload=function(r){var i=r.detail.data;a.progress=1,e.data=i,e.populateAssetManager(e._engine.assets),e.dispatchEvent(new CustomEvent(t.Event.DidLoadData,{detail:{data:e.data,palette:e.palette}})),n()},u.load()}))}},{key:"presentView",value:function(e){var t=this._window.mainContent;t.textContent="",t.appendChild(e)}},{key:"jumpStartEngine",value:(n=(0,u.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._showSceneView(t);case 1:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"engine",get:function(){return this._engine}},{key:"window",get:function(){return this._window}}]),ne}(T.EventTarget);Q.Event=t.Event,t.default=Q},301:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o=n(15695),u=n(17766),l=n(20779),s=n(31560),d=n(63806),c=n(82127),f=n(78126),h=n(46e3),p=function(){function e(){(0,a.default)(this,e)}return(0,i.default)(e,[{key:"handleEvent",value:function(e,t,n){switch(n.type){case l.Hero.Event.HealthDidChange:if(e.hero.health>0)return;if(e.inventory.contains(h.Yoda.tileIDs.SpiritHeart)){e.hero.health=l.Hero.MaxHealth,e.inventory.removeItem(h.Yoda.tileIDs.SpiritHeart);var r=e.assets.get(u.Sound,h.Yoda.sounds.Flourish);return void e.mixer.play(r,f.Channel.Effect)}return e.gameState=c.default.Lost,void e.sceneManager.pushScene(new d.LoseScene);case o.Inventory.Events.ItemActivated:if(e.gameState!==c.default.Running&&e.gameState!==c.default.Won)return void n.preventDefault();if(!(e.sceneManager.currentScene instanceof d.ZoneScene))return e.sceneManager.popScene(),void n.preventDefault();var a=n.detail.item;if(!a)return;return a.hasAttributes(u.Tile.Attributes.Map)?void e.sceneManager.pushScene(new d.MapScene):void e.metronome.stop();case o.Inventory.Events.ItemPlaced:if(e.gameState!==c.default.Running&&e.gameState!==c.default.Won)return void n.preventDefault();var i=n.detail.location,p=n.detail.item,v=document.elementFromPoint(i.x,i.y),y=v&&v.closest([o.Ammo.tagName,o.Weapon.tagName,o.Health.tagName,o.SceneView.tagName].join(",")),m=!1;if(y instanceof o.Health&&p.hasAttributes(u.Tile.Attributes.Edible)&&(e.consume(p),m=!0),p.hasAttributes(u.Tile.Attributes.Weapon)&&(y instanceof o.Ammo||y instanceof o.Weapon)&&(e.equip(p),m=!0),!m){var g=t.getBoundingClientRect(),_=g.left,w=g.top,k=i.bySubtracting(_,w).dividedBy(t.effectiveTileSize).byFlooring();if(!new s.Rectangle(new s.Point(0,0),new s.Size(9,9)).contains(k))return void e.metronome.start();var b=k.bySubtracting(e.camera.offset.x,e.camera.offset.y);if(b.z=null,!new s.Rectangle(new s.Point(0,0),e.currentZone.size).contains(b))return void e.metronome.start();e.inputManager.placedTile=p,e.inputManager.placedTileLocation=b}e.metronome.start()}}}]),e}();t.default=p},80885:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.GameController=t.App=void 0;var r=n(53260);t.GameController=r.default;var a=n(34785);t.App=a.default},11011:(e,t,n)=>{var r=n(92915),a=n(69159),i=n(67986),o=n(13037),u=n(29689),l=n(38468),s=l(n(25867)),d=l(n(40361)),c=l(n(7583)),f=l(n(68748)),h=l(n(20778)),p=l(n(75356)),v=l(n(36029)),y=l(n(92915)),m=l(n(47053));function g(e,t){var n=void 0!==i&&o(e)||e["@@iterator"];if(!n){if(u(e)||(n=function(e,t){var n;if(!e)return;if("string"==typeof e)return _(e,t);var i=r(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return a(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return _(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var l=0,s=function(){};return{s,n:function(){return l>=e.length?{done:!0}:{done:!1,value:e[l++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var d,c=!0,f=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){f=!0,d=e},f:function(){try{c||null==n.return||n.return()}finally{if(f)throw d}}}}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}(0,f.default)(t,"__esModule",{value:!0}),t.IniReaderDefaultOptions=void 0,t.IniReaderDefaultOptions={caseSensitiveKeys:!1,caseNormalizationStrategy:function(e){return e.toLowerCase()},encoding:"utf-8",lineSeparator:"\r\n",commentChar:";",sectionNameDelimiters:"[]"};var w=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,d.default)(this,e),this.options=(0,h.default)({},t.IniReaderDefaultOptions,n)}return(0,c.default)(e,[{key:"read",value:function(e){var t=e.readCharacters(e.length,this.options.encoding);return this.readFromString(t)}},{key:"readFromString",value:function(e){var t={};this.options.caseSensitiveKeys||(t=this.makeCaseInensitive(t));var n,r=null,a=g(e.split(this.options.lineSeparator));try{for(a.s();!(n=a.n()).done;){var i,o=n.value,u=(0,p.default)(o).call(o,this.options.commentChar);if(-1!==u&&(o=o.substr(0,u)),0!==(o=(0,v.default)(o).call(o)).length&&!(o.length<2))if(o[0]!==this.options.sectionNameDelimiters[0]||o[o.length-1]!==this.options.sectionNameDelimiters[1]){var l=o.split("="),d=(0,s.default)(l),c=d[0],f=(0,y.default)(d).call(d,1);t[r?(0,m.default)(i="".concat(r,".")).call(i,c):"".concat(c)]=f.join("=")}else r=o.substring(1,o.length-1)}}catch(e){a.e(e)}finally{a.f()}return t}},{key:"makeCaseInensitive",value:function(e){var t=this.options.caseNormalizationStrategy;return new Proxy(e,{set:function(e,n,r){return"string"==typeof n&&(n=t(n)),e[n]=r,!0},get:function(e,n){return"string"==typeof n&&(n=t(n)),e[n]}})}}]),e}();t.default=w},79891:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o=n(31560);n(93824);var u=function(){function e(t){(0,a.default)(this,e),this._node=t}return(0,i.default)(e,[{key:"changeCursor",value:function(e){var t=null;"string"==typeof e&&(t=e),"number"==typeof e&&(t=this._cursorNameForDirection(e)),null!==t?this._node.dataset.cursor="".concat(t):delete this._node.dataset.cursor}},{key:"_cursorNameForDirection",value:function(e){switch(e){case o.Direction.East:return"east";case o.Direction.SouthEast:return"south-east";case o.Direction.South:return"south";case o.Direction.SouthWest:return"south-west";case o.Direction.West:return"west";case o.Direction.NorthWest:return"north-west";case o.Direction.North:return"north";case o.Direction.NorthEast:return"north-east";default:console.assert(!1,"Invalid direction given!")}}}]),e}();t.default=u},11800:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.InputManager=void 0;var r=n(66967);t.InputManager=r.default},66967:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583)),o=r(n(68748)),u=r(n(42601));(0,o.default)(t,"__esModule",{value:!0});var l=n(34159),s=n(64141),d=n(21106),c=n(99222),f=function(){function e(t,n,r,i,o){(0,a.default)(this,e),this.placedTile=null,this.placedTileLocation=null,this.gameViewElement=t,this.keyboardInputManager=new s.default,this.mouseInputManager=new d.default(t,n),this.onscreenInputManager=new c.default(t,r,i,o),this.inputManagers=[this.keyboardInputManager,this.mouseInputManager,this.onscreenInputManager]}return(0,i.default)(e,[{key:"mouseLocationInView",get:function(){return this.mouseInputManager.mouseLocationInView}},{key:"clear",value:function(){var e;this.placedTileLocation=null,this.placedTile=null,(0,u.default)(e=this.inputManagers).call(e,(function(e){return e.clear()}))}},{key:"addListeners",value:function(){var e;this.gameViewElement.addEventListener("contextmenu",this),(0,u.default)(e=this.inputManagers).call(e,(function(e){return e.addListeners()}))}},{key:"handleEvent",value:function(e){e.stopPropagation(),e.preventDefault()}},{key:"removeListeners",value:function(){var e;this.gameViewElement.removeEventListener("contextmenu",this),(0,u.default)(e=this.inputManagers).call(e,(function(e){return e.removeListeners()}))}},{key:"readInput",value:function(e){var t=this.keyboardInputManager.readInput(e),n=this.keyboardInputManager.lastDirectionInput,r=this.onscreenInputManager.readInput(e),a=this.onscreenInputManager.lastDirectionInput,i=this.mouseInputManager.readInput(e),o=this.mouseInputManager.lastDirectionInput,u=0;return u=n>a?n>o?t&l.InputMask.Movement:i&l.InputMask.Movement:a>o?r&l.InputMask.Movement:i&l.InputMask.Movement,t&~l.InputMask.Movement|r&~l.InputMask.Movement|i&~l.InputMask.Movement|u}},{key:"engine",get:function(){return this._engine},set:function(e){var t;this._engine=e,(0,u.default)(t=this.inputManagers).call(t,(function(t){return t.engine=e}))}},{key:"mouseDownHandler",get:function(){return this.inputManagers.first().mouseDownHandler},set:function(e){var t;(0,u.default)(t=this.inputManagers).call(t,(function(t){return t.mouseDownHandler=e}))}},{key:"keyDownHandler",get:function(){return this.inputManagers.first().keyDownHandler},set:function(e){var t;(0,u.default)(t=this.inputManagers).call(t,(function(t){return t.keyDownHandler=e}))}}]),e}();t.default=f},64141:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583)),o=r(n(68748)),u=r(n(49477));(0,o.default)(t,"__esModule",{value:!0});var l=n(34159),s=function(){function e(){(0,a.default)(this,e),this.lastDirectionInput=performance.now()}return(0,i.default)(e,[{key:"clear",value:function(){this._currentInput&=~l.InputMask.Map,this._currentInput&=~l.InputMask.Pause}},{key:"addListeners",value:function(){document.addEventListener("keydown",this),document.addEventListener("keyup",this)}},{key:"handleEvent",value:function(e){if(!(e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement||e.target instanceof HTMLElement&&e.target.hasAttribute("contenteditable"))){if("keydown"===e.type&&"F8"===e.code&&e.ctrlKey&&e.shiftKey)return this.engine.showDebugStatusInfo(),e.stopPropagation(),void e.preventDefault();(0,u.default)(e)||"keydown"!==e.type?(0,u.default)(e)||"keyup"!==e.type||this._keyUp(e):this._keyDown(e),(0,u.default)(e)&&e.preventDefault()}}},{key:"_keyDown",value:function(e){var t=!0,n=0;switch(e.code){case"ArrowUp":case"KeyW":n|=l.Direction.Up,this._currentInput|=l.InputMask.ScrollUp,this.lastDirectionInput=performance.now();break;case"ArrowDown":case"KeyS":this._currentInput|=l.InputMask.ScrollDown,n|=l.Direction.Down,this.lastDirectionInput=performance.now();break;case"ArrowLeft":case"KeyA":n|=l.Direction.Left,this.lastDirectionInput=performance.now();break;case"ArrowRight":case"KeyD":n|=l.Direction.Right,this.lastDirectionInput=performance.now();break;case"Space":this._currentInput|=l.InputMask.Attack,this._currentInput|=l.InputMask.EndDialog,this._currentInput|=l.InputMask.PickUp;break;case"ShiftLeft":case"ShiftRight":this._currentInput|=l.InputMask.Drag;break;case"KeyP":this._currentInput^=l.InputMask.Pause;break;case this.engine.variant.mapKey:this._currentInput^=l.InputMask.Map;break;default:t=!1}e.metaKey||e.ctrlKey||(this._keyboardDirection|=n,this._keyboardDirection&&(this._currentInput|=l.InputMask.Walk),this.keyDownHandler?this.keyDownHandler(e):t&&(e.stopPropagation(),e.preventDefault()))}},{key:"_keyUp",value:function(e){var t=!0,n=65535;switch(e.code){case"ArrowUp":case"KeyW":n=~l.Direction.Up,this._currentInput&=~l.InputMask.ScrollUp,this.lastDirectionInput=performance.now();break;case"ArrowDown":case"KeyS":n&=~l.Direction.Down,this._currentInput&=~l.InputMask.ScrollDown,this.lastDirectionInput=performance.now();break;case"ArrowLeft":case"KeyA":n&=~l.Direction.Left,this.lastDirectionInput=performance.now();break;case"ArrowRight":case"KeyD":n&=~l.Direction.Right,this.lastDirectionInput=performance.now();break;case"Space":this._currentInput&=~l.InputMask.Attack,this._currentInput&=~l.InputMask.EndDialog,this._currentInput&=~l.InputMask.PickUp;break;case"ShiftLeft":case"ShiftRight":this._currentInput&=~l.InputMask.Drag;break;default:t=!1}this._keyboardDirection&=n,this._keyboardDirection||(this._currentInput&=~l.InputMask.Walk),t&&(e.preventDefault(),e.stopPropagation())}},{key:"readInput",value:function(e){return this._currentInput|this._keyboardDirection}},{key:"removeListeners",value:function(){document.removeEventListener("keydown",this),document.removeEventListener("keyup",this)}}]),e}();t.default=s},21106:(e,t,n)=>{var r=n(38468),a=r(n(94433)),i=r(n(40361)),o=r(n(7583)),u=r(n(68748)),l=r(n(35983)),s=r(n(68190));(0,u.default)(t,"__esModule",{value:!0});var d,c=n(34159),f=n(20779),h=n(31560),p=n(63806),v=n(17725),y=n(27818);!function(e){e[e.Direction=0]="Direction",e[e.Path=1]="Path"}(d||(d={}));var m=function(){function e(t,n){(0,i.default)(this,e),this.lastDirectionInput=performance.now(),this.mouseMode=d.Direction,this._highlight=new y.default,this._mouseDirection=0,this._element=t,this.cursorManager=n,this._lastMouse=new h.Point(NaN,NaN),this._highlight.highlight=new h.Point(3,2)}return(0,o.default)(e,[{key:"clear",value:function(){}},{key:"addListeners",value:function(){document.addEventListener("mousemove",this),document.addEventListener("mousedown",this),document.addEventListener("mouseup",this),this.engine.addEventListener(f.Engine.Event.CurrentZoneChange,this),this.engine.sceneManager.addOverlay(this._highlight)}},{key:"handleEvent",value:function(e){if(!(e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement||e.target instanceof HTMLElement&&e.target.hasAttribute("contenteditable"))){switch(e.type){case f.Engine.Event.CurrentZoneChange:this.pathTarget=null,this._highlight.highlight=null,this._highlight.target=null;break;case"mouseup":return this._mouseUp(e);case"mousedown":return this._mouseDown(e);case"mousemove":return this._mouseMove(e)}e.preventDefault(),e.stopPropagation()}}},{key:"_mouseDown",value:function(e){var t=new h.Point(e.clientX,e.clientY);if(this._element.contains(e.target)){var n=this.convertClientCoordinatesToView(t),r=n.x>0&&n.y>0&&n.x<1&&n.y<1;console.assert(r,"Previous in-bounds check should have been sufficient"),this.mouseDownHandler&&this.mouseDownHandler(n),this._lastMouse=n,this.updateMouse(),this.lastDirectionInput=performance.now(),this.mouseMode===d.Direction?(0===e.button&&(this._currentInput|=c.InputMask.Walk),2===e.button&&(this._currentInput|=c.InputMask.Attack)):(this.pathTarget=n.byScalingBy(9).floor().subtract(this.engine.camera.offset),this._highlight.target=this.pathTarget)}}},{key:"_mouseMove",value:function(e){var t=new h.Point(e.clientX,e.clientY),n=this.convertClientCoordinatesToView(t);n.isEqualTo(this._lastMouse)||(this._lastMouse=n,this.updateMouse(),this.lastDirectionInput=performance.now())}},{key:"updateMouse",value:function(){if(this.engine.settings.lookTowardsMouse){var e=this.calculateDirectionFromHero(this._lastMouse),t=(0,a.default)(e,2),n=t[0],r=t[1];this._mouseDirection=n,this.mouseMode===d.Direction?this._updateCursor(n,r):(this.cursorManager.changeCursor(null),this._highlight.highlight=new h.Point(this._lastMouse.x,this._lastMouse.y))}}},{key:"_directionInputFromAngle",value:function(e){var t=0;return e.x<0&&(t|=c.Direction.Left),e.x>0&&(t|=c.Direction.Right),e.y<0&&(t|=c.Direction.Up),e.y>0&&(t|=c.Direction.Down),t}},{key:"_mouseUp",value:function(e){0===e.button&&(this._currentInput&=~c.InputMask.Walk),2===e.button&&(this._currentInput&=~c.InputMask.Attack),this.lastDirectionInput=performance.now(),this._mouseDirection=0}},{key:"convertClientCoordinatesToView",value:function(e){var t=this._element.getBoundingClientRect(),n=new h.Point(t.left,t.top);return h.Point.subtract(e,n).dividedBy(t)}},{key:"calculateDirectionFromHero",value:function(e){var t=this.engine;if(!t)return[0,null];var n=e,r=t.camera,a=r.offset,i=r.size,o=t.hero,u=new h.Point(n.x*i.width-a.x-.5,n.y*i.height-a.y-.5),l=h.Point.subtract(u,o.location),s=Math.abs(l.x)<.5&&Math.abs(l.y)<.5,d=n.x<1/18||n.y<1/18||n.x>17/18||n.y>17/18;if(!s||d){var c=h.Direction.Confine(h.Direction.CalculateAngleFromRelativePoint(l));if(isNaN(c))return[0,null];var f=h.Direction.CalculateRelativeCoordinates(c,1);return[this._directionInputFromAngle(f),c]}return[0,null]}},{key:"_updateCursor",value:function(e,t){!this.engine||this.engine.sceneManager.currentScene instanceof p.ZoneScene&&this.engine.hero.visible?null===t?this.cursorManager.changeCursor("block"):this.cursorManager.changeCursor(t):this.cursorManager.changeCursor(null)}},{key:"readInput",value:function(e){if(this.pathTarget){var t,n=this.engine.currentZone,r=this.engine.hero.location,a=this.pathTarget;if(r.isEqualTo(a))return this.pathTarget=null,c.InputMask.None;var i=function(e){return e.x+e.y*n.size.width},o=function(e){return new h.Point(e%n.size.width,v.floor(e/n.size.width))},u=null!==(t=h.astar(i(r),i(a),(function(e){var t,r;return(0,l.default)(t=(0,s.default)(r=[o(e).byAdding(-1,-1),o(e).byAdding(0,-1),o(e).byAdding(1,-1),o(e).byAdding(-1,0),o(e).byAdding(1,0),o(e).byAdding(-1,1),o(e).byAdding(0,1),o(e).byAdding(1,1)]).call(r,(function(e){return n.bounds.contains(e)&&n.placeWalkable(e)||e.isEqualTo(a)}))).call(t,i)}),(function(e,t){return o(e).manhattanDistanceTo(o(t))}),(function(e){return o(e).manhattanDistanceTo(a)})))&&void 0!==t?t:[];u.shift();var d=o(u.shift()),f=c.InputMask.Walk;return d.x<r.x?f|=c.InputMask.Left:d.x>r.x&&(f|=c.InputMask.Right),d.y<r.y?f|=c.InputMask.Up:d.y>r.y&&(f|=c.InputMask.Down),0===u.length&&(this.pathTarget=null),f}return this._mouseDirection|this._currentInput}},{key:"removeListeners",value:function(){var e,t;document.removeEventListener("mousemove",this),document.removeEventListener("mousedown",this),document.removeEventListener("mouseup",this),null===(e=this.engine)||void 0===e||e.removeEventListener(f.Engine.Event.CurrentZoneChange,this),null===(t=this.engine)||void 0===t||t.sceneManager.removeOverlay(this._highlight)}},{key:"mouseLocationInView",get:function(){return this._lastMouse}}]),e}();t.default=m},99222:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o=n(34159),u=n(31560),l=n(63806),s=function(){function e(t,n,r,i){(0,a.default)(this,e),this.gameViewElement=t,this.pad=n,this.shoot=r,this.drag=i}return(0,i.default)(e,[{key:"readInput",value:function(e){var t=o.InputMask.None;return this.shoot.pressed&&(t|=o.InputMask.Attack),this.drag.pressed&&(t|=o.InputMask.Drag),t|=this.pad.input}},{key:"clear",value:function(){}},{key:"addListeners",value:function(){this.gameViewElement.addEventListener("touchstart",this),this.gameViewElement.addEventListener("mousedown",this)}},{key:"handleEvent",value:function(e){var t,n;if((null===(t=this.engine)||void 0===t||null===(n=t.sceneManager)||void 0===n?void 0:n.currentScene)instanceof l.PickupScene)this.engine.sceneManager.popScene();else if("touchstart"===e.type){var r=new u.Point(e.changedTouches[0].clientX,e.changedTouches[0].clientY),a=this.convertClientCoordinatesToView(r);this.mouseLocationInView=r,this.mouseDownHandler&&this.mouseDownHandler(a),this.mouseLocationInView=null}}},{key:"convertClientCoordinatesToView",value:function(e){var t=this.gameViewElement.getBoundingClientRect(),n=new u.Point(t.left,t.top);return u.Point.subtract(e,n).dividedBy(t)}},{key:"removeListeners",value:function(){this.gameViewElement.removeEventListener("mousedown",this),this.gameViewElement.removeEventListener("touchstart",this)}},{key:"lastDirectionInput",get:function(){return this.pad.lastInput}}]),e}();t.default=s},27818:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(63789)),o=a(n(76108)),u=a(n(40361)),l=a(n(7583)),s=a(n(80655)),d=a(n(20497)),c=a(n(75244));function f(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,d.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0});var h=n(20779),p=n(31560),v=n(63806),y=n(27778),m=n(17766),g=function(e){(0,s.default)(r,e);var t,n=f(r);function r(){var e;return(0,u.default)(this,r),(e=n.apply(this,arguments)).offset=0,e}return(0,l.default)(r,[{key:"render",value:function(e){if(this.canRender(e)){if(this.highlight){var t=this.walkable;this.highlightTile(e,this.highlight.byScalingBy(9).floor(),t?p.rgba(0,255,0,.5):p.rgba(255,0,0,.5),t?this.offset:0)}this.target&&this.highlightTile(e,this.target.byAdding(this.cameraOffset),p.rgba(255,255,255,.8),this.offset)}}},{key:"update",value:(t=(0,o.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.offset--;case 1:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"highlightTile",value:function(e,t,n,r){var a=e.context;a.save(),a.globalCompositeOperation="source-over",a.lineWidth=2,a.strokeStyle=n,a.setLineDash([5]),a.lineDashOffset=r,a.strokeRect(t.x*m.Tile.WIDTH,t.y*m.Tile.HEIGHT,m.Tile.WIDTH,m.Tile.HEIGHT),a.restore()}},{key:"walkable",get:function(){var e=this.engine.sceneManager.currentScene,t=this.highlight.byScalingBy(9).floor().subtract(this.cameraOffset);return e.zone.bounds.contains(t)&&e.zone.placeWalkable(t)}},{key:"canRender",value:function(e){return!(!this.highlight&&!this.target)&&(!!this.engine&&(!!this.engine.sceneManager&&(this.engine.sceneManager.currentScene instanceof v.ZoneScene&&(e instanceof y.CanvasRenderer.Renderer&&!!this.engine.hero.visible))))}}]),r}(h.Scene);t.default=g},41099:(e,t,n)=>{var r=n(79406),a=n(92915),i=n(69159),o=n(67986),u=n(13037),l=n(29689),s=n(38468),d=s(n(63789)),c=s(n(94433)),f=s(n(76108)),h=s(n(40361)),p=s(n(7583)),v=s(n(80655)),y=s(n(20497)),m=s(n(75244)),g=s(n(68748)),_=s(n(79302)),w=s(n(35983)),k=s(n(68190));function b(e,t){var n=void 0!==o&&u(e)||e["@@iterator"];if(!n){if(l(e)||(n=function(e,t){var n;if(!e)return;if("string"==typeof e)return S(e,t);var r=a(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return i(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return S(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,s=function(){};return{s,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var d,c=!0,f=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){f=!0,d=e},f:function(){try{c||null==n.return||n.return()}finally{if(f)throw d}}}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function I(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,m.default)(e);if(t){var i=(0,m.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,y.default)(this,n)}}(0,g.default)(t,"__esModule",{value:!0}),t.StageCount=t.Events=void 0;var x=n(31560),T=n(20779);t.Events={Progress:"progress",Fail:"fail",Load:"load",DidLoadSetupImage:"loadsetupimage",DidLoadStrings:"loadstrings"},t.StageCount=5;var M=function(e){(0,v.default)(l,e);var n,r,a,i,o,u=I(l);function l(e,n,r,a){var i;return(0,h.default)(this,l),(i=u.call(this)).log=a,i._resources=e,i._mixer=n,i._variant=r,i.registerEvents(t.Events),i}return(0,p.default)(l,[{key:"load",value:(o=(0,f.default)(d.default.mark((function e(){return d.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.loadPalette();case 3:return e.next=5,this.loadGameData();case 5:return e.next=7,this.readGameData();case 7:return e.next=9,this.loadSounds();case 9:return e.next=11,this.loadStrings();case 11:this.log("All resources loaded"),this.dispatchEvent(t.Events.Load,{palette:this._palette,data:this._data}),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(0),this.log("Failed",e.t0),this.dispatchEvent(t.Events.Fail,{reason:e.t0});case 19:case"end":return e.stop()}}),e,this,[[0,15]])}))),function(){return o.apply(this,arguments)})},{key:"loadPalette",value:(i=(0,f.default)(d.default.mark((function e(){var t=this;return d.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.log("Load palette"),this._progress(0,0),e.next=4,this._resources.loadPalette((function(e){return t._progress(0,e)}));case 4:this._palette=e.sent,this._progress(0,1);case 6:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"loadGameData",value:(a=(0,f.default)(d.default.mark((function e(){var n,r=this;return d.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.log("Load game data"),this._progress(1,0),n=!1,e.abrupt("return",new _.default(function(){var e=(0,f.default)(d.default.mark((function e(a,i){var o,u;return d.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r._resources.loadGameFile((function(e){return r._progress(1,e)}));case 2:o=e.sent,u=T.readGameDataFileProgressively(o,r._variant),o.onprogress=function(){r._progress(1,o.bytesAvailable/o.bytesTotal);var e=u.next(),a=e.done,i=e.value;a||i&&i.setup&&(o.onprogress=function(){return r._progress(1,o.bytesAvailable/o.bytesTotal)},n=!0,r.dispatchEvent(t.Events.DidLoadSetupImage,{pixels:i.setup,palette:r._palette}))},o.onerror=function(){o.onprogress=null,o.onload=null,i(o.error)},o.onload=function(){for(;;){var e=u.next(),i=e.value,l=e.done;if(i&&(r._rawData=i),l)break}n||r.dispatchEvent(t.Events.DidLoadSetupImage,{pixels:r._rawData.setup,palette:r._palette}),r._progress(1,1),o.onprogress=null,o.onload=null,a()};case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 4:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"readGameData",value:function(){return this.log("Read game data"),this._progress(2,0),this._data=new T.GameData(this._rawData),this._progress(2,1),_.default.resolve()}},{key:"loadSounds",value:(r=(0,f.default)(d.default.mark((function e(){var t,n,r,a,i,o,u,l,s,f,h=this;return d.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.log("Load sounds"),this._progress(3,0),r=0,a=(0,w.default)(t=(0,k.default)(n=this._data.sounds).call(n,(function(e){return e.file}))).call(t,(function(e){return[e,h._resources.loadSound(e.file,(function(e){r+=e,h._progress(3,r/a.length)}))]})),i=b(a),e.prev=5,i.s();case 7:if((o=i.n()).done){e.next=16;break}return u=(0,c.default)(o.value,2),l=u[0],s=u[1],e.next=11,s;case 11:return f=e.sent,e.next=14,this._mixer.prepare(l,f);case 14:e.next=7;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(5),i.e(e.t0);case 21:return e.prev=21,i.f(),e.finish(21);case 24:this._progress(3,1);case 25:case"end":return e.stop()}}),e,this,[[5,18,21,24]])}))),function(){return r.apply(this,arguments)})},{key:"loadStrings",value:(n=(0,f.default)(d.default.mark((function e(){var n=this;return d.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.log("Load strings"),this._progress(4,0),e.t0=this,e.t1=t.Events.DidLoadStrings,e.next=6,this._resources.loadStrings((function(e){return n._progress(4,e)}));case 6:e.t2=e.sent,e.t3={strings:e.t2},e.t0.dispatchEvent.call(e.t0,e.t1,e.t3),this._progress(4,1);case 10:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"_progress",value:function(e,n){this.dispatchEvent(t.Events.Progress,{progress:(e+n)/t.StageCount})}}]),l}(x.EventTarget);t.default=M},75235:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o=function(){function e(t){(0,a.default)(this,e),this.console=t}return(0,i.default)(e,[{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.console.debug(t)}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.console.info(t)}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.console.warn(t)}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.console.error(t)}}]),e}();t.default=o},87898:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0}),n(66822),n(80413);var o=n(15695),u=n(63147),l=n(88607);n(90599);var s=n(34785),d=n(31560),c=n(50177),f=function(){var e=(0,i.default)(a.default.mark((function e(){var t,r;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=d.observable(d.persistent(c.defaultSettings,"settings",localStorage))).debug){e.next=7;break}return e.next=4,n(45933);case 4:window.WebFun=e.sent,n(28474).default(),n(71277).default();case 7:window.WebFun=window.WebFun||{JSX:null,App:{App:s.default}},window.WebFun.JSX=new l.ComponentJSXRenderer,l.ComponentRegistry.sharedRegistry.registerComponents(l.Components),l.ComponentRegistry.sharedRegistry.registerComponents(o),l.ComponentRegistry.sharedRegistry.registerComponents(u),r=document.querySelector("wf-app"),new s.default(r,t).run();case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();window.addEventListener("load",f,{once:!0})},90780:(e,t,n)=>{var r=n(38468)(n(68748));(0,r.default)(t,"__esModule",{value:!0}),t.StringResourceParser=t.ResourceSectionParser=t.ResourceType=t.PortableExecutableParser=void 0;var a=n(95748);t.PortableExecutableParser=a.default;var i=n(8651);t.ResourceSectionParser=i.default;var o=n(23864);t.StringResourceParser=o.default;var u=n(11708);(0,r.default)(t,"ResourceType",{enumerable:!0,get:function(){return u.ResourceType}})},95748:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(7583)),o=a(n(40361)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244)),d=a(n(46386));function c(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),t.PortaleExecutableFileFormatError=void 0;var f=n(31560),h=function(e){(0,u.default)(n,e);var t=c(n);function n(){return(0,o.default)(this,n),t.apply(this,arguments)}return n}((0,d.default)(Error));t.PortaleExecutableFileFormatError=h;var p=function(){function e(){(0,o.default)(this,e)}return(0,i.default)(e,[{key:"parse",value:function(e){var t=this.readMZ(e);e.seek(t.peHeaderOffset,f.InputStream.Seek.Set);var n=this.readPEHeader(e);return this.skipPastOptionalHeader(e,n.sizeOfOptionalHeader),{mz:t,coff:n,sections:this.readSections(e,n.numberOfSections)}}},{key:"readMZ",value:function(e){var t=e.readCharacters(2);if("MZ"!==t)throw new h("File does not contain a valid MZ header.");return{magic:t,data:e.readUint8Array(58),peHeaderOffset:e.readUint32()}}},{key:"readPEHeader",value:function(e){if("PE"!==e.readCharacters(2))throw new h("File does not contain a valid PE header");var t=e.readUint16();return console.assert(0===t),this.readCoffHeader(e)}},{key:"readCoffHeader",value:function(e){return{machine:e.readUint16(),numberOfSections:e.readUint16(),timeDateStamp:e.readUint32(),pointerToSymbolTable:e.readUint32(),numberOfSymbols:e.readUint32(),sizeOfOptionalHeader:e.readUint16(),characteristics:e.readUint16()}}},{key:"skipPastOptionalHeader",value:function(e,t){e.seek(t,f.InputStream.Seek.Cur)}},{key:"readSections",value:function(e,t){for(var n=[],r=0;r<t;r++)n.push(this.readSection(e));return n}},{key:"readSection",value:function(e){var t=e.readCStringWithLength(8),n=e.readUint32(),r=e.readUint32(),a=e.readUint32(),i=e.readUint32(),o=e.readUint32(),u=e.readUint32(),l=e.readUint16();return{name:t,virtualSize:n,virtualAddress:r,bodySize:a,bodyOffset:i,lineNumbersOffset:u,lineNumbersCount:e.readUint16(),relocationsOffset:o,relocationCount:l,characteristics:e.readUint32()}}}]),e}();t.default=p},8651:(e,t,n)=>{var r=n(92915),a=n(69159),i=n(67986),o=n(13037),u=n(29689),l=n(95753),s=n(36225),d=n(68190),c=n(76593),f=n(42601),h=n(75533),p=n(54558),v=n(68748),y=n(38468),m=y(n(57362)),g=y(n(40361)),_=y(n(7583));function w(e,t){var n=l(e);if(s){var r=s(e);t&&(r=d(r).call(r,(function(t){return c(e,t).enumerable}))),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n,r=null!=arguments[t]?arguments[t]:{};if(t%2)f(n=w(Object(r),!0)).call(n,(function(t){(0,m.default)(e,t,r[t])}));else if(h)p(e,h(r));else{var a;f(a=w(Object(r))).call(a,(function(t){v(e,t,c(r,t))}))}}return e}function b(e,t){var n=void 0!==i&&o(e)||e["@@iterator"];if(!n){if(u(e)||(n=function(e,t){var n;if(!e)return;if("string"==typeof e)return S(e,t);var i=r(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return a(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return S(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var l=0,s=function(){};return{s,n:function(){return l>=e.length?{done:!0}:{done:!1,value:e[l++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var d,c=!0,f=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){f=!0,d=e},f:function(){try{c||null==n.return||n.return()}finally{if(f)throw d}}}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}(0,y(n(68748)).default)(t,"__esModule",{value:!0});var I=n(31560),x=function(){function e(){(0,g.default)(this,e)}return(0,_.default)(e,[{key:"parse",value:function(e,t){t.seek(e.bodyOffset,I.InputStream.Seek.Set);var n,r=[],a=b(this.readDirectory(t,e.bodyOffset).idEntries);try{for(a.s();!(n=a.n()).done;){var i,o=n.value,u=b(o.content.idEntries);try{for(u.s();!(i=u.n()).done;){var l,s=i.value,d=b(s.content.idEntries);try{for(d.s();!(l=d.n()).done;){var c=l.value;r.push(k({type:o.name,nameIdentifier:s.name,language:c.name},c.content))}}catch(e){d.e(e)}finally{d.f()}}}catch(e){u.e(e)}finally{u.f()}}}catch(e){a.e(e)}finally{a.f()}return r}},{key:"readDirectory",value:function(e,t){for(var n=this.readDirectoryHeader(e),r=n.numberOfNamedEntries,a=n.numberOfIdEntries,i=[],o=0;o<r;o++)i.push(this.readImageResourceDirectoryEntry(e));for(var u=[],l=0;l<a;l++)u.push(this.readImageResourceDirectoryEntry(e));for(var s=e.offset,d=0,c=i;d<c.length;d++){var f=c[d];e.seek(t+f.offset&2147483647,I.InputStream.Seek.Set),2147483648&f.offset?f.content=this.readDirectory(e,t):f.content=this.readDirectoryEntry(e)}for(var h=0,p=u;h<p.length;h++){var v=p[h];e.seek(t+v.offset&2147483647,I.InputStream.Seek.Set),2147483648&v.offset?v.content=this.readDirectory(e,t):v.content=this.readDirectoryEntry(e)}return e.seek(s,I.InputStream.Seek.Set),{namedEntries:i,idEntries:u}}},{key:"readImageResourceDirectoryEntry",value:function(e){return{name:e.readUint32(),offset:e.readUint32(),content:null}}},{key:"readDirectoryEntry",value:function(e){return{offset:e.readUint32(),size:e.readUint32(),codePage:e.readUint32(),reserved:e.readUint32()}}},{key:"readDirectoryHeader",value:function(e){return{characteristics:e.readUint32(),timeDateStamp:e.readUint32(),majorVersion:e.readUint16(),minorVersion:e.readUint16(),numberOfNamedEntries:e.readUint16(),numberOfIdEntries:e.readUint16()}}}]),e}();t.default=x},11708:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.ResourceType=void 0,function(e){e[e.RT_CURSOR=1]="RT_CURSOR",e[e.RT_BITMAP=2]="RT_BITMAP",e[e.RT_ICON=3]="RT_ICON",e[e.RT_MENU=4]="RT_MENU",e[e.RT_DIALOG=5]="RT_DIALOG",e[e.RT_STRING=6]="RT_STRING",e[e.RT_FONTDIR=7]="RT_FONTDIR",e[e.RT_FONT=8]="RT_FONT",e[e.RT_ACCELERATOR=9]="RT_ACCELERATOR",e[e.RT_RCDATA=10]="RT_RCDATA",e[e.RT_MESSAGETABLE=11]="RT_MESSAGETABLE",e[e.RT_CURSOR_GROUP=12]="RT_CURSOR_GROUP"}(t.ResourceType||(t.ResourceType={}))},23864:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o=n(31560),u=n(90780),l=function(){function e(){(0,a.default)(this,e)}return(0,i.default)(e,[{key:"parse",value:function(e,t,n){console.assert(e.type===u.ResourceType.RT_STRING),console.assert(".rsrc"===t.name);var r={};n.seek(t.bodyOffset+e.offset-t.virtualAddress,o.InputStream.Seek.Set);for(var a=0;a<16;a++){var i=n.readUint16();if(0!==i){var l=e.nameIdentifier-1<<4|a,s=n.readCharacters(2*i,"utf-16le");r[l]=s}}return r}}]),e}();t.default=l},40092:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583)),o=r(n(68748)),u=r(n(20778)),l=r(n(3350));(0,o.default)(t,"__esModule",{value:!0});var s=n(31560),d=n(17766),c=d.Tile.WIDTH,f=d.Tile.HEIGHT,h={textAlign:"left",shadowColor:"black",shadowBlur:1,shadowOffsetX:0,shadowOffsetY:1,font:'13px "Anonymous Pro", monospace',fillStyle:"white"},p=function(){function e(t){(0,a.default)(this,e),this._canvas=t,this._ctx=t.getContext("2d"),this._ctx.globalCompositeOperation="source-over",this._ctx.webkitImageSmoothingEnabled=!1,this._ctx.imageSmoothingEnabled=!1,this._ctx.imageSmoothingQuality="low",this._ctx.fillStyle=s.rgb(0,0,0),this._ctx.fillRect(0,0,288,288)}return(0,i.default)(e,[{key:"clear",value:function(){this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height)}},{key:"renderImage",value:function(e,t,n){this.drawImage(e,t,n)}},{key:"drawImage",value:function(e,t,n){this._ctx.drawImage(e,t,n)}},{key:"renderImageData",value:function(e,t,n){this._ctx.putImageData(e,t,n)}},{key:"fillBlackRect",value:function(e,t,n,r){this.fillRect(e,t,n,r,"#000000")}},{key:"fillRect",value:function(e,t,n,r,a){this._ctx.save(),this._ctx.globalCompositeOperation="source-over",this._ctx.fillStyle=a,this._ctx.fillRect(e,t,n,r),this._ctx.restore()}},{key:"fillTile",value:function(e,t,n){this.fillRect(e*c,t*f,c,f,n)}},{key:"renderText",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:h,r=(0,u.default)({},h,n);this._ctx.save(),this._ctx.globalCompositeOperation="source-over";for(var a=0,i=(0,l.default)(r);a<i.length;a++){var o=i[a];this._ctx[o[0]]=o[1]}this._ctx.fillText(e,t.x,t.y+6.5),this._ctx.restore()}},{key:"redisplayTile",value:function(e,t){}},{key:"redisplayRect",value:function(e,t,n,r){}},{key:"redisplay",value:function(){}},{key:"context",get:function(){return this._ctx}}],[{key:"isSupported",value:function(){return null!==document.createElement("canvas").getContext("2d")}}]),e}();t.default=p},6634:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.default=function(e,t,n){for(var r=t.width,a=t.height,i=new ImageData(r,a),o=new ArrayBuffer(i.data.length),u=new Uint8Array(o),l=new Uint32Array(o),s=0;s<a;s++)for(var d=0;d<r;d++){var c=e[s*r+d];0!==c&&(l[s*r+d]=n[c])}return i.data.set(u),i}},44935:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(31560),a=n(17766),i=n(6634),o=new r.Size(a.Tile.WIDTH,a.Tile.HEIGHT);t.default=function(e,t){return e?i.default(e.imageData,o,t):new ImageData(1,1)}},48699:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(17766);t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(!e)return new ImageData(1,1);for(var i=r.Tile.WIDTH,o=r.Tile.HEIGHT,u=e.size.width,l=e.size.height,s=new ImageData(u*i,l*o),d=new ArrayBuffer(s.data.length),c=new Uint8Array(d),f=new Uint32Array(d),h=u*i,p=0;p<l;p++)for(var v=0;v<u;v++)for(var y=0;y<r.Zone.LAYERS;y++){var m=e.getTile(v,p,y);if(n&&a&&a.x===v&&a.y===p&&y===r.Zone.Layer.Object&&(m=n),m)for(var g=m.imageData,_=p*o,w=v*i,k=_*h+w,b=0;b<o;b++){for(var S=0;S<i;S++){var I=b*i+S,x=g[I];0!==x&&(f[k+S]=t[x])}k+=h}}return s.data.set(c),s}},78160:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.drawZoneImageData=t.drawImage=t.drawTileImageData=t.Renderer=void 0;var r=n(40092);t.Renderer=r.default;var a=n(6634);t.drawImage=a.default;var i=n(44935);t.drawTileImageData=i.default;var o=n(48699);t.drawZoneImageData=o.default},27778:(e,t,n)=>{var r=n(38468)(n(68748));(0,r.default)(t,"__esModule",{value:!0}),t.drawZoneImageData=t.drawTileImageData=t.drawImage=t.CanvasRenderer=void 0;var a=n(78160);t.CanvasRenderer=a;var i=n(78160);(0,r.default)(t,"drawImage",{enumerable:!0,get:function(){return i.drawImage}}),(0,r.default)(t,"drawTileImageData",{enumerable:!0,get:function(){return i.drawTileImageData}}),(0,r.default)(t,"drawZoneImageData",{enumerable:!0,get:function(){return i.drawZoneImageData}})},59376:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108)),o=r(n(40361)),u=r(n(7583)),l=r(n(68748)),s=r(n(67093)),d=r(n(79302)),c=r(n(47053)),f=r(n(7273)),h=r(n(35983)),p=r(n(68190)),v=r(n(20778));(0,l.default)(t,"__esModule",{value:!0});var y=n(61334),m=n(37572),g=n(31560),_=n(66102),w=n(90780),k=n(95748),b=function(){function e(t,n,r,a){(0,o.default)(this,e),this._exeURL=t,this._dataURL=n,this._soundBaseURL=r,this._soundFormat=a}var t,n,r,l;return(0,u.default)(e,[{key:"loadPalette",value:(l=(0,i.default)(a.default.mark((function e(t){var n,r,i,o,u,l;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.loadSections(t);case 3:return n=e.sent,r=(0,s.default)(n).call(n,(function(e){return".data"===e.name})),i=new _.default,o=i.extractFromDataSection(r,this._exeStream),e.abrupt("return",y.ColorPalette.FromBGR8(o));case 10:if(e.prev=10,e.t0=e.catch(0),e.t0 instanceof k.PortaleExecutableFileFormatError){e.next=14;break}throw e.t0;case 14:return u=new _.default,l=u.extractFromBinary(this._exeStream),e.abrupt("return",y.ColorPalette.FromBGR8(l));case 17:case"end":return e.stop()}}),e,this,[[0,10]])}))),function(e){return l.apply(this,arguments)})},{key:"loadGameFile",value:(r=(0,i.default)(a.default.mark((function e(t){var n,r;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(this._dataURL);case 2:return n=e.sent,(r=new g.FetchInputStream(n,{expectedSize:45e5})).onprogress=function(){return t(r.bytesAvailable/r.bytesTotal)},e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"loadSound",value:function(e,t){var n=this;return new d.default((function(r,a){var i,o,u=e.split(/[\/\\]/).last().toLowerCase().replace(/\.(wav|mid|midi)/g,""),l=null!==(i=n._soundFormat)&&void 0!==i?i:e.toLowerCase().split(".").last(),s=n._soundBaseURL+m.encodeURIComponent((0,c.default)(o="".concat(u,".")).call(o,l)),d=new XMLHttpRequest;d.open("GET",s),d.responseType="arraybuffer",d.onerror=a,d.onprogress=function(e){e.lengthComputable&&t(e.loaded/e.total)},d.onload=function(){200!==d.status?a(new Error("Could not retrieve sound file ".concat(e))):r(d.response)},d.send()}))}},{key:"loadStrings",value:(n=(0,i.default)(a.default.mark((function e(t){var n,r,i,o,u,l,d,c=this;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.loadSections(t);case 3:return i=e.sent,o=(0,s.default)(i).call(i,(function(e){return".rsrc"===e.name})),u=new w.ResourceSectionParser,l=u.parse(o,this._exeStream),d=new w.StringResourceParser,e.abrupt("return",(0,f.default)(n=(0,h.default)(r=(0,p.default)(l).call(l,(function(e){return e.type===w.ResourceType.RT_STRING}))).call(r,(function(e){return d.parse(e,o,c._exeStream)}))).call(n,(function(e,t){return(0,v.default)(e,t)}),{}));case 11:if(e.prev=11,e.t0=e.catch(0),!(e.t0 instanceof k.PortaleExecutableFileFormatError)){e.next=15;break}return e.abrupt("return",{});case 15:throw e.t0;case 16:case"end":return e.stop()}}),e,this,[[0,11]])}))),function(e){return n.apply(this,arguments)})},{key:"loadSections",value:(t=(0,i.default)(a.default.mark((function e(t){var n,r,i;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._sections){e.next=3;break}return t(1),e.abrupt("return",this._sections);case 3:return e.next=5,g.FileLoader.loadAsStream(this._exeURL,t,{expectedSize:45e4});case 5:return n=e.sent,this._exeStream=n,r=new w.PortableExecutableParser,i=r.parse(n),this._sections=i.sections,e.abrupt("return",this._sections);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}();t.default=b},86174:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244)),c=a(n(68748)),f=a(n(47053));function h(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,c.default)(t,"__esModule",{value:!0}),n(60753);var p=n(17725),v=n(88607),y="lime",m="yellow",g="black",_=[g,"red",m,y,y],w=300,k=100,b=function(e){(0,l.default)(n,e);var t=h(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments))._condition=null,e._pie=null,e._health=w,e}return(0,o.default)(n,[{key:"health",get:function(){return this._health},set:function(e){this._health=p.max(0,p.min(e,w)),this._update()}},{key:"lives",get:function(){return p.floor(this._health/k)}},{key:"damage",get:function(){return k-(p.floor(this._health%k)||1)}},{key:"connectedCallback",value:function(){(0,u.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this),this.innerHTML='<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" height="43" version="1.1" width="43"><g transform="matrix(0.21500001,0,0,0.215,0,9.5140266e-7)"><g transform="matrix(1.0025057,0,0,1.0027319,-2.3574243,-282.67661)"><path d="m 101.85868,381.36758 64.9448,-76.04059 A 100,100 0 0 1 36.913868,457.40818 Z" style="fill:#ffffff;"/><path style="fill:#6D6D6D;" d="m 102.3445,381.90046 64.9448,-76.0406 A 100,100 0 0 0 37.399688,457.94105 Z"/></g><circle id="health-condition" style="fill:#00FF00;" cx="100" cy="100" r="89"/><path id="health-pie" style="fill:#6D6D6D;" d="m 0,0 Z"/></g></svg>',this._condition=this.querySelector("#health-condition"),this._pie=this.querySelector("#health-pie"),this._update()}},{key:"_update",value:function(){if(this.isConnected){var e=299===this.health?w:this.health,t=p.floor(e/k);this._condition.style.fill=_[t];var n=e%k/k;this._pie.style.fill=_[t+1],this._pie.setAttribute("d","M100,100 L"+this._buildArc(n)+"Z")}}},{key:"_buildArc",value:function(e){var t,n,r,a,i,o,u={x:100,y:100},l=this._pointWithAngle(0,u,90),s=this._pointWithAngle(360*e,u,90),d=e>.5?1:0;return(0,f.default)(t=(0,f.default)(n=(0,f.default)(r=(0,f.default)(a=(0,f.default)(i=(0,f.default)(o="".concat(l.x,",")).call(o,l.y," A")).call(i,90,",")).call(a,90,",0,")).call(r,d,",0,")).call(n,s.x,",")).call(t,s.y," ")}},{key:"_toRadians",value:function(e){return p.PI*e/180}},{key:"_pointWithAngle",value:function(e,t,n){return{x:t.x+n*p.cos(this._toRadians(270-e)),y:t.y+n*p.sin(this._toRadians(270-e))}}}]),n}(v.Component);b.GoodColor=y,b.MediumColor=m,b.BadColor="red",b.CriticalColor=g,b.Conditions=_,t.default=b},90495:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244));function d(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(13426);var c=n(31560),f=n(27778),h=function(e){(0,u.default)(n,e);var t=d(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments)).canvas=WebFun.JSX.render("canvas",null),e.ctx=e.canvas.getContext("2d"),e.imageData=null,e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){this.appendChild(this.canvas),this.redraw()}},{key:"pixelSize",get:function(){var e=this.canvas.getBoundingClientRect(),t=e.width,n=e.height;return new c.Size(t/this.size.width,n/this.size.height)}},{key:"redraw",value:function(){this.size&&this.ctx.clearRect(0,0,this.size.width,this.size.height),this.ctx&&this.size&&this.palette&&this.image&&(this.imageData=f.drawImage(this.image,this.size,this.palette),this.ctx.putImageData(this.imageData,0,0))}},{key:"renderedImage",get:function(){return this.imageData}},{key:"size",get:function(){return this._size},set:function(e){this._size=e,this.canvas.width=e.width,this.canvas.height=e.height}},{key:"palette",get:function(){return this._palette},set:function(e){this._palette=e,this.redraw()}},{key:"image",get:function(){return this._image},set:function(e){this._image=e,this.redraw()}},{key:"imageDataURL",get:function(){return this.canvas.toDataURL()}}]),n}(n(88607).Component);h.observedAttributes=[],t.default=h},60997:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244));function c(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(47881);var f=function(e){(0,l.default)(n,e);var t=c(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments))._background=WebFun.JSX.render("div",{className:"background"}),e._indicator=WebFun.JSX.render("div",{className:"value"}),e._value=-1,e}return(0,o.default)(n,[{key:"ammo",get:function(){return this._value},set:function(e){var t="";255===e||-1===e?e=0:t="#000000",this._background.style.backgroundColor=t,this._indicator.style.height=94*(e>1?1:e)+"%",this._value=e}},{key:"connectedCallback",value:function(){(0,u.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this),this.appendChild(this._background),this.appendChild(this._indicator),this.ammo=this.ammo}}]),n}(n(88607).Component);f.tagName="wf-ammo",t.default=f},26908:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244));function c(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),t.Direction=void 0,n(38753);var f=n(88607);t.Direction={None:0,North:1,East:2,South:4,West:8};var h=function(e){(0,l.default)(r,e);var n=c(r);function r(){var e;return(0,i.default)(this,r),(e=n.apply(this,arguments))._mask=t.Direction.None,e._svg=null,e}return(0,o.default)(r,[{key:"mask",get:function(){return this._mask},set:function(e){this._mask=e,this._updateClassList()}},{key:"connectedCallback",value:function(){(0,u.default)((0,d.default)(r.prototype),"connectedCallback",this).call(this),this.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" height="46" width="46"><g><polygon class="right" points="9.333333,11.25 14,11.25 14,3.75 9.333333,3.75 9.333333,0 0,7.5 9.333333,15 " transform="matrix(-1,0,0,1,46,15.5)"/><path class="dark" d="M 36.161105,15.5 45.494438,23"/><path d="m 45.494438,23 -9.333333,7.5"/><path class="dark" d="m 36.161105,30.5 0,-3.75"/><path d="m 36.161105,26.75 -4.666667,0"/><path d="m 31.494438,26.75 0,-7.5" class="dark"/><path class="dark" d="m 31.494438,19.25 4.666667,0"/><path class="dark" d="m 36.161105,19.25 0,-3.75"/></g><g transform="matrix(0,1,-1,0,46,-9.8257772e-8)"><polygon class="down" transform="matrix(-1,0,0,1,46,15.5)" points="14,11.25 14,3.75 9.333333,3.75 9.333333,0 0,7.5 9.333333,15 9.333333,11.25 "/><path d="M 36.161105,15.5 45.494438,23"/><path d="m 45.494438,23 -9.333333,7.5" class="dark"/><path class="dark" d="m 36.161105,30.5 0,-3.75"/><path d="m 36.161105,26.75 -4.666667,0" class="dark"/><path class="dark" d="m 31.494438,26.75 0,-7.5"/><path d="m 31.494438,19.25 4.666667,0"/><path class="dark" d="m 36.161105,19.25 0,-3.75"/></g><g transform="matrix(-1,0,0,-1,46,46)"><polygon class="left" points="9.333333,3.75 9.333333,0 0,7.5 9.333333,15 9.333333,11.25 14,11.25 14,3.75 " transform="matrix(-1,0,0,1,46,15.5)"/><path class="dark" d="M 36.161105,15.5 45.494438,23"/><path d="m 45.494438,23 -9.333333,7.5" class="dark"/><path d="m 36.161105,30.5 0,-3.75"/><path class="dark" d="m 36.161105,26.75 -4.666667,0"/><path d="m 31.494438,26.75 0,-7.5"/><path d="m 31.494438,19.25 4.666667,0"/><path d="m 36.161105,19.25 0,-3.75"/></g><g transform="matrix(0,-1,1,0,0,46)"><polygon class="up" transform="matrix(-1,0,0,1,46,15.5)" points="9.333333,15 9.333333,11.25 14,11.25 14,3.75 9.333333,3.75 9.333333,0 0,7.5 "/><path d="M 36.161105,15.5 45.494438,23" class="dark"/><path d="m 45.494438,23 -9.333333,7.5" class="dark"/><path d="m 36.161105,30.5 0,-3.75"/><path d="m 36.161105,26.75 -4.666667,0"/><path d="m 31.494438,26.75 0,-7.5"/><path d="m 31.494438,19.25 4.666667,0" class="dark"/><path d="m 36.161105,19.25 0,-3.75"/></g></svg>',this._svg=this.querySelector("svg"),this._updateClassList()}},{key:"_updateClassList",value:function(){var e=this._svg.classList,n=function(t,n){return t?e.add(n):e.remove(n)};n(this._mask&t.Direction.North,"up"),n(this._mask&t.Direction.South,"down"),n(this._mask&t.Direction.West,"left"),n(this._mask&t.Direction.East,"right")}}]),r}(f.Component);h.tagName="wf-compass",t.default=h},89308:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244));function c(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0});var f=n(5008);n(94224);var h=function(e){(0,l.default)(n,e);var t=c(n);function n(){var e;return(0,i.default)(this,n),(e=t.call(this)).title="Current Status Info",e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){var e,t,r,a,i,o=this,l=this.engine;this.content=WebFun.JSX.render("div",null,WebFun.JSX.render("div",null,"Current Zone is #:",WebFun.JSX.render("span",null,null===(e=l.currentZone)||void 0===e?void 0:e.id)),WebFun.JSX.render("div",{className:"row"},WebFun.JSX.render("div",null,"X:",WebFun.JSX.render("br",null),WebFun.JSX.render("span",null,null===(t=l.hero)||void 0===t?void 0:t.location.x)),WebFun.JSX.render("div",null,"Y:",WebFun.JSX.render("br",null),WebFun.JSX.render("span",null,null===(r=l.hero)||void 0===r?void 0:r.location.y)),WebFun.JSX.render("div",null,"E:",WebFun.JSX.render("br",null),WebFun.JSX.render("span",null,null===(a=l.story)||void 0===a||null===(i=a.goal)||void 0===i?void 0:i.id))),WebFun.JSX.render("div",null,WebFun.JSX.render(f.Button,{label:"OK",onclick:function(){return o.close()}}))),(0,u.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this)}}]),n}(f.AbstractWindow);h.tagName="wf-current-status-info",t.default=h},47832:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244));function c(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(76057);var f=n(88607),h=n(82761),p=n(70581),v=function(e){(0,l.default)(n,e);var t=c(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return(0,o.default)(n,[{key:"connectedCallback",value:function(){this.presentError(),(0,u.default)((0,d.default)(n.prototype),"disconnectedCallback",this).call(this)}},{key:"disconnectedCallback",value:function(){this.textContent="",(0,u.default)((0,d.default)(n.prototype),"disconnectedCallback",this).call(this)}},{key:"presentError",value:function(){var e;if(this.isConnected&&(this.textContent="",this._error)){var t=WebFun.JSX.render("div",null);if(t.appendChild(WebFun.JSX.render("h1",null,"Oh, no!")),this._error instanceof p.default){var n=this._error,r=n.seed,a=n.planet,i=n.size;return t.appendChild(WebFun.JSX.render("h2",null,"Something went wrong while generating the new world.")),t.appendChild(WebFun.JSX.render("div",null,WebFun.JSX.render("label",null,"Details"),WebFun.JSX.render("div",null,this._error.message,WebFun.JSX.render("br",null),"While generating a ",WebFun.JSX.render("i",null,i.name)," world on ",WebFun.JSX.render("i",null,a.name)," with seed"," ",WebFun.JSX.render("i",null,r.toHex(4))))),void this.appendChild(t)}if(this._error instanceof h.default)return t.appendChild(WebFun.JSX.render("h2",null,"Something went wrong while reading the game file..")),void this.appendChild(t);t.appendChild(WebFun.JSX.render("h2",null,"An unknown error occured")),t.appendChild(WebFun.JSX.render("div",null,WebFun.JSX.render("label",null,"Details"),WebFun.JSX.render("div",null,null!==(e=this._error.message)&&void 0!==e?e:this._error))),this.appendChild(t)}}},{key:"error",get:function(){return this._error},set:function(e){if(console.error(e),console.log(e.previousErrors),console.log(e),e instanceof ErrorEvent)e=e.error;else if(e instanceof CustomEvent){var t;e=null!==(t=e.detail.error)&&void 0!==t?t:e.detail.reason}this._error=e,this.presentError()}}]),n}(f.Component);v.tagName="wf-error-view",t.default=v},67999:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244)),c=a(n(68748)),f=a(n(73035)),h=a(n(35983)),p=a(n(42601));function v(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,c.default)(t,"__esModule",{value:!0}),n(54532);var y=n(88607),m=n(5008),g=function(e){(0,l.default)(n,e);var t=v(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments))._parent=null,e.onclose=function(){},e.onclick=function(){return e.close()},e._rootMenu=null,e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){var e=this;(0,u.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this),this._parent=this.parentElement,(0,f.default)((function(){e._parent===e.parentElement&&e._parent.setAttribute("fs-menu-open","")}))}},{key:"disconnectedCallback",value:function(){this._parent.removeAttribute("fs-menu-open"),this._parent=null,(0,u.default)((0,d.default)(n.prototype),"disconnectedCallback",this).call(this)}},{key:"close",value:function(){var e=this;this.onclose(),this._parent.removeAttribute("fs-menu-open"),(0,f.default)((function(){return e.remove()}),300)}},{key:"menu",get:function(){return this._rootMenu},set:function(e){this._rootMenu=e,this.textContent="",this.appendChild(WebFun.JSX.render("div",{className:"content",onclick:function(e){return e.stopPropagation()}},WebFun.JSX.render("h1",null,"WebFun"),e&&this.renderItems(e)))}},{key:"renderMenu",value:function(e,t){var n,r=this;if(e)return WebFun.JSX.render("ul",null,WebFun.JSX.render("li",{className:"submenu-title",style:{display:t?"":"none"}},WebFun.JSX.render("a",{onclick:function(){return r.navigateToRoot()}},WebFun.JSX.render(m.IconButton,{icon:"chevron-left"}),WebFun.JSX.render("span",null,t))),(0,h.default)(n=e.items).call(n,(function(e){return r.renderItem(e)})))}},{key:"renderItems",value:function(e){return WebFun.JSX.render("div",{className:"items"},this.renderMenu(e))}},{key:"renderItem",value:function(e){var t=this;return e.isSeparator?WebFun.JSX.render("div",{className:"hr"}):WebFun.JSX.render("li",null,WebFun.JSX.render("a",{onclick:function(n){return t.itemClickHandler(e,n.target)}},e.title,e.state!==y.MenuItem.State.None?WebFun.JSX.render("span",{className:"state"},y.MenuItem.State[e.state]):"",e.hasSubmenu?WebFun.JSX.render("span",{className:"submenu-indicator"},WebFun.JSX.render(m.IconButton,{icon:"chevron-right"})):""),e.hasSubmenu&&this.renderMenu(e.submenu,e.title))}},{key:"itemClickHandler",value:function(e,t){e.enabled&&e.submenu&&this.navigateTo(e,t.closest("li")),e.enabled&&e.callback&&(e.callback(),this.close())}},{key:"navigateTo",value:function(e,t){this.querySelector(".items > ul").style.transform="translateX(-100%)",t.querySelector("ul").style.display="block"}},{key:"navigateToRoot",value:function(){var e,t=this.querySelector(".items > ul");t.style.transform="translateX(0%)",(0,p.default)(e=t.querySelectorAll("ul")).call(e,(function(e){return e.style.display="none"}))}}]),n}(y.Component);g.tagName="wf-fullscreen-menu",t.default=g},65814:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(80655)),u=a(n(20497)),l=a(n(75244));function s(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(58482);var d=function(e){(0,o.default)(n,e);var t=s(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return n}(n(86174).default);d.tagName="wf-health",t.default=d},15695:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.Weapon=t.SettingsWindow=t.SceneView=t.PaletteView=t.OnscreenPad=t.OnscreenButton=t.Compass=t.LoadingView=t.InventoryRow=t.ErrorView=t.Inventory=t.Health=t.FullscreenMenu=t.CurrentStatusInfo=t.Ammo=t.AbstractPaletteView=t.AbstractHealth=void 0;var r=n(22279);t.SettingsWindow=r.default;var a=n(86174);t.AbstractHealth=a.default;var i=n(90495);t.AbstractPaletteView=i.default;var o=n(60997);t.Ammo=o.default;var u=n(65814);t.Health=u.default;var l=n(40510);t.Inventory=l.default;var s=n(71540);t.InventoryRow=s.default;var d=n(26908);t.Compass=d.default;var c=n(97207);t.Weapon=c.default;var f=n(29157);t.LoadingView=f.default;var h=n(2603);t.SceneView=h.default;var p=n(22392);t.OnscreenPad=p.default;var v=n(53295);t.OnscreenButton=v.default;var y=n(19711);t.PaletteView=y.default;var m=n(47832);t.ErrorView=m.default;var g=n(67999);t.FullscreenMenu=g.default;var _=n(89308);t.CurrentStatusInfo=_.default},71540:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244));function c(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(29447);var f=n(5008),h=n(31560),p=n(17766),v=n(15695),y=new Uint8Array(p.Tile.WIDTH*p.Tile.HEIGHT),m=function(e){(0,l.default)(n,e);var t=c(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments))._label=WebFun.JSX.render("span",null),e._tile=null,e._pickedUp=!1,e._paletteView=WebFun.JSX.render(v.PaletteView,{size:new h.Size(p.Tile.WIDTH,p.Tile.HEIGHT)}),e._iconBorder=WebFun.JSX.render("span",null),e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){(0,u.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this),this.appendChild(this._paletteView),this.appendChild(this._iconBorder),this.appendChild(this._label)}},{key:"cloneNode",value:function(e){var t=(0,u.default)((0,d.default)(n.prototype),"cloneNode",this).call(this,e);return t.onclick=this.onclick,t.palette=this.palette,t}},{key:"data",get:function(){return this._tile},set:function(e){this._tile=e,this._label.innerText=e?e.name:"",this._paletteView.image=e?e.imageData:y}},{key:"pickedUp",get:function(){return this._pickedUp},set:function(e){this._pickedUp=e,this._paletteView.image=e?y:this._tile?this._tile.imageData:y}},{key:"palette",get:function(){return this._paletteView.palette},set:function(e){this._paletteView.palette=e}},{key:"imageDataURL",get:function(){return this._paletteView.imageDataURL}}]),n}(f.Cell);m.tagName="wf-inventory-row",t.default=m},40510:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(61822)),o=a(n(40361)),u=a(n(7583)),l=a(n(18582)),s=a(n(80655)),d=a(n(20497)),c=a(n(75244)),f=a(n(68748)),h=a(n(75356)),p=a(n(47053)),v=a(n(42601));function y(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,d.default)(this,n)}}(0,f.default)(t,"__esModule",{value:!0}),t.Events=void 0,n(7523);var m=n(49961),g=n(5008),_=n(71540),w=n(48387),k=n(17766),b=n(17725);t.Events={ItemPlaced:"ItemPlaced",ItemActivated:"ItemActivated"};var S=function(e){(0,s.default)(r,e);var n=y(r);function r(){var e;return(0,o.default)(this,r),(e=n.apply(this,arguments)).cell=WebFun.JSX.render(_.default,{onclick:function(t){return e.rowClicked(t.currentTarget)}}),e._inventory=null,e._inventoryChangedHandler=function(){return e._rebuildTable()},e}return(0,u.default)(r,[{key:"connectedCallback",value:function(){(0,l.default)((0,c.default)(r.prototype),"connectedCallback",this).call(this),this._rebuildTable()}},{key:"rowClicked",value:function(e){var n,r=this,a=(0,h.default)(n=this._cells).call(n,e),i=e.data,o=new CustomEvent(t.Events.ItemActivated,{detail:{item:i,row:a},cancelable:!0});if(this.dispatchEvent(o)&&i&&this._canPlaceItem(i)){var u=e.imageDataURL;e.pickedUp=!0;var l=new w.ModalSession;l.onmouseup=function(){return l.end(0)},l.onend=function(){e.pickedUp=!1,r._placeItem(i,a,l.lastMouseLocation)},l.cursor=u,l.run()}}},{key:"_placeItem",value:function(e,n,r){this.dispatchEvent(new CustomEvent(t.Events.ItemPlaced,{detail:{item:e,row:n,location:r}}))}},{key:"inventory",get:function(){return this._inventory},set:function(e){this._inventory&&(this._inventory.removeEventListener(m.Events.DidChangeItems,this._inventoryChangedHandler),this.items=Array.Repeat(null,7)),this._inventory=e,this._inventory&&(this._inventory.addEventListener(m.Events.DidChangeItems,this._inventoryChangedHandler),this._rebuildTable())}},{key:"_rebuildTable",value:function(){var e,t,n=null!==(e=null===(t=this._inventory)||void 0===t?void 0:t.items)&&void 0!==e?e:[];this.items=(0,p.default)(n).apply(n,(0,i.default)(Array.Repeat(null,b.max(0,7-n.length))))}},{key:"_canPlaceItem",value:function(e){return!e.hasAttributes(k.Tile.Attributes.Map)}},{key:"palette",get:function(){return this.cell.palette},set:function(e){var t;(0,v.default)(t=this._cells).call(t,(function(t){return t.palette=e})),this.cell.palette=e}}]),r}(g.AbstractList);S.tagName="wf-inventory",S.Events=t.Events,t.default=S},29157:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244));function c(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(76343);var f=n(83722),h=n(5008),p=n(31560),v=n(19711),y=function(e){(0,l.default)(n,e);var t=c(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments))._background=WebFun.JSX.render(v.default,{size:new p.Size(288,288)}),e._progressBar=WebFun.JSX.render(h.SegmentedProgressBar,null),e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){(0,u.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this),this.appendChild(this._background),this.appendChild(this._progressBar)}},{key:"progress",get:function(){return this._progressBar.value},set:function(e){this._progressBar.value=e}},{key:"palette",get:function(){return this._background.palette},set:function(e){this._background.palette=e}},{key:"image",get:function(){return this._background.image},set:function(e){this._background.image=e}}]),n}(f.default);y.tagName="wf-loading-view",t.default=y},53295:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244));function c(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0});var f=n(88607);n(96788);var h='<svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 80 80"><defs><linearGradient id="a" gradientTransform="rotate(-90 675 -115) scale(.04883)" spreadMethod="pad" x2="819.2" x1="-819.2" gradientUnits="userSpaceOnUse"><stop stop-color="#6d6d6d" offset="0"/><stop stop-color="#6d6d6d" offset="1"/></linearGradient></defs><path fill="url(#a)" d="M818.25 588.25Q806.55 600 790 600q-16.65 0-28.35-11.75Q750 576.55 750 560t11.65-28.3Q773.35 520 790 520q16.55 0 28.25 11.7Q830 543.45 830 560t-11.75 28.25m-4.05-4.05q10.1-9.95 10.1-24.2 0-14.15-10.1-24.25-9.95-10.05-24.2-10.05t-24.25 10.05Q755.7 545.85 755.7 560q0 14.25 10.05 24.2 10 10.1 24.25 10.1t24.2-10.1" transform="translate(-750 -520)"/><path fill="#cac6bc" d="M64.2 64.2Q54.25 74.3 40 74.3T15.75 64.2Q5.7 54.25 5.7 40q0-14.15 10.05-24.25Q25.75 5.7 40 5.7t24.2 10.05Q74.3 25.85 74.3 40q0 14.25-10.1 24.2"/></svg>',p=function(e){var t=WebFun.JSX.render("div",null);return t.innerHTML=e,t.firstElementChild},v=function(e){(0,l.default)(n,e);var t=c(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments))._background=p(h),e._pressed=!1,e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){(0,u.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this),this.appendChild(this._background),this.appendChild(WebFun.JSX.render("label",null,this.label)),this.addEventListener("touchstart",this),this.addEventListener("mousedown",this),this.addEventListener("mouseup",this),this.addEventListener("touchend",this),this.addEventListener("touchcancel",this)}},{key:"disconnectedCallback",value:function(){this.removeEventListener("touchstart",this),this.removeEventListener("touchend",this),this.removeEventListener("touchcancel",this),this.removeEventListener("mousedown",this),this.removeEventListener("mouseup",this),this.textContent="",(0,u.default)((0,d.default)(n.prototype),"disconnectedCallback",this).call(this)}},{key:"handleEvent",value:function(e){this._pressed="touchstart"===e.type,"touchstart"===e.type||"mousedown"===e.type?this.classList.add("pressed"):this.classList.remove("pressed"),e.preventDefault(),e.stopPropagation()}},{key:"pressed",get:function(){return this._pressed}}]),n}(f.Component);v.tagName="wf-onscreen-button",t.default=v},22392:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(94433)),o=a(n(40361)),u=a(n(7583)),l=a(n(18582)),s=a(n(80655)),d=a(n(20497)),c=a(n(75244)),f=a(n(68748)),h=a(n(67093)),p=a(n(69159));function v(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,d.default)(this,n)}}(0,f.default)(t,"__esModule",{value:!0});var y=n(88607);n(75148);var m=n(8120),g=n(31560),_='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 42.32 42.32"><path d="M28.046 0q1.323 0 1.323 1.323v10.583l-8.07 8.07-8.07-8.07V1.323Q13.23 0 14.552 0h13.494m.264 1.323q0-.265-.264-.265H14.552q-.264 0-.264.265V11.47l7.011 7.011 7.011-7.011V1.323" fill="#6d6d6d"/><path d="M21.431 3.969q-.106 0-.185.08l-1.323 1.335h-.013q-.08.08-.066.172l.013.106q.066.159.238.159h2.66q.171 0 .237-.159.066-.159-.053-.278l-1.336-1.336q-.08-.08-.172-.08"/><path d="M28.31 1.323V11.47l-7.01 7.01-7.011-7.011V1.323q0-.265.264-.265h13.494q.264 0 .264.265" fill="#cac6bc"/><path d="M21.431 3.969q.093 0 .172.08l1.336 1.335q.12.12.053.278-.066.159-.238.159h-2.659q-.172 0-.238-.159l-.013-.106q-.013-.092.066-.172h.013l1.323-1.336q.08-.08.185-.08" fill="#6d6d6d"/><path d="M41.262 14.552v13.494q0 .264-.265.264h-9.869l-7.011-7.01 7.011-7.012h9.87q.264 0 .264.265" fill="#cac6bc"/><path d="M36.95 19.923q-.12-.119-.279-.053-.158.066-.158.238v2.66q0 .171.158.238l.106.013.172-.066v-.014l1.336-1.323.08-.185-.08-.172-1.336-1.336"/><path d="M36.95 19.923l1.335 1.336.08.172-.08.185-1.336 1.323v.014l-.172.066-.106-.013q-.158-.067-.158-.239v-2.659q0-.172.158-.238.159-.066.278.053" fill="#6d6d6d"/><path d="M41.262 14.552c0-.176-.088-.265-.265-.265h-9.869L24.117 21.3l7.011 7.011h9.87c.176 0 .264-.088.264-.264V14.552m-10.57-1.323H42.32c.882 0 0-.882 0 0v16.14c0 .882.882 0 0 0H30.692l-8.07-8.07 8.07-8.07" fill="#6d6d6d"/><path d="M21.431 38.365l.172-.08 1.336-1.336q.12-.119.053-.278-.066-.159-.238-.159h-2.659q-.172 0-.238.16l-.013.105q-.013.093.066.172h.013l1.323 1.336.185.08" stroke="#00f" stroke-width=".265"/><path d="M28.31 31.128v9.87q0 .264-.264.264H14.552q-.264 0-.264-.265v-9.869l7.011-7.011 7.011 7.011" fill="#cac6bc"/><path d="M21.431 38.365l-.185-.08-1.323-1.336h-.013q-.08-.08-.066-.172l.013-.106q.066-.159.238-.159h2.66q.171 0 .237.16.066.158-.053.277l-1.336 1.336-.172.08" fill="#6d6d6d"/><path d="M28.31 31.128l-7.01-7.011-7.011 7.011v9.87q0 .264.264.264h13.494q.264 0 .264-.265v-9.869M21.3 22.622l8.07 8.07v10.305q0 1.323-1.323 1.323H14.552q-1.323 0-1.323-1.323V30.692l8.07-8.07" fill="#6d6d6d"/><path d="M1.323 14.287H11.47l7.01 7.013-7.01 7.01H1.323q-.265 0-.265-.264V14.552q0-.265.265-.265" fill="#cac6bc"/><path d="M5.662 19.87q-.159-.066-.278.053L4.048 21.26q-.08.08-.08.172 0 .106.08.185l1.336 1.323v.014q.08.079.172.066l.106-.013q.159-.067.159-.239v-2.659q0-.172-.159-.238"/><path d="M5.662 19.87q.159.066.159.238v2.66q0 .171-.159.238l-.106.013q-.092.013-.172-.066v-.014l-1.336-1.323q-.08-.079-.08-.185 0-.092.08-.172l1.336-1.336q.12-.119.278-.053" fill="#6d6d6d"/><path d="M0 14.552q0-1.323 1.323-1.323h10.583l8.07 8.07-8.07 8.07H1.323Q0 29.369 0 28.046V14.552m1.323-.265q-.265 0-.265.265v13.494q0 .264.265.264H11.47l7.01-7.01-7.011-7.012H1.323" fill="#6d6d6d"/></svg>',w=function(e){var t=WebFun.JSX.render("div",null);return t.innerHTML=e,t.firstElementChild},k=function(e){(0,s.default)(n,e);var t=v(n);function n(){var e;return(0,o.default)(this,n),(e=t.apply(this,arguments))._base=w(_),e._input=m.default.None,e._label=WebFun.JSX.render("div",{style:"position: absolute; top: 0px; left: 0px; font-size: .9em"}),e._label2=WebFun.JSX.render("div",{style:"position: absolute; top: 0px; right: 0px; font-size: .9em; text-align: right;"}),e.trackedTouch=null,e._lastInput=performance.now(),e}return(0,u.default)(n,[{key:"connectedCallback",value:function(){(0,l.default)((0,c.default)(n.prototype),"connectedCallback",this).call(this),this.positionThumb(0,0),this.appendChild(this._base),this.appendChild(this._label),this.appendChild(this._label2),this.addEventListener("touchstart",this),this.addEventListener("touchmove",this),this.addEventListener("touchend",this)}},{key:"handleEvent",value:function(e){var t=this;if(e.preventDefault(),e.stopImmediatePropagation(),"mousedown"===e.type&&(document.addEventListener("mouseup",this),document.addEventListener("mousemove",this)),"touchstart"!==e.type||this.trackedTouch||(this.trackedTouch="changedTouches"in e?e.changedTouches[0].identifier:null),"touchend"===e.type||"mouseup"===e.type){var n;if("changedTouches"in e&&!(0,h.default)(n=(0,p.default)(e.changedTouches)).call(n,(function(e){return e.identifier===t.trackedTouch})))return;this.positionThumb(0,0),this.trackedTouch=null,document.removeEventListener("mouseup",this),document.removeEventListener("mousemove",this)}else{var r="changedTouches"in e?(0,p.default)(e.changedTouches):[],a=(0,h.default)(r).call(r,(function(e){return e.identifier===t.trackedTouch}));if(!a&&"touchmove"===e.type)return;a||(a=e);var i=this.getBoundingClientRect(),o=i.left+i.width/2,u=i.top+i.height/2,l=(a.clientX-o)/80,s=(a.clientY-u)/80;this.positionThumb(l,s)}}},{key:"positionThumb",value:function(e,t){var n=55,r=.1;e=g.clamp(-1,e,1),t=g.clamp(-1,t,1);var a=m.default.None,o=g.xy2polar(e,t),u=(0,i.default)(o,2),l=u[0],s=u[1],d=function(e){return(360+e)%360}(g.rad2deg(s))%360;l>r&&(d.isInRange(0,n)||d.isInRange(305,360))&&(a|=m.default.Right),l>r&&d.isInRange(125,235)&&(a|=m.default.Left),l>r&&d.isInRange(35,145)&&(a|=m.default.Up),l>r&&d.isInRange(215,325)&&(a|=m.default.Down),a!==m.default.None&&l>.4&&(a|=m.default.Walk),this._input=a,this._lastInput=performance.now()}},{key:"disconnectedCallback",value:function(){this.removeEventListener("touchstart",this),this.removeEventListener("touchmove",this),this.removeEventListener("touchend",this),this.removeEventListener("mousedown",this),this.removeEventListener("zoom",this),document.removeEventListener("mousemove",this),document.removeEventListener("mouseup",this),(0,l.default)((0,c.default)(n.prototype),"disconnectedCallback",this).call(this)}},{key:"input",get:function(){return this._input}},{key:"lastInput",get:function(){return this._lastInput}}]),n}(y.Component);k.tagName="wf-onscreen-pad",t.default=k},19711:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(80655)),u=a(n(20497)),l=a(n(75244));function s(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(92029);var d=function(e){(0,o.default)(n,e);var t=s(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return n}(n(90495).default);d.tagName="wf-palette-view",t.default=d},2603:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244));function d(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(48349);var c=n(31560),f=n(83722),h=n(20779),p=function(e){(0,u.default)(n,e);var t=d(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments)).canvas=WebFun.JSX.render("canvas",{className:"pixelated",width:288,height:288,style:{background:c.rgb(0,0,0)}}),e._manager=new h.SceneManager,e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){this.appendChild(this.canvas)}},{key:"effectiveTileSize",get:function(){var e=this.getBoundingClientRect(),t=e.width,n=e.height;return new c.Size(t/9,n/9)}},{key:"manager",get:function(){return this._manager}}]),n}(f.default);p.tagName="wf-scene-view",t.default=p},22279:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244));function c(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(98586);var f=n(5008),h=function(e){(0,l.default)(n,e);var t=c(n);function n(){var e;return(0,i.default)(this,n),(e=t.call(this))._minLabel=WebFun.JSX.render("label",null),e._midLabel=WebFun.JSX.render("label",null),e._maxLabel=WebFun.JSX.render("label",null),e._slider=WebFun.JSX.render(f.Slider,{min:0,value:.5,max:1}),e.store=localStorage,e.closable=!1,e.content.appendChild(e._slider),e.content.appendChild(WebFun.JSX.render("div",{style:{justifyContent:"space-between"}},[e._minLabel,e._midLabel,e._maxLabel])),e.content.appendChild(WebFun.JSX.render("div",{style:{justifyContent:"center"}},WebFun.JSX.render(f.Button,{label:"OK",onclick:function(){e._storeValue(),e.close()}}),WebFun.JSX.render(f.Button,{label:"Cancel",onclick:function(){e._storeValue(),e.close()}}))),e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){(0,u.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this),this._updateValue()}},{key:"_storeValue",value:function(){this._key&&this.store.store("settings.".concat(this._key),this._slider.value)}},{key:"_updateValue",value:function(){this._key&&(this._slider.value=this.store.load("settings.".concat(this._key)))}},{key:"steps",get:function(){return this._slider.steps},set:function(e){this._slider.steps=e}},{key:"key",get:function(){return this._key},set:function(e){this._key=e,this._updateValue()}},{key:"minLabel",get:function(){return this._minLabel.textContent},set:function(e){this._minLabel.textContent=e}},{key:"midLabel",get:function(){return this._midLabel.textContent},set:function(e){this._midLabel.textContent=e}},{key:"maxLabel",get:function(){return this._maxLabel.textContent},set:function(e){this._maxLabel.textContent=e}},{key:"slider",get:function(){return this._slider}}]),n}(f.AbstractWindow);t.default=h},97207:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244));function d(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(50994);var c=n(17766),f=n(88607),h=n(15695),p=n(31560),v=function(e){(0,u.default)(n,e);var t=d(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments)).data=null,e._weapon=null,e._background=WebFun.JSX.render("div",{className:"background"}),e._paletteView=WebFun.JSX.render(h.PaletteView,{size:new p.Size(c.Tile.WIDTH,c.Tile.HEIGHT)}),e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){this.appendChild(this._background),this.appendChild(this._paletteView)}},{key:"_update",value:function(){if(this._paletteView.image=null,this._weapon&&this._weapon.frames&&this._weapon.frames.length){var e=this._weapon.frames[0].extensionRight;this._paletteView.image=e?e.imageData:null}}},{key:"weapon",get:function(){return this._weapon},set:function(e){this._weapon=e,this._update()}},{key:"palette",get:function(){return this._paletteView.palette},set:function(e){this._paletteView.palette=e}}]),n}(f.Component);v.tagName="wf-weapon",t.default=v},33702:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244));function d(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0});var c=n(5008);n(75837);var f=function(e){(0,u.default)(n,e);var t=d(n);function n(){var e;return(0,i.default)(this,n),(e=t.call(this)).title="About",e.content.append(WebFun.JSX.render("h1",null,"WebFun"),WebFun.JSX.render("div",{className:"version"},"90903e7f"),WebFun.JSX.render("a",{className:"source-link",href:"https://github.com/cyco/webfun",target:"_blank"},"github.com/cyco/webfun"),WebFun.JSX.render("hr",null),WebFun.JSX.render("h2",null,"Yoda(tm) Stories"),WebFun.JSX.render("div",{className:"copyright"},"1997 Lucasfilm Ltd. and LucasArts Entertainment Company. All Rights Reserved."),WebFun.JSX.render("div",{className:"box"},"Team Yoda",WebFun.JSX.render("div",{className:"team"},"Hal Barwood",WebFun.JSX.render("br",null),"Jesse Clark",WebFun.JSX.render("br",null),"Mark Crowley",WebFun.JSX.render("br",null),"Randy Tudor",WebFun.JSX.render("br",null),"Rachael Bristol",WebFun.JSX.render("br",null),"Wayne Cline",WebFun.JSX.render("br",null),"Tom Payne",WebFun.JSX.render("br",null),"Martin Yee")),WebFun.JSX.render(c.Button,{onclick:function(){return e.close()},label:"OK"})),e}return(0,o.default)(n,[{key:"handleEvent",value:function(e){e.stopImmediatePropagation()}}]),n}(c.AbstractWindow);f.tagName="wf-about-window",t.default=f},33623:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(80655)),u=a(n(20497)),l=a(n(75244));function s(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(22223);var d=function(e){(0,o.default)(n,e);var t=s(n);function n(){var e;return(0,i.default)(this,n),(e=t.call(this)).title="Difficulty",e.key="difficulty",e.minLabel="Easy",e.midLabel="Medium",e.maxLabel="Hard",e.slider.min=1,e.slider.max=100,e.slider.snapToIntegers=!0,e}return n}(n(15695).SettingsWindow);d.tagName="wf-difficulty-window",t.default=d},64180:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244));function c(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(25653);var f=function(e){(0,l.default)(n,e);var t=c(n);function n(){var e;return(0,i.default)(this,n),(e=t.call(this)).metronome=null,e.title="Game Speed",e.key="tickDuration",e.minLabel="Slow",e.midLabel="Normal",e.maxLabel="Fast",e.slider.min=155,e.slider.max=90,e.slider.snapToIntegers=!0,e}return(0,o.default)(n,[{key:"close",value:function(){this.metronome&&(this.metronome.tickDuration=this.slider.value),(0,u.default)((0,d.default)(n.prototype),"close",this).call(this)}}]),n}(n(15695).SettingsWindow);f.tagName="wf-game-speed-window",t.default=f},79783:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(63789)),o=a(n(76108)),u=a(n(40361)),l=a(n(7583)),s=a(n(80655)),d=a(n(20497)),c=a(n(75244)),f=a(n(68748)),h=a(n(79302)),p=a(n(42601));function v(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,d.default)(this,n)}}(0,f.default)(t,"__esModule",{value:!0}),n(3509);var y=n(5008),m=n(31560),g="helpdeco-topic",_=function(e){(0,s.default)(a,e);var t,r=v(a);function a(){var e;return(0,u.default)(this,a),(e=r.call(this)).history=[],e.topicCount=0,e.currentTopic=0,e.closable=!0,e.title="Help Viewer",e.origin=new m.Point(20,20),e.autosaveName="help-viewer-window",e.content=WebFun.JSX.render("div",null,WebFun.JSX.render("div",{className:"action-bar"}),WebFun.JSX.render("div",{className:"help-contents"},WebFun.JSX.render(y.ProgressIndicator,null))),e}return(0,l.default)(a,[{key:"loadHelpFile",value:(t=(0,o.default)(i.default.mark((function e(t){var r,a,o;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.history=[],this.topicCount=0,this.currentTopic=0,this.updateActionBar(),(r=this.querySelector(".help-contents")).textContent="",r.appendChild(WebFun.JSX.render(y.ProgressIndicator,null)),this.helpdeco){e.next=14;break}return e.next=10,h.default.resolve().then((function(){return n(63663)}));case 10:return a=e.sent,e.next=13,a({locateFile:function(e){return"assets/"+e}});case 13:this.helpdeco=e.sent;case 14:return e.next=16,m.FileLoader.loadAsStream(t);case 16:o=e.sent,r.innerHTML=this.helpdeco.render(o.buffer,t.split(".").last()),this.topicCount=this.getElementsByTagName(g).length,this.history=[0],this.title=this.querySelector("helpdeco-title").textContent,this.showTopic(0);case 22:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"showTopic",value:function(e){var t,n=this.querySelector(".help-contents ".concat(g,'[id="topic-').concat(e+1,'"]'));n&&(this.currentTopic=e,(0,p.default)(t=this.getElementsByTagName(g)).call(t,(function(e){return e.style.display="none"})),n.style.display="",this.updateActionBar())}},{key:"visitTopic",value:function(e){e<0||e>this.topicCount-1||e!==this.currentTopic&&(this.history.push(e),this.showTopic(e))}},{key:"visitLastTopic",value:function(){var e;this.history.pop();var t=null!==(e=this.history.pop())&&void 0!==e?e:0;this.visitTopic(t)}},{key:"updateActionBar",value:function(){var e=this;this.querySelector(".action-bar").replaceWith(WebFun.JSX.render("div",{className:"action-bar"},WebFun.JSX.render(y.Button,{disabled:!0},"Contents"),WebFun.JSX.render(y.Button,{disabled:!0},"Search"),WebFun.JSX.render(y.Button,{disabled:this.history.length<=1,onclick:function(){return e.visitLastTopic()}},"Back"),WebFun.JSX.render(y.Button,{disabled:this.currentTopic<=0,onclick:function(){return e.visitTopic(e.currentTopic-1)}},"<<"),WebFun.JSX.render(y.Button,{disabled:this.currentTopic>=this.topicCount-1,onclick:function(){return e.visitTopic(e.currentTopic+1)}},">>")))}},{key:"handleEvent",value:function(e){}}]),a}(y.AbstractWindow);_.tagName="wf-help-viewer",t.default=_},29149:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(79783);t.default=r.default},63147:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.HelpViewer=t.WorldSizeWindow=t.StatisticsWindow=t.MobileMainMenu=t.MainWindow=t.MainMenu=t.GameSpeedWindow=t.DifficultyWindow=t.AboutWindow=void 0;var r=n(33702);t.AboutWindow=r.default;var a=n(33623);t.DifficultyWindow=a.default;var i=n(64180);t.GameSpeedWindow=i.default;var o=n(29149);t.HelpViewer=o.default;var u=n(11607);t.MainMenu=u.default;var l=n(83862);t.MainWindow=l.default;var s=n(47872);t.MobileMainMenu=s.default;var d=n(82229);t.StatisticsWindow=d.default;var c=n(65348);t.WorldSizeWindow=c.default},11607:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(61822)),o=a(n(40361)),u=a(n(7583)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244)),c=a(n(68748)),f=a(n(47053));function h(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,c.default)(t,"__esModule",{value:!0});var p=n(88607),v=n(28061),y=n(20779),m=n(46e3),g=n(63806),_=n(48387),w=n(13165),k=n(33702),b=n(33623),S=n(64180),I=n(29149),x=n(82229),T=n(65348);function M(e,t,n,r){return{title:"".concat(t," On"),mnemonic:0,enabled:function(){return null!==e.engine},state:function(){return r[n]?1:0},callback:function(){r[n]=!r[n]}}}var E=function(e){(0,l.default)(n,e);var t=h(n);function n(e,r){var a,u;return(0,o.default)(this,n),(u=t.call(this,(0,f.default)(a=[{title:"File",mnemonic:0,submenu:[{title:"New World",mnemonic:0,callback:function(){return e.newStory()},enabled:function(){return null!==e.data}},{title:"Replay Story",mnemonic:0,callback:function(){return e.replayStory()},enabled:function(){return null!==e.engine}},{title:"Load World",mnemonic:0,callback:function(){return e.load()},enabled:function(){return null!==e.data},beta:!0},{title:"Save World",mnemonic:0,callback:function(){return e.save()},enabled:function(){var t;return(null===(t=e.engine)||void 0===t?void 0:t.variant)===m.Yoda},beta:!0},p.MenuItemSeparator,{title:"Exit",mnemonic:1,callback:function(){return e.exit()}}]},{title:"Options",mnemonic:0,submenu:[{title:"Combat Difficulty...",mnemonic:0,callback:function(){return u._runModalSessionForWindowComponent(b.default.tagName)}},{title:"Game Speed...",callback:function(){return u._runModalSessionForWindowComponent(S.default.tagName)},mnemonic:0},{title:"World Control...",callback:function(){return u._runModalSessionForWindowComponent(T.default.tagName)},mnemonic:0},{title:"Statistics...",mnemonic:0,callback:function(){return u._runModalSessionForWindowComponent(x.default.tagName)}},p.MenuItemSeparator,M(e,"Music","playMusic",r),M(e,"Sound","playEffects",r),p.MenuItemSeparator,{title:"Pause",mnemonic:0,enabled:function(){var t;return(null===(t=e.engine)||void 0===t?void 0:t.gameState)===y.GameState.Running},state:function(){var t,n;return(null===(t=e.engine)||void 0===t||null===(n=t.sceneManager)||void 0===n?void 0:n.currentScene)instanceof g.PauseScene?p.MenuItem.State.On:p.MenuItem.State.Off},callback:function(){var t,n;return(null===(t=e.engine)||void 0===t||null===(n=t.sceneManager)||void 0===n?void 0:n.currentScene)instanceof g.PauseScene?e.engine.sceneManager.popScene():e.engine.sceneManager.pushScene(new g.PauseScene)}}]},{title:"Window",mnemonic:0,submenu:[{title:"Hide Me!",mnemonic:0}]},{title:"Help",mnemonic:0,submenu:[{title:"How to Play",callback:function(){var t=v.document.createElement(I.default.tagName);e.window.manager.showWindow(t),t.loadHelpFile(e.gameSource.help)},enabled:function(){var t;return(null===(t=e.gameSource.help)||void 0===t?void 0:t.length)>0},mnemonic:0},{title:"Using Help",mnemonic:0},{title:"Report a Bug",mnemonic:0,callback:function(){return v.window.open(r.issueTracker)}},p.MenuItemSeparator,{title:"About...",mnemonic:0,callback:function(){return u._runModalSessionForWindowComponent(k.default.tagName)}}]}]).call(a,(0,i.default)(e.settings.debug?[w.default(e)]:[])))).controller=e,u}return(0,u.default)(n,[{key:"_runModalSessionForWindowComponent",value:function(e){var t=v.document.createElement(e);t instanceof S.default&&(t.metronome=this.controller.engine.metronome),this._runModalSession(t)}},{key:"_runModalSession",value:function(e){var t=new _.WindowModalSession(e);e.onclose=function(){return t.end(0)},t.runForWindow(this.controller.window)}}]),n}(p.Menu);t.default=E},83862:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(57362)),o=a(n(40361)),u=a(n(7583)),l=a(n(18582)),s=a(n(80655)),d=a(n(20497)),c=a(n(75244)),f=a(n(68748)),h=a(n(23982)),p=a(n(67093));function v(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,d.default)(this,n)}}(0,f.default)(t,"__esModule",{value:!0}),n(65008);var y=n(15695),m=n(15695),g=n(41777),_=n(5008),w=n(26908),k=n(20779),b=n(17766),S=n(63806),I=function(e){(0,s.default)(n,e);var t=v(n);function n(){var e,r;return(0,o.default)(this,n),(r=t.call(this))._engine=null,r._handlers=(e={},(0,i.default)(e,g.default.Event.AmmoChanged,(function(){return r._updateAmmo()})),(0,i.default)(e,g.default.Event.WeaponChanged,(function(){return r._updateWeapon()})),(0,i.default)(e,g.default.Event.LocationChanged,(function(e){var t=e.detail;return r._updateLocation(t)})),(0,i.default)(e,k.Hero.Event.HealthDidChange,(function(){return r._updateHealth()})),(0,i.default)(e,k.Inventory.Event.DidAddItem,(function(e){var t=e.target;r._updateMapButton(t),r._highlightInventoryButton()})),(0,i.default)(e,k.Inventory.Event.DidRemoveItem,(function(e){var t=e.target;r._updateMapButton(t)})),(0,i.default)(e,k.SceneManager.Event.SceneChanged,(function(e){var t=e.target;return r._updateMapButton(t)})),e),r.cache=new h.default,r._menu=null,r.autosaveName="main-window",r.closable=!1,r.onclose=function(){return r._engine&&r._engine.metronome.stop()},r.content=WebFun.JSX.render("div",null,WebFun.JSX.render("div",{className:"main"}),WebFun.JSX.render("div",{className:"actions"},WebFun.JSX.render(_.Button,{label:"Inventory",onclick:function(e){return r.toggleInventory(e)},onanimationend:function(e){return e.target.classList.remove("pulse-animation")}}),WebFun.JSX.render(_.Button,{label:"Map",disabled:!0,onclick:function(){return r.toggleMap()}}),WebFun.JSX.render(_.Button,{label:"Menu",onclick:function(e){return r.toggleMenu(e)}})),WebFun.JSX.render("div",{className:"status"},WebFun.JSX.render(y.Compass,null),WebFun.JSX.render("div",{className:"equipment"},WebFun.JSX.render(y.Ammo,null),WebFun.JSX.render(y.Weapon,null)),WebFun.JSX.render(y.Health,null)),WebFun.JSX.render("div",{className:"controls"},WebFun.JSX.render(m.OnscreenPad,null),WebFun.JSX.render("div",{className:"buttons"},WebFun.JSX.render(m.OnscreenButton,{className:"drag",label:"Drag"}),WebFun.JSX.render(m.OnscreenButton,{className:"shoot",label:"Shoot"}))),WebFun.JSX.render(y.Inventory,null)),r.content.querySelector(".controls").addEventListener("touchstart",(function(e){e.preventDefault(),e.stopImmediatePropagation()})),r}return(0,u.default)(n,[{key:"engine",get:function(){return this._engine},set:function(e){var t=this;if(this._engine){var n=this._engine.hero;this._handlers.each((function(e,n){return t._engine.removeEventListener(e,n)})),n.removeEventListener(k.Hero.Event.HealthDidChange,this._handlers[k.Hero.Event.HealthDidChange]),n.removeEventListener(k.Hero.Event.WeaponChanged,this._handlers[g.default.Event.WeaponChanged]),n.removeEventListener(k.Hero.Event.AmmoChanged,this._handlers[g.default.Event.AmmoChanged]),this._engine.inventory.removeEventListener(k.Inventory.Event.DidAddItem,this._handlers[k.Inventory.Event.DidAddItem]),this._engine.inventory.removeEventListener(k.Inventory.Event.DidRemoveItem,this._handlers[k.Inventory.Event.DidRemoveItem]),this._engine.sceneManager.removeEventListener(k.SceneManager.Event.SceneChanged,this._handlers[k.SceneManager.Event.SceneChanged])}if(this._engine=e,this._engine){var r=this._engine.hero;r.addEventListener(k.Hero.Event.HealthDidChange,this._handlers[k.Hero.Event.HealthDidChange]),r.addEventListener(k.Hero.Event.WeaponChanged,this._handlers[g.default.Event.WeaponChanged]),r.addEventListener(k.Hero.Event.AmmoChanged,this._handlers[g.default.Event.AmmoChanged]),this._handlers.each((function(e,n){return t._engine.addEventListener(e,n)})),this._engine.inventory.addEventListener(k.Inventory.Event.DidAddItem,this._handlers[k.Inventory.Event.DidAddItem]),this._engine.inventory.addEventListener(k.Inventory.Event.DidRemoveItem,this._handlers[k.Inventory.Event.DidRemoveItem]),this._engine.sceneManager.addEventListener(k.SceneManager.Event.SceneChanged,this._handlers[k.SceneManager.Event.SceneChanged])}this.applyCurrentValues()}},{key:"disconnectedCallback",value:function(){this.cache=new h.default,(0,l.default)((0,c.default)(n.prototype),"disconnectedCallback",this).call(this)}},{key:"_highlightInventoryButton",value:function(){var e=this.inventoryButton;e&&e.classList.add("pulse-animation")}},{key:"_updateMapButton",value:function(e){e instanceof k.SceneManager&&(this.mapButton.active=e.currentScene instanceof S.MapScene),e instanceof k.Inventory&&(this.mapButton.disabled=!(0,p.default)(e).call(e,(function(e){return e.hasAttributes(b.Tile.Attributes.Map)})))}},{key:"mapButton",get:function(){return this.querySelector("".concat(_.Button.tagName,'[label="Map"]'))}},{key:"inventoryButton",get:function(){return this.querySelector("".concat(_.Button.tagName,'[label="Inventory"]'))}},{key:"toggleMap",value:function(){var e;if((0,p.default)(e=this.engine.inventory).call(e,(function(e){return e.hasAttributes(b.Tile.Attributes.Map)}))){var t=this.engine.sceneManager.currentScene;t instanceof S.MapScene?this.engine.sceneManager.popScene():t instanceof S.ZoneScene&&this.engine.sceneManager.pushScene(new S.MapScene)}}},{key:"toggleInventory",value:function(e){var t=e.target;t.active=!t.active,t.active?this.inventory.classList.add("slide-up"):this.inventory.classList.remove("slide-up")}},{key:"toggleMenu",value:function(e){var t=this,n=e.target;n.active=!n.active,n.active?(this._menu=WebFun.JSX.render(m.FullscreenMenu,{menu:this.menu,onclose:function(){t._menu=null,n.active=!1}}),this.parentElement.appendChild(this._menu)):(this._menu.close(),this._menu=null)}},{key:"applyCurrentValues",value:function(){var e=this._engine;this.inventory.inventory=e?e.inventory:null,this.weapon.weapon=e?e.hero.weapon:null,this._updateAmmo(),this._updateHealth(),this._updateLocation({})}},{key:"mainContent",get:function(){return this.content.querySelector(".main")}},{key:"_updateAmmo",value:function(){var e,t,n,r=null===(e=this.engine)||void 0===e?void 0:e.hero.weapon,a=null===(t=this.engine)||void 0===t?void 0:t.hero.ammo,i=null===(n=this.engine)||void 0===n?void 0:n.variant.getMaxAmmo(r);this.ammo.ammo=r?a/i:255}},{key:"_updateWeapon",value:function(){this.weapon.weapon=this.engine.hero.weapon}},{key:"_updateLocation",value:function(e){var t=e.zone,n=e.world,r=this.content.querySelector(y.Compass.tagName);if(n&&t&&!t.isRoom()){var a=n.findLocationOfZone(t);if(a){var i=w.Direction.None,o=function(e){return n.bounds.contains(e)?n.at(e).zone:null};i|=o(a.byAdding(-1,0))?w.Direction.West:0,i|=o(a.byAdding(1,0))?w.Direction.East:0,i|=o(a.byAdding(0,-1))?w.Direction.North:0,i|=o(a.byAdding(0,1))?w.Direction.South:0,r.mask=i}else r.mask=w.Direction.None}else r.mask=w.Direction.None}},{key:"_updateHealth",value:function(){var e,t;this.querySelectorCache(y.Health.tagName).health=null!==(e=null===(t=this._engine)||void 0===t?void 0:t.hero.health)&&void 0!==e?e:k.Hero.MaxHealth}},{key:"inventory",get:function(){return this.querySelectorCache(y.Inventory.tagName)}},{key:"weapon",get:function(){return this.querySelectorCache(y.Weapon.tagName)}},{key:"ammo",get:function(){return this.querySelectorCache(y.Ammo.tagName)}},{key:"controls",get:function(){return this.querySelectorCache(".controls")}},{key:"querySelectorCache",value:function(e){if(this.cache.has(e))return this.cache.get(e);var t=this.querySelector(e);return this.cache.set(e,t),t}}]),n}(_.AbstractWindow);I.tagName="wf-main-window",t.default=I},47872:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(61822)),o=a(n(40361)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244)),d=a(n(68748)),c=a(n(47053));function f(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,d.default)(t,"__esModule",{value:!0});var h=n(88607),p=n(13165),v=n(28061);function y(e,t,n,r){return{title:"".concat(t),mnemonic:0,enabled:function(){return null!==e.engine},state:function(){return r[n]?h.MenuItem.State.On:h.MenuItem.State.Off},callback:function(){r[n]=!r[n]}}}var m=function(e){(0,u.default)(n,e);var t=f(n);function n(e,r){var a;return(0,o.default)(this,n),t.call(this,(0,c.default)(a=[{title:"New World",mnemonic:0,callback:function(){return e.newStory()},enabled:function(){return null!==e.data}},{title:"Replay Story",mnemonic:0,callback:function(){return e.replayStory()},enabled:function(){return null!==e.engine}},{title:"Load World",mnemonic:0,callback:function(){return e.load()},enabled:function(){return null!==e.data},beta:!0},{title:"Save World",mnemonic:0,callback:function(){return e.save()},enabled:function(){return null!==e.engine},beta:!0},h.MenuItemSeparator,{title:"Options",mnemonic:0,submenu:[{title:"Difficulty"},{title:"Game Speed"},{title:"World Size"},h.MenuItemSeparator,y(e,"Play Music","playMusic",r),y(e,"Play Effects","playEffects",r)]},{title:"Statistics",mnemonic:0,submenu:[{title:"High Score"},{title:"Last Score"},{title:"Games Won"},{title:"Games Lost"}]},h.MenuItemSeparator,{title:"Report a Bug",mnemonic:0,callback:function(){return v.window.open(r.issueTracker)}}]).call(a,(0,i.default)(e.settings.debug?[p.default(e)]:[]),[h.MenuItemSeparator,{title:"Leave",mnemonic:0,callback:function(){return e.exit()}}]))}return n}(h.Menu);t.default=m},82229:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244));function c(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(48563);var f=n(5008),h=n(20779),p=function(e){(0,l.default)(n,e);var t=c(n);function n(){var e;return(0,i.default)(this,n),(e=t.call(this))._state=h.PersistentState,e.closable=!0,e.title="Player Statistics",e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){(0,u.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this),this.content.appendChild(WebFun.JSX.render("div",{className:"icon"})),this.content.appendChild(WebFun.JSX.render("ul",null,this._buildRow("High Score:","highScore"),this._buildRow("Last Score:","lastScore"),this._buildRow("Game Won:","gamesWon"),this._buildRow("Games Lost:","gamesLost")))}},{key:"_buildRow",value:function(e,t){return WebFun.JSX.render("li",null,WebFun.JSX.render("span",null,e),WebFun.JSX.render(f.Textbox,{editable:!1,align:"right",width:60,height:20,value:"".concat(this._state[t])}))}},{key:"disconnectedCallback",value:function(){this.content.textContent="",(0,u.default)((0,d.default)(n.prototype),"disconnectedCallback",this).call(this)}}]),n}(f.AbstractWindow);p.tagName="wf-statistics-window",t.default=p},65348:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(80655)),u=a(n(20497)),l=a(n(75244));function s(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(72157);var d=function(e){(0,o.default)(n,e);var t=s(n);function n(){var e;return(0,i.default)(this,n),(e=t.call(this)).title="World Size",e.key="world-size",e.minLabel="Small",e.midLabel="Medium",e.maxLabel="Large",e.slider.min=1,e.slider.max=3,e.slider.snapToIntegers=!0,e}return n}(n(15695).SettingsWindow);d.tagName="wf-world-size-window",t.default=d},92540:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583)),o=r(n(68748)),u=r(n(47053)),l=r(n(23982)),s=r(n(6849)),d=r(n(67093)),c=r(n(68190));(0,o.default)(t,"__esModule",{value:!0}),t.NullIfMissing=t.ThrowIfMissing=void 0;t.NullIfMissing=function(){return null};var f=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;throw new Error((0,u.default)(t="Entity ".concat(n," of type ")).call(t,e," cannot be found"))};t.ThrowIfMissing=f;var h=function(){function e(){(0,a.default)(this,e),this.entries=new l.default}return(0,i.default)(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:f,r=(0,s.default)(this).get(e);if(!r)throw new Error("Type ".concat(e," is not registered"));return r[t]||n(e,t)}},{key:"set",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=(0,s.default)(this).get(e);r||((0,s.default)(this).set(e,[]),r=(0,s.default)(this).get(e)),r[n]=t}},{key:"find",value:function(e,t){var n=(0,s.default)(this).get(e)||[];return(0,d.default)(n).call(n,t)}},{key:"getFiltered",value:function(e,t){var n=(0,s.default)(this).get(e)||[];return(0,c.default)(n).call(n,t)}},{key:"getAll",value:function(e){return(0,s.default)(this).get(e)||[]}},{key:"populate",value:function(e,t){(0,s.default)(this).set(e,t)}}]),e}();t.default=h},58574:(e,t,n)=>{var r;(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),function(e){e[e.Effect=0]="Effect",e[e.Music=1]="Music"}(r||(r={})),t.default=r},78126:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.Channel=void 0;var r=n(58574);t.Channel=r.default},25775:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108)),o=r(n(68748)),u=r(n(68190)),l=r(n(55903)),s=r(n(42601));(0,o.default)(t,"__esModule",{value:!0});var d=n(83608),c=n(31560),f=n(17766),h=n(76500),p=n(46e3);function v(e,t,n,r){var a;t.id!==p.Yoda.charIDs.TheForce?(null===(a=e.face)||void 0===a?void 0:a.health)<0||(e.damageTaken+=t.damage,e.alive||(n.setTile(null,e.position),e.enabled=!1,e.dropsLoot&&function(e,t,n){var r=new h.MutableHotspot;r.type=f.Hotspot.Type.DropItem,r.enabled=!0,r.location=e.position;var a=-1;if(e.loot>0)a=e.loot-1;else{var i,o=(0,u.default)(i=t.hotspots.withType(f.Hotspot.Type.DropQuestItem)).call(i,(function(e){return e.arg>0}));if(!o.length)return;var l=o.first();a=l.arg,l.enabled=!1}if(-1===a)return;r.arg=a,t.hotspots.push(r);var s=n.get(f.Tile,r.arg);t.setTile(s,r.location.x,r.location.y,f.Zone.Layer.Object)}(e,n,r))):e.cooldown=t.damage}function y(e){var t=e.hero;if(3===t._actionFrames)return null;var n=t.weapon.frames,r=function(e){switch(c.Direction.Confine(e)){case c.Direction.South:case c.Direction.SouthEast:case c.Direction.SouthWest:return f.Char.FrameEntry.Down;case c.Direction.North:case c.Direction.NorthEast:case c.Direction.NorthWest:return f.Char.FrameEntry.Up;case c.Direction.East:return f.Char.FrameEntry.Right;case c.Direction.West:return f.Char.FrameEntry.Left}}(t.direction);return n[0].tiles[r]}t.default=function(){var e=(0,i.default)(a.default.mark((function e(t,n){var r,i,o,h,p,m,g,_,w,k,b;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t.hero,h=t.assets,o.isAttacking){e.next=4;break}return e.abrupt("return",d.ScriptResult.Done);case 4:if(3!==(p=o._actionFrames)){e.next=9;break}return o.isAttacking=!1,o._actionFrames=0,e.abrupt("return",d.ScriptResult.Done);case 9:if(m=c.Direction.Confine(o.direction,!1),g=!!o.weapon.frames[0].left,0!==(_=(0,u.default)(r=g?[o.location.byAdding(c.Direction.CalculateRelativeCoordinates(m,p+1))]:[o.location.byAdding(c.Direction.CalculateRelativeCoordinates(m,1)),o.location.byAdding(c.Direction.CalculateRelativeCoordinates(m-45,1)),o.location.byAdding(c.Direction.CalculateRelativeCoordinates(m+50,1))]).call(r,(function(e){return n.bounds.contains(e)}))).length){e.next=16;break}return o.isAttacking=!1,o._actionFrames=0,e.abrupt("return",d.ScriptResult.Done);case 16:if(w=(0,u.default)(i=n.monsters).call(i,(function(e){var t=e.position,n=e.alive,r=e.enabled;return n&&r&&(0,l.default)(_).call(_,(function(e){return t.isEqualTo(e)}))})),(0,s.default)(w).call(w,(function(e){return v(e,o.weapon,n,h)})),!w.length){e.next=22;break}return o.isAttacking=!1,o._actionFrames=0,e.abrupt("return",d.ScriptResult.Done);case 22:if(k=n.getTile(_[0]),y(t)){e.next=25;break}return e.abrupt("return",d.ScriptResult.Done);case 25:if(k&&!k.isOpaque()){e.next=33;break}return t.inputManager.placedTileLocation=_[0],t.inputManager.placedTile=o.weapon.frames[0].tiles[f.Char.FrameEntry.ExtensionRight],t.spu.prepareExecution(d.EvaluationMode.PlaceItem,n),e.next=31,t.spu.run();case 31:return b=e.sent,e.abrupt("return",b);case 33:o.isAttacking=!1,o._actionFrames=0;case 35:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},53684:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o=n(31560),u=function(){function e(){(0,a.default)(this,e),this.zoneSize=new o.Size(9,9),this.hero=null,this._offset=new o.Point(0,0),this._size=new o.Size(9,9)}return(0,i.default)(e,[{key:"offset",get:function(){return this._offset}},{key:"size",get:function(){return this._size}},{key:"update",value:function(e){this._offset.x=this._size.width/2-this.hero.location.x,this._offset.y=this._size.height/2-this.hero.location.y,this._offset.x=Math.floor(this._offset.x),this._offset.y=Math.floor(this._offset.y),this._offset.x=Math.min(0,this._offset.x),this._offset.y=Math.min(0,this._offset.y),this._offset.x=Math.max(this._offset.x,this._size.width-this.zoneSize.width),this._offset.y=Math.max(this._offset.y,this._size.height-this.zoneSize.height)}}]),e}();t.default=u},13992:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583)),o=r(n(68748)),u=r(n(68190)),l=r(n(42601)),s=r(n(35983));(0,o.default)(t,"__esModule",{value:!0});var d=function(){function e(t){(0,a.default)(this,e),this._input="",this._cheats=t}return(0,i.default)(e,[{key:"addCharacter",value:function(e){this._input+=e}},{key:"reset",value:function(){this._input=""}},{key:"execute",value:function(e){var t,n=this,r=(0,u.default)(t=this._cheats).call(t,(function(e){return e.code===n._input}));return(0,l.default)(r).call(r,(function(t){return t.execute(e)})),(0,s.default)(r).call(r,(function(e){return e.message}))}}]),e}();t.default=d},68311:(e,t,n)=>{var r=n(38468),a=r(n(40361));(0,r(n(68748)).default)(t,"__esModule",{value:!0});t.default=function e(){(0,a.default)(this,e)}},87317:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.RequiredItems=t.Weapons=t.UnlimitedAmmo=t.Invincibility=t.Cheat=t.CheatCodeInput=void 0;var r=n(68311);t.Cheat=r.default;var a=n(13992);t.CheatCodeInput=a.default;var i=n(40588);t.Invincibility=i.default;var o=n(2209);t.RequiredItems=o.default;var u=n(93939);t.UnlimitedAmmo=u.default;var l=n(13662);t.Weapons=l.default},40588:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244));function d(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0});var c=function(e){(0,u.default)(n,e);var t=d(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return(0,o.default)(n,[{key:"code",get:function(){return"goyoda"}},{key:"message",get:function(){return"Invincible!"}},{key:"execute",value:function(e){e.hero.invincible=!0}}]),n}(n(68311).default);t.default=c},2209:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244));function d(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0});var c=function(e){(0,u.default)(n,e);var t=d(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return(0,o.default)(n,[{key:"code",get:function(){return"go3po"}},{key:"message",get:function(){return"It's Dangerous to Go Alone! Take This!"}},{key:"execute",value:function(e){var t=e.currentWorld.findSectorContainingZone(e.currentZone);if(t){var n=t.requiredItem;n&&e.inventory.addItem(n);var r=t.additionalRequiredItem;r&&e.inventory.addItem(r)}}}]),n}(n(68311).default);t.default=c},93939:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244));function d(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0});var c=function(e){(0,u.default)(n,e);var t=d(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return(0,o.default)(n,[{key:"code",get:function(){return"gohan"}},{key:"message",get:function(){return"Super Smuggler!"}},{key:"execute",value:function(e){e.hero.unlimitedAmmo=!0}}]),n}(n(68311).default);t.default=c},13662:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244));function d(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0});var c=n(68311),f=n(46e3),h=n(17766),p=function(e){(0,u.default)(n,e);var t=d(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return(0,o.default)(n,[{key:"code",get:function(){return"gojedi"}},{key:"message",get:function(){return"Super Jedi!"}},{key:"execute",value:function(e){for(var t=0;t<5;t++)this.addItem(e,f.Yoda.tileIDs.ThermalDetonator);this.addItem(e,f.Yoda.tileIDs.BlasterRifle),this.addItem(e,f.Yoda.tileIDs.Blaster),this.addItem(e,f.Yoda.tileIDs.TheForce)}},{key:"addItem",value:function(e,t){var n=e.assets.get(h.Tile,t);e.inventory.addItem(n)}}]),n}(c.default);t.default=p},69810:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(79302));(0,a.default)(t,"__esModule",{value:!0});var o=n(2341),u=n(87342),l=n(8939),s=n(49961),d=n(83608),c=n(9021),f=n(53995),h=n(46724),p=n(92540),v=n(37871),y=n(46438);t.default={Metronome:function(){return new l.default},Inventory:function(){return new s.default},ScriptProcessingUnit:function(e,t,n){return new d.ScriptProcessingUnit(e,t,n)},Hero:function(){return new c.default},Mixer:function(){return new f.default},InputManager:function(){return new o.default},Renderer:function(){return new u.default},SceneManager:function(){return new h.default},AssetManager:function(){return new p.default},ResourceManager:function(){return new v.default},Logger:function(){return new y.default},ShowText:function(){return i.default.resolve()}}},75747:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.Mixer=t.Renderer=t.InputManager=t.ResourceManager=void 0;var r=n(2341);t.InputManager=r.default;var a=n(87342);t.Renderer=a.default;var i=n(53995);t.Mixer=i.default;var o=n(37871);t.ResourceManager=o.default;var u=n(69810);t.default=u.default},2341:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o=n(34159),u=function(){function e(){(0,a.default)(this,e)}return(0,i.default)(e,[{key:"clear",value:function(){}},{key:"addListeners",value:function(){}},{key:"readInput",value:function(e){return o.InputMask.None}},{key:"removeListeners",value:function(){}}]),e}();t.default=u},46438:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o=function(){function e(){(0,a.default)(this,e)}return(0,i.default)(e,[{key:"debug",value:function(){}},{key:"info",value:function(){}},{key:"warn",value:function(){}},{key:"error",value:function(){}}]),e}();t.default=o},53995:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o=function(){function e(){(0,a.default)(this,e),this.volume=1}return(0,i.default)(e,[{key:"play",value:function(e,t){}},{key:"stop",value:function(){}}]),e}();t.default=o},87342:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o=function(){function e(){(0,a.default)(this,e)}return(0,i.default)(e,[{key:"fillRect",value:function(e,t,n,r,a){}},{key:"renderImageData",value:function(e,t,n){}},{key:"renderImage",value:function(e,t,n){}},{key:"drawImage",value:function(e,t,n){}},{key:"clear",value:function(){}},{key:"redisplayTile",value:function(e,t){}},{key:"redisplayRect",value:function(e,t,n,r){}},{key:"redisplay",value:function(){}},{key:"fillBlackRect",value:function(e,t,n,r){}}]),e}();t.default=o},37871:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o=function(){function e(){(0,a.default)(this,e)}return(0,i.default)(e,[{key:"loadGameFile",value:function(e){throw new Error("Method not implemented.")}},{key:"loadPalette",value:function(e){throw new Error("Method not implemented.")}},{key:"loadSound",value:function(e,t){throw new Error("Method not implemented.")}},{key:"loadStrings",value:function(e){throw new Error("Method not implemented.")}}]),e}();t.default=o},41777:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(6060)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244)),c=a(n(68748)),f=a(n(20778)),h=a(n(67093)),p=a(n(79302));function v(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,c.default)(t,"__esModule",{value:!0}),t.Events=void 0;var y=n(17766),m=n(53684),g=n(31560),_=n(2577);t.Events=_.default;var w=n(82127),k=n(9021),b=n(78126),S=n(83608),I=n(35930),x=n(63806),T=n(50177),M=n(92540),E=n(47590),C=n(35288),A=n(75747),D=n(34850),z=n(17725),P=function(e){(0,l.default)(n,e);var t=v(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,i.default)(this,n),(r=t.call(this)).variant=null,r.assets=null,r.resources=null,r.camera=new m.default,r.hero=null,r.inputManager=null,r.inventory=null,r.metronome=null,r.mixer=null,r.palette=null,r.persistentState=I.default,r.renderer=null,r.sceneManager=null,r.spu=null,r.story=null,r.currentPlayStart=new Date,r.totalPlayTime=0,r.settings=T.defaultSettings,r._currentWorld=null,r._currentZone=null,r._updateInProgress=!1,r._gameState=w.default.Stopped,a=(0,f.default)({},A.default,a),r._interface=a,r.mixer=a.Mixer(),r.resources=a.ResourceManager(),r.assets=a.AssetManager(),r.renderer=a.Renderer(null),r.sceneManager=a.SceneManager(),r.inputManager=a.InputManager(null),r.metronome=a.Metronome(),r.inventory=a.Inventory(),r.spu=a.ScriptProcessingUnit((0,u.default)(r),C.InstructionImplementations,E.ConditionImplementations),r.hero=a.Hero(),r.variant=e,r._hpu=new S.HotspotProcessingUnit((0,u.default)(r)),r.registerEvents(_.default),r}return(0,o.default)(n,[{key:"dagobah",get:function(){return this.story.dagobah}},{key:"world",get:function(){return this.story.world}},{key:"currentZone",get:function(){return this._currentZone},set:function(e){this._currentZone=e,this.dispatchEvent(_.default.CurrentZoneChange)}},{key:"currentSector",get:function(){return this.currentWorld.findSectorContainingZone(this.currentZone)}},{key:"currentWorld",get:function(){return this._currentWorld},set:function(e){this._currentWorld=e}},{key:"triggerLocationChange",value:function(){this.dispatchEvent(_.default.LocationChanged,{zone:this._currentZone,world:this._currentWorld})}},{key:"update",value:function(e){var t=this;return this._updateInProgress&&console.warn("Reentering update!"),this._updateInProgress=!0,this.sceneManager.update(e).catch((function(e){return console.warn("Update failed",e)})).finally((function(){return t._updateInProgress=!1}))}},{key:"render",value:function(){this.sceneManager.render(this.renderer)}},{key:"consume",value:function(e){if(e.hasAttributes(y.Tile.Attributes.Edible)){var t=this.variant.getHealthBonus(e);if(t>0&&this.hero.health>=k.default.MaxHealth){var n=this.assets.get(y.Sound,this.variant.sounds.NoGo,M.NullIfMissing);this.mixer.play(n,b.Channel.Effect)}else if(this.hero.health+=t,this.inventory.removeItem(e),t<0){var r=this.assets.get(y.Sound,this.variant.sounds.Hurt,M.NullIfMissing);this.mixer.play(r,b.Channel.Effect)}else;}else{var a=this.assets.get(y.Sound,this.variant.sounds.NoGo,M.NullIfMissing);this.mixer.play(a,b.Channel.Effect)}}},{key:"equip",value:function(e){var t;if(e.hasAttributes(y.Tile.Attributes.Weapon))if(this.variant.canBeEquipped(e)){var n=(0,h.default)(t=this.assets).call(t,y.Char,(function(t){return t.isWeapon()&&t.frames[0].extensionRight===e}));if(this.hero.weapon!==n){this.hero.weapon=n;var r=this.hero.getAmmoForWeapon(n);r||(r=this.variant.getMaxAmmo(n)),this.hero.ammo=r;var a=this.variant.getEquipSound(n),i=this.assets.get(y.Sound,a,M.NullIfMissing);this.mixer.play(i,b.Channel.Effect),this.dispatchEvent(new CustomEvent(_.default.WeaponChanged,{detail:{weapon:e}}))}}else{var o=this.assets.get(y.Sound,this.variant.sounds.NoGo,M.NullIfMissing);this.mixer.play(o,b.Channel.Effect)}else{var u=this.assets.get(y.Sound,this.variant.sounds.NoGo,M.NullIfMissing);this.mixer.play(u,b.Channel.Effect)}}},{key:"speak",value:function(e,t){if(this.settings.skipDialogs)return p.default.resolve();var n=new x.SpeechScene(this);return n.text=e,n.location=t,this.sceneManager.presentScene(n)}},{key:"showText",value:function(e,t){return this._interface.ShowText(e,t)}},{key:"showDebugStatusInfo",value:function(){this._interface.ShowDebugStatusInfo(this)}},{key:"dropItem",value:function(e,t){var n=this;console.assert(!!e&&!!t);var r=function(){n.currentSector.findItem===e&&(n.currentSector.solved1=!0,n.currentSector.solved2=!0)};if(this.settings.pickupItemsAutomatically)return this.inventory.addItem(e),r(),p.default.resolve();var a=new x.PickupScene(this);return a.tile=e,a.location=t,this.sceneManager.presentScene(a).then(r)}},{key:"findSectorContainingZone",value:function(e){var t=this.world.findSectorContainingZone(e);return t?{sector:t,world:this.world}:(t=this.dagobah.findSectorContainingZone(e))?{sector:t,world:this.dagobah}:void 0}},{key:"findLocationOfZone",value:function(e){var t=this.world.findLocationOfZone(e);return t?{location:t,world:this.world}:(t=this.dagobah.findLocationOfZone(e))?{location:t,world:this.dagobah}:{location:null,world:this.currentWorld}}},{key:"hpu",get:function(){return this._hpu}},{key:"gameState",get:function(){return this._gameState},set:function(e){if(e!==this._gameState&&(this._gameState=e,this._gameState===w.default.Lost&&(this.persistentState.gamesLost+=1),this._gameState===w.default.Won)){var t=D.default(this);this.persistentState.gamesWon+=1,this.persistentState.lastScore=t,this.persistentState.highScore=z.max(this.persistentState.highScore,this.persistentState.lastScore)}}},{key:"teardown",value:function(){this.inputManager.mouseDownHandler=null,this.inputManager.keyDownHandler=null,this.inputManager.removeListeners(),this.inputManager.engine=null,this.sceneManager.engine=null,this.currentZone=null}}]),n}(g.EventTarget);P.Event=_.default,t.default=P},2577:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.Events=void 0,t.Events={CurrentZoneChange:"currentzonechange",AmmoChanged:"ammochange",WeaponChanged:"weaponchange",LocationChanged:"locationchange"},t.default=t.Events},61623:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(20778));(0,a.default)(t,"__esModule",{value:!0}),t.parseActionNames=t.parseActions=t.parseAction=void 0;var o=n(71184),u="IACT",l=function(e){var t=e.readUint16(),n=e.readInt16Array(5),r=e.readUint16();return{opcode:t,arguments:n,text:e.readCharacters(r,"iso-8859-2")}},s=function(e){return(0,i.default)(l(e),{isCondition:!0})},d=function(e){return(0,i.default)(l(e),{isInstruction:!0})};t.parseAction=function(e,t){var n=e.readCharacters(4);o.assert(n===u,"Expected to find category ".concat(u,"."),e),e.readUint32();for(var r=e.readUint16(),a=new Array(r),i=0;i<r;i++)a[i]=s(e);for(var l=e.readUint16(),c=new Array(l),f=0;f<l;f++)c[f]=d(e);return{conditions:a,instructions:c}};t.parseActions=function(e,n){for(e.readUint32();;){var r=e.readInt16();if(-1===r)break;for(var a=e.readUint16(),i=new Array(a),o=0;o<a;o++)i[o]=t.parseAction(e,n);n.zones[r].actions=i}};t.parseActionNames=function(e,t){for(e.readUint32();;){var n=e.readInt16();if(-1===n)break;for(var r=t.zones[n].actions;;){var a=e.readInt16();if(-1===a)break;r[a].name=e.readCStringWithLength(16,"iso-8859-2")}}}},67074:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.parseCharacterWeapons=t.parseCharacterWeapon=t.parseCharacterAux1=t.parseCharacterAux=t.parseCharacters=void 0;var r=n(46e3),a=n(71184),i=function(e,t){return e.readInt16Array(8)},o=function(e,t,n){var o=e.readCharacters(4);a.assert("ICHA"===o,"Expected to find ICHA marker.",e),e.readUint32();var u=e.readCStringWithLength(16,"iso-8859-2"),l=e.readInt16(),s=e.readInt16(),d=0,c=0;return n!==r.Yoda&&n!==r.YodaDemo||(d=e.readInt16(),c=e.readUint32()),{name:u,type:l,movementType:s,probablyGarbage1:d,probablyGarbage2:c,frame1:i(e),frame2:i(e),frame3:i(e),damage:-1,health:-1,reference:-1}};t.parseCharacters=function(e,t,n){e.readUint32();for(var r=[];;){if(-1===e.readInt16())break;r.push(o(e,0,n))}t.characters=r};t.parseCharacterAux=function(e,n){for(e.readUint32();;){var r=e.readInt16();if(-1===r)break;t.parseCharacterAux1(e,n,r)}};t.parseCharacterAux1=function(e,t,n){var r=e.readInt16();t.characters[n].damage=r};t.parseCharacterWeapon=function(e,t,n){var r=e.readInt16(),a=e.readInt16();t.characters[n].health=a,t.characters[n].reference=r};t.parseCharacterWeapons=function(e,n){for(e.readUint32();;){var r=e.readInt16();if(-1===r)break;t.parseCharacterWeapon(e,n,r)}}},32495:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.parseEndOfFile=void 0;t.parseEndOfFile=function(e,t){t.end=e.readUint32()}},79360:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.parseHotspots=t.parseHotspot=void 0;t.parseHotspot=function(e){return{type:e.readUint32(),x:e.readInt16(),y:e.readInt16(),enabled:0!==e.readUint16(),argument:e.readInt16()}};t.parseHotspots=function(e,n){for(e.readUint32();;){var r=e.readInt16();if(-1===r)break;for(var a=e.readUint16(),i=[],o=0;o<a;o++)i.push(t.parseHotspot(e));n.zones[r].hotspots=i}}},6868:(e,t,n)=>{var r=n(38468)(n(68748));(0,r.default)(t,"__esModule",{value:!0}),t.parseEndOfFile=t.parseTgen=t.parseZoneNames=t.parseZax4=t.parseZax3=t.parseZax2=t.parseZaux=t.parseZones=t.parseVersion=t.parseTileNames=t.parseTiles=t.parseSounds=t.parseSetupImage=t.parsePuzzleNames=t.parsePuzzles=t.parseHotspots=t.parseCharacterWeapons=t.parseCharacterAux=t.parseCharacters=t.parseActionNames=t.parseActions=void 0;var a=n(61623);(0,r.default)(t,"parseActionNames",{enumerable:!0,get:function(){return a.parseActionNames}}),(0,r.default)(t,"parseActions",{enumerable:!0,get:function(){return a.parseActions}});var i=n(67074);(0,r.default)(t,"parseCharacterAux",{enumerable:!0,get:function(){return i.parseCharacterAux}}),(0,r.default)(t,"parseCharacterWeapons",{enumerable:!0,get:function(){return i.parseCharacterWeapons}}),(0,r.default)(t,"parseCharacters",{enumerable:!0,get:function(){return i.parseCharacters}});var o=n(75641);(0,r.default)(t,"parsePuzzleNames",{enumerable:!0,get:function(){return o.parsePuzzleNames}}),(0,r.default)(t,"parsePuzzles",{enumerable:!0,get:function(){return o.parsePuzzles}});var u=n(36157);(0,r.default)(t,"parseTileNames",{enumerable:!0,get:function(){return u.parseTileNames}}),(0,r.default)(t,"parseTiles",{enumerable:!0,get:function(){return u.parseTiles}});var l=n(1638);(0,r.default)(t,"parseZaux",{enumerable:!0,get:function(){return l.parseZaux}}),(0,r.default)(t,"parseZax2",{enumerable:!0,get:function(){return l.parseZax2}}),(0,r.default)(t,"parseZax3",{enumerable:!0,get:function(){return l.parseZax3}}),(0,r.default)(t,"parseZax4",{enumerable:!0,get:function(){return l.parseZax4}}),(0,r.default)(t,"parseZoneNames",{enumerable:!0,get:function(){return l.parseZoneNames}}),(0,r.default)(t,"parseZones",{enumerable:!0,get:function(){return l.parseZones}});var s=n(32495);(0,r.default)(t,"parseEndOfFile",{enumerable:!0,get:function(){return s.parseEndOfFile}});var d=n(79360);(0,r.default)(t,"parseHotspots",{enumerable:!0,get:function(){return d.parseHotspots}});var c=n(6928);(0,r.default)(t,"parseSetupImage",{enumerable:!0,get:function(){return c.parseSetupImage}});var f=n(90869);(0,r.default)(t,"parseSounds",{enumerable:!0,get:function(){return f.parseSounds}});var h=n(3858);(0,r.default)(t,"parseVersion",{enumerable:!0,get:function(){return h.parseVersion}});var p=n(1264);(0,r.default)(t,"parseTgen",{enumerable:!0,get:function(){return p.parseTgen}})},50740:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.parseMonster=void 0;var r=n(46e3);t.parseMonster=function(e,t){return t.type===r.Yoda||t.type===r.YodaDemo?{character:e.readUint16(),x:e.readUint16(),y:e.readUint16(),loot:e.readInt16(),dropsLoot:!!e.readUint32(),waypoints:e.readInt32Array(8)}:{character:e.readUint16(),x:e.readUint16(),y:e.readUint16(),loot:-1,dropsLoot:!1,waypoints:new Int16Array}}},75641:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.parsePuzzleNames=t.parsePuzzles=void 0;var r=n(46e3),a=n(71184),i=function(e,t,n){var i=e.readCharacters(4);a.assert("IPUZ"===i,"Expected to find category marker IPUZ",e),e.readUint32();var o=-1;n!==r.Yoda&&n!==r.YodaDemo||(o=e.readUint32());for(var u=e.readUint32(),l=e.readUint32(),s=e.readUint16(),d=Array.Repeat("",5),c=0;c<5;c++)d[c]=e.readLengthPrefixedString("iso-8859-2");var f=e.readUint16(),h=null;return n!==r.Yoda&&n!==r.YodaDemo||(h=e.readUint16()),{name:"",type:o,unknown1:u,unknown2:l,unknown3:s,texts:d,item1:f,item2:h}};t.parsePuzzles=function(e,t,n){e.readUint32();for(var r=[];;){if(-1===e.readInt16())break;r.push(i(e,0,n))}t.puzzles=r};t.parsePuzzleNames=function(e,t){e.readUint32();for(var n=e.readInt16(),r=0;r<n;r++)t.puzzles[r].name=e.readCStringWithLength(16,"iso-8859-2")}},6928:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.parseSetupImage=void 0;var r=n(71184);t.parseSetupImage=function(e,t){var n=e.readUint32();r.assert(82944===n,"Expected setup image to be 288x288 pixels in size.",e),t.setup=e.readUint8Array(n)}},90869:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.parseSounds=void 0;var r=n(71184);t.parseSounds=function(e,t){e.readUint32();for(var n=-e.readInt16(),a=new Array(n),i=0;i<n;i++){var o=e.readUint16();r.assert(o>0,"Expected at least as null byte to terminate an empty string!",e),a[i]=e.readCStringWithLength(o,"iso-8859-2")}t.sounds=a}},1264:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.parseTgen=void 0;t.parseTgen=function(e){var t=e.readUint32();e.readUint8Array(t)}},36157:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.parseTileNames=t.parseTiles=t.parseTile=void 0;var r=n(46e3),a=n(17766);t.parseTile=function(e,t){return{attributes:e.readUint32(),pixels:e.readUint8Array(a.Tile.SIZE),name:""}};t.parseTiles=function(e,n){for(var r=e.readUint32()/(a.Tile.SIZE+4),i=new Array(r),o=0;o<r;o++)i[o]=t.parseTile(e,n);n.tiles=i};t.parseTileNames=function(e,t,n){for(e.readUint32();;){var a=e.readInt16();if(-1===a)break;var i=n===r.Yoda||n===r.YodaDemo?24:16;t.tiles[a].name=e.readCStringWithLength(i,"iso-8859-2")}}},3858:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.parseVersion=void 0;t.parseVersion=function(e,t){t.version=e.readUint32()}},1638:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.parseZax4=t.parseZax3=t.parseZax2=t.parseZaux=t.parseZoneNames=t.parseZones=void 0;var r=n(46e3),a=n(71184),i=n(61623),o=n(79360),u=n(50740),l="IZON",s="IZAX",d="IZX2",c="IZX3",f="IZX4",h=function(e,t,n){var u=0;n!==r.Yoda&&n!==r.YodaDemo||(u=e.readUint16(),e.readUint32(),e.readUint16());var s=e.readCharacters(4);a.assert(s===l,"Expected to find category ".concat(l,"."),e),e.readUint32();var d=e.readUint16(),c=e.readUint16(),f=e.readUint32();if(n===r.Yoda||n===r.YodaDemo){e.readUint16();var h=e.readUint16();a.assert(u===h,"Expected to find the same planet again",e)}var g=e.readInt16Array(3*d*c);if(n===r.Indy||n===r.IndyDemo)return{planet:u,width:d,height:c,zoneType:f,tileIDs:g,hotspots:[],monsters:[],actions:[],requiredItemIDs:new Int16Array(0),goalItemIDs:new Int16Array(0),providedItemIDs:new Int16Array(0),npcIDs:new Int16Array(0),unknown:0};for(var _=e.readUint16(),w=[],k=0;k<_;k++)w.push(o.parseHotspot(e));for(var b=p(e,t),S=b.monsters,I=b.requiredItemIDs,x=b.goalItemIDs,T=v(e,t).providedItemIDs,M=y(e,t).npcIDs,E=m(e,t).unknown,C=e.readUint16(),A=[],D=0;D<C;D++)A.push(i.parseAction(e,t));return{planet:u,width:d,height:c,zoneType:f,tileIDs:g,hotspots:w,monsters:S,actions:A,requiredItemIDs:I,goalItemIDs:x,providedItemIDs:T,npcIDs:M,unknown:E}};t.parseZones=function(e,t,n){var a=e.readUint16();n!==r.Indy&&n!==r.IndyDemo||(e.readUint16(),a=e.readUint16());for(var i=[],o=0;o<a;o++)i.push(h(e,t,n));t.zones=i};var p=function(e,t){var n=e.readCharacters(4);a.assert(n===s,"Expected to find category ".concat(s,"."),e),e.readUint32();for(var i=e.readUint16(),o=e.readUint16(),l=[],d=0;d<o;d++)l.push(u.parseMonster(e,t));var c=e.readUint16(),f=e.readInt16Array(c);if(t.type===r.Yoda||t.type===r.YodaDemo){var h=e.readUint16();return{unknown:i,monsters:l,requiredItemIDs:f,goalItemIDs:e.readInt16Array(h)}}return{unknown:i,monsters:l,requiredItemIDs:f,goalItemIDs:new Int16Array}},v=function(e,t){var n=e.readCharacters(4);a.assert(n===d,"Expected to find category ".concat(d,"."),e),e.readUint32();var r=e.readUint16();return{providedItemIDs:e.readUint16Array(r)}},y=function(e,t){var n=e.readCharacters(4);a.assert(n===c,"Expected to find category ".concat(c,"."),e),e.readUint32();var r=e.readUint16();return{npcIDs:e.readUint16Array(r)}},m=function(e,t){var n=e.readCharacters(4);return a.assert(n===f,"Expected to find category ".concat(f,"."),e),e.readUint32(),{unknown:e.readUint16()}};t.parseZoneNames=function(e,t){for(e.readUint32();;){var n=e.readInt16();if(-1===n)break;t.zones[n].name=e.readCStringWithLength(16,"iso-8859-2")}};t.parseZaux=function(e,t){e.readUint32();for(var n=0;n<t.zones.length;n++){var r=p(e,t),a=r.monsters,i=r.requiredItemIDs,o=r.goalItemIDs;t.zones[n].monsters=a,t.zones[n].requiredItemIDs=i,t.zones[n].goalItemIDs=o}};t.parseZax2=function(e,t){e.readUint32();for(var n=0;n<t.zones.length;n++){var r=v(e,t).providedItemIDs;t.zones[n].providedItemIDs=r}};t.parseZax3=function(e,t){e.readUint32();for(var n=0;n<t.zones.length;n++){var r=y(e,t).npcIDs;t.zones[n].npcIDs=r}};t.parseZax4=function(e,t){e.readUint32();for(var n=0;n<t.zones.length;n++){var r=m(e,t).unknown;t.zones[n].unknown=r}}},75903:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(6868);t.default={VERS:r.parseVersion,STUP:r.parseSetupImage,SNDS:r.parseSounds,TILE:r.parseTiles,ZONE:r.parseZones,PUZ2:r.parsePuzzles,CHAR:r.parseCharacters,CHWP:r.parseCharacterWeapons,CAUX:r.parseCharacterAux,TNAM:r.parseTileNames,ZAUX:r.parseZaux,ZAX2:r.parseZax2,ZAX3:r.parseZax3,ZAX4:r.parseZax4,HTSP:r.parseHotspots,ACTN:r.parseActions,ZNAM:r.parseZoneNames,PNAM:r.parsePuzzleNames,ANAM:r.parseActionNames,TGEN:r.parseTgen,ENDF:r.parseEndOfFile}},71184:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.assert=t.error=void 0;var r=n(82761);t.error=function(e,t){var n=null;throw n=e instanceof r.default?e:e instanceof Error?new r.default(e.message):"string"==typeof e?new r.default(e):new r.default("Unknown error"),n};t.assert=function(e,n,r){e||t.error(n,r)},t.default=t.error},81724:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.ParseError=t.readProgressively=t.read=void 0;var r=n(82761);t.ParseError=r.default;var a=n(97588);t.read=a.default;var i=n(92160);t.readProgressively=i.default},82761:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(80655)),u=a(n(20497)),l=a(n(75244)),s=a(n(46386));function d(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0});var c=function(e){(0,o.default)(n,e);var t=d(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return n}((0,s.default)(Error));t.default=c},92160:(e,t,n)=>{var r=n(63789),a=n(38468),i=a(n(63789)),o=a(n(68748)),u=r.mark(d);(0,o.default)(t,"__esModule",{value:!0});var l=n(71184),s=n(75903);function d(e,t){var n,r,a,o;return i.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:n={version:null,setup:null,sounds:[],tiles:[],zones:[],puzzles:[],characters:[],end:0,type:t};case 1:if(!(e.bytesAvailable<8)){i.next=6;break}return i.next=4,n;case 4:i.next=1;break;case 6:if(a=e.readCharacters(4),o=e.readUint32(),"VERS"===a&&(n.version=o),"STUP"!==a){i.next=19;break}case 10:if(!(e.bytesAvailable<o)){i.next=15;break}return i.next=13,n;case 13:i.next=10;break;case 15:return n.setup=e.readUint8Array(o),i.next=18,n;case 18:return i.abrupt("break",20);case 19:i.next=1;break;case 20:if(e.done){i.next=25;break}return i.next=23,n;case 23:i.next=20;break;case 25:do{r=e.readCharacters(4),(s.default[r]||function(){return l.error("Invalid category ".concat(r," found."),e)})(e,n,t)}while("ENDF"!==r);return console.assert(e.isAtEnd(),"0x".concat((e.length-e.offset).toString(16)," unknown bytes at end of stream!")),i.abrupt("return",n);case 28:case"end":return i.stop()}}),u)}t.default=d},97588:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(71184),a=n(75903);t.default=function(e,t){var n,i={version:0,setup:new Uint8Array(0),sounds:[],tiles:[],zones:[],puzzles:[],characters:[],end:0,type:t};do{n=e.readCharacters(4),(a.default[n]||function(){return r.error("Invalid category ".concat(n," found."),e)})(e,i,t)}while("ENDF"!==n);return console.assert(e.isAtEnd(),"0x".concat((e.length-e.offset).toString(16)," unknown bytes at end of stream!")),i}},93321:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(92915)),o=r(n(35983)),u=r(n(42601));(0,a.default)(t,"__esModule",{value:!0});var l=n(17766),s=n(76500),d=n(31560),c=n(46e3),f=function(e,t){var n=new s.MutableTile;return n.id=t,n.attributes=e.attributes,n.imageData=e.pixels,n.name=e.name,n},h=function(e,t,n){var r,a,u,c,f=new s.MutableZone;return f.id=t,f.name=e.name||"",f.planet=l.Zone.Planet.fromNumber(e.planet),f.size=new d.Size(e.width,e.height),f.type=l.Zone.Type.fromNumber(e.zoneType),f.tileIDs=(0,i.default)(r=e.tileIDs).call(r),f.hotspots=(0,o.default)(a=e.hotspots).call(a,(function(e,t){return function(e,t,n){var r=new l.Hotspot;switch(r.id=t,r.x=e.x,r.y=e.y,r.enabled=!!e.enabled,r.arg=e.argument,r.type=l.Hotspot.Type.fromNumber(e.type),r.type){case l.Hotspot.Type.DropQuestItem:case l.Hotspot.Type.SpawnLocation:case l.Hotspot.Type.DropUniqueWeapon:case l.Hotspot.Type.DropMap:r.enabled=!1;break;case l.Hotspot.Type.VehicleTo:case l.Hotspot.Type.VehicleBack:case l.Hotspot.Type.DoorIn:case l.Hotspot.Type.Lock:case l.Hotspot.Type.ShipToPlanet:case l.Hotspot.Type.ShipFromPlanet:case l.Hotspot.Type.DropItem:case l.Hotspot.Type.NPC:case l.Hotspot.Type.DropWeapon:r.enabled=!0;break;default:r.arg=-1,r.enabled=!0}return r}(e,t)})),f.monsters=(0,o.default)(u=e.monsters).call(u,(function(e,t){return function(e,t,n){for(var r=e.waypoints,a=[],i=!1,o=0;o<8;o+=2){var u=r[o],c=r[o+1];i=i||-1!==u||-1!==c,a.push(new d.Point(u,c))}return new s.MutableMonster({_id:t,face:n.characters[e.character],_position:new d.Point(e.x,e.y,l.Zone.Layer.Object),_loot:e.loot,_dropsLoot:e.dropsLoot,_waypoints:a})}(e,t,n)})),f.goalItems=e.goalItemIDs.mapArray((function(e){return n.tiles[e]})),f.requiredItems=e.requiredItemIDs.mapArray((function(e){return n.tiles[e]})),f.providedItems=e.providedItemIDs.mapArray((function(e){return n.tiles[e]})),f.npcs=e.npcIDs.mapArray((function(e){return n.tiles[e]})),f.izaxUnknown=e.unknown,f.izx4Unknown=e.unknown,f.actions=(0,o.default)(c=e.actions).call(c,(function(e,t){return function(e,t,n,r){var a,o,u=new s.MutableAction;return u.id=t,u.name=e.name||"",u.conditions=(0,i.default)(a=e.conditions).call(a),u.instructions=(0,i.default)(o=e.instructions).call(o),u.zone=n,u}(e,t,f)})),f.tileStore=n.tiles,f};t.default=function(e,t){var n,r,a,d,p,v;e._rawInput=t,e._type=t.type,e._version=t.version,e._setup=t.setup,e._sounds=(0,o.default)(n=t.sounds).call(n,(function(e,t){return new l.Sound(t,e)})),e._tiles=(0,o.default)(r=t.tiles).call(r,f),e._characters=(0,o.default)(a=t.characters).call(a,(function(t,n){return function(e,t,n){var r=new s.MutableChar;return r.id=t,r.name=e.name,r.frames=[new l.Char.Frame(e.frame1.mapArray((function(e){return n.tiles[e]||null}))),new l.Char.Frame(e.frame2.mapArray((function(e){return n.tiles[e]||null}))),new l.Char.Frame(e.frame3.mapArray((function(e){return n.tiles[e]||null})))],r.type=l.Char.Type.fromNumber(e.type),r.movementType=l.Char.MovementType.fromNumber(e.movementType),r.garbage1=e.probablyGarbage1,r.garbage2=e.probablyGarbage2,r.damage=e.damage,r.health=e.health,r.reference=e.reference,r}(t,n,e)})),e._puzzles=(0,o.default)(d=t.puzzles).call(d,(function(t,n){return function(e,t,n){var r,a=new s.MutablePuzzle;return a.id=t,a.name=e.name||"",a.type=-1===e.type?l.Puzzle.Type.None:l.Puzzle.Type.fromNumber(e.type),a.unknown1=e.unknown1,a.unknown2=e.unknown2,a.unknown3=e.unknown3,a.strings=(0,i.default)(r=e.texts).call(r),a.item1=n.tiles[e.item1]||null,a.item2=n.tiles[e.item2]||null,a.type!==l.Puzzle.Type.End&&a.type!==l.Puzzle.Type.Disabled&&(a.item2=null),n.type!==c.Yoda&&n.type!==c.YodaDemo||t!==c.Yoda.goalIDs.RESCUE_YODA&&t!==c.Yoda.goalIDs.CAR||(a.type=l.Puzzle.Type.Disabled),a}(t,n,e)})),e._zones=(0,o.default)(p=t.zones).call(p,(function(t,n){return h(t,n,e)})),(0,u.default)(v=e.zones).call(v,(function(e,t,n){return e.zoneStore=n}))}},30961:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583)),o=r(n(68748)),u=r(n(42601));(0,o.default)(t,"__esModule",{value:!0});var l=n(93321),s=function(){function e(t){(0,a.default)(this,e),l.default(this,t)}return(0,i.default)(e,[{key:"copy",value:function(){return new e(this._rawInput)}},{key:"resetAfterWorldGeneration",value:function(){var e,t=this;(0,u.default)(e=this._zones).call(e,(function(e,n){var r,a=t._rawInput.zones[n];(0,u.default)(r=e.hotspots).call(r,(function(e,t){var n=a.hotspots[t];e.enabled=n.enabled,e.arg=n.argument}))}))}},{key:"type",get:function(){return this._type}},{key:"version",get:function(){return this._version}},{key:"sounds",get:function(){return this._sounds}},{key:"tiles",get:function(){return this._tiles}},{key:"puzzles",get:function(){return this._puzzles}},{key:"zones",get:function(){return this._zones}},{key:"characters",get:function(){return this._characters}},{key:"setupImageData",get:function(){return this._setup}}]),e}();t.default=s},81191:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(30961);t.default=r.default},82127:(e,t,n)=>{var r;(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),function(e){e[e.Stopped=0]="Stopped",e[e.Running=1]="Running",e[e.Won=2]="Won",e[e.Lost=3]="Lost"}(r||(r={})),t.default=r},45623:(e,t,n)=>{var r=n(38468),a=r(n(94433)),i=r(n(40361)),o=r(n(7583)),u=r(n(68748)),l=r(n(67093));(0,u.default)(t,"__esModule",{value:!0});var s,d=n(17766),c=n(23754),f=n(46e3),h=n(31560);!function(e){e[e.NorthWest=0]="NorthWest",e[e.Hut=1]="Hut",e[e.SouthEast=2]="SouthEast",e[e.SouthWest=3]="SouthWest",e[e.None=4]="None"}(s||(s={}));var p=function(){function e(t){var n=this;(0,i.default)(this,e),this._world=null,this.determineYodaSpawnLocation=function(e){var t=h.randmod(4);return e===n.assets.get(d.Puzzle,f.Yoda.goalIDs.IMPERIAL_BATTLE_CODE)?s.SouthWest:e===n.assets.get(d.Puzzle,f.Yoda.goalIDs.RESCUE_YODA)?s.None:t},this.assets=t}return(0,o.default)(e,[{key:"world",get:function(){return console.assert(null!==this._world),this._world}},{key:"generate",value:function(e){var t=this.assets,n=new c.default(this.assets);n.at(4,4).zone=t.get(d.Zone,f.Yoda.zoneIDs.DagobahNorthWest),n.at(4,4).zoneType=d.Zone.Type.Find,n.at(5,4).zone=t.get(d.Zone,f.Yoda.zoneIDs.DagobahNorthEast),n.at(5,4).zoneType=d.Zone.Type.Find,n.at(4,5).zone=t.get(d.Zone,f.Yoda.zoneIDs.DagobahSouthWest),n.at(4,5).zoneType=d.Zone.Type.Find,n.at(5,5).zone=t.get(d.Zone,f.Yoda.zoneIDs.DagobahSouthEast),n.at(5,5).zoneType=d.Zone.Type.Town;var r=e.world;n.at(4,4).zoneType=r.at(4,4).zoneType,n.at(5,4).zoneType=r.at(5,4).zoneType,n.at(4,5).zoneType=r.at(4,5).zoneType,n.at(5,5).zoneType=r.at(5,5).zoneType;var a=this.determineYodaSpawnLocation(e.goalPuzzle);switch(a){case s.NorthWest:case s.SouthEast:case s.SouthWest:this.setupOutdoorSpawn(a,e.initialItem,n);break;case s.Hut:this._setupIndoorSpawn(n,e.initialItem,f.Yoda.tileIDs.Yoda);break;case s.None:this._setupIndoorSpawn(n,e.initialItem,f.Yoda.tileIDs.YodasSeat)}this._world=n}},{key:"setupOutdoorSpawn",value:function(e,t,n){var r,i=f.Yoda.tileIDs.Yoda,o=(0,a.default)([[4,4],[-1,-1],[5,5],[4,5]][e],2),u=o[0],s=o[1],c=n.at(u,s);c.zoneType=d.Zone.Type.Use,c.npc=this.assets.get(d.Tile,i),c.findItem=t;var p=this.assets.get(d.Zone,c.zone.id);console.assert(!!(0,l.default)(r=p.npcs).call(r,(function(e){return e.id===i})));var v=p.hotspots.withType(d.Hotspot.Type.SpawnLocation);console.assert(1===v.length);var y=v[h.randmod(v.length)];y?(y.arg=i,y.enabled=!0):console.warn("Could not find npc hotspot on daboah hut!")}},{key:"_setupIndoorSpawn",value:function(e,t,n){var r,a,i=f.Yoda.zoneIDs.YodasHut,o=this.assets.get(d.Zone,i),u=e.at(5,4);u.zoneType=d.Zone.Type.Use,u.npc=this.assets.get(d.Tile,n),u.findItem=t,a=n===f.Yoda.tileIDs.Yoda?function(e){var t=e.x,n=e.y;return 3===t&&3===n}:function(e){var t=e.x,n=e.y;return 3===t&&2===n};var s=(0,l.default)(r=o.hotspots).call(r,a);s?(s.arg=n,s.enabled=!0):console.warn("Could not find npc hotspot in yoda's hut!")}}]),e}();t.default=p},60648:(e,t,n)=>{var r,a=n(38468),i=a(n(68748)),o=a(n(47053));(0,i.default)(t,"__esModule",{value:!0});var u=(0,o.default)(r=[5,5,5,5,5,5,5,5,5,5]).call(r,[5,4,4,4,4,4,4,4,4,5],[5,4,3,3,3,3,3,3,4,5],[5,4,3,2,2,2,2,3,4,5],[5,4,3,2,1,1,2,3,4,5],[5,4,3,2,1,1,2,3,4,5],[5,4,3,2,2,2,2,3,4,5],[5,4,3,3,3,3,3,3,4,5],[5,4,4,4,4,4,4,4,4,5],[5,5,5,5,5,5,5,5,5,5]);t.default=function(e,t){return u[e+10*t]}},78256:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.WorldGenerationError=t.DagobahGenerator=t.WorldSize=t.WorldGenerator=void 0;var r=n(45623);t.DagobahGenerator=r.default;var a=n(70581);t.WorldGenerationError=a.default;var i=n(391);t.WorldGenerator=i.default;var o=n(80361);t.WorldSize=o.default},23229:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(31560);!function(e){e[e.East=3]="East",e[e.North=1]="North",e[e.South=2]="South",e[e.West=0]="West"}(o||(o={}));var l=function(){function e(t){(0,a.default)(this,e),this.typeMap=t}return(0,i.default)(e,[{key:"placeIslands",value:function(e){for(var t=0;t<e;t++)this._placeIsland()}},{key:"at",value:function(e,t){var n=e.x+10*e.y;if(void 0===t)return this.typeMap[n];this.typeMap[n]=t}},{key:"_placeIsland",value:function(){for(var e=0;e<=200;e++)switch(u.rand()%4){case 0:if(this._placeIslandWest())return;break;case 1:if(this._placeIslandNorth())return;break;case 2:if(this._placeIslandSouth())return;break;case 3:if(this._placeIslandEast())return}}},{key:"_findRun",value:function(e,t){var n=this,r=0,a=0,i=0,o=0;return e.iterate((function(e){var l=n.at(e),s=n.at(u.Point.add(e,t));12!==l||12!==s&&7!==s?(a<i&&(a=i,r=o-i),i=0):i++,o++})),a<i&&(a=i,r=10-i),{start:r,length:a}}},{key:"_buildIsland",value:function(e){var t=this;e.iterate((function(e){return t.at(e,6)}));var n=u.rand()%2?e.from:e.to;this.at(n,10)}},{key:"_verifyShortRun",value:function(e){if(e.length<3)return!1;if(3===e.length){if(0<e.start&&e.start<7)return!1;0===e.start&&(e.length=2),7===e.start&&(e.length=2)}else e.length>=4&&(e.length=Math.min(e.length-2,4));return e.start>0&&e.start+e.length<10&&e.start++,!0}},{key:"_verifyLongRun",value:function(e){return!(e.length<4)&&(e.length=Math.min(e.length-2,4),e.start>0&&e.start+e.length<10&&e.start++,!0)}},{key:"_placeIslandWest",value:function(){var e=new u.VerticalPointRange(0,9,0),t=this._findRun(e,new u.Point(1,0));return!!this._verifyShortRun(t)&&(e=new u.VerticalPointRange(t.start,t.start+t.length-1,0),this._buildIsland(e),!0)}},{key:"_placeIslandNorth",value:function(){var e=new u.HorizontalPointRange(0,9,0),t=this._findRun(e,new u.Point(0,1));return!!this._verifyShortRun(t)&&(e=new u.HorizontalPointRange(t.start,t.start+t.length-1,0),this._buildIsland(e),!0)}},{key:"_placeIslandSouth",value:function(){var e=new u.HorizontalPointRange(0,9,9),t=this._findRun(e,new u.Point(0,-1));return!!this._verifyLongRun(t)&&(e=new u.HorizontalPointRange(t.start,t.start+t.length-1,9),this._buildIsland(e),1)}},{key:"_placeIslandEast",value:function(){var e=new u.VerticalPointRange(0,9,9),t=this._findRun(e,new u.Point(-1,0));return!!this._verifyLongRun(t)&&(e=new u.VerticalPointRange(t.start,t.start+t.length-1,9),this._buildIsland(e),1)}}]),e}();t.default=l},91547:(e,t,n)=>{var r=n(38468),a=r(n(61822)),i=r(n(40361)),o=r(n(7583)),u=r(n(68748)),l=r(n(16825)),s=r(n(69159));(0,u.default)(t,"__esModule",{value:!0});var d,c=n(31560),f=n(60648),h=n(23229),p=n(80361),v=n(17725),y=10,m=10;!function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Up=2]="Up",e[e.Down=3]="Down"}(d||(d={}));var g=function(){function e(){(0,i.default)(this,e),this.min=new c.Point(0,0),this.alternate=new c.Point(0,0),this.variance=0,this.probability=0,this.threshold=0,this.travelThreshold=0,this.lastType=0,this.remainingSectors=0,this._typeMap=null,this.placedSectors=0,this.blockades=0,this.travels=0,this.placedTravels=0,this.puzzles=0,this._orderMap=null}return(0,o.default)(e,[{key:"blockadeTypeFor",value:function(e,t){return 0===e&&1===t?1:0===e&&-1===t?2:-1===e&&0===t?0:1===e&&0===t?3:null}},{key:"_determineCounts",value:function(){this.travels=c.rand()%3,this.blockades=c.rand()%4,this.placedSectors=0,this.placedTravels=0}},{key:"getIslandOrientation",value:function(e,t,n){return 6===n.get(e-1,t)?0:6===n.get(e+1,t)?1:6===n.get(e,t-1)?2:6===n.get(e,t+1)?3:0}},{key:"determineRanges",value:function(e){switch(e){case p.default.Small:return[new c.Range(5,8),new c.Range(4,6),new c.Range(1,1),new c.Range(1,1)];case p.default.Medium:return[new c.Range(5,9),new c.Range(5,9),new c.Range(4,8),new c.Range(3,8)];case p.default.Large:return[new c.Range(6,12),new c.Range(6,12),new c.Range(6,11),new c.Range(4,11)]}}},{key:"placeBlockade",value:function(e,t,n,r){this.typeMap.set(e,t,this.blockadeTypeFor(n,r)),this.typeMap.set(e-r,t-n,7),this.typeMap.set(e+r,t+n,7),this.typeMap.set(e-n,t-r,4),this.typeMap.set(e-r-n,t-r-n,7),this.typeMap.set(e+r-n,t-r+n,7),this.remainingSectors-=1,this.placedSectors+=2,this.blockades-=1}},{key:"extendBlockade",value:function(e,t,n,r){this.typeMap.set(e,t,4),this.typeMap.set(e-r,t-n,7),this.typeMap.set(e+r,t+n,7),this.placedSectors+=1,this.remainingSectors-=1}},{key:"isFree",value:function(e){return 12===e||7===e}},{key:"isLessThanCandidate",value:function(e){switch(e){case 12:case 5:case 11:case 10:case 6:case 9:return!0;default:return!1}}},{key:"neighbors",value:function(e,t,n){return[e.get(t-1,n),e.get(t+1,n),e.get(t,n-1),e.get(t,n+1)]}},{key:"isBlockade",value:function(e){return 3===e||0===e||1===e||2===e}},{key:"handleNeighbor",value:function(e,t,n,r,a){var i,o=e+y*t,u=this.typeMap.get(e+r,t+a),s=this.typeMap.get(e+a,t+r),d=this.typeMap.get(e-a,t-r);if(this.isFree(u))return!1;this.lastType=this.typeMap.get(e+r,t+a);var h=this.blockadeTypeFor(r,a),p=this.isFree(s)&&this.isFree(d);if((p&&4===u||u===h)&&this.extendBlockade(e,t,r,a),4===u)return!0;if(this.isBlockade(u))return!0;var v=this.blockades>0&&c.rand()%this.probability<this.threshold,m=f.default(e+r,t+a)<n,g=(0,l.default)(i=this.neighbors(this.typeMap,e,t)).call(i,this.isLessThanCandidate);return v&&p&&m?(this.placeBlockade(e,t,r,a),!0):!g||(!(!v||a&&!p||r&&m)||(this.typeMap[o]=5,this.placedSectors+=1,this.remainingSectors-=1,!0))}},{key:"_initializeTypeMap",value:function(e,t){this._typeMap=new Uint16Array(100);for(var n=0;n<100;n++)this.typeMap[n]=12;this.typeMap[44]=5,this.typeMap[45]=5,this.typeMap[54]=5,this.typeMap[55]=5,this.typeMap[e+y*t]=9}},{key:"_initializeOrderMap",value:function(){this._orderMap=new Int16Array(100);for(var e=0,t=this.orderMap.length;e<t;e++)this.orderMap[e]=-1}},{key:"generate",value:function(e,t){e>=0&&c.srand(e),this.travels=0,this.placedTravels=0,this.blockades=0,this.puzzles=0,this.placedSectors=0,this._determineCounts(),c.rand();var n=c.randmod(2)+4,r=c.randmod(2)+4;this._initializeTypeMap(n,r),this._initializeOrderMap();var a=this.determineRanges(t),i=this.travels;return i+=this.blockades,i+=a[0].randomElement(),this._determinePuzzleLocations(2,Math.min(i,12)),this._determinePuzzleLocations(3,a[1].randomElement()),this._determinePuzzleLocations(4,a[2].randomElement()),this._determineAdditionalPuzzleLocations(a[3].randomElement()),new h.default(this.typeMap).placeIslands(this.placedTravels),this._placeIntermediateWorldThing(),this.typeMap}},{key:"findPuzzleLastPuzzle",value:function(){for(var e=0;e<m;e++)for(var t=0;t<y;t++)if(this.orderMap.get(t,e)===this.placedSectors-1)return new c.Point(t,e);return null}},{key:"_choosePuzzlesBehindBlockades",value:function(){for(var e,t,n={width:y,height:m},r=0;r<m;r++)for(var a=0;a<y;a++){switch(this.typeMap.get(a,r)){case 3:e=new c.Point(-1,0),t=new c.Point(-2,0);break;case 0:e=new c.Point(1,0),t=new c.Point(2,0);break;case 1:e=new c.Point(0,-1),t=new c.Point(0,-2);break;case 2:e=new c.Point(0,1),t=new c.Point(0,2);break;default:continue}var i=new c.Point(a,r),o=c.Point.add(i,e),u=c.Point.add(i,t);4===this.typeMap.get(o.x,o.y)&&(i=u.isInBounds(n)&&4===this.typeMap.get(u.x,u.y)?u:o,this.typeMap.set(i.x,i.y,8),this.orderMap.set(i.x,i.y,this.placedSectors),this.placedSectors+=1)}}},{key:"_choosePuzzlesOnIslands",value:function(){for(var e,t,n,r=this,a={width:y,height:m},i=function(e,t){var i=c.Point.add(e,t.step);i.isInBounds(a)&&6===r.typeMap.get(i.x,i.y)||(t.stop=!0,n=e)},o=0;o<m;o++)for(var u=0;u<y;u++)if(10===this.typeMap.get(u,o)){switch(this.getIslandOrientation(u,o,this.typeMap)){case 0:e=new c.HorizontalPointRange(u,0,o),t=-1;break;case 2:e=new c.VerticalPointRange(o,0,u),t=-1;break;case 1:e=new c.HorizontalPointRange(u,9,o),t=1;break;case 3:e=new c.VerticalPointRange(o,9,u),t=1}n=e.from,e.iterate(i,t),this.typeMap.set(n.x,n.y,8),this.orderMap.set(n.x,n.y,this.placedSectors),this.placedSectors+=1}}},{key:"_chooseAdditionalPuzzles",value:function(e){for(var t=0,n=5e3,r=0;r<=200;r++){var a=void 0;if(0===--n)break;r>200&&(t=1),this.placedSectors>=e&&(t=1);var i=c.rand()%10;if(a=r>=50||0===i||9===i?c.rand()%10:(1&c.rand())<1?9:0,this.placedSectors>=e)break;var o=f.default(i,a);if(o>=3||r>=150){var u=this.typeMap.get(i,a);if(5!==u&&4!==u||0!==i&&8===this.typeMap.get(i-1,a)||9!==i&&8===this.typeMap.get(i+1,a)||0!==a&&8===this.typeMap.get(i,a-1)||9!==a&&8===this.typeMap.get(i,a+1)||(this.typeMap.set(i,a,8),this.orderMap.set(i,a,this.placedSectors),this.placedSectors+=1),this.placedSectors>=e)break}if(o<3&&r<150&&r--,t)break}}},{key:"_mapCountStuff",value:function(){this.travels=0,this.blockades=0,this.puzzles=0;for(var e=0;e<100;e++)switch(this.typeMap[e]){case 5:case 6:case 4:this.puzzles+=1;break;case 1:case 0:case 2:case 3:this.blockades+=1;break;case 11:this.travels+=1}}},{key:"_makeSureLastPuzzleIsNotTooCloseToCenter",value:function(){var e=f.default,t=this.findPuzzleLastPuzzle();if(e(t.x,t.y)<3)for(var n=0;n<m;n++)for(var r=0;r<y;r++)if(this.orderMap.get(r,n)>=0&&e(r,n)>=3&&(r!==t.x||n!==t.y))return this.orderMap.set(t.x,t.y,this.orderMap.get(r,n)),void this.orderMap.set(r,n,this.placedSectors-1)}},{key:"_placeIntermediateWorldThing",value:function(){this.placedSectors=0,this._mapCountStuff();var e=this.puzzles,t=this.travels,n=this.blockades,r=Math.floor(e/4)+c.rand()%(Math.floor(e/5)+1)-n-t-2;r<4&&(r=4),this.placedSectors=0,this._choosePuzzlesBehindBlockades(),this._choosePuzzlesOnIslands(),this._chooseAdditionalPuzzles(r),this._makeSureLastPuzzleIsNotTooCloseToCenter()}},{key:"_tryPlacingTravel",value:function(e,t,n){5===this.typeMap[e]&&(this.travels<=this.placedTravels||(7&c.rand())>=this.travelThreshold||11!==n&&(t<=2||(this.typeMap[e]=11,this.placedTravels+=1)))}},{key:"_determinePuzzleLocations",value:function(e,t){switch(this.remainingSectors=t,e){case 2:this.min=new c.Point(3,3),this.alternate=new c.Point(6,6),this.variance=4,this.probability=9,this.threshold=2,this.travelThreshold=1;break;case 3:this.min=new c.Point(2,2),this.alternate=new c.Point(7,7),this.variance=6,this.probability=4,this.travelThreshold=3,this.threshold=2;break;case 4:this.min=new c.Point(1,1),this.alternate=new c.Point(8,8),this.variance=8,this.threshold=1,this.probability=5,this.travelThreshold=6;break;default:return}for(var n=0;n<=144&&this.remainingSectors>0;n++){var r=void 0,a=void 0;c.rand()%2?(r=c.rand()%2?this.min.x:this.alternate.x,a=c.rand()%this.variance+this.min.y):(a=c.rand()%2?this.min.y:this.alternate.y,r=c.rand()%this.variance+this.min.x);var i=r+y*a;12===this.typeMap[i]&&(this.handleNeighbor(r,a,e,-1,0)||this.handleNeighbor(r,a,e,1,0)||this.handleNeighbor(r,a,e,0,-1)||this.handleNeighbor(r,a,e,0,1),this._tryPlacingTravel(i,e,this.lastType))}}},{key:"_determineAdditionalPuzzleLocations",value:function(e){for(var t=0;t<=400&&e>0;t++){var n=void 0,r=void 0,a=c.rand()%2;a?(n=c.rand()%2?0:9,r=c.rand()%m):(r=c.rand()%2?0:9,n=c.rand()%y);var i=n+y*r;if(12===this.typeMap[i]){var o=this.typeMap.get(n-1,r),u=this.typeMap.get(n+1,r),l=this.typeMap.get(n,r-1),s=this.typeMap.get(n,r+1),d=0,f=0;if(a&&9===n&&7!==o?(f=1,d=0):a&&0===n&&7!==u?(f=-1,d=0):a||9!==r||7===l?a||0!==r||7===s||(f=0,d=-1):(f=0,d=1),0!==f||0!==d){var h=this.typeMap.get(n-f,r-d);if(12!==h){switch(h){case 5:case 11:case 9:this.typeMap[i]=5;break;case 4:this.typeMap[i]=4,f?d||(r>0&&(this.typeMap[i-y]=7),r<9&&(this.typeMap[i+y]=7)):(n>0&&(this.typeMap[i-1]=7),n<9&&(this.typeMap[i+1]=7));continue;case 0:if(1!==f)continue;if(12<s&&s<=1)continue;if(12<l&&l<=1)continue;this.typeMap[i]=4,r>0&&(this.typeMap[i-y]=7),r<9&&(this.typeMap[i+y]=7);break;case 3:if(-1!==f)continue;if(12<l&&l<=1)continue;if(12<s&&s<=1)continue;this.typeMap[i]=4,r>0&&(this.typeMap[i-y]=7),r<9&&(this.typeMap[i+y]=7);break;case 1:if(-1!==d)continue;if(12<o&&o<=1)continue;if(12<u&&u<=1)continue;this.typeMap[i]=4,n>0&&(this.typeMap[i-1]=7),n<9&&(this.typeMap[i+1]=7);break;case 2:if(1!==d)continue;if(12<o&&o<=1)continue;if(12<u&&u<=1)continue;this.typeMap[i]=4,n>0&&(this.typeMap[i-1]=7),n<9&&(this.typeMap[i+1]=7);break;default:continue}this.placedSectors+=1,--e}}}}}},{key:"puzzleCount",get:function(){return v.max.apply(v,(0,a.default)((0,s.default)(this.orderMap)))+1}},{key:"orderMap",get:function(){return this._orderMap}},{key:"typeMap",get:function(){return this._typeMap}}]),e}();t.default=g},56978:(e,t,n)=>{var r=n(38468),a=r(n(40361));(0,r(n(68748)).default)(t,"__esModule",{value:!0});t.default=function e(t,n){(0,a.default)(this,e),this.item=t,this.distance=n}},70581:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(80655)),u=a(n(20497)),l=a(n(75244)),s=a(n(46386));function d(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0});var c=function(e){(0,o.default)(n,e);var t=d(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments)).history=[],e.iterations=0,e}return n}((0,s.default)(Error));t.default=c},391:(e,t,n)=>{var r=n(92915),a=n(69159),i=n(67986),o=n(13037),u=n(29689),l=n(38468),s=l(n(40361)),d=l(n(7583)),c=l(n(68748)),f=l(n(23982)),h=l(n(67093)),p=l(n(7478)),v=l(n(47053)),y=l(n(92915)),m=l(n(68190)),g=l(n(41870)),_=l(n(31920)),w=l(n(42601));function k(e,t){var n=void 0!==i&&o(e)||e["@@iterator"];if(!n){if(u(e)||(n=function(e,t){var n;if(!e)return;if("string"==typeof e)return b(e,t);var i=r(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return a(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return b(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var l=0,s=function(){};return{s,n:function(){return l>=e.length?{done:!0}:{done:!1,value:e[l++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var d,c=!0,f=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){f=!0,d=e},f:function(){try{c||null==n.return||n.return()}finally{if(f)throw d}}}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}(0,c.default)(t,"__esModule",{value:!0});var S=n(31560),I=n(17766),x=n(80361),T=n(17725),M=n(64230),E=n(92540),C=n(60648),A=n(91547),D=n(56978),z=n(23754),P=n(70581),R=n(83297),L=function(){function e(t,n,r,a){(0,s.default)(this,e),this.world=null,this._seed=0,this.usedZones=[],this.mapGenerator=null,this.additionalRequiredItem=null,this.additionalFindItem=null,this.providedItemQuests=[],this.usedPuzzles=[],this.puzzleStrain1=[],this.puzzleStrain2=[],this.requiredItemQuests=[],this.currentPuzzleIndex=-1,this.requiredItem=null,this.findItem=null,this.npc=null,this.somethingWithTeleporters=-1,this.puzzlesCanBeReused=0,this.usedAlternateStrain=!1,this._size=t,this._planet=n,this._assets=r,this._variant=a}return(0,d.default)(e,[{key:"generate",value:function(e){var t=this;this._seed=e,S.srand(this._seed),this._zones=this._assets.getFiltered(I.Zone,(function(e){return e.planet===t._planet})),this._zonesByType=new f.default;var n=this.mapGenerator=new A.default;n.generate(-1,this._size),this.world=new z.default(this._assets);for(var r=0;r<100;r++)this.world.at(r).puzzleIndex=n.orderMap[r];var a=n.puzzleCount,i=T.floor(a%2==1?(a+1)/2:a/2+1),o=T.floor(a%2==1?(a+1)/2:a/2);this.puzzleStrain1=Array.Repeat(null,i+1),this.puzzleStrain2=Array.Repeat(null,o+1),this.currentPuzzleIndex=-1,this.usedPuzzles=[],this.providedItemQuests=[],this.requiredItemQuests=[];var u=this.getUnusedPuzzleRandomly(null,I.Zone.Type.PlaceholderForEndPuzzle);this.errorWhen(!u,"Could not find a suitable goal puzzle"),this.usedPuzzles.push(u),this.puzzleStrain1[i]=u,this.puzzleStrain2[o]=u,this.determineTransportZones(),this.determineGoalZone(a,o,n.orderMap),this.determineQuestZones(a,n.orderMap),this.placePuzzlesZones(o-1,n.orderMap),this.determineBlockadeAndTownZones(n.typeMap),this.addProvidedItemQuest(this.lookupTileById(this._variant.weaponTileId),2),this.addProvidedItemQuest(this.lookupTileById(this._variant.mapTileId),1),this.determineFindZones(n.typeMap),this.determineTeleporters(n.typeMap),S.rand(),this.writePlanetValues()}},{key:"determineTransportZones",value:function(){for(var e=this,t=this.mapGenerator.typeMap,n=function(n){var r=n.x+10*n.y;return 10===t[r]&&!e.world.at(r).zone},r=0;r<10;r++)for(var a=0;a<10;a++){var i;if(11===t[a+10*r]){this.resetState();var o=C.default(a,r),u=this.getUnusedZoneRandomly(I.Zone.Type.TravelStart,-1,-1,null,null,o,!0);this.errorWhen(!u,"Could not determine zone for travel start"),this.placeZone(a,r,u,I.Zone.Type.TravelStart,{requiredItem:this.requiredItem});var l=u.hotspots.withType(I.Hotspot.Type.VehicleTo).first(),s=this.lookupZoneById(l?l.arg:-1);this.errorWhen(!u,"Could not determine zone for travel end");var d=null,c=null;c||(d=new S.VerticalPointRange(0,9,0),c=(0,h.default)(d).call(d,n)),c||(d=new S.HorizontalPointRange(0,9,0),c=(0,h.default)(d).call(d,n)),c||(d=new S.VerticalPointRange(0,9,9),c=(0,h.default)(d).call(d,n)),c||(d=new S.HorizontalPointRange(0,9,9),c=(0,h.default)(d).call(d,n)),this.errorWhen(!c,"Could not determine location for travel target"),this.errorWhen((0,p.default)(i=this.usedZones).call(i,s),"Zone is already in use for a different travel sector"),this.placeZone(c.x,c.y,s,I.Zone.Type.TravelEnd,{requiredItem:this.requiredItem})}}}},{key:"loopWorld",value:function(e,t){for(var n=0;n<10;n++)for(var r=0;r<10;r++)t(e[r+10*n],r,n,r+10*n,e)}},{key:"zoneTypeForSectorType",value:function(e){switch(e){case 9:return I.Zone.Type.Town;case 0:return I.Zone.Type.BlockadeEast;case 3:return I.Zone.Type.BlockadeWest;case 1:return I.Zone.Type.BlockadeNorth;case 2:return I.Zone.Type.BlockadeSouth;default:return I.Zone.Type.Empty}}},{key:"determineBlockadeAndTownZones",value:function(e){var t=this;this.loopWorld(e,(function(e,n,r){var a=t.zoneTypeForSectorType(e);if(a.isBlockadeType()||a===I.Zone.Type.Town){t.resetState();var i=C.default(n,r),o=t.getUnusedZoneRandomly(a,-1,-1,null,null,i,!1);o||(o=t.getUnusedZoneRandomly(I.Zone.Type.Empty,-1,-1,null,null,i,!1)),t.errorWhen(!o,"Could not find an unused empty zone");var u={};a!==I.Zone.Type.Town&&(u.requiredItem=t.requiredItem),t.placeZone(n,r,o,o.type,u)}}))}},{key:"findPositionOfPuzzle",value:function(e,t){for(var n=0;n<10;n++)for(var r=0;r<10;r++)if(t[r+10*n]===e)return new S.Point(r,n);return null}},{key:"placePuzzlesZones",value:function(e,t){for(var n=e;n>0;n--){this.resetState();var r=this.findPositionOfPuzzle(n-1,t),a=C.default(r.x,r.y),i=this.puzzleStrain2[n].item1,o=S.rand()%2?I.Zone.Type.Use:I.Zone.Type.Trade,u=this.getUnusedZoneRandomly(o,n-1,-1,i,null,a,!1);u||(o=o===I.Zone.Type.Use?I.Zone.Type.Trade:I.Zone.Type.Use,u=this.getUnusedZoneRandomly(o,n-1,-1,i,null,a,!1)),this.errorWhen(!u,"Unable to find suitable puzzle zone"),this.placeZone(r.x,r.y,u,u.type,{findItem:this.findItem,puzzleIndex:this.currentPuzzleIndex,requiredItem:this.requiredItem,npc:this.npc}),this.currentPuzzleIndex=-1}}},{key:"determineGoalZone",value:function(e,t,n){this.resetState();var r=this.puzzleStrain1[this.puzzleStrain1.length-1],a=this.findPositionOfPuzzle(e-1,n),i=C.default(a.x,a.y),o=this.getUnusedZoneRandomly(I.Zone.Type.Goal,this.puzzleStrain1.length-2,t-1,r.item1,r.item2?r.item2:null,i,!0);this.errorWhen(!o,"Unable to find suitable goal zone."),this.placeZone(a.x,a.y,o,I.Zone.Type.Goal,{findItem:this.findItem,puzzleIndex:this.currentPuzzleIndex,requiredItem:this.requiredItem,npc:null,additionalRequiredItem:this.usedPuzzles[2].item1,additionalGainItem:this.additionalFindItem})}},{key:"resetState",value:function(){this.requiredItem=null,this.findItem=null,this.npc=null,this.currentPuzzleIndex=-1,this.additionalRequiredItem=null,this.additionalFindItem=null}},{key:"determineQuestZones",value:function(e,t){for(var n=e-1,r=this.puzzleStrain1.length-2;r>0;r--){this.resetState();var a=this.puzzleStrain1[r],i=this.findPositionOfPuzzle(n-1,t);this.errorWhen(null===i,"Could not find previous puzzle location!");var o=C.default(i.x,i.y),u=a.item1,l=null,s=1e4;do{var d;s--,this.errorWhen(0===s,"Maximum number of iterations exceeded.");var c=S.rand()%2?I.Zone.Type.Trade:I.Zone.Type.Use;if((l=this.getUnusedZoneRandomly(c,r-1,-1,u,null,o,!0))||(c=c===I.Zone.Type.Use?I.Zone.Type.Trade:I.Zone.Type.Use,l=this.getUnusedZoneRandomly(c,r-1,-1,u,null,o,!0)),this.errorWhen(!l,(0,v.default)(d="Unable to find suitable zone for puzzle at ".concat(i.x,"x")).call(d,i.y)),this.placeZone(i.x,i.y,l,l.type,{findItem:this.findItem,puzzleIndex:this.currentPuzzleIndex,requiredItem:this.requiredItem,npc:this.npc,additionalRequiredItem:this.additionalRequiredItem}),1===r){this.addProvidedItemQuest(this.requiredItem,o);break}}while(!l);n--}}},{key:"getUnusedPuzzleRandomly",value:function(e,t){var n=this,r=this.getPuzzleCandidates(t).shuffle(),a=t.toPuzzleType(),i=function(t){return t.item1===e};return t===I.Zone.Type.PlaceholderForEndPuzzle&&(i=S.constantly(!0)),(0,h.default)(r).call(r,M.and((function(e){return e.type===a}),M.not((function(e){return n.hasPuzzleBeenPlaced(e)})),i))}},{key:"getUnusedZoneRandomly",value:function(e,t,n,r,a,i,o){var u,l=this;this.usedAlternateStrain=o;var s=this.getZonesForType(e),d=(0,y.default)(s).call(s).shuffle();return(0,h.default)(u=(0,m.default)(d).call(d,(function(t){var n;return!(0,p.default)(n=l.usedZones).call(n,t)||e===I.Zone.Type.Goal&&l.puzzlesCanBeReused>0}))).call(u,(function(e){return l.getUnusedZone(e,t,n,r,a,i,o)}))}},{key:"getZonesForType",value:function(e){var t,n=this._zonesByType.get(e);if(n)return n;var r=function(t){return t.type===e};return e!==I.Zone.Type.Find&&e!==I.Zone.Type.FindUniqueWeapon||(r=function(e){return e.type===I.Zone.Type.Find||e.type===I.Zone.Type.FindUniqueWeapon}),n=(0,m.default)(t=this._zones).call(t,r),this._zonesByType.set(e,n),e===I.Zone.Type.Find&&this._zonesByType.set(I.Zone.Type.FindUniqueWeapon,n),e===I.Zone.Type.FindUniqueWeapon&&this._zonesByType.set(I.Zone.Type.Find,n),n}},{key:"getUnusedZone",value:function(e,t,n,r,a,i,o){var u,l=this;switch(this.usedAlternateStrain=o,e.type){case I.Zone.Type.Town:return!0;case I.Zone.Type.BlockadeNorth:case I.Zone.Type.TravelStart:case I.Zone.Type.BlockadeWest:case I.Zone.Type.BlockadeSouth:case I.Zone.Type.BlockadeEast:case I.Zone.Type.TravelEnd:if(!this.requiredItemForZoneWasNotPlaced(e))return!1;var s=(0,m.default)(u=e.requiredItems).call(u,(function(e){return!l.hasQuestRequiringItem(e)}));if(0===s.length)return!1;var d=s[S.rand()%s.length];return this.addProvidedItemQuest(d,e.type===I.Zone.Type.TravelStart?5:i),this.addRequiredItemQuest(d,i),this.requiredItem=d,this.addRequiredItemQuestsFromHotspots(e),!0;case I.Zone.Type.Empty:return!this.somethingWithTeleporters||!e.hotspots.length;case I.Zone.Type.Goal:if(!this.zoneLeadsToProvidedItem(e,r))return!1;if(!this.zoneLeadsToProvidedItem(e,a))return!1;var c=this.getUnusedRequiredItemForZoneRandomly(e,!1),f=this.getUnusedRequiredItemForZoneRandomly(e,!0);if(null===c||null===f)return!1;var h=this.getUnusedPuzzleRandomly(c,I.Zone.Type.Goal);h&&this.usedPuzzles.push(h);var p=this.getUnusedPuzzleRandomly(f,I.Zone.Type.Goal);if(p&&this.usedPuzzles.push(p),!h||!p)return!1;if(this.puzzleStrain1[t]=h,this.puzzleStrain2[n]=p,!this.requiredItemForZoneWasNotPlaced(e))return!1;var v=this.puzzleStrain1[t],y=this.puzzleStrain2[n],g=this.puzzleStrain1[t+1],_=this.findUnusedNPCForZoneRandomly(e),w=null!==_?this.zoneLeadsToNPC(e,_):0,k=1;if(k=+(k=+k&+this.zoneLeadsToRequiredItem(e,v.item1))&+this.zoneLeadsToProvidedItem(e,g.item1),this.zoneLeadsToProvidedItem(e,g.item2?g.item2:null),!k)return!1;if(w)this.addRequiredItemQuestsFromHotspots(e),this.npc=_,this.findItem=null,this.requiredItem=v.item1,this.currentPuzzleIndex=t,this.additionalRequiredItem=null,this.addRequiredItemQuestsFromHotspots(e);else{var b=1;if(b&=+this.chooseItemFromZone(e,v.item1,!1),b&=+this.placeQuestItem(e,g.item1),b&=+this.chooseItemFromZone(e,y.item1,!0),!(b&=+this.placeQuestItem(e,g.item2?g.item2:null)))return!1;this.addRequiredItemQuest(v.item1,i),this.addRequiredItemQuest(y.item1,i),this.addRequiredItemQuest(g.item1,i),this.addRequiredItemQuest(g.item2?g.item2:null,i),this.npc=null,this.findItem=g.item1,this.requiredItem=v.item1,this.currentPuzzleIndex=t,this.additionalRequiredItem=null,this.additionalFindItem=g.item2,this.addRequiredItemQuestsFromHotspots(e)}return this.addRequiredItemQuest(c,i),this.addRequiredItemQuest(f,i),!0;case I.Zone.Type.Trade:if(!this.zoneLeadsToProvidedItem(e,r))return!1;var x=this.getUnusedRequiredItemForZoneRandomly(e,!1);if(null===x)return!1;var T=this.getUnusedPuzzleRandomly(x,I.Zone.Type.Trade);if(!T)return!1;var M=o?this.puzzleStrain1:this.puzzleStrain2;M[t]=T;var E=M[t],C=M[t+1];return this.currentPuzzleIndex=t,this.addRequiredItemQuest(E.item1,i),this.addRequiredItemQuest(C.item1,i),this.requiredItemForZoneWasNotPlaced(e)?(this.dropItemAtLockHotspot(e,E.item1)&&(this.addRequiredItemQuest(E.item1,i),this.requiredItem=E.item1,this.placeQuestItem(e,C.item1)&&(this.addRequiredItemQuest(C.item1,i),this.findItem=C.item1)),this.addRequiredItemQuestsFromHotspots(e),this.usedPuzzles.push(T),this.addRequiredItemQuest(x,i),!0):(this.removeQuestRequiringItem(E.item1),!1);case I.Zone.Type.Use:if(!this.zoneLeadsToProvidedItem(e,r))return!1;var A=this.getUnusedRequiredItemForZoneRandomly(e,!1);if(null===A)return!1;var D=this.getUnusedPuzzleRandomly(A,I.Zone.Type.Use);if(!D)return!1;var z=o?this.puzzleStrain1:this.puzzleStrain2;if(z[t]=D,e.type!==I.Zone.Type.Use)return!1;if(!this.requiredItemForZoneWasNotPlaced(e))return!1;var P=this.findUnusedNPCForZoneRandomly(e);if(null===P)return!1;var R=z[t].item1;if(!this.zoneLeadsToRequiredItem(e,R))return!1;var L=z[t+1].item1;return!!this.zoneLeadsToProvidedItem(e,L)&&(!!this.dropNPCAtHotspotRandomly(e,P)&&(this.npc=P,this.findItem=L,this.requiredItem=R,this.currentPuzzleIndex=t,this.addRequiredItemQuest(P,i),this.addRequiredItemQuestsFromHotspots(e),this.usedPuzzles.push(D),this.addRequiredItemQuest(A,i),!0));case I.Zone.Type.Find:case I.Zone.Type.FindUniqueWeapon:return!!this.dropItemAtHotspotRandomly(e,r)&&(this.addRequiredItemQuest(r,i),this.findItem=r,this.addRequiredItemQuestsFromHotspots(e),!0);default:return!1}}},{key:"determineFindZones",value:function(e){var t,n=k(this.providedItemQuests);try{for(n.s();!(t=n.n()).done;){var r=t.value,a=this.determinePuzzleLocationChoices(e,r.distance),i=a[S.rand()%a.length];this.errorWhen(!i,"No place to find item ".concat(r.item," found!"));var o=this.getUnusedZoneRandomly(I.Zone.Type.Find,-1,-1,r.item,null,r.distance,!1);this.errorWhen(!o,"No zone for puzzle found"),this.placeZone(i.x,i.y,o,I.Zone.Type.Find,{findItem:this.findItem}),e[i.x+10*i.y]=8}}catch(e){n.e(e)}finally{n.f()}}},{key:"determineTeleporters",value:function(e){for(var t=null,n=null,r=!1,a=0,i=0;i<10;i++)for(var o=0;o<10;o++){var u=e[o+10*i];if(5===u||4===u||6===u){var l=C.default(o,i);this.somethingWithTeleporters=+(6===u||l<2);var s=null;s=this.somethingWithTeleporters||!r?this.getUnusedZoneRandomly(I.Zone.Type.Empty,-1,-1,null,null,l,!1):n,this.errorWhen(!s,"No zone found");for(var d=5e3;d--,this.errorWhen(0===d,"Maximum number of iterations exceeded"),!this.somethingWithTeleporters;){if(!s.hotspots.withType(I.Hotspot.Type.Teleporter).first())break;if(!a){a++,t=new S.Point(o,i);break}var c=this._size===x.default.Large?2:1;if(T.abs(t.x-o)>c||T.abs(t.y-i)>c){if(a++,t=new S.Point(o,i),!r)break;r=!1,n=null;break}n=s,r=!0,s=this.getUnusedZoneRandomly(I.Zone.Type.Empty,-1,-1,null,null,c,!1),this.errorWhen(!s,"No zone found")}this.placeZone(o,i,s||null,I.Zone.Type.Empty)}}if(1===a){this.somethingWithTeleporters=1;var f=C.default(t.x,t.y),h=this.getUnusedZoneRandomly(I.Zone.Type.Empty,-1,-1,null,null,f,!1);h&&this.placeZone(t.x,t.y,h,I.Zone.Type.Empty)}return!0}},{key:"writePlanetValues",value:function(){}},{key:"puzzleUsedInLastGame",value:function(e,t){return!1}},{key:"hasPuzzleBeenPlaced",value:function(e){var t;return(0,p.default)(t=this.usedPuzzles).call(t,e)}},{key:"zoneLeadsToRequiredItem",value:function(e,t){return this._traverseZoneUntil(e,(function(e){var n=e.requiredItems;return(0,p.default)(n).call(n,t)}),!1,S.identity)}},{key:"zoneLeadsToProvidedItem",value:function(e,t){return this._traverseZoneUntil(e,(function(e){var n=e.providedItems;return(0,p.default)(n).call(n,t)}),!1,S.identity)}},{key:"hasQuestRequiringItem",value:function(e){var t;return!!(0,h.default)(t=this.requiredItemQuests).call(t,(function(t){return t.item===e}))}},{key:"addProvidedItemQuest",value:function(e,t){var n=new D.default(e,t);return this.providedItemQuests.unshift(n),n}},{key:"addRequiredItemQuest",value:function(e,t){var n=new D.default(e,t);return this.requiredItemQuests.push(n),n}},{key:"removeQuestRequiringItem",value:function(e){var t,n,r=(0,g.default)(t=this.requiredItemQuests).call(t,(function(t){return t.item===e}));-1!==r&&(0,_.default)(n=this.requiredItemQuests).call(n,r,1)}},{key:"removeQuestProvidingItem",value:function(e){var t,n,r=(0,g.default)(t=this.providedItemQuests).call(t,(function(t){return t.item===e}));-1!==r&&(0,_.default)(n=this.providedItemQuests).call(n,r,1)}},{key:"requiredItemForZoneWasNotPlaced",value:function(e){var t,n=k(e.hotspots);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(-1!==r.arg){if(r.type.canHoldItem()&&this.hasQuestRequiringItem(this.lookupTileById(r.arg)))return!1;if(r.type===I.Hotspot.Type.DoorIn&&!this.requiredItemForZoneWasNotPlaced(this.lookupZoneById(r.arg)))return!1}}}catch(e){n.e(e)}finally{n.f()}return!0}},{key:"addRequiredItemQuestsFromHotspots",value:function(e){var t,n=this;(0,w.default)(t=e.hotspots).call(t,(function(e){-1!==e.arg&&(e.type.canHoldItem()&&n.addRequiredItemQuest(n.lookupTileById(e.arg),-1),e.type===I.Hotspot.Type.DoorIn&&n.addRequiredItemQuestsFromHotspots(n.lookupZoneById(e.arg)))}))}},{key:"chooseItemFromZone",value:function(e,t,n){return this._traverseZoneUntil(e,(function(e){var r=n?e.goalItems:e.requiredItems;return(0,p.default)(r).call(r,t)}),!1,S.identity)}},{key:"findUnusedNPCForZoneRandomly",value:function(e){var t=this;return this._traverseZoneUntil(e,(function(e){var n,r=(0,m.default)(n=e.npcs).call(n,(function(e){return!t.hasQuestRequiringItem(e)}));return r.length?r[S.rand()%r.length]:null}),null)}},{key:"zoneLeadsToNPC",value:function(e,t){return this._traverseZoneUntil(e,(function(e){var n;return(0,p.default)(n=e.npcs).call(n,t)}),!1,S.identity)}},{key:"getUnusedRequiredItemForZoneRandomly",value:function(e,t){var n=this;return this._traverseZoneUntil(e,(function(e){var r=t?e.goalItems:e.requiredItems,a=(0,m.default)(r).call(r,(function(e){return!n.hasQuestRequiringItem(e)}));return a.length?a[S.rand()%a.length]:null}),null)}},{key:"_traverseZoneUntil",value:function(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return e!==n},i=k(R.default(e,this._assets));try{for(i.s();!(r=i.n()).done;){var o=r.value,u=t(o);if(a(u))return u}}catch(e){i.e(e)}finally{i.f()}return n}},{key:"determinePuzzleLocationChoices",value:function(e,t){var n=[],r=[],a=[];return this.loopWorld(e,(function(i,o,u,l){var s=new S.Point(o,u);C.default(o,u)>t?5===i&&n.push(s):5!==i&&4!==i||((o<1||8!==e[l-1])&&(o>8||8!==e[l+1])&&(u<1||8!==e[l-10])&&(u>8||8!==e[l+10])?r.push(s):a.push(s))})),r.length?r:a.length?a:n.length?n:null}},{key:"getPuzzleCandidates",value:function(e){var t=this;return this._assets.getFiltered(I.Puzzle,(function(n){switch(e){case I.Zone.Type.Find:case I.Zone.Type.FindUniqueWeapon:return!1;case I.Zone.Type.Use:case I.Zone.Type.Trade:case I.Zone.Type.Goal:return!t.hasPuzzleBeenPlaced(n)&&n.type===e.toPuzzleType();case I.Zone.Type.PlaceholderForEndPuzzle:return n.type===I.Puzzle.Type.End&&(!t.puzzleUsedInLastGame(n,t._planet)||null!==t.goalPuzzle)&&t.isGoalOnPlanet(t._planet,n);default:return!0}}))}},{key:"isGoalOnPlanet",value:function(e,t){var n,r=this;return!!(0,h.default)(n=this._assets).call(n,I.Zone,(function(n){return n.type===I.Zone.Type.Goal&&n.planet===e&&r.zoneLeadsToProvidedItem(n,t.item1)&&r.zoneLeadsToProvidedItem(n,t.item2)}))}},{key:"placeQuestItem",value:function(e,t){var n=this;return this._traverseZoneUntil(e,(function(e){var r;if(!(0,p.default)(r=e.providedItems).call(r,t))return!1;var a=e.hotspots.withType(I.Hotspot.Type.DropQuestItem);return n.placeItemAtHotspotRandomly(a,t)}),!1,S.identity)}},{key:"placeItemAtHotspotRandomly",value:function(e,t){if(!e.length)return!1;var n=e[S.rand()%e.length];return this.dropItemAtHotspot(t,n)}},{key:"dropItemAtLockHotspot",value:function(e,t){var n=this;return this._traverseZoneUntil(e,(function(e){var r;if(!(0,p.default)(r=e.requiredItems).call(r,t))return!1;var a=e.hotspots.withType(I.Hotspot.Type.Lock);return!!a.length&&n.dropItemAtHotspot(t,a[0])}),!1,S.identity)}},{key:"dropItemAtHotspot",value:function(e,t){return!!t&&(t.arg=e.id,t.enabled=!0,!0)}},{key:"dropNPCAtHotspotRandomly",value:function(e,t){var n=this,r=function(e){return-1===e.arg};return this._traverseZoneUntil(e,(function(e){var a,i;if(!(0,p.default)(a=e.npcs).call(a,t))return!1;var o=(0,m.default)(i=e.hotspots.withType(I.Hotspot.Type.SpawnLocation)).call(i,r);return n.placeItemAtHotspotRandomly(o,t)}),!1,S.identity)}},{key:"dropItemAtHotspotRandomly",value:function(e,t){var n=this;return!!this.requiredItemForZoneWasNotPlaced(e)&&this._traverseZoneUntil(e,(function(e){var r;if(!(0,p.default)(r=e.providedItems).call(r,t))return!1;var a=n.hotspotTypeForTile(t),i=e.hotspots.withType(a);return n.placeItemAtHotspotRandomly(i,t)}),!1,S.identity)}},{key:"hotspotTypeForTile",value:function(e){return e.hasAttributes(I.Tile.Attributes.Weapon)?I.Hotspot.Type.DropUniqueWeapon:e.hasAttributes(I.Tile.Attributes.Map)?I.Hotspot.Type.DropMap:e.hasAttributes(I.Tile.Attributes.Item)?I.Hotspot.Type.DropQuestItem:void 0}},{key:"placeZone",value:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},i=e+10*t,o=this.world.at(i);o.zone=n,o.zoneType=r,o.puzzleIndex=void 0!==a.puzzleIndex?a.puzzleIndex:-1,o.requiredItem=void 0!==a.requiredItem?a.requiredItem:null,o.npc=void 0!==a.npc?a.npc:null,o.findItem=void 0!==a.findItem?a.findItem:null,o.additionalRequiredItem=void 0!==a.additionalRequiredItem?a.additionalRequiredItem:null,o.additionalGainItem=void 0!==a.additionalGainItem?a.additionalGainItem:null,o.usedAlternateStrain=this.usedAlternateStrain,null!==n&&r!==I.Zone.Type.Town&&this.usedZones.unshift(n)}},{key:"errorWhen",value:function(e,t){if(e){var n=new P.default(t);throw n.seed=this._seed,n.size=this._size,n.planet=this._planet,n}}},{key:"initialItem",get:function(){return this.puzzleStrain2[0].item1}},{key:"goalPuzzle",get:function(){return this.usedPuzzles[0]||null}},{key:"puzzles",get:function(){return[this.puzzleStrain1,this.puzzleStrain2]}},{key:"lookupTileById",value:function(e){return this._assets.get(I.Tile,e,E.NullIfMissing)}},{key:"lookupZoneById",value:function(e){return this._assets.get(I.Zone,e,E.NullIfMissing)}}]),e}();t.default=L},80361:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583)),o=r(n(68748)),u=r(n(75356));(0,o.default)(t,"__esModule",{value:!0});var l=function(){function e(){(0,a.default)(this,e)}return(0,i.default)(e,[{key:"rawValue",get:function(){var t;return(0,u.default)(t=e.knownSizes).call(t,this)+1}},{key:"toString",value:function(){return"WorldSize {".concat(this.name,"}")}},{key:"name",get:function(){switch(this){case e.Small:return"Small";case e.Medium:return"Medium";case e.Large:return"Large"}}}],[{key:"isWorldSize",value:function(t){return t>=1&&t<=e.knownSizes.length}},{key:"fromNumber",value:function(t){return console.assert(e.isWorldSize(t),"Value ".concat(t," does not specify a valid world size!")),e.knownSizes[t-1]}}]),e}();l.Small=new l,l.Medium=new l,l.Large=new l,l.knownSizes=[l.Small,l.Medium,l.Large],t.default=l},14635:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o=n(17766),u=n(31560),l=n(83608),s=n(63806),d=n(57266),c=n(33683);function f(e,t,n){var r=t.hero,a=t.currentZone,i=u.Point.add(r.location,e);if(a.bounds.contains(i))return!1;var o=new u.Point(i.x,i.y);if(o.x<0?o.x=-1:o.x>=18?o.x=1:o.x=0,o.y<0?o.y=-1:o.y>=18?o.y=1:o.y=0,!o.isUnidirectional())return console.log("can't move two zones at once!"),!1;var l=t.findLocationOfZone(t.currentZone),d=l.world,c=l.location;if(c&&d){var f=d.at(c);if(f&&f.zone===t.currentZone){var h=u.Point.add(c,o),p=d.at(h);if(!p)return!1;var v=p.zone;if(!v)return!1;var y=u.Point.add(r.location,e);if(a.bounds.contains(y))return!1;var m=u.Point.add(r.location,e);if(m.subtract(18*o.x,18*o.y),!v.placeWalkable(m))return!1;var g=new s.SectorTransitionScene;return g.destinationHeroLocation=m,g.destinationSector=h,g.originSector=c,g.destinationZone=v,g.destinationWorld=d,g.scene=n,t.sceneManager.pushScene(g),!0}}}t.default=function(){var e=(0,i.default)(a.default.mark((function e(t,n,r,i){var s,h,p,v,y,m,g;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=r.hero,h=u.Direction.Confine(t),p=u.Direction.CalculateRelativeCoordinates(h,1),v=new u.Point(p.x,p.y,0),s.isWalking=!0,y=u.Point.add(s.location,v),!(n.bounds.contains(y)&&n.getTile(y.x,y.y,o.Zone.Layer.Object))){e.next=17;break}if(r.bumpedLocation=y,!r.hpu.execute(d.HotspotExecutionMode.Bump,y,null)){e.next=11;break}return e.abrupt("return");case 11:return r.spu.prepareExecution(l.EvaluationMode.Bump,n),e.next=14,r.spu.run();case 14:if((m=e.sent)===l.ScriptResult.Done){e.next=17;break}return e.abrupt("return",m);case 17:if(s.move(v,n)){e.next=21;break}return f(v,r,i),e.abrupt("return",l.ScriptResult.Done);case 21:if(!((g=r.hpu.execute(d.HotspotExecutionMode.Walk))&c.HotspotExecutionResult.Speak||g&c.HotspotExecutionResult.ChangeZone||g&c.HotspotExecutionResult.Drop)){e.next=24;break}return e.abrupt("return",l.ScriptResult.Wait);case 24:return e.abrupt("return",l.ScriptResult.Done);case 25:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},9021:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(94433)),o=a(n(40361)),u=a(n(7583)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244)),c=a(n(68748)),f=a(n(9805));function h(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,c.default)(t,"__esModule",{value:!0}),t.Events=t.MaxHealth=t.MaxLives=t.HealthPerLive=void 0;var p=n(17766),v=n(31560),y=n(17725);t.HealthPerLive=100,t.MaxLives=3,t.MaxHealth=t.MaxLives*t.HealthPerLive,t.Events={HealthDidChange:"HealthDidChange",WeaponChanged:"WeaponChanged",AmmoChanged:"AmmoChanged"};var m=function(e){(0,l.default)(r,e);var n=h(r);function r(){var e;return(0,o.default)(this,r),(e=n.apply(this,arguments)).visible=!0,e.location=new v.Point(10,10,1),e.invincible=!1,e.unlimitedAmmo=!1,e._actionFrames=0,e._direction=v.Direction.South,e._appearance=null,e._health=t.MaxHealth,e._walking=!1,e._attacking=!1,e._dragging=!1,e._weapon=null,e._ammo=-1,e._ammoByWeapon=new f.default,e}return(0,u.default)(r,[{key:"isWalking",get:function(){return this._walking},set:function(e){this._walking=e}},{key:"isAttacking",get:function(){return this._attacking},set:function(e){this._attacking=e}},{key:"isDragging",get:function(){return this._dragging},set:function(e){this._dragging=e}},{key:"health",get:function(){return this._health},set:function(e){this.invincible||(this._health=y.max(0,y.min(t.MaxHealth,e)),this.dispatchEvent(t.Events.HealthDidChange,{health:e}))}},{key:"direction",get:function(){return v.Direction.Confine(this._direction)}},{key:"appearance",get:function(){return this._appearance},set:function(e){this._appearance=e}},{key:"weapon",get:function(){return this._weapon},set:function(e){this._weapon&&this._ammoByWeapon.set(this._weapon,this._ammo),this._weapon=e,this.dispatchEvent(t.Events.WeaponChanged,{weapon:e}),this._weapon||(this.ammo=-1)}},{key:"ammo",get:function(){return this._ammo},set:function(e){this.unlimitedAmmo||(this._ammo=e<0?-1:e,this.weapon&&this._ammoByWeapon.set(this.weapon,this._ammo),this.dispatchEvent(t.Events.AmmoChanged,{ammo:e}))}},{key:"getAmmoForWeapon",value:function(e){return this._ammoByWeapon.has(e)?this._ammoByWeapon.get(e):0}},{key:"setAmmoForWeapon",value:function(e,t){this._ammoByWeapon.set(e,t),e===this.weapon&&(this._ammo=t)}},{key:"update",value:function(e){this.isWalking||this.isAttacking?this._actionFrames+=e:this._actionFrames=0}},{key:"face",value:function(e){this._direction=e}},{key:"move",value:function(e,t){var n=v.Point.add(e,this.location),r=t.size;if(!n.isInBounds(r))return this._walking=!1;if(this._doMove(e,t,e.isUnidirectional()&&this._dragging))return this._walking=!0;var a=e.y,i=e.x;if(e.y=0,this._doMove(e,t,this._dragging))return this._walking=!0;if(e.y=a,e.x=0,this._doMove(e,t,this._dragging))return this._walking=!0;if(e.x=i,e.y=a,this._dragging)return this._walking=!1;if(0!==a&&0===i){if(e.x=i-1,v.Point.add(n,e).isInBounds(r)&&this._doMove(e,t,!1))return this._walking=!0;if(e.x=i+1,v.Point.add(n,e).isInBounds(r)&&this._doMove(e,t,!1))return this._walking=!0}else if(0!==i&&0===a){if(e.y=a+1,v.Point.add(n,e).isInBounds(r)&&this._doMove(e,t,!1))return this._walking=!0;if(e.y=a-1,v.Point.add(n,e).isInBounds(r)&&this._doMove(e,t,!1))return this._walking=!0}return this._walking=!1}},{key:"_doMove",value:function(e,t,n){if(e.isZeroPoint())return!1;var r=this.location,a=v.Point.add(r,e);if(a.z=1,t.placeWalkable(a))return n&&this._doDrag(v.Point.subtract(r,e),r,t),this.location=a,!0;if(n){var i=v.Point.add(a,e);if(i.z=1,i.isInBounds(t.size)&&this._doDrag(a,i,t))return this.location=a,!0}return!1}},{key:"_doDrag",value:function(e,t,n){if(t.isInBounds(n.size)&&e.isInBounds(n.size)){var r=n.getTile(e);return!(!r||!r.hasAttributes(p.Tile.Attributes.Draggable))&&(null===n.getTile(t.x,t.y,1)&&(n.setTile(null,e),n.setTile(r,t),!0))}}},{key:"changeHealth",value:function(e,t){if(!this.invincible){var n=r.ConvertHealthToDamage(this.health),a=(0,i.default)(n,2),o=a[0],u=a[1],l=y.floor(100/t.difficulty),s=y.floor(e/l);s>-100?(o-=s,u+=y.floor(o/100)-y.ceil(s/100)):(o-=y.ceil(s/3)+1,u+=y.floor(o/100)-y.ceil(s/100)),o%=100,u>3&&(u=3,o=100),this.health=r.ConvertDamageToHealth(o,u)}}},{key:"damage",get:function(){return r.ConvertHealthToDamage(this.health)[0]}},{key:"lives",get:function(){return r.ConvertHealthToDamage(this.health)[1]}}],[{key:"ConvertDamageToHealth",value:function(e,n){return e>99&&n>=3?0:e<=1&&n<=1?t.MaxHealth:100*(4-n)-e}},{key:"ConvertHealthToDamage",value:function(e){return e<=0?[100,3]:e>=t.MaxHealth?[1,1]:[100-e%100,3-y.floor(e/100)]}}]),r}(v.EventTarget);m.MaxHealth=t.MaxHealth,m.HealthPerLive=t.HealthPerLive,m.MaxLives=t.MaxLives,m.Event=t.Events,t.default=m},20779:(e,t,n)=>{var r=n(38468)(n(68748));(0,r.default)(t,"__esModule",{value:!0}),t.readGameDataFileProgressively=t.readGameDataFile=t.Story=t.Script=t.SceneManager=t.Scene=t.SaveState=t.SaveGameWriter=t.SaveGameReader=t.PersistentState=t.PaletteAnimation=t.Objects=t.MutableObjects=t.Metronome=t.Inventory=t.Hero=t.Variant=t.GameState=t.GameData=t.EngineEvents=t.Engine=t.ColorPalette=t.AssetManager=void 0;var a=n(95451);(0,r.default)(t,"SaveGameReader",{enumerable:!0,get:function(){return a.Reader}}),(0,r.default)(t,"SaveGameWriter",{enumerable:!0,get:function(){return a.Writer}}),(0,r.default)(t,"SaveState",{enumerable:!0,get:function(){return a.SaveState}});var i=n(61334);(0,r.default)(t,"ColorPalette",{enumerable:!0,get:function(){return i.ColorPalette}}),(0,r.default)(t,"PaletteAnimation",{enumerable:!0,get:function(){return i.PaletteAnimation}});var o=n(41777);t.Engine=o.default;var u=n(2577);t.EngineEvents=u.default;var l=n(81191);t.GameData=l.default;var s=n(9021);t.Hero=s.default;var d=n(49961);t.Inventory=d.default;var c=n(8939);t.Metronome=c.default;var f=n(35930);t.PersistentState=f.default;var h=n(46724);t.SceneManager=h.default;var p=n(76523);t.Story=p.default;var v=n(81724);(0,r.default)(t,"readGameDataFile",{enumerable:!0,get:function(){return v.read}}),(0,r.default)(t,"readGameDataFileProgressively",{enumerable:!0,get:function(){return v.readProgressively}});var y=n(63806);(0,r.default)(t,"Scene",{enumerable:!0,get:function(){return y.Scene}});var m=n(82127);t.GameState=m.default;var g=n(92540);t.AssetManager=g.default;var _=n(17766);t.Objects=_;var w=n(76500);t.MutableObjects=w;var k=n(83608);t.Script=k;var b=n(63239);t.Variant=b.default},20495:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});t.default={Up:1,Down:2,Left:4,Right:8}},34159:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.Direction=t.InputMask=void 0;var r=n(8120);t.InputMask=r.default;var a=n(20495);t.Direction=a.default},8120:(e,t,n)=>{var r;(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),function(e){e[e.None=0]="None",e[e.Up=1]="Up",e[e.Down=2]="Down",e[e.Left=4]="Left",e[e.Right=8]="Right",e[e.PickUp=16]="PickUp",e[e.Pause=32]="Pause",e[e.Map=64]="Map",e[e.EndDialog=128]="EndDialog",e[e.ScrollDown=256]="ScrollDown",e[e.Attack=512]="Attack",e[e.Walk=1024]="Walk",e[e.Drag=2048]="Drag",e[e.ScrollUp=4096]="ScrollUp",e[e.Movement=1039]="Movement"}(r||(r={})),t.default=r},49961:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244)),d=a(n(68748)),c=a(n(31920)),f=a(n(42601)),h=a(n(58831)),p=a(n(67093)),v=a(n(75356)),y=a(n(92915));function m(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,d.default)(t,"__esModule",{value:!0}),t.Events=void 0;var g=n(31560),_=n(17766);t.Events={DidAddItem:"ItemAdded",DidRemoveItem:"ItemRemoved",DidChangeItems:"ItemsChanged"};var w=function(e){(0,u.default)(r,e);var n=m(r);function r(){var e;return(0,i.default)(this,r),(e=n.call(this))._items=[],e}return(0,o.default)(r,[{key:"addItem",value:function(e){var n,r=this._items.length;e.hasAttributes(_.Tile.Attributes.Map)&&(r=0),(0,c.default)(n=this._items).call(n,r,0,e),this.dispatchEvent(t.Events.DidAddItem,{item:e}),this.dispatchEvent(t.Events.DidChangeItems,{mode:"add",item:e})}},{key:"removeAllItems",value:function(){var e,n,r=this;(0,f.default)(e=(0,h.default)(n=this._items).call(n)).call(e,(function(e){return r.dispatchEvent(t.Events.DidRemoveItem,{item:e})})),this._items=[],this.dispatchEvent(t.Events.DidChangeItems)}},{key:"removeItem",value:function(e){var n,r,a;"number"==typeof e&&(e=(0,p.default)(a=this._items).call(a,(function(t){return t.id===e})));var i=(0,v.default)(n=this._items).call(n,e);-1!==i&&((0,c.default)(r=this._items).call(r,i,1),this.dispatchEvent(t.Events.DidChangeItems,{mode:"remove",item:e}),this.dispatchEvent(t.Events.DidRemoveItem,{item:e}))}},{key:"contains",value:function(e){var t;if("number"!=typeof e)return-1!==(0,v.default)(t=this._items).call(t,e);for(var n=0,r=this._items.length;n<r;n++)if(this._items[n].id===e)return!0;return!1}},{key:"find",value:function(e){var t;return(0,p.default)(t=this._items).call(t,e)||null}},{key:"forEach",value:function(e){var t;(0,f.default)(t=this._items).call(t,e)}},{key:"items",get:function(){var e;return(0,y.default)(e=this._items).call(e)}}]),r}(g.EventTarget);w.Event=t.Events,t.default=w},43090:(e,t,n)=>{var r=n(38468),a=r(n(40361));(0,r(n(68748)).default)(t,"__esModule",{value:!0});t.default=function e(){(0,a.default)(this,e)}},8939:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(63789)),o=a(n(76108)),u=a(n(7583)),l=a(n(40361)),s=a(n(80655)),d=a(n(20497)),c=a(n(75244)),f=a(n(46386)),h=a(n(68748)),p=a(n(73035)),v=a(n(79302));function y(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,d.default)(this,n)}}(0,h.default)(t,"__esModule",{value:!0}),t.Event=t.DefaultTickDuration=void 0;var m=n(31560),g=n(37572);t.DefaultTickDuration=100,t.Event={Start:"start",Stop:"stop",BeforeTick:"beforeTick",AfterTick:"afterTick",BeforeRender:"BeforeRender",Render:"Render",AfterRender:"AfterRender"};var _=function(e){(0,s.default)(n,e);var t=y(n);function n(){return(0,l.default)(this,n),t.apply(this,arguments)}return n}((0,f.default)(CustomEvent)),w=function(e){(0,s.default)(f,e);var n,r,a,d,c=y(f);function f(){var e;return(0,l.default)(this,f),(e=c.call(this)).ontick=m.identity,e.onrender=m.identity,e._stopped=!1,e._mainLoop=0,e._updateLoop=0,e._nextTick=0,e._tickCallback=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e._executeRenderAndUpdateLoop(t)},e._renderCallback=function(){return e._executeRenderLoop()},e._updatesSuspended=!1,e._tickDuration=t.DefaultTickDuration,e._tickCount=new Uint32Array(new ArrayBuffer(4)),e._nextTick=g.performance.now(),e}return(0,u.default)(f,[{key:"start",value:function(){this._stopped=!1,this._nextTick=0,this.dispatchEvent(new _(t.Event.Start)),this.tickDuration<16.666666666666668?(this._executeUpdateLoop(),this._executeRenderLoop()):this._executeRenderAndUpdateLoop()}},{key:"_executeUpdateLoop",value:function(){var e=this;this._stopped||(this._updateLoop=(0,p.default)((function(){return e._executeUpdateLoop()}),this.tickDuration),this.update())}},{key:"_executeRenderLoop",value:function(){this._stopped||(this._mainLoop=window.requestAnimationFrame(this._renderCallback),this.onrender())}},{key:"_executeRenderAndUpdateLoop",value:(d=(0,o.default)(i.default.mark((function e(){var t,n,r=arguments;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.length>0&&void 0!==r[0]?r[0]:g.performance.now(),!this._stopped){e.next=3;break}return e.abrupt("return");case 3:if(this._mainLoop=window.requestAnimationFrame(this._tickCallback),!(n=t>=this._nextTick)){e.next=8;break}return e.next=8,this.update(t);case 8:return e.next=10,this.onrender();case 10:n&&window.onMetronomeTick instanceof Function&&this.withSuspendedUpdates(m.dispatch((0,o.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.onMetronomeTick();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))));case 11:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"update",value:(a=(0,o.default)(i.default.mark((function e(){var n,r=this,a=arguments;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.length>0&&void 0!==a[0]?a[0]:g.performance.now(),this._nextTick=n+this._tickDuration,this._updatesSuspended){e.next=5;break}return e.next=5,this.withSuspendedUpdates((0,o.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r._tickCount[0]++,r.dispatchEvent(new _(t.Event.BeforeTick)),e.next=4,r.ontick(1);case 4:r.dispatchEvent(new _(t.Event.AfterTick));case 5:case"end":return e.stop()}}),e)}))));case 5:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"stop",value:(r=(0,o.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._stopped){e.next=2;break}return e.abrupt("return");case 2:if(this._mainLoop){e.next=4;break}return e.abrupt("return");case 4:this._stopped=!0,window.cancelAnimationFrame(this._mainLoop),window.clearTimeout(this._updateLoop),this._mainLoop=null;case 8:return e.next=10,m.dispatch((function(){}),1);case 10:if(this._updatesSuspended){e.next=8;break}case 11:this.dispatchEvent(new _(t.Event.Stop));case 12:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"withSuspendedUpdates",value:(n=(0,o.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.assert(!this._updatesSuspended,"withSuspendedUpdates does not support reentry"),this._updatesSuspended=!0,e.prev=2,!(t instanceof v.default)){e.next=6;break}return e.next=6,t;case 6:if(!(t instanceof Function)){e.next=9;break}return e.next=9,t();case 9:e.next=13;break;case 11:e.prev=11,e.t0=e.catch(2);case 13:return e.prev=13,this._updatesSuspended=!1,e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[2,11,13,16]])}))),function(e){return n.apply(this,arguments)})},{key:"tickDuration",get:function(){return this._tickDuration},set:function(e){this._tickDuration=e}},{key:"tickCount",get:function(){return this._tickCount[0]}}]),f}(m.EventTarget);w.Event=t.Event,t.default=w},93612:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(17766),a=n(49257),i=n(48261),o=n(99400),u=n(27227);function l(e,t,n,r){return e.flag34&&(i.default(e.face,t),e.flag34=!1),function(e,t,n){var r=a.findAnimationTileIdForCharFrame(e.face.frames.first(),e.facingDirection);u.default(n,t,e.position,r.id),e.facingDirection++,e.facingDirection%=6}(e,n,r)}t.default=function(e,t,n){var a=n.hero.location,u=a.comparedTo(e.position);if(e.face){if(console.assert(e.face.movementType!==r.Char.MovementType.Unspecific3),u.x||u.y)return l(e,u,t,n);if(e.x===a.x)u.x=-1,e.x<=a.x&&(u.x=0);else{if(e.y!==a.y)return l(e,u,t,n);e.x>=a.x?(u.x=-1,e.x<=a.x&&(u.x=0)):u.x=1}return e.y>=a.y?(u.y=-1,e.y<=a.y&&(u.y=0)):u.y=1,i.default(e.face,u),l(e,u,t,n)}o.default(e.position,t)}},58027:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(31560),a=n(83139),i=n(49257);t.default=function(e,t,n){var o,u=n.hero.location,l=e.position.bySubtracting(u).abs(),s=u.comparedTo(e.position);if(e.cooldown)return e.cooldown--,i.noMovement(e,t,n);var d=!1;return l.x>=2||l.y>=2?r.randmod(3)?(d=!1,o=i.convertToDirectionPoint(e.preferredDirection)):(o=a.default(),d=!0):(d=!0,o=r.randmod(2)?s:a.default()),d?o=i.evade(o,i.moveCheck(e.position,o,t,!1,n)):i.moveCheck(e.position,o,t,!1,n)!==i.MoveCheckResult.Free&&(o=new r.Point(0,0),e.cooldown=r.randmod(10),e.preferredDirection=r.randmod(4)-1),i.canPerformMeleeAttack(o,e,u)?(i.performMeleeAttackIfUnarmed(!r.randmod(2),e,n),i.noMovement(e,t,n)):i.performMoveAfterDoorwayCheck(o,e,t,n)}},6075:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.default=function(e,t,n){return t.position.byAdding(e).isEqualTo(n)}},48261:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(43100);t.default=function(e,t){return r.default(e,t,0)}},43100:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(49257);t.default=function(e,t,n){var a=r.findTileIdForCharFrameWithDirection(e.frames[n],t),i=r.findTileIdForCharFrameWithDirection(e.frames[0],t);return e.tile=a||i,e.tile}},88044:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(31560);t.default=function(e){switch(e){case-1:return new r.Point(0,-1);case 0:return new r.Point(0,1);case 1:return new r.Point(1,0);case 2:return new r.Point(-1,0);default:return new r.Point(0,0)}}},40668:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(31560),a=n(70926);t.default=function(e,t){switch(t){case a.default.OutOfBounds:case a.default.Blocked:return new r.Point(0,0);case a.default.EvadeRight:return e.byAdding(1,0);case a.default.EvadeLeft:return e.byAdding(-1,0);case a.default.EvadeDown:return e.byAdding(0,1);case a.default.EvadeUp:return e.byAdding(0,-1);default:return e}}},20914:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.default=function(e){return e%2==0}},21234:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(17766);t.default=function(e,t){if(!e)return null;switch(t){case r.Char.FrameEntry.Up:return e.up;case r.Char.FrameEntry.Down:return e.down;case r.Char.FrameEntry.ExtensionUp:return e.extensionUp;case r.Char.FrameEntry.Left:return e.left;case r.Char.FrameEntry.ExtensionDown:return e.extensionDown;case r.Char.FrameEntry.ExtensionLeft:return e.extensionLeft}}},10814:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.default=function(e,t){return e?0===t.x&&1===t.y?e.down:0===t.x&&-1===t.y?e.up||e.down:1===t.x&&0===t.y?e.right||e.down:-1===t.x&&0===t.y?e.left||e.down:-1===t.x&&-1===t.y?e.extensionUp||e.down:-1===t.x&&1===t.y?e.extensionDown||e.down:1===t.x&&-1===t.y?e.extensionLeft||e.down:1===t.x&&1===t.y&&e.extensionRight||e.down:null}},49257:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.shoot=t.even=t.isDoorway=t.canPerformMeleeAttack=t.performMeleeAttack=t.performMeleeAttackIfUnarmed=t.convertToDirectionPoint=t.performMoveAfterDoorwayCheck=t.playSound=t.noMovement=t.randomDirection=t.evade=t.performMove=t.MoveCheckResult=t.moveCheck=t.findTileIdForCharFrameWithDirection=t.findAnimationTileIdForCharFrame=void 0;var r=n(10814);t.findTileIdForCharFrameWithDirection=r.default;var a=n(70926);t.MoveCheckResult=a.default;var i=n(1918);t.moveCheck=i.default;var o=n(21234);t.findAnimationTileIdForCharFrame=o.default;var u=n(54274);t.performMove=u.default;var l=n(40668);t.evade=l.default;var s=n(83139);t.randomDirection=s.default;var d=n(48705);t.noMovement=d.default;var c=n(63084);t.playSound=c.default;var f=n(87540);t.performMoveAfterDoorwayCheck=f.default;var h=n(88044);t.convertToDirectionPoint=h.default;var p=n(20049);t.performMeleeAttackIfUnarmed=p.default;var v=n(97583);t.performMeleeAttack=v.default;var y=n(6075);t.canPerformMeleeAttack=y.default;var m=n(30633);t.isDoorway=m.default;var g=n(20914);t.even=g.default;var _=n(90087);t.shoot=_.default},30633:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(17766);t.default=function(e,t){var n=e.getTile(t.x,t.y,r.Zone.Layer.Floor);return n&&n.hasAttributes(r.Tile.Attributes.Doorway)}},70926:(e,t,n)=>{var r;(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),function(e){e[e.OutOfBounds=-1]="OutOfBounds",e[e.Free=1]="Free",e[e.Blocked=0]="Blocked",e[e.EvadeRight=2]="EvadeRight",e[e.EvadeLeft=3]="EvadeLeft",e[e.EvadeDown=4]="EvadeDown",e[e.EvadeUp=5]="EvadeUp"}(r||(r={})),t.default=r},1918:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.EvasionStrategy=void 0;var r=n(17766),a=n(70926),i=n(31560);t.EvasionStrategy=function(e){return(1&e)<1?1:-1},t.default=function(e,n,o){var u=arguments.length>3&&void 0!==arguments[3]&&arguments[3],l=arguments.length>4?arguments[4]:void 0,s=e.byAdding(n);if(!o.bounds.contains(s))return a.default.OutOfBounds;if(!o.getTile(s.x,s.y,r.Zone.Layer.Object))return a.default.Free;var d=function(e){var t=s.byAdding(e);return o.bounds.contains(t)&&(u||!o.getTile(t.x,t.y,r.Zone.Layer.Object))},c=t.EvasionStrategy(l.metronome.tickCount);return n.x&&!n.y&&d(new i.Point(0,-c))?a.default.EvadeUp:n.x&&!n.y&&d(new i.Point(0,c))?a.default.EvadeDown:n.x&&!n.y?a.default.Blocked:!n.x&&n.y&&d(new i.Point(-c,0))?a.default.EvadeLeft:!n.x&&n.y&&d(new i.Point(c,0))?a.default.EvadeRight:!n.x&&n.y?a.default.Blocked:n.x<0&&d(new i.Point(1,0))?a.default.EvadeRight:n.x>=0&&d(new i.Point(-1,0))?a.default.EvadeLeft:n.y<0&&d(new i.Point(0,1))?a.default.EvadeDown:n.y>=0&&d(new i.Point(0,-1))?a.default.EvadeUp:a.default.Blocked}},48705:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(31560),a=n(54274);t.default=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:a.default;return i(e,new r.Point(0,0),!1,t,n)}},20049:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(63084),a=n(17766);t.default=function(e,t,n){t.face.reference<0&&t.face.damage>=0&&e&&(r.default(n.assets.get(a.Sound,n.variant.sounds.Hurt),n),n.hero.changeHealth(-t.face.damage,n.settings))}},97583:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(63084),a=n(17766);t.default=function(e,t){e.face.damage>=0&&(r.default(t.assets.get(a.Sound,t.variant.sounds.Hurt),t),t.hero.changeHealth(-e.face.damage,t.settings))}},87540:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(48705),a=n(31560),i=n(17766),o=n(54274),u=n(30633);t.default=function(e,t,n,l){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:o.default,d=t.position.byAdding(e);if(!n.bounds.contains(d))return r.default(t,n,l,s);if(n.getTile(d.x,d.y,i.Zone.Layer.Object))return r.default(t,n,l,s);var c=!u.default(n,d);return c?t.position.add(e):e=new a.Point(0,0),s(t,e,c,n,l)}},54274:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(17766),a=n(99400),i=n(48261),o=n(27227);function u(e,t,n){e.flag34&&(i.default(e.face,t),e.flag34=!1),a.default(e.position,n)}t.default=function(e,t,n,l,s){var d=s.hero.location;if(e.face){if(console.assert(e.face.movementType!==r.Char.MovementType.Animation),console.assert(e.face.movementType!==r.Char.MovementType.Unspecific3),t.x||t.y)return n?(o.default(s,l,e.position.bySubtracting(t),-1),a.default(e.position.bySubtracting(t),l),i.default(e.face,t)):e.flag34&&(i.default(e.face,t),e.flag34=!1),u(e,t,l);var c=d.comparedTo(e.position);return 0!==c.x&&0!==c.y||(t=c,i.default(e.face,t)),u(e,t,l)}a.default(e.position,l)}},63084:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.default=function(e,t){}},83139:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(31560);t.default=function(){return new r.Point(r.randmod(3)-1,r.randmod(3)-1)}},90087:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(17766),a=n(31560),i=n(92540),o=n(1918),u=n(70926),l=n(46e3),s=n(78126);t.default=function(e,t,n){var d=n.hero.location,c=e.position.bySubtracting(d).abs(),f=d.comparedTo(e.position),h=n.assets.get(r.Char,e.face.reference,i.NullIfMissing);if(!h)return!1;var p=!1,v=!1;if(e.bulletOffset||e.cooldown>0);else{if(!(e.enabled&&e.alive&&c.x<4&&c.y<4))return e.bulletOffset=0,e.bullet=new a.Point(e.position),!1;if(f.x&&f.y||!f.x&&!f.y)return e.bulletOffset=0,e.bullet=new a.Point(e.position),!1;if(e.bullet=new a.Point(e.position),e.direction=f,a.rand()%7!=3)return e.bulletOffset=0,e.bullet=new a.Point(e.position),!1;p=!0}var y=e.direction;if(y.x&&y.y||!y.x&&!y.y)return e.bulletOffset=0,e.bullet=new a.Point(e.position),!1;if(!p&&0===e.bulletOffset)return!1;if(o.default(e.bullet,y,t,!1,n)===u.default.Free){if(e.bulletOffset++,e.bullet.byAdding(y).isEqualTo(d)){n.hero.changeHealth(-e.face.damage,n.settings);var m=n.assets.get(r.Sound,l.Yoda.sounds.Hurt);n.mixer.play(m,s.Channel.Effect),v=!1}else if(v=!0,e.bullet=e.bullet.byAdding(y),1===e.bulletOffset&&p){var g=n.assets.get(r.Sound,h.reference);n.mixer.play(g,s.Channel.Effect)}}else e.bulletOffset++,v=!1;return!!(v&&e.bulletOffset<4)||(e.bulletOffset=0,e.bullet=new a.Point(e.position),!1)}},99400:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(68190)),o=r(n(67093));(0,a.default)(t,"__esModule",{value:!0});var u=n(17766);t.default=function(e,t){var n,r=(0,i.default)(n=t.monsters).call(n,(function(t){var n=t.x,r=t.y;return n===e.x&&r===e.y})),a=(0,o.default)(r).call(r,(function(e){return e.enabled&&e.face&&e.alive}));if(a&&a.face.tile&&t.bounds.contains(e)){var l=a.face.tile;t.setTile(l,e.x,e.y,u.Zone.Layer.Object)}}},27227:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(17766),a=n(92540);t.default=function(e,t,n,i){var o=e.assets.get(r.Tile,i,a.NullIfMissing);t.bounds.contains(n)&&t.setTile(o,n.x,n.y,r.Zone.Layer.Object)}},67460:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(23982));(0,a.default)(t,"__esModule",{value:!0});var o=n(17766),u=n(31560),l=n(49257),s=n(92540),d=n(99400),c=n(27389),f=n(1511),h=n(60278),p=n(19952),v=n(81984),y=n(21663),m=n(58027),g=n(79399),_=n(13067),w=n(45303),k=n(93612),b=n(48261),S=new i.default([[o.Char.MovementType.Unspecific1,c.default],[o.Char.MovementType.Unspecific2,f.default],[o.Char.MovementType.Unspecific3,y.default],[o.Char.MovementType.Sit,h.default],[o.Char.MovementType.Unspecific4,p.default],[o.Char.MovementType.Unspecific5,v.default],[o.Char.MovementType.Droid,m.default],[o.Char.MovementType.Wander,g.default],[o.Char.MovementType.Patrol,_.default],[o.Char.MovementType.Scaredy,w.default],[o.Char.MovementType.Animation,k.default]]);t.default=function(e,t,n){if(e.face){if(!e.alive||!e.enabled)return function(e,t,n){var r=n.hero.location,a=n.assets.get(o.Char,e.face.id,s.NullIfMissing);if(a){var i=n.assets.get(o.Char,a.reference,s.NullIfMissing);if(i){var c=l.findTileIdForCharFrameWithDirection(i.frames[0],e.direction);t.getTile(e.bullet.x,e.bullet.y,o.Zone.Layer.Object)===c&&(e.bullet.isEqualTo(r)||d.default(e.bullet,t)),e.bulletOffset=0,e.bullet=new u.Point(e.position),e.direction=new u.Point(0,0)}}}(e,t,n),void b.default(e.face,e.direction);if(l.shoot(e,t,n))return b.default(e.face,e.direction),void d.default(e.position,t);var r=S.get(e.face.movementType)||null;return r?r(e,t,n):void 0}}},13067:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(49257);t.default=function(e,t,n){var a=n.metronome.tickCount,i=n.hero.location,o=e.waypoints[e.facingDirection+1];if(e.cooldown)return e.cooldown--,r.noMovement(e,t,n);if(r.even(a))return r.noMovement(e,t,n);var u=o.comparedTo(e.position);return u.x||u.y||(e.facingDirection++,e.facingDirection>2&&(e.facingDirection=-1)),r.canPerformMeleeAttack(u,e,i)?(r.performMeleeAttack(e,n),r.noMovement(e,t,n)):r.performMoveAfterDoorwayCheck(u,e,t,n)}},45303:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(17766),a=n(83139),i=n(49257);t.default=function(e,t,n){var o,u=n.hero.location,l=e.position.bySubtracting(u).abs(),s=u.comparedTo(e.position).byScalingBy(-1);for(o=l.x<6&&l.y<6?s:a.default();;){if(o=i.evade(o,i.moveCheck(e.position,o,t,!1,n)),i.canPerformMeleeAttack(o,e,u))return i.performMeleeAttack(e,n),i.noMovement(e,t,n);var d=o.byAdding(e.position);if(t.getTile(d.x,d.y,r.Zone.Layer.Object))return i.noMovement(e,t,n);if(!i.isDoorway(t,d))return e.position.add(o),i.performMove(e,o,!0,t,n);o=a.default()}}},60278:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(49257);t.default=function(e,t,n){var a=n.hero.location.comparedTo(e.position);return e.flag34=!0,r.performMove(e,a,!1,t,n)}},27389:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(17766),a=n(31560),i=n(83139),o=n(49257);t.default=function(e,t,n){var u;if(e.cooldown)return e.cooldown--,o.noMovement(e,t,n);if(!a.randmod(2))return o.noMovement(e,t,n);var l=n.hero.location,s=l.comparedTo(e.position),d=s.byScalingBy(-1);return e.flag1c?(u=a.randmod(2)?i.default():d,e.currentFrame++,e.currentFrame>3&&(e.flag1c=!1,e.currentFrame=0)):u=s,u=o.evade(u,o.moveCheck(e.position,u,t,!1,n)),o.canPerformMeleeAttack(u,e,l)&&(u=new a.Point(0,0),e.face.damage>=0&&(o.playSound(n.assets.get(r.Sound,n.variant.sounds.Hurt),n),n.hero.changeHealth(-e.face.damage,n.settings)),e.currentFrame++,e.currentFrame>1&&(e.flag1c=!0,e.currentFrame=0)),e.flag1c||(e.currentFrame++,e.currentFrame>=15&&(e.flag1c=!0,e.currentFrame=0)),o.performMoveAfterDoorwayCheck(u,e,t,n)}},1511:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(31560),a=n(83139),i=n(49257);t.default=function(e,t,n){var o;if(e.cooldown)return e.cooldown--,i.noMovement(e,t,n);if(!r.randmod(2))return i.noMovement(e,t,n);var u=n.hero.location,l=e.position.bySubtracting(u).abs(),s=u.comparedTo(e.position);return s.x|=0,s.y|=0,l.x>=2||l.y>=2?o=i.convertToDirectionPoint(e.preferredDirection):r.randmod(2)?(o=s,o=i.evade(o,i.moveCheck(e.position,o,t,!1,n))):o=a.default(),i.moveCheck(e.position,o,t,!1,n)!==i.MoveCheckResult.Free&&(o=new r.Point(0,0),e.cooldown=r.randmod(3),e.preferredDirection=r.randmod(4)-1),i.canPerformMeleeAttack(o,e,u)?(i.performMeleeAttack(e,n),i.noMovement(e,t,n)):i.performMoveAfterDoorwayCheck(o,e,t,n)}},21663:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(17766),a=n(31560),i=n(83139),o=n(49257),u=n(99400),l=n(48261),s=n(27227);function d(e,t,n){c(e,new a.Point(0,0),!1,t,n)}function c(e,t,n,r,a){var i=a.hero.location.comparedTo(e.position);e.face?(t.x||t.y?(n&&(s.default(a,r,e.position.bySubtracting(t),-1),u.default(e.position.bySubtracting(t),r)),l.default(e.face,t)):(t=i,l.default(e.face,t)),u.default(e.position,r)):u.default(e.position,r)}t.default=function(e,t,n){if(e.cooldown)return e.cooldown--,d(e,t,n);if(!a.randmod(2))return d(e,t,n);var u,l=n.hero.location,s=e.position.bySubtracting(l).abs(),f=l.comparedTo(e.position);return u=s.x<2&&s.y<2&&a.randmod(2)?f:i.default(),u=o.evade(u,o.moveCheck(e.position,u,t,!1,n)),o.canPerformMeleeAttack(u,e,l)?function(e,t,n,a){return t.face.reference<0&&t.face.damage>=0&&e&&(o.playSound(a.assets.get(r.Sound,a.variant.sounds.Hurt),a),a.hero.changeHealth(-t.face.damage,a.settings)),d(t,n,a)}(!0,e,t,n):o.performMoveAfterDoorwayCheck(u,e,t,n,c)}},19952:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(17766),a=n(83139),i=n(49257);t.default=function(e,t,n){if(e.cooldown)return e.cooldown--,i.noMovement(e,t,n);var o=n.metronome.tickCount;if(o%3)return i.noMovement(e,t,n);e.currentActionFrame||(e.currentActionFrame=o%10?0:1);var u,l=n.hero.location,s=e.position.bySubtracting(l).abs(),d=l.comparedTo(e.position),c=d.byScalingBy(-1);return u=e.currentActionFrame?d:c,s.x<6&&s.y<6&&(u=a.default()),u=i.evade(u,i.moveCheck(e.position,u,t,!1,n)),i.canPerformMeleeAttack(u,e,l)?(e.face.reference<0&&e.face.damage>=0&&(o%3||i.playSound(n.assets.get(r.Sound,n.variant.sounds.Hurt),n),n.hero.changeHealth(-e.face.damage,n.settings)),e.currentActionFrame++,e.currentActionFrame%=5,i.noMovement(e,t,n)):i.performMoveAfterDoorwayCheck(u,e,t,n)}},81984:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(31560),a=n(49257);t.default=function(e,t,n){if(e.cooldown)return e.cooldown--,a.noMovement(e,t,n);if(!r.randmod(2))return a.noMovement(e,t,n);var i,o=n.hero.location,u=e.position.bySubtracting(o).abs(),l=o.comparedTo(e.position);return u.x>=2||u.y>=2?(i=a.convertToDirectionPoint(e.preferredDirection),a.moveCheck(e.position,i,t,!1,n)!==a.MoveCheckResult.Free&&(i=new r.Point(0,0),e.cooldown=r.randmod(8),e.preferredDirection=r.randmod(4)-1)):(i=l,i=a.evade(i,a.moveCheck(e.position,i,t,!1,n))),a.canPerformMeleeAttack(i,e,o)?(a.performMeleeAttack(e,n),a.noMovement(e,t,n)):a.performMoveAfterDoorwayCheck(i,e,t,n)}},79399:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(31560),a=n(49257);t.default=function(e,t,n){var i=n.metronome.tickCount;if(e.cooldown)return e.cooldown--,a.noMovement(e,t,n);if(a.even(i))return a.noMovement(e,t,n);var o=a.convertToDirectionPoint(e.preferredDirection),u=n.hero.location;return a.moveCheck(e.position,o,t,!1,n)!==a.MoveCheckResult.Free&&(o=new r.Point(0,0),e.cooldown=r.randmod(3),e.preferredDirection=r.randmod(4)-1),a.canPerformMeleeAttack(o,e,u)?(a.performMeleeAttackIfUnarmed(!0,e,n),a.noMovement(e,t,n)):a.performMoveAfterDoorwayCheck(o,e,t,n)}},76500:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.MutableHotspot=t.MutableMonster=t.MutableZone=t.MutablePuzzle=t.MutableAction=t.MutableTile=t.MutableChar=void 0;var r=n(37650);t.MutableAction=r.default;var a=n(96452);t.MutableChar=a.default;var i=n(88979);t.MutableHotspot=i.default;var o=n(27329);t.MutableMonster=o.default;var u=n(20865);t.MutablePuzzle=u.default;var l=n(92535);t.MutableTile=l.default;var s=n(8957);t.MutableZone=s.default},37650:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244));function d(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0});var c=function(e){(0,u.default)(n,e);var t=d(n);function n(e){var r;return(0,i.default)(this,n),r=t.call(this),e?(r._id=e.id,r._zone=e.zone,r._conditions=e.conditions,r._instructions=e.instructions,r._name=e.name,r):(0,l.default)(r)}return(0,o.default)(n,[{key:"id",get:function(){return this._id},set:function(e){this._id=e}},{key:"name",get:function(){return this._name},set:function(e){this._name=e}},{key:"conditions",get:function(){return this._conditions},set:function(e){this._conditions=e}},{key:"instructions",get:function(){return this._instructions},set:function(e){this._instructions=e}},{key:"zone",get:function(){return this._zone},set:function(e){this._zone=e}}]),n}(n(17766).Action);t.default=c},96452:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244));function d(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0});var c=function(e){(0,u.default)(n,e);var t=d(n);function n(e){var r;return(0,i.default)(this,n),r=t.call(this),e?(r._id=e.id,r._name=e.name,r._frames=e.frames,r._type=e.type,r._movementType=e.movementType,r._garbage1=e.garbage1,r._garbage2=e.garbage2,r._reference=e.reference,r._damage=e.damage,r._health=e.health,r):(0,l.default)(r)}return(0,o.default)(n,[{key:"id",get:function(){return this._id},set:function(e){this._id=e}},{key:"name",get:function(){return this._name},set:function(e){this._name=e}},{key:"frames",get:function(){return this._frames},set:function(e){this._frames=e}},{key:"type",get:function(){return this._type},set:function(e){this._type=e}},{key:"movementType",get:function(){return this._movementType},set:function(e){this._movementType=e}},{key:"garbage1",get:function(){return this._garbage1},set:function(e){this._garbage1=e}},{key:"garbage2",get:function(){return this._garbage2},set:function(e){this._garbage2=e}},{key:"damage",get:function(){return this._damage},set:function(e){this._damage=e}},{key:"health",get:function(){return this._health},set:function(e){this._health=e}},{key:"reference",get:function(){return this._reference},set:function(e){this._reference=e}}]),n}(n(17766).Char);t.default=c},88979:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244));function d(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0});var c=n(17766),f=n(31560),h=function(e){(0,u.default)(n,e);var t=d(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return(0,o.default)(n,[{key:"location",get:function(){return new f.Point(this.x,this.y)},set:function(e){this.x=e.x,this.y=e.y}}]),n}(c.Hotspot);t.default=h},27329:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244));function d(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0});var c=function(e){(0,u.default)(n,e);var t=d(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return(0,o.default)(n,[{key:"id",get:function(){return this._id},set:function(e){this._id=e}},{key:"position",get:function(){return this._position},set:function(e){this._position=e}},{key:"loot",get:function(){return this._loot},set:function(e){this._loot=e}},{key:"dropsLoot",get:function(){return this._dropsLoot},set:function(e){this._dropsLoot=e}},{key:"waypoints",get:function(){return this._waypoints},set:function(e){this._waypoints=e}}]),n}(n(17766).Monster);t.default=c},20865:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244));function d(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0});var c=function(e){(0,u.default)(n,e);var t=d(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return(0,o.default)(n,[{key:"id",get:function(){return this._id},set:function(e){this._id=e}},{key:"item1",get:function(){return this._item1},set:function(e){this._item1=e}},{key:"item2",get:function(){return this._item2},set:function(e){this._item2=e}},{key:"strings",get:function(){return this._strings},set:function(e){this._strings=e}},{key:"name",get:function(){return this._name},set:function(e){this._name=e}},{key:"type",get:function(){return this._type},set:function(e){this._type=e}},{key:"unknown1",get:function(){return this._unknown1},set:function(e){this._unknown1=e}},{key:"unknown2",get:function(){return this._unknown2},set:function(e){this._unknown2=e}},{key:"unknown3",get:function(){return this._unknown3},set:function(e){this._unknown3=e}}]),n}(n(17766).Puzzle);t.default=c},92535:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244));function d(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0});var c=function(e){(0,u.default)(n,e);var t=d(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return(0,o.default)(n,[{key:"id",get:function(){return this._id},set:function(e){this._id=e}},{key:"name",get:function(){return this._name},set:function(e){this._name=e}},{key:"attributes",get:function(){return this._attributes},set:function(e){this._attributes=e}},{key:"imageData",get:function(){return this._imageData},set:function(e){this._imageData=e}}]),n}(n(17766).Tile);t.default=c},8957:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244));function d(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0});var c=function(e){(0,u.default)(n,e);var t=d(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return(0,o.default)(n,[{key:"monsters",get:function(){return this._monsters},set:function(e){this._monsters=e}},{key:"id",get:function(){return this._id},set:function(e){this._id=e}},{key:"name",get:function(){return this._name},set:function(e){this._name=e}},{key:"planet",get:function(){return this._planet},set:function(e){this._planet=e}},{key:"size",get:function(){return this._size},set:function(e){this._size=e}},{key:"type",get:function(){return this._type},set:function(e){this._type=e}},{key:"tileIDs",get:function(){return this._tileIDs},set:function(e){this._tileIDs=e}},{key:"hotspots",get:function(){return this._hotspots},set:function(e){this._hotspots=e}},{key:"tileStore",get:function(){return this._tileStore},set:function(e){this._tileStore=e}},{key:"zoneStore",get:function(){return this._zoneStore},set:function(e){this._zoneStore=e}},{key:"goalItems",get:function(){return this._goalItems},set:function(e){this._goalItems=e}},{key:"requiredItems",get:function(){return this._requiredItems},set:function(e){this._requiredItems=e}},{key:"providedItems",get:function(){return this._providedItems},set:function(e){this._providedItems=e}},{key:"npcs",get:function(){return this._npcs},set:function(e){this._npcs=e}},{key:"izx4Unknown",get:function(){return this._izx4Unknown},set:function(e){this._izx4Unknown=e}},{key:"izaxUnknown",get:function(){return this._izaxUnknown},set:function(e){this._izaxUnknown=e}},{key:"actions",get:function(){return this._actions},set:function(e){this._actions=e}}]),n}(n(17766).Zone);t.default=c},41547:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o=function(){function e(){(0,a.default)(this,e),this.instructionPointer=0,this.enabled=!0,this._zone=null,this._name="",this._id=-1,this._conditions=[],this._instructions=[]}return(0,i.default)(e,[{key:"zone",get:function(){return this._zone}},{key:"name",get:function(){return this._name}},{key:"id",get:function(){return this._id}},{key:"conditions",get:function(){return this._conditions}},{key:"instructions",get:function(){return this._instructions}}]),e}();t.default=o},13615:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.CharFrameEntry=void 0,function(e){e[e.Up=0]="Up",e[e.Down=1]="Down",e[e.ExtensionUp=2]="ExtensionUp",e[e.Left=3]="Left",e[e.ExtensionDown=4]="ExtensionDown",e[e.ExtensionLeft=5]="ExtensionLeft",e[e.Right=6]="Right",e[e.ExtensionRight=7]="ExtensionRight"}(t.CharFrameEntry||(t.CharFrameEntry={}))},79595:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o=n(13615),u=function(){function e(t){(0,a.default)(this,e),this._tiles=t}return(0,i.default)(e,[{key:"tiles",get:function(){return this._tiles}},{key:"up",get:function(){return this._tiles[o.CharFrameEntry.Up]}},{key:"down",get:function(){return this._tiles[o.CharFrameEntry.Down]}},{key:"extensionUp",get:function(){return this._tiles[o.CharFrameEntry.ExtensionUp]}},{key:"left",get:function(){return this._tiles[o.CharFrameEntry.Left]}},{key:"extensionDown",get:function(){return this._tiles[o.CharFrameEntry.ExtensionDown]}},{key:"extensionLeft",get:function(){return this._tiles[o.CharFrameEntry.ExtensionLeft]}},{key:"right",get:function(){return this._tiles[o.CharFrameEntry.Right]}},{key:"extensionRight",get:function(){return this._tiles[o.CharFrameEntry.ExtensionRight]}}]),e}();t.default=u},73925:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583)),o=r(n(68748)),u=r(n(75356));(0,o.default)(t,"__esModule",{value:!0});var l=function(){function e(){(0,a.default)(this,e)}return(0,i.default)(e,[{key:"rawValue",get:function(){var t;return(0,u.default)(t=e.knownTypes).call(t,this)}},{key:"name",get:function(){switch(this){case e.None:return"None";case e.Unspecific1:return"Unspecific1";case e.Unspecific2:return"Unspecific2";case e.Unspecific3:return"Unspecific3";case e.Sit:return"Sit";case e.Unspecific4:return"Unspecific4";case e.Unspecific5:return"Unspecific5";case e.Droid:return"Droid";case e.Wander:return"Wander";case e.Patrol:return"Patrol";case e.Scaredy:return"Scaredy";case e.Animation:return"Animation";case e.UnknownIndyOnly:return"Unknown (Indy)";default:return"None"}}},{key:"toString",value:function(){return"CharMovementType{".concat(this.name,"}")}}],[{key:"isMovementType",value:function(t){return void 0!==e.knownTypes[t]}},{key:"fromNumber",value:function(t){if(!this.isMovementType(t))throw RangeError("Invalid movement type ".concat(t," specified!"));return e.knownTypes[t]}}]),e}();l.None=new l,l.Unspecific1=new l,l.Unspecific2=new l,l.Unspecific3=new l,l.Sit=new l,l.Unspecific4=new l,l.Unspecific5=new l,l.Droid=new l,l.Wander=new l,l.Patrol=new l,l.Scaredy=new l,l.Animation=new l,l.UnknownIndyOnly=new l,l.knownTypes=[l.None,l.Unspecific1,l.Unspecific2,l.Unspecific3,l.Sit,l.UnknownIndyOnly,l.Unspecific4,l.Unspecific5,l.Droid,l.Wander,l.Patrol,l.Scaredy,l.Animation],t.default=l},86071:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583)),o=r(n(68748)),u=r(n(75356));(0,o.default)(t,"__esModule",{value:!0});var l=function(){function e(){(0,a.default)(this,e)}return(0,i.default)(e,[{key:"rawValue",get:function(){var t;return(0,u.default)(t=e.knownTypes).call(t,this)}},{key:"name",get:function(){switch(this){case e.Hero:return"Hero";case e.Enemy:return"Enemy";case e.Weapon:return"Weapon";default:console.assert(!1,"Invalid char type encountered")}}},{key:"toString",value:function(){return"CharType{".concat(this.name,"}")}}],[{key:"isType",value:function(t){return void 0!==e.knownTypes[t]}},{key:"fromNumber",value:function(t){if(!this.isType(t))throw RangeError("Invalid zone type ".concat(t," specified!"));return e.knownTypes[t]}}]),e}();l.Hero=new l,l.Enemy=new l,l.Weapon=new l,l.knownTypes=[void 0,l.Hero,l.Enemy,void 0,l.Weapon],t.default=l},21634:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o=n(86071),u=n(79595),l=n(13615),s=n(73925),d=n(31560),c=function(){function e(){(0,a.default)(this,e),this._name=null,this._type=null,this._garbage1=null,this._garbage2=null,this._reference=null,this._health=null,this._damage=null}return(0,i.default)(e,[{key:"id",get:function(){return this._id}},{key:"frames",get:function(){return this._frames}},{key:"name",get:function(){return this._name}},{key:"type",get:function(){return this._type}},{key:"attackDuration",get:function(){return 4}},{key:"getFace",value:function(e,t){this.isHero()?t%=3:t=1+t%2;var n=null,r=this._frames[t];if(!r)return null;switch(d.Direction.Confine(e)){case d.Direction.NorthEast:case d.Direction.NorthWest:case d.Direction.North:n=r.up;break;case d.Direction.SouthEast:case d.Direction.SouthWest:case d.Direction.South:n=r.down;break;case d.Direction.East:n=r.right;break;case d.Direction.West:n=r.left}return n}},{key:"isHero",value:function(){return this.type===o.default.Hero}},{key:"isEnemy",value:function(){return this.type===o.default.Enemy}},{key:"isWeapon",value:function(){return this.type===o.default.Weapon}},{key:"movementType",get:function(){return this._movementType}},{key:"garbage1",get:function(){return this._garbage1}},{key:"garbage2",get:function(){return this._garbage2}},{key:"damage",get:function(){return this._damage}},{key:"health",get:function(){return this._health}},{key:"reference",get:function(){return this._reference}},{key:"getWeaponIcon",value:function(){return this.isWeapon()?this.frames[0].tiles[l.CharFrameEntry.ExtensionRight]:null}}]),e}();c.Frame=u.default,c.FrameEntry=l.CharFrameEntry,c.Type=o.default,c.MovementType=s.default,t.default=c},28608:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583)),o=r(n(68748)),u=r(n(75356));(0,o.default)(t,"__esModule",{value:!0});var l=function(){function e(){(0,a.default)(this,e)}return(0,i.default)(e,[{key:"rawValue",get:function(){var t;return(0,u.default)(t=e.knownTypes).call(t,this)}},{key:"name",get:function(){switch(this){case e.DropQuestItem:return"DropQuestItem";case e.SpawnLocation:return"SpawnLocation";case e.DropUniqueWeapon:return"DropUniqueWeapon";case e.VehicleTo:return"VehicleTo";case e.VehicleBack:return"VehicleBack";case e.DropMap:return"DropMap";case e.DropItem:return"DropItem";case e.NPC:return"NPC";case e.DropWeapon:return"DropWeapon";case e.DoorIn:return"DoorIn";case e.DoorOut:return"DoorOut";case e.Unused:return"Unused";case e.Lock:return"Lock";case e.Teleporter:return"Teleporter";case e.ShipToPlanet:return"ShipToPlanet";case e.ShipFromPlanet:return"ShipFromPlanet";default:return"unknown"}}},{key:"canHoldItem",value:function(){switch(this){case e.DropItem:case e.NPC:case e.DropWeapon:return!0;default:return!1}}},{key:"toString",value:function(){return"HotspotType{".concat(this.name,"}")}}],[{key:"isHotspotType",value:function(t){return t>=0&&t<e.knownTypes.length}},{key:"fromNumber",value:function(t){if(!e.isHotspotType(t))throw"Value ".concat(t," does not specify a valid hotspot type!");return e.knownTypes[t]}}]),e}();l.DropQuestItem=new l,l.SpawnLocation=new l,l.DropUniqueWeapon=new l,l.VehicleTo=new l,l.VehicleBack=new l,l.DropMap=new l,l.DropItem=new l,l.NPC=new l,l.DropWeapon=new l,l.DoorIn=new l,l.DoorOut=new l,l.Unused=new l,l.Lock=new l,l.Teleporter=new l,l.ShipToPlanet=new l,l.ShipFromPlanet=new l,l.knownTypes=[l.DropQuestItem,l.SpawnLocation,l.DropUniqueWeapon,l.VehicleTo,l.VehicleBack,l.DropMap,l.DropItem,l.NPC,l.DropWeapon,l.DoorIn,l.DoorOut,l.Unused,l.Lock,l.Teleporter,l.ShipToPlanet,l.ShipFromPlanet],t.default=l},28732:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o=n(31560),u=n(28608),l=function(){function e(){(0,a.default)(this,e),this.id=0,this.x=-1,this.y=-1,this.enabled=!1,this.arg=-1,this.type=null}return(0,i.default)(e,[{key:"location",get:function(){return new o.Point(this.x,this.y)}}]),e}();l.Type=u.default,t.default=l},17766:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.Sound=t.Monster=t.Hotspot=t.Zone=t.Action=t.Tile=t.Puzzle=t.Char=void 0;var r=n(41547);t.Action=r.default;var a=n(21634);t.Char=a.default;var i=n(28732);t.Hotspot=i.default;var o=n(17959);t.Monster=o.default;var u=n(180);t.Puzzle=u.default;var l=n(84349);t.Sound=l.default;var s=n(44887);t.Tile=s.default;var d=n(19384);t.Zone=d.default},17959:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583)),o=r(n(68748)),u=r(n(20778));(0,o.default)(t,"__esModule",{value:!0});var l=n(21634),s=n(31560),d=n(19384),c=n(17725),f={_id:-1,enabled:!0,face:null,_position:null,_loot:-1,_dropsLoot:!1,_waypoints:[],_damageTaken:0,field10:0,bulletX:0,bulletY:0,currentFrame:0,flag18:!1,flag1c:!1,flag20:!1,cooldown:0,hasItem:!1,flag2c:!1,preferredDirection:1,field32:0,flag34:!1,directionX:0,directionY:0,bulletOffset:0,facingDirection:l.default.FrameEntry.Up,field60:0,field62:0,currentActionFrame:0},h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f;(0,a.default)(this,e),(0,u.default)(this,f,t)}return(0,i.default)(e,[{key:"id",get:function(){return this._id}},{key:"loot",get:function(){return this._loot}},{key:"dropsLoot",get:function(){return this._dropsLoot}},{key:"waypoints",get:function(){return this._waypoints}},{key:"position",get:function(){return this._position},set:function(e){console.assert(e.z===d.default.Layer.Object,"Monsters must be placed on object layer!"),this._position=e}},{key:"alive",get:function(){return this.face&&(!this._damageTaken||this._damageTaken<this.face.health)}},{key:"damageTaken",get:function(){return this._damageTaken},set:function(e){var t=this.face?this.face.health:1/0;this._damageTaken+=e,this._damageTaken=c.min(this._damageTaken,t)}},{key:"x",get:function(){return this.position.x},set:function(e){this.position.x=e}},{key:"y",get:function(){return this.position.y},set:function(e){this.position.y=e}},{key:"direction",get:function(){return new s.Point(this.directionX,this.directionY)},set:function(e){this.directionX=e.x,this.directionY=e.y}},{key:"bullet",get:function(){return new s.Point(this.bulletX,this.bulletY)},set:function(e){this.bulletX=e.x,this.bulletY=e.y}}]),e}();t.default=h},33565:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583)),o=r(n(68748)),u=r(n(75356));(0,o.default)(t,"__esModule",{value:!0});var l=function(){function e(){(0,a.default)(this,e)}return(0,i.default)(e,[{key:"rawValue",get:function(){var t;return this===e.Disabled||this===e.None?-1:(0,u.default)(t=e.knownTypes).call(t,this)}},{key:"name",get:function(){switch(this){case e.Use:return"Use";case e.Trade:return"Trade";case e.Goal:return"Goal";case e.End:return"End";case e.U4:return"U4";case e.None:return"None"}}},{key:"toString",value:function(){return"PuzzleType{".concat(this.name,"}")}}],[{key:"isPuzzleType",value:function(t){return-1===t||65535===t||0<=t&&t<e.knownTypes.length}},{key:"fromNumber",value:function(t){if(!e.isPuzzleType(t))throw new RangeError("Value ".concat(t," does not specify a puzzle type"));return-1===t||65535===t?e.Disabled:this.knownTypes[t]}}]),e}();l.Use=new l,l.Trade=new l,l.Goal=new l,l.End=new l,l.U4=new l,l.None=new l,l.Disabled=new l,l.knownTypes=[l.Use,l.Trade,l.Goal,l.End,l.U4],t.default=l},180:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o=n(33565),u=function(){function e(){(0,a.default)(this,e),this._id=-1,this._item1=null,this._item2=null,this._strings=["","","","",""],this._name="",this._type=null,this._unknown1=null,this._unknown2=null,this._unknown3=null}return(0,i.default)(e,[{key:"id",get:function(){return this._id}},{key:"item1",get:function(){return this._item1}},{key:"item2",get:function(){return this._item2}},{key:"strings",get:function(){return this._strings}},{key:"name",get:function(){return this._name}},{key:"type",get:function(){return this._type}},{key:"unknown1",get:function(){return this._unknown1}},{key:"unknown2",get:function(){return this._unknown2}},{key:"unknown3",get:function(){return this._unknown3}}]),e}();u.Type=o.default,t.default=u},84349:(e,t,n)=>{var r=n(38468),a=r(n(40361));(0,r(n(68748)).default)(t,"__esModule",{value:!0});t.default=function e(t,n){(0,a.default)(this,e),this.id=t,this.file=n}},4707:(e,t,n)=>{var r;(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),function(e){e[e.Transparent=1]="Transparent",e[e.Floor=2]="Floor",e[e.Object=4]="Object",e[e.Draggable=8]="Draggable",e[e.Roof=16]="Roof",e[e.Locator=32]="Locator",e[e.Weapon=64]="Weapon",e[e.Item=128]="Item",e[e.Character=256]="Character",e[e.Doorway=65538]="Doorway",e[e.Town=131104]="Town",e[e.PuzzleUnsolved=262176]="PuzzleUnsolved",e[e.PuzzleSolved=524320]="PuzzleSolved",e[e.TravelUnsolved=1048608]="TravelUnsolved",e[e.TravelSolved=2097184]="TravelSolved",e[e.NorthUnsolved=4194336]="NorthUnsolved",e[e.SouthUnsolved=8388640]="SouthUnsolved",e[e.WestUnsolved=16777248]="WestUnsolved",e[e.EastUnsolved=33554464]="EastUnsolved",e[e.NorthSolved=67108896]="NorthSolved",e[e.SouthSolved=134217760]="SouthSolved",e[e.WestSolved=268435488]="WestSolved",e[e.EastSolved=536870944]="EastSolved",e[e.Goal=1073741856]="Goal",e[e.YouAreHere=-2147483616]="YouAreHere",e[e.BlasterLow=65600]="BlasterLow",e[e.BlasterHigh=131136]="BlasterHigh",e[e.Lightsaber=262208]="Lightsaber",e[e.TheForce=524352]="TheForce",e[e.Map=1048704]="Map",e[e.Keycard=65664]="Keycard",e[e.Tool=131200]="Tool",e[e.Part=262272]="Part",e[e.Valuable=524416]="Valuable",e[e.Edible=4194432]="Edible",e[e.Hero=65792]="Hero",e[e.Enemy=131328]="Enemy",e[e.NPC=262400]="NPC"}(r||(r={})),t.default=r},44887:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583));(0,r(n(68748)).default)(t,"__esModule",{value:!0}),t.SIZE=t.HEIGHT=t.WIDTH=void 0;var o=n(4707);t.WIDTH=32,t.HEIGHT=32,t.SIZE=t.WIDTH*t.HEIGHT;var u=function(){function e(){(0,a.default)(this,e),this._id=0,this._name="",this._attributes=0}return(0,i.default)(e,[{key:"isOpaque",value:function(){return!this.hasAttributes(e.Attributes.Transparent)}},{key:"hasAttributes",value:function(e){return(this._attributes&e)===e}},{key:"id",get:function(){return this._id}},{key:"name",get:function(){return this._name}},{key:"attributes",get:function(){return this._attributes}},{key:"imageData",get:function(){return this._imageData}}]),e}();u.WIDTH=t.WIDTH,u.HEIGHT=t.HEIGHT,u.SIZE=t.SIZE,u.Attributes=o.default,t.default=u},20221:(e,t,n)=>{var r;(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),function(e){e[e.Floor=0]="Floor",e[e.Object=1]="Object",e[e.Roof=2]="Roof"}(r||(r={})),t.default=r},90047:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583)),o=r(n(68748)),u=r(n(75356));(0,o.default)(t,"__esModule",{value:!0});var l=function(){function e(){(0,a.default)(this,e)}return(0,i.default)(e,[{key:"rawValue",get:function(){var t;return(0,u.default)(t=e.knownPlanets).call(t,this)}},{key:"name",get:function(){switch(this){case e.None:return"None";case e.Tatooine:return"Tatooine";case e.Hoth:return"Hoth";case e.Endor:return"Endor";case e.Dagobah:return"Dagobah";case e.Load:return"Load";default:console.assert(!1,"Unknown planet encountered!",this)}}}],[{key:"isPlanet",value:function(t){return-1===t||t>=0&&t<e.knownPlanets.length&&void 0!==e.knownPlanets[t]}},{key:"fromNumber",value:function(t){return console.assert(this.isPlanet(t),"Invalid planet ".concat(t," specified!")),-1===t?e.Load:e.knownPlanets[t]}}]),e}();l.None=new l,l.Tatooine=new l,l.Hoth=new l,l.Endor=new l,l.Dagobah=new l,l.Load=new l,l.knownPlanets=[l.None,l.Tatooine,l.Hoth,l.Endor,void 0,l.Dagobah],t.default=l},30530:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583)),o=r(n(68748)),u=r(n(75356));(0,o.default)(t,"__esModule",{value:!0});var l=n(33565),s=function(){function e(){(0,a.default)(this,e)}return(0,i.default)(e,[{key:"rawValue",get:function(){var t;return this===e.PlaceholderForEndPuzzle?9999:(0,u.default)(t=e.knownTypes).call(t,this)}},{key:"name",get:function(){switch(this){case e.None:return"None";case e.Empty:return"Empty";case e.BlockadeNorth:return"Blockade North";case e.BlockadeSouth:return"Blockade South";case e.BlockadeEast:return"Blockade East";case e.BlockadeWest:return"Blockade West";case e.TravelStart:return"Travel Start";case e.TravelEnd:return"Travel End";case e.Room:return"Room";case e.Load:return"Load";case e.Goal:return"Goal";case e.Town:return"Town";case e.Win:return"Win";case e.Lose:return"Lose";case e.Trade:return"Trade";case e.Use:return"Use";case e.Find:return"Find";case e.FindUniqueWeapon:return"Find Unique Weapon";case e.UnknownIndyOnly:return"Unknown (indy)";default:return"Unknown"}}},{key:"isBlockadeType",value:function(){switch(this){case e.BlockadeNorth:case e.BlockadeEast:case e.BlockadeWest:case e.BlockadeSouth:return!0;default:return!1}}},{key:"toPuzzleType",value:function(){switch(this){case e.Use:return l.default.Use;case e.PlaceholderForEndPuzzle:return l.default.End;case e.Goal:return l.default.Goal;case e.Trade:return l.default.Trade;default:throw"Zone type ".concat(this," does not match any puzzle type!")}}},{key:"toString",value:function(){return"ZoneType{".concat(this.name.split(" ").join(""),"}")}}],[{key:"isZoneType",value:function(t){return t>=0&&t<e.knownTypes.length||9999===t}},{key:"fromNumber",value:function(t){if(!this.isZoneType(t))throw RangeError("Invalid zone type ".concat(t," specified!"));return 9999===t?e.PlaceholderForEndPuzzle:e.knownTypes[t]}}]),e}();s.None=new s,s.Empty=new s,s.BlockadeNorth=new s,s.BlockadeSouth=new s,s.BlockadeEast=new s,s.BlockadeWest=new s,s.UnknownIndyOnly=new s,s.TravelStart=new s,s.TravelEnd=new s,s.Room=new s,s.Load=new s,s.Goal=new s,s.Town=new s,s.Win=new s,s.Lose=new s,s.Trade=new s,s.Use=new s,s.Find=new s,s.FindUniqueWeapon=new s,s.PlaceholderForEndPuzzle=new s,s.knownTypes=[s.None,s.Empty,s.BlockadeNorth,s.BlockadeSouth,s.BlockadeEast,s.BlockadeWest,s.TravelStart,s.TravelEnd,s.Room,s.Load,s.Goal,s.Town,s.UnknownIndyOnly,s.Win,s.Lose,s.Trade,s.Use,s.Find,s.FindUniqueWeapon],t.default=s},19384:(e,t,n)=>{var r=n(92915),a=n(69159),i=n(67986),o=n(13037),u=n(29689),l=n(38468),s=l(n(88225)),d=l(n(40361)),c=l(n(7583)),f=l(n(68748)),h=l(n(68190)),p=l(n(42601));function v(e,t){var n=void 0!==i&&o(e)||e["@@iterator"];if(!n){if(u(e)||(n=function(e,t){var n;if(!e)return;if("string"==typeof e)return y(e,t);var i=r(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return a(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return y(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var l=0,s=function(){};return{s,n:function(){return l>=e.length?{done:!0}:{done:!1,value:e[l++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var d,c=!0,f=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){f=!0,d=e},f:function(){try{c||null==n.return||n.return()}finally{if(f)throw d}}}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}(0,f.default)(t,"__esModule",{value:!0});var m=n(28732),g=n(31560),_=n(30530),w=n(90047),k=n(20221),b=n(92540),S=function(){function e(){(0,d.default)(this,e),this.visited=!1,this.actionsInitialized=!1,this.counter=0,this.random=0,this.sectorCounter=0,this._monsters=[],this._id=-1,this._name="",this._planet=w.default.None,this._size=null,this._type=null,this._tileIDs=new Int16Array(0),this._hotspots=[],this._tileStore=null,this._zoneStore=null,this._goalItems=[],this._requiredItems=[],this._providedItems=[],this._npcs=[],this._izx4Unknown=0,this._izaxUnknown=0,this._actions=[],this.doorInLocation=new g.Point(0,0)}return(0,c.default)(e,[{key:"doors",get:function(){var e;return(0,h.default)(e=this._hotspots).call(e,(function(e){return e.type===m.default.Type.DoorIn&&-1!==e.arg}))}},{key:"getTileID",value:function(t,n,r){return t<0||t>=this._size.width||n<0||n>=this._size.height?null:this.tileIDs[e.LAYERS*(n*this._size.width+t)+r]}},{key:"getTile",value:function(e,t,n){var r=this.normalizeInput(e,t,n);if(e=r.x,t=r.y,n=r.z,this.bounds.contains(new g.Point(e,t))){var a=this.getTileID(e,t,n);return-1===a||65535===a||a>=this._tileStore.length?null:this._tileStore[a]}}},{key:"setTile",value:function(t,n,r,a){var i=this.normalizeInput(n,r,a);if(n=i.x,r=i.y,a=i.z,!this.bounds.contains(new g.Point(n,r)))return console.warn("Missing bounds check"),void console.trace();var o=e.LAYERS*(r*this._size.width+n)+a;this.tileIDs[o]=null===t?-1:t.id}},{key:"placeWalkable",value:function(e,t){var n=this.normalizeInput(e,t);return e=n.x,t=n.y,!this.getTile(e,t,1)}},{key:"normalizeInput",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return"object"===(0,s.default)(e)?e:{x:e,y:t,z:n}}},{key:"leadsTo",value:function(t,n){if(t===this)return!0;var r,a=v(this._hotspots);try{for(a.s();!(r=a.n()).done;){var i=r.value;if(i.type===m.default.Type.DoorIn&&-1!==i.arg)if(n.get(e,i.arg,b.NullIfMissing).leadsTo(t,n))return!0}}catch(e){a.e(e)}finally{a.f()}return!1}},{key:"isLoadingZone",value:function(){return this._type===_.default.Load}},{key:"initialize",value:function(){this.placeMonsters(),this.layDownHotspotItems()}},{key:"placeMonsters",value:function(){var e,t,n=this;(0,p.default)(e=(0,h.default)(t=this.monsters).call(t,(function(e){return e.enabled}))).call(e,(function(e){if(null===n.getTile(e.x,e.y,k.default.Object)){var t=e.face.frames[0].down;n.setTile(t,e.x,e.y,k.default.Object)}}))}},{key:"layDownHotspotItems",value:function(){var e,t,n=this;(0,p.default)(e=(0,h.default)(t=this.hotspots).call(t,(function(e){return e.enabled}))).call(e,(function(e){switch(e.type){case m.default.Type.Unused:e.arg=12;case m.default.Type.DropQuestItem:case m.default.Type.SpawnLocation:case m.default.Type.DropUniqueWeapon:case m.default.Type.DropMap:case m.default.Type.DropItem:case m.default.Type.NPC:case m.default.Type.DropWeapon:if(e.arg<0)break;if(n.getTile(e.x,e.y,1))return;n.setTile({id:e.arg},e.x,e.y,1);break;case m.default.Type.DoorIn:if(e.arg<0)break;n._zoneStore[e.arg].layDownHotspotItems()}}))}},{key:"isRoom",value:function(){return 9===this._size.width}},{key:"hasTeleporter",get:function(){return this._type===_.default.Empty&&0!==this.hotspots.withType(m.default.Type.Teleporter).length}},{key:"bounds",get:function(){return new g.Rectangle(new g.Point(0,0),this._size)}},{key:"monsters",get:function(){return this._monsters}},{key:"id",get:function(){return this._id}},{key:"name",get:function(){return this._name}},{key:"planet",get:function(){return this._planet}},{key:"size",get:function(){return this._size}},{key:"type",get:function(){return this._type}},{key:"tileIDs",get:function(){return this._tileIDs}},{key:"hotspots",get:function(){return this._hotspots}},{key:"tileStore",get:function(){return this._tileStore}},{key:"zoneStore",get:function(){return this._zoneStore}},{key:"goalItems",get:function(){return this._goalItems}},{key:"requiredItems",get:function(){return this._requiredItems}},{key:"providedItems",get:function(){return this._providedItems}},{key:"npcs",get:function(){return this._npcs}},{key:"izx4Unknown",get:function(){return this._izx4Unknown}},{key:"izaxUnknown",get:function(){return this._izaxUnknown}},{key:"actions",get:function(){return this._actions}}]),e}();S.LAYERS=3,S.Type=_.default,S.Layer=k.default,S.Planet=w.default,t.default=S},35930:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.loadState=void 0;var r=n(31560),a={highScore:0,lastScore:0,gamesWon:0,gamesLost:0};t.loadState=function(){return a=r.persistent(a,"settings")},t.default=a},63487:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244)),d=a(n(46386)),c=a(n(68748)),f=a(n(92915));function h(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,c.default)(t,"__esModule",{value:!0});var p=n(17725),v=n(42053),y=n(2186),m=function(e){(0,u.default)(n,e);var t=h(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return(0,o.default)(n,[{key:"slice",value:function(e,t){var r=(0,f.default)(Uint32Array.prototype).call(this,e,t);return n.Create(r)}},{key:"toGIMP",value:function(e){return v.default(this,e)}},{key:"toAdobeColorTable",value:function(){return y.default(this)}}],[{key:"FromBGR8Buffer",value:function(e){var t=new Uint8Array(e);return this.FromBGR8(t)}},{key:"FromBGR8",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,n=p.floor(e.length/4),r=new Uint32Array(n);r[0]=e[0]<<16|e[1]<<8|e[2];for(var a=1;a<n;a++)r[a]=255<<24|e[a*t+0]<<16|e[a*t+1]<<8|e[a*t+2];return this.Create(r)}},{key:"FromRGB8",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,n=p.floor(e.length/4),r=new Uint32Array(n);r[0]=e[0]<<0|e[1]<<8|e[2]<<16;for(var a=1;a<n;a++)r[a]=255<<24|e[a*t+0]<<0|e[a*t+1]<<8|e[a*t+2]<<16;return this.Create(r)}},{key:"Create",value:function(e){return e.__proto__=n.prototype,e}}]),n}((0,d.default)(Uint32Array));t.default=m},22631:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(63487);t.default=r.default},2186:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(31560),a=n(17725);t.default=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e.length,i=new r.OutputStream(3*n+2+2),o=0;o<n;o++){var u=e[o];i.writeUint8(u>>16&255),i.writeUint8(u>>8&255),i.writeUint8(255&u)}return i.endianness=r.OutputStream.Endian.Big,i.writeUint16(a.floor(n/4)),i.writeUint16(t),new Uint8Array(i.buffer)}},42053:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(47053));(0,a.default)(t,"__esModule",{value:!0}),t.default=function(e,t){var n="";n+="GIMP Palette\n",n+="Name: ".concat(t)+"\n",n+="#\n";for(var r=0;r<e.length;r++){var a,o,u,l=e[r];n+=(0,i.default)(a=(0,i.default)(o=(0,i.default)(u="".concat(255&l," ")).call(u,l>>8&255," ")).call(o,l>>16&255)).call(a,0===r?" transparent":"")+"\n"}return n}},61334:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.Sprite=t.PaletteAnimation=t.ColorPalette=void 0;var r=n(22631);t.ColorPalette=r.default;var a=n(32115);t.PaletteAnimation=a.default;var i=n(31309);t.Sprite=i.default},32115:(e,t,n)=>{var r=n(38468),a=r(n(94433)),i=r(n(40361)),o=r(n(7583)),u=r(n(68748)),l=r(n(92915)),s=r(n(42601));(0,u.default)(t,"__esModule",{value:!0});var d=function(){function e(t,n,r){(0,i.default)(this,e),this.fastAnimations=n,this.slowAnimations=r,this._state=!0,this._original=t,this._current=(0,l.default)(t).call(t)}return(0,o.default)(e,[{key:"reset",value:function(){var e;this._current=(0,l.default)(e=this.original).call(e),this._state=!0}},{key:"step",value:function(){var e,t,n=this;(0,s.default)(e=this.fastAnimations).call(e,(function(e){var t=(0,a.default)(e,2),r=t[0],i=t[1];return n.cycle(r,i)})),(this._state=!this._state)||(0,s.default)(t=this.slowAnimations).call(t,(function(e){var t=(0,a.default)(e,2),r=t[0],i=t[1];return n.cycle(r,i)}))}},{key:"cycle",value:function(e,t){var n=t-1,r=this._current[e+n];do{this._current[e+n]=this._current[e+n-1]}while(--n);this._current[e]=r}},{key:"current",get:function(){return this._current}},{key:"original",get:function(){return this._original}}]),e}();t.default=d},31309:(e,t,n)=>{var r=n(38468),a=r(n(40361));(0,r(n(68748)).default)(t,"__esModule",{value:!0});t.default=function e(t,n,r){(0,a.default)(this,e),this.position=t,this.size=n,this.pixels=r}},84141:(e,t,n)=>{var r=n(92915),a=n(69159),i=n(67986),o=n(13037),u=n(29689),l=n(38468),s=l(n(40361)),d=l(n(7583)),c=l(n(68748)),f=l(n(42601));function h(e,t){var n=void 0!==i&&o(e)||e["@@iterator"];if(!n){if(u(e)||(n=function(e,t){var n;if(!e)return;if("string"==typeof e)return p(e,t);var i=r(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return a(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return p(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var l=0,s=function(){};return{s,n:function(){return l>=e.length?{done:!0}:{done:!1,value:e[l++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var d,c=!0,f=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){f=!0,d=e},f:function(){try{c||null==n.return||n.return()}finally{if(f)throw d}}}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}(0,c.default)(t,"__esModule",{value:!0});var v=n(17766),y=n(5318),m=n(92540),g=n(49257),_=function(){function e(){(0,s.default)(this,e)}return(0,d.default)(e,[{key:"render",value:function(e,t,n,r,a){var i,o,u,l=t.camera.offset,s=v.Tile.WIDTH,d=v.Tile.HEIGHT,c=v.Zone.LAYERS,p=-l.x,_=-l.y,w=new ImageData(9*s,9*d),k=new ArrayBuffer(w.data.length),b=new Uint8Array(k),S=new Uint32Array(k),I=function(e,t,n){var a,i,o=e.imageData,u=n*d*E+t*s;for(i=0;i<d;i++){for(a=0;a<s;a++)S[u+a]=r[o[i*s+a]];u+=E}},x=function(e,t,n,a,i){var o,u,l=n*E+t;for(u=0;u<i;u++){for(o=0;o<a;o++){var s=e[u*a+o];0!==s&&(S[l+o]=r[s])}l+=E}},T=function(e,t,n){x(e.imageData,t*s,n*d,s,d)},M=t.hero,E=9*s;for(u=0;u<c;u++){for(o=0;o<9;o++)for(i=0;i<9;i++){var C=e.getTile(i+p,o+_,u);C&&(C.isOpaque()?I(C,i,o):T(C,i,o))}if(1===u){if(M.visible){var A=M._appearance,D=M._actionFrames;M._attacking&&(A=M.weapon);var z=A.getFace(M._direction,D);if(z){var P=M.location.x+l.x,R=M.location.y+l.y;P>=0&&P<9&&R>=0&&R<9&&T(z,P,R)}}var L,F=h(e.monsters);try{for(F.s();!(L=F.n()).done;){var W=L.value;if(W.bulletOffset){var B=t.assets.get(v.Char,W.face.reference,m.NullIfMissing);if(B)T(g.findTileIdForCharFrameWithDirection(B.frames[0],W.direction),W.bulletX+l.x,W.bulletY+l.y)}}}catch(e){F.e(e)}finally{F.f()}(0,f.default)(a).call(a,(function(e){var t=e.position.x+l.x,n=e.position.y+l.y;console.assert(0<=t&&t<=9&&0<=n&&n<=9,"Sprites must be located on the zone."),x(e.pixels,t*s,n*d,e.size.width,e.size.height)}))}}w.data.set(b),n.renderImageData(w,0,0),!M.visible&&t.settings.drawHeroTile&&y.highlightHero(n,M.location,l),t.settings.drawHotspots&&y.highlightHotspots(n,e.hotspots,l),t.settings.drawMonsterState&&y.highlightMonsters(n,e.monsters,l)}}]),e}();t.default=_},83297:(e,t,n)=>{var r=n(63789),a=n(92915),i=n(69159),o=n(67986),u=n(13037),l=n(29689),s=n(38468),d=s(n(63789)),c=s(n(68748)),f=r.mark(y);function h(e,t){var n=void 0!==o&&u(e)||e["@@iterator"];if(!n){if(l(e)||(n=function(e,t){var n;if(!e)return;if("string"==typeof e)return p(e,t);var r=a(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return i(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return p(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,s=function(){};return{s,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var d,c=!0,f=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){f=!0,d=e},f:function(){try{c||null==n.return||n.return()}finally{if(f)throw d}}}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}(0,c.default)(t,"__esModule",{value:!0});var v=n(17766);function y(e,t){var n,r,a,i,o,u,l,s;return d.default.wrap((function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,e;case 2:n=h(e.hotspots),d.prev=3,n.s();case 5:if((r=n.n()).done){d.next=30;break}if(a=r.value,i=a.type,o=a.arg,i===v.Hotspot.Type.DoorIn){d.next=9;break}return d.abrupt("continue",28);case 9:if(!(o<0)){d.next=11;break}return d.abrupt("continue",28);case 11:u=h(y(t.get(v.Zone,o),t)),d.prev=12,u.s();case 14:if((l=u.n()).done){d.next=20;break}return s=l.value,d.next=18,s;case 18:d.next=14;break;case 20:d.next=25;break;case 22:d.prev=22,d.t0=d.catch(12),u.e(d.t0);case 25:return d.prev=25,u.f(),d.finish(25);case 28:d.next=5;break;case 30:d.next=35;break;case 32:d.prev=32,d.t1=d.catch(3),n.e(d.t1);case 35:return d.prev=35,n.f(),d.finish(35);case 38:case"end":return d.stop()}}),f,null,[[3,32,35,38],[12,22,25,28]])}t.default=y},488:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(46e3);t.default=function(e){var t=e.readCharacters(9);return t===r.Yoda.saveGameMagic?r.Yoda:t===r.Indy.saveGameMagic?r.Indy:null}},95451:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.SaveGameReader=t.SaveState=t.Reader=t.Writer=void 0;var r=n(26634);t.Reader=r.default;var a=n(45247);t.SaveGameReader=a.default;var i=n(90094);t.SaveState=i.default;var o=n(23992);t.Writer=o.default},38698:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244));function d(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0});var c=n(31560),f=n(17766),h=n(46e3),p=n(76500),v=n(45247),y=n(90094),m=n(21156),g=n(92540),_=function(e){(0,u.default)(n,e);var t=d(n);function n(e){return(0,i.default)(this,n),t.call(this,e,h.Indy)}return(0,o.default)(n,[{key:"read",value:function(e){return this._assets=e,this._doRead()}},{key:"_doRead",value:function(){var e=this._stream,t=65535&e.readUint32(),n=this.readPuzzles(e),r=this.readWorld(e,{start:0,end:10},{start:0,end:10}),a=this.readInventory(e),i=e.readUint16(),o=e.readUint16(),u=e.readUint16();e.readUint16();var l=e.readUint16(),s=e.readUint16();e.readInt16(),e.readInt16(),e.readInt16(),e.readInt16(),e.readInt16(),e.readInt16(),e.readInt16();var d=e.readInt16();console.assert(e.isAtEnd(),"Encountered ".concat(e.length-e.offset," unknown bytes at end of stream"));var p=new y.default;return p.type=h.Indy,p.planet=f.Zone.Planet.None,p.seed=t,p.puzzleIDs1=n,p.puzzleIDs2=null,p.inventoryIDs=a,p.onDagobah=!1,p.currentZoneID=i,p.positionOnZone=new c.Point(l,s),p.positionOnWorld=new c.Point(o,u),p.goalPuzzle=d,p.world=r,p.damageTaken=0,p.livesLost=0,p}},{key:"readSector",value:function(e,t,n){var r=this.readBool(e),a=this.readBool(e),i=this.readBool(e),o=e.readInt16(),u=e.readInt16(),l=e.readInt16(),s=e.readInt16(),d=e.readInt16();e.readInt16();var c=new m.default;return c.visited=r,c.solved1=a,c.solved2=i,c.zone=this._assets.get(f.Zone,o,g.NullIfMissing),c.puzzleIndex=u,c.requiredItem=this._assets.get(f.Tile,l,g.NullIfMissing),c.findItem=this._assets.get(f.Tile,s,g.NullIfMissing),c.npc=this._assets.get(f.Tile,d,g.NullIfMissing),c}},{key:"readHotspot",value:function(e,t){var n=0!==e.readUint16(),r=e.readInt16(),a=new p.MutableHotspot;return a.enabled=n,a.type=t.type,a.arg=r,a.x=t.x,a.y=t.y,a}},{key:"readMonster",value:function(e){var t=e.readInt16(),n=e.readInt16(),r=e.readInt16(),a=e.readInt16();e.readUint8Array(24);var i=new p.MutableMonster;return i.face=this._assets.get(f.Char,t,g.NullIfMissing),i.position=new c.Point(n,r,f.Zone.Layer.Object),i.damageTaken=a,i}},{key:"readInt",value:function(e){return e.readInt16()}}]),n}(v.default);t.default=_},26634:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583)),o=r(n(68748)),u=r(n(7401));(0,o.default)(t,"__esModule",{value:!0});var l=n(46e3),s=n(38698),d=n(9820),c=n(488),f=function(){function e(){(0,a.default)(this,e)}return(0,i.default)(e,null,[{key:"build",value:function(e){var t,n=c.default(e),r=this.buildReader(n,e);return{type:n,read:(0,u.default)(t=r.read).call(t,r)}}},{key:"buildReader",value:function(e,t){return e===l.Indy||e===l.IndyDemo?new s.default(t):e===l.Yoda||e===l.YodaDemo?new d.default(t):void 0}}]),e}();t.default=f},45247:(e,t,n)=>{var r=n(92915),a=n(69159),i=n(67986),o=n(13037),u=n(29689),l=n(38468),s=l(n(94433)),d=l(n(40361)),c=l(n(7583)),f=l(n(68748)),h=l(n(35983));function p(e,t){var n=void 0!==i&&o(e)||e["@@iterator"];if(!n){if(u(e)||(n=function(e,t){var n;if(!e)return;if("string"==typeof e)return v(e,t);var i=r(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return a(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return v(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var l=0,s=function(){};return{s,n:function(){return l>=e.length?{done:!0}:{done:!1,value:e[l++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var d,c=!0,f=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){f=!0,d=e},f:function(){try{c||null==n.return||n.return()}finally{if(f)throw d}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}(0,f.default)(t,"__esModule",{value:!0});var y=n(46e3),m=n(17766),g=n(31560),_=n(23754),w=function(){function e(t,n){(0,d.default)(this,e),this._stream=t,this._assets=null,this._type=n}return(0,c.default)(e,[{key:"readBool",value:function(e){return 0!==this.readInt(e)}},{key:"readWorldDetails",value:function(e){for(;;){var t=this.readInt(e);if(-1===this.readInt(e)||-1===t)break;var n=e.readInt16(),r=this.readBool(e);this.readRoom(e,n,r)}}},{key:"readRooms",value:function(e,t,n){for(var r=[],a=this._assets.get(m.Zone,t).hotspots,i=a.length,o=n;o<i;o++){n=o;var u=void 0,l=a[o];if(m.Hotspot.Type.DoorIn===l.type&&-1!==l.arg){u=l.arg;var d=e.readInt16(),c=this.readBool(e);console.assert(!d||d===u,"Expected door to lead to zone {} instead of {}",d,u),r.push([u,c]);break}}for(var f=0,h=r;f<h.length;f++){var p=(0,s.default)(h[f],2),v=p[0],y=p[1];this.readRoom(e,v,y)}n+1<i&&this.readRooms(e,t,n+1)}},{key:"readRoom",value:function(e,t,n){var r=this._assets.get(m.Zone,t);this.readZone(e,r,n),this.readRooms(e,t,0)}},{key:"readZone",value:function(e,t,n){if(n){t.counter=this.readInt(e),t.random=this.readInt(e);var r=this.readInt(e),a=this.readInt(e);if(t.doorInLocation=new g.Point(r,a),this._type===y.Yoda||this._type===y.YodaDemo){t.sectorCounter=e.readInt16();var i=e.readInt16();console.assert(i===t.planet.rawValue)}var o=t.size.width*t.size.height*m.Zone.LAYERS;t.tileIDs=e.readInt16Array(o)}t.visited=this.readBool(e)||n,this.readHotspots(e,t),n&&(this.readMonsters(e,t),this.readActions(e,t))}},{key:"readHotspots",value:function(e,t){var n,r=this,a=this.readInt(e);console.assert(a>=0),a!==t.hotspots.length&&(t.hotspots=Array.Repeat(new m.Hotspot,a)),t.hotspots=(0,h.default)(n=t.hotspots).call(n,(function(t){return r.readHotspot(e,t)}))}},{key:"readMonsters",value:function(e,t){var n=this.readInt(e);console.assert(n>=0),this._type!==y.Indy&&this._type!==y.IndyDemo||(t.monsters=new Array(n));for(var r=0;r<t.monsters.length;r++){var a=this.readMonster(e);a.id=r,t.monsters[r]=a}}},{key:"readActions",value:function(e,t){var n=this.readInt(e);console.assert(n>=0);var r,a=p(t.actions);try{for(a.s();!(r=a.n()).done;){r.value.enabled=!this.readBool(e)}}catch(e){a.e(e)}finally{a.f()}for(var i=t.actions.length;i<n;i++)i===t.actions.length&&console.log("Zone ".concat(t.id," has additional actions")),this.readInt(e)}},{key:"readInventory",value:function(e){var t=this.readInt(e);return t<0?new Int16Array([]):e.readInt16Array(t)}},{key:"readWorld",value:function(e,t,n){for(var r=new _.default(this._assets),a=n.start;a<n.end;a++)for(var i=t.start;i<t.end;i++){var o=this.readSector(e,i,a);r.replaceSector(i,a,o)}return this.readWorldDetails(e),r}},{key:"readPuzzles",value:function(e){var t=e.readUint16();return e.readInt16Array(t)}}]),e}();t.default=w},90094:(e,t,n)=>{var r=n(38468),a=r(n(40361));(0,r(n(68748)).default)(t,"__esModule",{value:!0});t.default=function e(){(0,a.default)(this,e)}},23992:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583)),o=r(n(68748)),u=r(n(68190)),l=r(n(42601));(0,o.default)(t,"__esModule",{value:!0});var s=n(17766),d=n(23754),c=function(){function e(t){(0,a.default)(this,e),this._assets=t}return(0,i.default)(e,[{key:"write",value:function(e,t){t.writeCharacters("YODASAV44"),t.writeUint32(e.seed),t.writeUint32(e.planet.rawValue),t.writeUint32(+e.onDagobah),t.writeUint16(e.puzzleIDs1.length),t.writeUint16Array(e.puzzleIDs1),t.writeUint16(e.puzzleIDs2.length),t.writeUint16Array(e.puzzleIDs2),this._writeDagobah(e.dagobah,t),this._writeWorld(e.world,t),t.writeInt32(e.inventoryIDs.length),t.writeInt16Array(e.inventoryIDs),t.writeInt16(e.currentZoneID),t.writeUint32(e.positionOnWorld.x),t.writeUint32(e.positionOnWorld.y),t.writeInt16(e.currentWeapon),-1!==e.currentWeapon&&t.writeInt16(e.currentAmmo),t.writeInt16(e.forceAmmo),t.writeInt16(e.blasterAmmo),t.writeInt16(e.blasterRifleAmmo),t.writeUint32(e.positionOnZone.x*s.Tile.WIDTH),t.writeUint32(e.positionOnZone.y*s.Tile.HEIGHT),t.writeUint32(e.damageTaken),t.writeUint32(e.livesLost),t.writeUint32(e.difficulty),t.writeUint32(e.timeElapsed),t.writeInt32(e.worldSize),t.writeInt16(e.unknownCount),t.writeInt16(e.unknownSum),t.writeUint32(e.goalPuzzle),t.writeUint32(e.goalPuzzle)}},{key:"_writeDagobah",value:function(e,t){for(var n=4;n<=5;n++)for(var r=4;r<=5;r++)this._writeSector(e.at(r,n),t);this._writeWorldDetails(e,t)}},{key:"_writeWorld",value:function(e,t){for(var n=0;n<10;n++)for(var r=0;r<10;r++)this._writeSector(e.at(r,n),t);this._writeWorldDetails(e,t)}},{key:"_writeRoom",value:function(e,t,n){var r,a=this;this._writeZone(e,t,n);var i=(0,u.default)(r=e.hotspots).call(r,(function(e){return e.type===s.Hotspot.Type.DoorIn&&-1!==e.arg}));(0,l.default)(i).call(i,(function(e){var r=a._assets.get(s.Zone,e.arg);n.writeInt16(r.id),n.writeUint32(r.visited?1:0),a._writeRoom(r,t,n)}))}},{key:"_writeZone",value:function(e,t,n){var r,a,i,o=this;(t&&(n.writeUint32(e.counter),n.writeUint32(e.random),n.writeInt32(e.doorInLocation.x),n.writeInt32(e.doorInLocation.y),n.writeInt16(e.sectorCounter),n.writeUint16(e.planet.rawValue),n.writeInt16Array(e.tileIDs)),n.writeUint32(+e.visited),n.writeUint32(e.hotspots.length),(0,l.default)(r=e.hotspots).call(r,(function(e){return o._writeHotspot(e,n)})),t)&&(n.writeUint32(e.monsters.length),(0,l.default)(a=e.monsters).call(a,(function(e){return o.writeMonster(e,n)})),n.writeUint32(e.actions.length),(0,l.default)(i=e.actions).call(i,(function(e){return n.writeUint32(+e.enabled)})))}},{key:"writeMonster",value:function(e,t){t.writeInt16(e.alive?e.face.id:-1),t.writeInt16(e.position.x),t.writeInt16(e.position.y),t.writeInt16(e.damageTaken),t.writeUint32(+e.enabled),t.writeInt16(e.field10),t.writeInt16(e.bulletX),t.writeInt16(e.bulletY),t.writeInt16(e.currentFrame),t.writeUint32(+e.flag18),t.writeUint32(+e.flag1c),t.writeUint32(+e.flag20),t.writeInt16(e.directionX),t.writeInt16(e.directionY),t.writeInt16(e.bulletOffset),t.writeInt16(e.facingDirection),t.writeInt16(e.field60),t.writeInt16(e.loot),t.writeUint32(+e.flag2c),t.writeUint32(+e.flag34),t.writeUint32(+e.hasItem),t.writeInt16(e.cooldown),t.writeInt16(e.preferredDirection);for(var n=0;n<4;n++){var r=e.waypoints[n];t.writeInt32(r.x),t.writeInt32(r.y)}}},{key:"_writeHotspot",value:function(e,t){t.writeUint16(+e.enabled),t.writeInt16(e.arg),t.writeUint32(e.type.rawValue),t.writeInt16(e.x),t.writeInt16(e.y)}},{key:"_writeWorldDetails",value:function(e,t){for(var n=0;n<d.default.Size.height;n++)for(var r=0;r<d.default.Size.width;r++){var a=e.at(r,n);a&&a.zone&&(t.writeInt32(r),t.writeInt32(n),t.writeInt16(a.zone.id),t.writeUint32(+a.visited),this._writeRoom(a.zone,a.visited,t))}t.writeInt32(-1),t.writeInt32(-1)}},{key:"_writeSector",value:function(e,t){var n=function(e){return e?e.id:-1};t.writeUint32(+e.visited),t.writeUint32(+e.solved1),t.writeUint32(+e.solved3),t.writeUint32(+e.solved2),t.writeUint32(+e.solved4),t.writeInt16(n(e.zone)),t.writeInt16(e.puzzleIndex),t.writeInt16(n(e.requiredItem)),t.writeInt16(n(e.findItem)),t.writeInt16(e.isGoal),t.writeInt16(n(e.additionalRequiredItem)),t.writeInt16(n(e.additionalGainItem)),t.writeInt16(n(e.npc)),t.writeInt32(e.unknown),t.writeInt16(null===e.usedAlternateStrain?-1:+e.usedAlternateStrain)}}]),e}();t.default=c},9820:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244)),d=a(n(68748)),c=a(n(47053));function f(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,d.default)(t,"__esModule",{value:!0});var h=n(17766),p=n(31560),v=n(76500),y=n(45247),m=n(90094),g=n(21156),_=n(46e3),w=n(17725),k=n(92540),b=function(e){(0,u.default)(n,e);var t=f(n);function n(e){return(0,i.default)(this,n),t.call(this,e,_.Yoda)}return(0,o.default)(n,[{key:"read",value:function(e){return this._assets=e,this._doRead()}},{key:"_doRead",value:function(){var e,t=this._stream,n=65535&t.readUint32(),r=t.readUint32(),a=0!==t.readUint32(),i=this.readPuzzles(t),o=this.readPuzzles(t),u=this.readWorld(t,{start:4,end:6},{start:4,end:6}),l=this.readWorld(t,{start:0,end:10},{start:0,end:10}),s=this.readInventory(t),d=t.readUint16(),f=t.readUint32(),v=t.readUint32(),y=t.readInt16(),g=y>=0?t.readInt16():-1,k=t.readInt16(),b=t.readInt16(),S=t.readInt16(),I=w.floor(t.readUint32()/h.Tile.WIDTH),x=w.floor(t.readUint32()/h.Tile.HEIGHT),T=t.readInt32(),M=t.readInt32(),E=t.readUint32(),C=t.readUint32(),A=t.readInt32(),D=t.readInt16(),z=t.readInt16(),P=t.readUint32(),R=t.readUint32();console.assert(P===R,(0,c.default)(e="Expected goal ".concat(P," to be repeated. Found ")).call(e,R," instead")),console.assert(t.isAtEnd(),"Encountered ".concat(t.length-t.offset," unknown bytes at end of stream"));var L=new m.default;return L.type=_.Yoda,L.planet=h.Zone.Planet.isPlanet(r)?h.Zone.Planet.fromNumber(r):h.Zone.Planet.None,L.seed=n,L.puzzleIDs1=i,L.puzzleIDs2=o,L.inventoryIDs=s,L.onDagobah=a,L.currentZoneID=d,L.positionOnZone=new p.Point(I,x),L.positionOnWorld=new p.Point(f,v),L.goalPuzzle=P,L.currentWeapon=y,L.currentAmmo=g,L.blasterAmmo=b,L.blasterRifleAmmo=S,L.forceAmmo=k,L.damageTaken=T,L.livesLost=M,L.dagobah=u,L.world=l,L.timeElapsed=C,L.difficulty=E,L.unknownCount=D,L.unknownSum=z,L.worldSize=A,L}},{key:"readSector",value:function(e,t,n){var r=this.readBool(e),a=this.readBool(e),i=this.readBool(e),o=this.readBool(e),u=this.readBool(e),l=e.readInt16(),s=e.readInt16(),d=e.readInt16(),c=e.readInt16(),f=e.readInt16(),p=e.readInt16(),v=e.readInt16(),y=e.readInt16(),m=e.readInt32(),_=e.readInt16(),w=new g.default;return w.visited=r,w.solved1=a,w.solved2=i,w.solved3=o,w.solved4=u,w.zone=this._assets.get(h.Zone,l,k.NullIfMissing),w.puzzleIndex=s,w.requiredItem=this._assets.get(h.Tile,d,k.NullIfMissing),w.findItem=this._assets.get(h.Tile,c,k.NullIfMissing),w.isGoal=f,w.additionalRequiredItem=this._assets.get(h.Tile,p,k.NullIfMissing),w.additionalGainItem=this._assets.get(h.Tile,v,k.NullIfMissing),w.usedAlternateStrain=-1===_?null:1===_,w.npc=this._assets.get(h.Tile,y,k.NullIfMissing),w.unknown=m,w}},{key:"readMonster",value:function(e){for(var t=e.readInt16(),n=e.readInt16(),r=e.readInt16(),a=e.readInt16(),i=0!==e.readUint32(),o=e.readInt16(),u=e.readInt16(),l=e.readInt16(),s=e.readInt16(),d=0!==e.readUint32(),c=0!==e.readUint32(),f=0!==e.readUint32(),y=e.readInt16(),m=e.readInt16(),g=e.readInt16(),_=e.readInt16(),w=e.readInt16(),b=e.readInt16(),S=0!==e.readUint32(),I=0!==e.readUint32(),x=0!==e.readUint32(),T=e.readInt16(),M=e.readInt16(),E=[],C=0;C<4;C++)E.push(new p.Point(e.readUint32(),e.readUint32()));var A=new v.MutableMonster;return A.face=this._assets.get(h.Char,t,k.NullIfMissing),A.enabled=i,A.position=new p.Point(n,r,h.Zone.Layer.Object),A.damageTaken=a,A.loot=b,A.field10=o,A.bulletX=u,A.bulletY=l,A.currentFrame=s,A.facingDirection=_,A.cooldown=T,A.flag18=d,A.flag20=f,A.flag1c=c,A.directionX=y,A.directionY=m,A.bulletOffset=g,A.field60=w,A.flag2c=S,A.flag34=I,A.hasItem=x,A.preferredDirection=M,A.waypoints=E,A}},{key:"readHotspot",value:function(e,t){var n=0!==e.readUint16(),r=e.readInt16(),a=h.Hotspot.Type.fromNumber(e.readUint32()),i=e.readInt16(),o=e.readInt16(),u=new v.MutableHotspot;return u.enabled=n,u.type=a,u.arg=r,u.x=i,u.y=o,u}},{key:"readInt",value:function(e){return e.readInt32()}}]),n}(y.default);t.default=b},46724:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(63789)),o=a(n(76108)),u=a(n(40361)),l=a(n(7583)),s=a(n(80655)),d=a(n(20497)),c=a(n(75244)),f=a(n(68748)),h=a(n(23982)),p=a(n(79302)),v=a(n(31920)),y=a(n(75356)),m=a(n(42601));function g(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,d.default)(this,n)}}(0,f.default)(t,"__esModule",{value:!0}),t.Event=void 0;var _=n(31560);t.Event={SceneChanged:"scenechange"};var w=function(e){(0,s.default)(d,e);var n,r,a=g(d);function d(){var e;return(0,u.default)(this,d),(e=a.apply(this,arguments))._engine=null,e._stack=[],e._popHandlers=new h.default,e._overlays=[],e._visibleScenes=[],e}return(0,l.default)(d,[{key:"pushScene",value:function(e){e.engine=this.engine,this._stack.push(e),this._rebuildVisibleScenes(),this.currentScene=e}},{key:"update",value:(r=(0,o.default)(i.default.mark((function e(t){var n,r;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.currentScene.update(t);case 2:for(n=0,r=this._overlays.length;n<r;n++)this._overlays[n].update(t);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"render",value:function(e){for(var t=0,n=this._visibleScenes.length;t<n;t++)this._visibleScenes[t].render(e);for(var r=0,a=this._overlays.length;r<a;r++)this._overlays[r].render(e)}},{key:"popScene",value:function(){var e=this._stack.pop(),t=this._stack.last();return this._popHandlers.has(e)&&this._popHandlers.get(e)(),this._rebuildVisibleScenes(),t!==this._stack.last()||(this.currentScene=this._stack.last()),e}},{key:"presentScene",value:(n=(0,o.default)(i.default.mark((function e(t){var n=this;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new p.default((function(e){n._popHandlers.set(t,e),n.pushScene(t)})));case 1:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})},{key:"clear",value:function(){for(;this._stack.length;)this.popScene()}},{key:"currentScene",get:function(){return this._currentScene},set:function(e){var n=this._currentScene;n&&n.willHide(),e&&e.willShow(),this._currentScene=e,this._popHandlers.delete(n),e&&e.didShow(),n&&n.didHide(),this.dispatchEvent(new CustomEvent(t.Event.SceneChanged))}},{key:"_rebuildVisibleScenes",value:function(){for(var e=[],t=0,n=this._stack.length;t<n;t++){var r=this._stack[t];r.isOpaque()?e=[r]:e.push(r)}this._visibleScenes=e}},{key:"addOverlay",value:function(e){this._overlays.push(e),e.engine=this.engine}},{key:"removeOverlay",value:function(e){var t,n;e.engine=null,(0,v.default)(t=this._overlays).call(t,(0,y.default)(n=this._overlays).call(n,e),1)}},{key:"engine",get:function(){return this._engine},set:function(e){var t,n;this._engine=e,(0,m.default)(t=this._stack).call(t,(function(t){return t.engine=e})),(0,m.default)(n=this._overlays).call(n,(function(t){return t.engine=e}))}},{key:"stack",get:function(){return this._stack}}]),d}(_.EventTarget);w.Event=t.Event,t.default=w},63806:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.SectorTransitionScene=t.ZoneScene=t.WinScene=t.TeleportScene=t.SpeechScene=t.Scene=t.RoomTransitionScene=t.PickupScene=t.PauseScene=t.MapScene=t.LoseScene=void 0;var r=n(56977);t.LoseScene=r.default;var a=n(37867);t.MapScene=a.default;var i=n(69083);t.PauseScene=i.default;var o=n(60102);t.PickupScene=o.default;var u=n(26523);t.RoomTransitionScene=u.default;var l=n(36310);t.Scene=l.default;var s=n(6762);t.SpeechScene=s.default;var d=n(95363);t.TeleportScene=d.default;var c=n(89778);t.WinScene=c.default;var f=n(80347);t.ZoneScene=f.default;var h=n(21472);t.SectorTransitionScene=h.default},56977:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(63789)),o=a(n(76108)),u=a(n(40361)),l=a(n(7583)),s=a(n(80655)),d=a(n(20497)),c=a(n(75244)),f=a(n(68748)),h=a(n(67093));function p(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,d.default)(this,n)}}(0,f.default)(t,"__esModule",{value:!0});var v=n(36310),y=n(80347),m=n(17766),g=n(31560),_=function(e){(0,s.default)(r,e);var t,n=p(r);function r(){return(0,u.default)(this,r),n.apply(this,arguments)}return(0,l.default)(r,[{key:"willShow",value:function(){var e,t=this.engine;t.hero.isAttacking=!1,t.hero._actionFrames=1/0,t.hero.visible=!1,t.hero.location=new g.Point(0,0),t.camera.update(1/0),this._zoneScene=new y.default,this._zoneScene.engine=t,this._zoneScene.zone=(0,h.default)(e=t.assets).call(e,m.Zone,(function(e){return e.type===m.Zone.Type.Lose})),this._zoneScene.willShow()}},{key:"didShow",value:function(){this._zoneScene.didShow(),this.engine.metronome.stop()}},{key:"update",value:(t=(0,o.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"render",value:function(e){this._zoneScene.render(e)}},{key:"willHide",value:function(){this._zoneScene.willHide()}},{key:"didHide",value:function(){this._zoneScene.didHide()}},{key:"isOpaque",value:function(){return!1}}]),r}(v.default);t.default=_},37867:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(63789)),o=a(n(76108)),u=a(n(40361)),l=a(n(7583)),s=a(n(80655)),d=a(n(20497)),c=a(n(75244)),f=a(n(68748)),h=a(n(35983)),p=a(n(68190));function v(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,d.default)(this,n)}}(0,f.default)(t,"__esModule",{value:!0});var y,m=n(87317),g=n(31560),_=n(17766),w=n(12312),k=n(36310),b=n(6762),S=n(26523),I=n(23754),x=n(59923),T=n(34159),M=n(92540),E=288,C=288;!function(e){e[e.None=-1]="None",e[e.requires=57358]="requires",e[e.find=57359]="find",e[e.aPart=57367]="aPart",e[e.aValuable=57368]="aValuable",e[e.aKeyCard=57369]="aKeyCard",e[e.aTool=57366]="aTool",e[e.aUnknown=57365]="aUnknown",e[e.Solved=57357]="Solved",e[e.TravelSolved=57370]="TravelSolved",e[e.GoalSolved=57364]="GoalSolved",e[e.Town=57363]="Town",e[e.aMap=57360]="aMap",e[e.TheForce=57362]="TheForce",e[e.SomethingUseful=57361]="SomethingUseful"}(y||(y={}));var A=function(e){(0,s.default)(r,e);var t,n=v(r);function r(){var e;return(0,u.default)(this,r),(e=n.apply(this,arguments))._ticks=0,e._location=null,e._cheatInput=new m.CheatCodeInput([new m.Weapons,new m.UnlimitedAmmo,new m.Invincibility,new m.RequiredItems]),e._locatorTile=new w.default,e}return(0,l.default)(r,[{key:"isOpaque",value:function(){return!0}},{key:"willShow",value:function(){var e=this;this._pdg||(this._pdg=new x.default(this.engine)),this._cheatInput.reset(),this._ticks=4,this._location=this.engine.assets.get(_.Tile,this._locatorTile.here),this.engine.inputManager.clear(),this.engine.inputManager.mouseDownHandler=function(t){return e.mouseDown(t)},this.engine.inputManager.keyDownHandler=function(t){e._cheatInput.addCharacter(String.fromCharCode(t.keyCode).toLowerCase())}}},{key:"willHide",value:function(){this.engine.inputManager.mouseDownHandler=null,this.engine.inputManager.keyDownHandler=null}},{key:"update",value:(t=(0,o.default)(i.default.mark((function e(t){var n,r;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((n=this.engine).inputManager.readInput(t)&T.InputMask.Map)){e.next=5;break}return this.exitScene(),e.abrupt("return");case 5:(r=this._cheatInput.execute(n)).length&&(this._cheatInput.reset(),this._showText(r.first(),this.engine.currentWorld.findLocationOfZone(this.engine.currentZone))),this._ticks++;case 8:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"_showText",value:function(e,t){var n=new b.default(this.engine);n.text=e,t=t.bySubtracting(this.cameraOffset),n.location=t,n.tileSize=new g.Size(28,28);var r=28*I.default.Size.height,a=28*I.default.Size.width,i=(E-a)/576,o=(C-r)/576-1.5*_.Tile.HEIGHT;n.offset=new g.Point(i,o),this.engine.sceneManager.pushScene(n)}},{key:"mouseDown",value:function(e){var t=28*I.default.Size.height,n=28*I.default.Size.width,r=(E-n)/576,a=(C-t)/576;if(e.x-=r,e.y-=a,e.x*=1+2*r,e.y*=1+2*a,!(e.x<0||e.y<0||e.x>=1||e.y>=1)){var i=Math.floor(e.x*I.default.Size.width),o=Math.floor(e.y*I.default.Size.height),u=this.engine.currentWorld.at(i,o);if(!u||!u.zone)return this.exitScene();var l=this.engine.inputManager.readInput(0);return this.engine.settings.debug&&l&T.InputMask.Drag?this.performDebugTeleportAndExit(u.zone):this.isZoneConsideredVisited(u.zone)?void this.handleMouseDown(new g.Point(i,o),u.zone):this.exitScene()}}},{key:"handleMouseDown",value:function(e,t){var n=this._locatorDescription(e);if(!n)return this.exitScene();this._showText(n,e)}},{key:"performDebugTeleportAndExit",value:function(e){var t=this.engine;this.exitScene();var n=new S.default;n.destinationHeroLocation=t.hero.location,n.destinationZone=e,n.scene=t.sceneManager.currentScene,n.destinationWorld=t.currentWorld,n.destinationSector=t.currentWorld.findLocationOfZone(e),t.sceneManager.pushScene(n)}},{key:"_locatorDescription",value:function(e){var t,n=this,r=this._locatorDescriptionId(e);return"number"==typeof r?null===(t=this.engine.assets.get(String,r,M.NullIfMissing))||void 0===t?void 0:t.toString():"string"==typeof r?r:(0,h.default)(r).call(r,(function(e){var t;return"string"==typeof e?e:null===(t=n.engine.assets.get(String,e,M.NullIfMissing))||void 0===t?void 0:t.toString()})).join("")+"!"}},{key:"_locatorDescriptionId",value:function(e){var t,n=this.engine.currentWorld.at(e.x,e.y);if(!n||!n.zone)return-1;if(!n.zone.visited&&!this.engine.settings.revealWorld)return-2;var r=n.requiredItem,a=n.findItem;console.log((0,p.default)(t=[r?"requires ".concat(r.name):null,a?"gives ".concat(a.name):null]).call(t,(function(e){return e})).join(", "));var i=function(e){return e.hasAttributes(_.Tile.Attributes.Tool)?57366:e.hasAttributes(_.Tile.Attributes.Part)?57367:e.hasAttributes(_.Tile.Attributes.Valuable)?57368:e.hasAttributes(_.Tile.Attributes.Keycard)?57369:e.hasAttributes(_.Tile.Attributes.Locator)?57360:e.hasAttributes(_.Tile.Attributes.Weapon)?57362:e.hasAttributes(_.Tile.Attributes.Item)?57361:57365};switch(n.zone.type){case _.Zone.Type.Empty:return-1;case _.Zone.Type.Town:return 57363;case _.Zone.Type.BlockadeNorth:case _.Zone.Type.BlockadeSouth:case _.Zone.Type.BlockadeEast:case _.Zone.Type.BlockadeWest:case _.Zone.Type.TravelStart:case _.Zone.Type.TravelEnd:return n.requiredItem?n.solved1?57370:[57358,i(n.requiredItem)]:-1;case _.Zone.Type.Goal:return n.solved1&&n.solved2?57364:57365;case _.Zone.Type.Find:case _.Zone.Type.FindUniqueWeapon:if(!n.findItem)return-1;if(n.solved1)return 57357;if(n.findItem.hasAttributes(_.Tile.Attributes.Map))return[57359,57360];if(n.findItem.hasAttributes(_.Tile.Attributes.Weapon))return[57359,57362];if(n.findItem.hasAttributes(_.Tile.Attributes.Item))return[57359,57361];console.assert(!1,"Unknown find item!");case _.Zone.Type.Trade:return n.requiredItem?n.solved2?57357:[57358,i(n.requiredItem)]:-1;case _.Zone.Type.Use:return n.requiredItem?n.solved2?57357:[57358,n.requiredItem.name]:-1;case _.Zone.Type.Load:case _.Zone.Type.Room:case _.Zone.Type.Win:case _.Zone.Type.Lose:case _.Zone.Type.None:default:return console.assert(!1,"Zone does not appear on map!"),-1}}},{key:"exitScene",value:function(){this.engine.inputManager.clear(),this.engine.sceneManager.popScene()}},{key:"render",value:function(e){var t,n,a=this.engine,i=this.engine.palette.current,o=_.Tile.WIDTH,u=a.currentWorld,l=(288-28*I.default.Size.width)/2,s=(288-28*I.default.Size.height)/2,d=new ImageData(288,288),c=new ArrayBuffer(d.data.length),f=new Uint8Array(c),h=new Uint32Array(c),p=288,v=function(e,t,n){var r,a,u=e.imageData,d=28*n*p+28*t;for(a=0;a<28;a++){for(r=0;r<28;r++)h[d+r+s*p+l]=i[u[a*o+r]];d+=p}},y=function(e,t,n){var r,a,u=e.imageData,d=28*n*p+28*t;for(a=0;a<28;a++){for(r=0;r<28;r++){var c=u[a*o+r];0!==c&&(h[d+r+s*p+l]=i[c])}d+=p}};for(n=0;n<10;n++)for(t=0;t<10;t++){var m=u.at(t,n).zone,g=this._tileForZone(m);g&&(g.isOpaque()?v(g,t,n):y(g,t,n))}var w=a.findLocationOfZone(a.currentZone).location;this._ticks%(2*r.LOCATOR_ANIMATION_TICKS)/r.LOCATOR_ANIMATION_TICKS<1&&w&&this._location&&y(this._location,w.x,w.y),d.data.set(f),e.renderImageData(d,0,0),this.engine.settings.drawDebugStats&&a.currentWorld===a.world&&this._renderPDG(e)}},{key:"_renderPDG",value:function(e){for(var t=this._pdg.visitOrder,n=0;n<10;n++)for(var r=0;r<10;r++){var a,i=null!==(a=t[10*n+r])&&void 0!==a?a:-1;-1!==i&&e.renderText((i+1).toString(),new g.Point(4+28*r+14,1+28*n+14),{textAlign:"center",fillStyle:this.engine.world.at(n,r).solved?g.rgba(78,52,49,1):g.rgba(231,37,34,1),font:'15px "Anonymous Pro", monospace'})}}},{key:"_tileForZone",value:function(e){var t=this._locatorTile.forZone(e,e&&e.visited,this.engine.settings.revealWorld);return t instanceof Array&&(t=t[e&&this.isZoneConsideredSolved(e)?1:0]),this.engine.assets.get(_.Tile,t)}},{key:"isZoneConsideredSolved",value:function(e){var t=this.engine.currentWorld.findSectorContainingZone(e);return t&&t.solved}},{key:"isZoneConsideredVisited",value:function(e){return e.visited||this.engine.settings.revealWorld}}]),r}(k.default);A.LOCATOR_ANIMATION_TICKS=10,t.default=A},69083:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(63789)),o=a(n(76108)),u=a(n(40361)),l=a(n(7583)),s=a(n(80655)),d=a(n(20497)),c=a(n(75244));function f(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,d.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0});var h=n(36310),p=n(17766),v=n(34159),y=function(e){(0,s.default)(r,e);var t,n=f(r);function r(){var e;(0,u.default)(this,r),e=n.call(this);var t=new Image;return t.width=p.Tile.WIDTH,t.height=p.Tile.HEIGHT,t.src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAMElEQVRYw+3QoQEAAAjDsO3/o+EMBKmpT5NMjpvLlwABAgQIECBAgAABAgQIEHgvsI0fDxA3PoMxAAAAAElFTkSuQmCC",t.className="pixelated",e._image=t,e}return(0,l.default)(r,[{key:"willShow",value:function(){this.engine.inputManager.clear(),this.engine.totalPlayTime+=((new Date).getTime()-this.engine.currentPlayStart.getTime())/1e3,this.engine.currentPlayStart=new Date}},{key:"render",value:function(e){for(var t=0;t<9;t++)for(var n=0;n<9;n++)e.drawImage(this._image,t*p.Tile.WIDTH,n*p.Tile.HEIGHT)}},{key:"update",value:(t=(0,o.default)(i.default.mark((function e(t){var n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=this.engine).inputManager.readInput(t)&v.InputMask.Pause&&n.sceneManager.popScene();case 3:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"willHide",value:function(){this.engine.currentPlayStart=new Date,this.engine.inputManager.clear()}},{key:"isOpaque",value:function(){return!1}}]),r}(h.default);t.default=y},60102:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(63789)),o=a(n(76108)),u=a(n(40361)),l=a(n(7583)),s=a(n(18582)),d=a(n(80655)),c=a(n(20497)),f=a(n(75244));function h(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,f.default)(e);if(t){var i=(0,f.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,c.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0});var p=n(36310),v=n(27778),y=n(17766),m=n(34159),g=function(e){(0,d.default)(r,e);var t,n=h(r);function r(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return(0,u.default)(this,r),(e=n.call(this)).location=null,e._ticks=0,e.engine=t,e}return(0,l.default)(r,[{key:"willShow",value:function(){var e=this;(0,s.default)((0,f.default)(r.prototype),"willShow",this).call(this),this._image=null,v.drawTileImageData(this.tile,this.engine.palette.current).toImage().then((function(t){return e._image=t}))}},{key:"render",value:function(e){if(this._ticks%10>=5){var t=this.location.x+this.cameraOffset.x,n=this.location.y+this.cameraOffset.y;e.renderImage(this._image,t*y.Tile.WIDTH,n*y.Tile.HEIGHT)}}},{key:"update",value:(t=(0,o.default)(i.default.mark((function e(t){var n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=this.engine).inputManager.readInput(t)&m.InputMask.PickUp&&n.sceneManager.popScene(),this._ticks++;case 4:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"willHide",value:function(){var e=this.engine;e.inventory.addItem(this.tile),e.inputManager.clear(),this._image=null,(0,s.default)((0,f.default)(r.prototype),"willHide",this).call(this)}},{key:"isOpaque",value:function(){return!1}}]),r}(p.default);t.default=g},26523:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(63789)),o=a(n(68748)),u=a(n(76108)),l=a(n(40361)),s=a(n(7583)),d=a(n(80655)),c=a(n(20497)),f=a(n(75244)),h=(a(n(19765)),a(n(81581)));function p(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,f.default)(e);if(t){var i=(0,f.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,c.default)(this,n)}}(0,o.default)(t,"__esModule",{value:!0});var v,y=n(36310),m=n(83608),g=n(17766),_=n(17725);!function(e){e[e.FadeIn=-1]="FadeIn",e[e.FadeOut=1]="FadeOut"}(v||(v={}));var w=function(e){(0,d.default)(r,e);var t,n=p(r);function r(){var e;return(0,l.default)(this,r),(e=n.apply(this,arguments)).scene=null,e.destinationHeroLocation=null,e.destinationSector=null,e.originSector=null,e.destinationZone=null,e.destinationWorld=null,e.originZone=null,e.duration=750,e._startTime=1/0,e._mode=1,e._aborted=!1,e._skipped=!1,e}return(0,s.default)(r,[{key:"willShow",value:function(){this._executingActions||(this.engine.spu.drain(),this._sequence=this.buildSequence(),this._startTime=performance.now(),this.originZone=this.engine.currentZone)}},{key:"didHide",value:function(){this._executingActions||(this.scene=null,this._sequence=null,this.destinationHeroLocation=null,this.destinationSector=null,this.originSector=null,this.destinationZone=null,this.destinationWorld=null,this.originZone=null)}},{key:"update",value:(t=(0,u.default)(i.default.mark((function e(){var t;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._aborted){e.next=2;break}return e.abrupt("return");case 2:if(this._executingActions=!0,!this._skipped){e.next=7;break}if(-1!==this._mode&&(this._startTime=performance.now(),this._mode=-1,this.engine.triggerLocationChange()),this.isFadeComplete()){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,this.engine.spu.run();case 9:if((t=e.sent)===m.ScriptResult.Done){e.next=14;break}return t===m.ScriptResult.UpdateZone&&(this.engine.spu.drain(),this._aborted=!0,this.didHide()),this._skipped=!0,e.abrupt("return");case 14:if(this._executingActions=!1,!this._aborted){e.next=17;break}return e.abrupt("return");case 17:return e.next=19,this._sequence.next();case 19:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"render",value:function(e){var t=performance.now()-this._startTime,n=this._mode*(t/this.duration),r=_.floor(6*n);-1===this._mode&&(r=6+r),e.fillBlackRect(0,0,9*g.Tile.WIDTH,r*g.Tile.HEIGHT),e.fillBlackRect(0,0,r*g.Tile.WIDTH,9*g.Tile.HEIGHT),e.fillBlackRect((9-r)*g.Tile.WIDTH,0,r*g.Tile.WIDTH,9*g.Tile.HEIGHT),e.fillBlackRect(0,(9-r)*g.Tile.HEIGHT,9*g.Tile.WIDTH,r*g.Tile.HEIGHT)}},{key:"buildSequence",value:function(){var e=this;return(0,h.default)(i.default.mark((function t(){var n,r,a,o,u,l;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.scene,r=e.engine,a=e.destinationZone,o=e.destinationWorld,u=e.destinationHeroLocation;case 1:if(e.isFadeComplete()){t.next=6;break}return void(t.next=4);case 4:t.next=1;break;case 6:return r.hero.location=u,r.currentWorld=o,r.currentZone=a,n.zone=r.currentZone,r.camera.hero=r.hero,r.camera.zoneSize=r.currentZone.size,r.camera.update(1/0),e.destinationZone.sectorCounter=e.originZone.sectorCounter,r.spu.prepareExecution(m.EvaluationMode.JustEntered,a),void(t.next=17);case 17:return l=a.visited?m.EvaluationMode.ByPlane:m.EvaluationMode.Initialize|m.EvaluationMode.ByPlane,r.spu.prepareExecution(l,a),void(t.next=21);case 21:a.visited||(a.visited=!0,a.initialize()),-1!==e._mode&&(e._startTime=performance.now(),e._mode=-1,e.engine.triggerLocationChange());case 23:if(e.isFadeComplete()){t.next=28;break}return void(t.next=26);case 26:t.next=23;break;case 28:r.spu.prepareExecution(m.EvaluationMode.ByPlane,a),r.sceneManager.popScene();case 30:case"end":return t.stop()}}),t)})))()}},{key:"isFadeComplete",value:function(){return!!this.engine.settings.skipTransitions||this.duration<performance.now()-this._startTime}},{key:"isOpaque",value:function(){return!1}}]),r}(y.default);t.default=w},36310:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o=function(){function e(){(0,a.default)(this,e),this.engine=null}return(0,i.default)(e,[{key:"cameraOffset",get:function(){return this.engine.camera.offset}},{key:"willShow",value:function(){}},{key:"didShow",value:function(){}},{key:"willHide",value:function(){}},{key:"didHide",value:function(){}},{key:"isOpaque",value:function(){return!0}}]),e}();t.default=o},21472:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(63789)),o=a(n(68748)),u=a(n(76108)),l=a(n(40361)),s=a(n(7583)),d=a(n(80655)),c=a(n(20497)),f=a(n(75244)),h=(a(n(19765)),a(n(81581)));function p(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,f.default)(e);if(t){var i=(0,f.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,c.default)(this,n)}}(0,o.default)(t,"__esModule",{value:!0});var v=n(17725),y=n(17766),m=n(27778),g=n(36310),_=n(83608),w=.87,k=function(e){(0,d.default)(r,e);var t,n=p(r);function r(){var e;return(0,l.default)(this,r),(e=n.apply(this,arguments)).scene=null,e.destinationHeroLocation=null,e.destinationSector=null,e.originSector=null,e.destinationZone=null,e.destinationWorld=null,e._originZone=null,e._startTime=-1/0,e.duration=1/0,e._executingActions=!1,e}return(0,s.default)(r,[{key:"willShow",value:function(){this._executingActions||(this.duration=this.engine.settings.skipTransitions?0:1e3,this._direction=this.originSector.bySubtracting(this.destinationSector),this._sequence=this.buildSequence(),this._startTime=1/0,this._originZone=this.engine.currentZone,this._originLocation=this.engine.hero.location)}},{key:"didHide",value:function(){this._executingActions||(this.scene=null,this.destinationHeroLocation=null,this.destinationSector=null,this.originSector=null,this.destinationZone=null,this.destinationWorld=null,this._direction=null,this._originImage=null,this._destinationImage=null,this._originZone=null,this._originLocation=null)}},{key:"update",value:(t=(0,u.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._executingActions=!0,e.next=3,this.engine.spu.run();case 3:if(e.sent===_.ScriptResult.Done){e.next=6;break}return e.abrupt("return");case 6:return this._executingActions=!1,e.next=9,this._sequence.next();case 9:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"buildSequence",value:function(){var e=this;return(0,h.default)(i.default.mark((function t(){var n,r,a,o;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.engine,r=e.destinationZone,a=e.destinationHeroLocation,o=e.destinationWorld,e.engine.hero.location=a,n.currentWorld=o,n.currentZone=r,e.scene.zone=r,n.spu.prepareExecution(_.EvaluationMode.JustEntered,r),void(t.next=9);case 9:if(r.visited){t.next=13;break}return n.spu.prepareExecution(_.EvaluationMode.Initialize,r),void(t.next=13);case 13:r.visited||(r.visited=!0,r.initialize()),e._destinationImage=null,e._originImage=null,e._startTime=performance.now();case 17:if(!(v.max(v.min((performance.now()-e._startTime)/e.duration,1),0)<w)){t.next=22;break}return void(t.next=20);case 20:t.next=17;break;case 22:e._destinationImage=null,e._originImage=null;case 24:if(e.isFadeComplete()){t.next=29;break}return void(t.next=27);case 27:t.next=24;break;case 29:e.engine.triggerLocationChange(),e.scene.prepareCamera(),n.sceneManager.popScene();case 32:case"end":return t.stop()}}),t)})))()}},{key:"isFadeComplete",value:function(){return!!this.engine.settings.skipTransitions||this.duration<performance.now()-this._startTime}},{key:"render",value:function(e){var t=performance.now()-this._startTime;this.renderState(e,t)}},{key:"renderState",value:function(e,t){var n=v.max(v.min(t/this.duration,1),0);if(!this._originImage){var r=this.engine.hero,a=r._appearance,i=r._actionFrames,o=n<w?a.getFace(r._direction,i):null;this._originImage=m.drawZoneImageData(this._originZone,this.engine.palette.current,o,this._originLocation),o=n>=w?a.getFace(r._direction,i):null,this._destinationImage=m.drawZoneImageData(this.destinationZone,this.engine.palette.current,o,r.location)}var u=this.engine.camera.offset.byScalingBy(y.Tile.WIDTH),l=9*y.Tile.WIDTH,s=9*y.Tile.HEIGHT;e.renderImageData(this._originImage,u.x+this._direction.x*l*n,u.y+this._direction.y*s*n),e.renderImageData(this._destinationImage,u.x+this._direction.x*l*(n-2),u.y+this._direction.y*s*(n-2))}},{key:"isOpaque",value:function(){return!1}}]),r}(g.default);t.default=k},6762:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(63789)),o=a(n(76108)),u=a(n(40361)),l=a(n(7583)),s=a(n(80655)),d=a(n(20497)),c=a(n(75244));function f(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,d.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0});var h=n(31560),p=n(36310),v=n(17766),y=function(e){(0,s.default)(r,e);var t,n=f(r);function r(e){var t;return(0,u.default)(this,r),(t=n.call(this)).tileSize=new h.Size(v.Tile.WIDTH,v.Tile.HEIGHT),t.offset=new h.Point(0,0),t.text="",t.engine=e,t}return(0,l.default)(r,[{key:"render",value:function(){}},{key:"willShow",value:function(){var e=this;this.engine.inputManager.mouseDownHandler=null;var t=h.Point.add(this.location,this.cameraOffset),n=this.engine.currentSector,r=this.resolveVariables(this.text,n);this.engine.showText(r,t).then((function(){return e.engine.sceneManager.popScene()}))}},{key:"resolveVariables",value:function(e,t){return t?(t.findItem&&(e=e.replace(/[|]/g,t.findItem.name)),t.requiredItem&&(e=e.replace(/[|]/g,t.requiredItem.name)),e):e}},{key:"update",value:(t=(0,o.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"willHide",value:function(){this.engine.inputManager.mouseDownHandler=null,this.engine.inputManager.clear()}},{key:"isOpaque",value:function(){return!1}}]),r}(p.default);t.default=y},95363:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244)),c=a(n(68748)),f=a(n(55903)),h=a(n(67093));function p(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,c.default)(t,"__esModule",{value:!0});var v=n(37867),y=n(26523),m=n(17766),g=function(e){(0,l.default)(n,e);var t=p(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return(0,o.default)(n,[{key:"isZoneConsideredSolved",value:function(e){var t;return e.hasTeleporter?(0,f.default)(t=e.hotspots.withType(m.Hotspot.Type.Teleporter)).call(t,(function(e){return e.enabled})):(0,u.default)((0,d.default)(n.prototype),"isZoneConsideredSolved",this).call(this,e)}},{key:"handleMouseDown",value:function(e,t){var n,r=this.engine;this.exitScene();var a=(0,h.default)(n=t.hotspots.withType(m.Hotspot.Type.Teleporter)).call(n,(function(e){return e.enabled}));if(a){r.sceneManager.currentScene instanceof y.default&&r.sceneManager.popScene();var i=new y.default;i.destinationHeroLocation=a.location,i.destinationZone=t,i.scene=r.sceneManager.currentScene,i.destinationWorld=r.currentWorld,i.destinationSector=r.currentWorld.findLocationOfZone(t),r.sceneManager.pushScene(i)}}}]),n}(v.default);t.default=g},89778:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(63789)),o=a(n(76108)),u=a(n(40361)),l=a(n(7583)),s=a(n(80655)),d=a(n(20497)),c=a(n(75244)),f=a(n(68748)),h=a(n(67093));function p(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,d.default)(this,n)}}(0,f.default)(t,"__esModule",{value:!0});var v=n(36310),y=n(80347),m=n(17766),g=n(31560),_=n(40092),w=n(17725),k=n(34159),b=function(e){(0,s.default)(r,e);var t,n=p(r);function r(e){var t;return(0,u.default)(this,r),(t=n.call(this))._ticksUntilScoreIsShown=11,t._originalLocation=new g.Point(0,0),t.score=w.round(e).toString(10),t}return(0,l.default)(r,[{key:"willShow",value:function(){var e,t=this.engine;this._originalLocation=t.hero.location,t.hero.isAttacking=!1,t.hero._actionFrames=1/0,t.hero.visible=!1,t.hero.location=new g.Point(0,0),t.camera.update(1/0),this._zoneScene=new y.default,this._zoneScene.engine=t,this._zoneScene.zone=(0,h.default)(e=t.assets).call(e,m.Zone,(function(e){return e.type===m.Zone.Type.Win})),this._zoneScene.willShow()}},{key:"didShow",value:function(){this._zoneScene.didShow(),this.engine.settings.skipWinScene&&this.engine.sceneManager.popScene()}},{key:"update",value:(t=(0,o.default)(i.default.mark((function e(t){var n,r;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._ticksUntilScoreIsShown-=1,!(this._ticksUntilScoreIsShown<0)){e.next=7;break}if(n=this.engine,!((r=n.inputManager.readInput(t))&k.InputMask.Map||r&k.InputMask.Attack||r&k.InputMask.Walk)){e.next=7;break}return n.sceneManager.popScene(),e.abrupt("return");case 7:this._zoneScene.update(t);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"render",value:function(e){this._zoneScene.render(e),this._ticksUntilScoreIsShown>0||e instanceof _.default&&e.renderText(this.score,new g.Point(201,239),{textAlign:"center"})}},{key:"willHide",value:function(){this._zoneScene.willHide(),this.engine.hero.location=this._originalLocation,this.engine.hero.visible=!0,this.engine.camera.update(0)}},{key:"didHide",value:function(){this._zoneScene.didHide()}}]),r}(v.default);t.default=b},80347:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(63789)),o=a(n(61822)),u=a(n(76108)),l=a(n(40361)),s=a(n(7583)),d=a(n(80655)),c=a(n(20497)),f=a(n(75244)),h=a(n(68748)),p=a(n(47053)),v=a(n(68190)),y=a(n(42601)),m=a(n(67093));function g(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,f.default)(e);if(t){var i=(0,f.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,c.default)(this,n)}}(0,h.default)(t,"__esModule",{value:!0});var _=n(31560),w=n(83608),k=n(17766),b=n(34159),S=n(61334),I=n(37867),x=n(67460),T=n(69083),M=n(36310),E=n(84141),C=n(14635),A=n(25775),D=n(78126),z=n(57266),P=n(33683),R=function(e){(0,d.default)(c,e);var t,n,r,a=g(c);function c(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(0,l.default)(this,c),(e=a.call(this))._renderer=new E.default,e.sprites=[],e._zone=n,e.engine=t,e}return(0,s.default)(c,[{key:"update",value:(r=(0,u.default)(i.default.mark((function e(t){var n,r,a;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.engine.palette.step(),n=this.engine,(r=n.hero).isWalking=!1,e.next=6,n.spu.run();case 6:if(e.sent===w.ScriptResult.Done){e.next=9;break}return e.abrupt("return");case 9:return e.next=11,this._handlePlacedTile();case 11:if(e.sent===w.ScriptResult.Done){e.next=14;break}return e.abrupt("return");case 14:if(!((a=n.hpu.execute(z.HotspotExecutionMode.Initialize))&P.HotspotExecutionResult.Speak||a&P.HotspotExecutionResult.ChangeZone||a&P.HotspotExecutionResult.Drop)){e.next=17;break}return e.abrupt("return");case 17:return n.spu.prepareExecution(w.EvaluationMode.Walk,this.zone),e.next=20,n.spu.run();case 20:if(e.sent===w.ScriptResult.Done){e.next=23;break}return e.abrupt("return");case 23:if(!((a=n.hpu.execute(z.HotspotExecutionMode.Stand))&P.HotspotExecutionResult.Speak||a&P.HotspotExecutionResult.ChangeZone||a&P.HotspotExecutionResult.Drop)){e.next=26;break}return e.abrupt("return");case 26:return e.next=28,A.default(n,this.zone);case 28:if(e.sent===w.ScriptResult.Done){e.next=31;break}return e.abrupt("return");case 31:return this._moveMonsters(),e.next=34,this.handleInput(t);case 34:if(!e.sent){e.next=37;break}return e.abrupt("return");case 37:return this.engine.camera.update(t),r.update(t),e.next=41,n.spu.run();case 41:if(e.sent===w.ScriptResult.Done){e.next=44;break}return e.abrupt("return");case 44:return n.spu.prepareExecution(w.EvaluationMode.Walk,this.zone),e.next=47,n.spu.run();case 47:if(e.sent===w.ScriptResult.Done){e.next=50;break}return e.abrupt("return");case 50:if(!((a=n.hpu.execute(z.HotspotExecutionMode.Stand))&P.HotspotExecutionResult.Speak||a&P.HotspotExecutionResult.ChangeZone||a&P.HotspotExecutionResult.Drop)){e.next=53;break}return e.abrupt("return");case 53:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"render",value:function(e){var t,n=[],r=this.zone,a=this.engine,i=a.hero,u=a.palette;if(i.isAttacking&&i.weapon){var l=this._extensionTileForBullet();if(l){var s=_.Direction.Confine(i.direction,!1),d=_.Direction.CalculateRelativeCoordinates(s,1),c=i.location.byAdding(d),f=new S.Sprite(c,new _.Size(k.Tile.WIDTH,k.Tile.HEIGHT),l.imageData);n.push(f)}if(l=this._bulletTileForBullet()){var h=_.Direction.Confine(i.direction,!1),y=_.Direction.CalculateRelativeCoordinates(h,i._actionFrames+1),m=i.location.byAdding(y),g=r.getTile(m);if(!g||g.isOpaque()){var w=new S.Sprite(m,new _.Size(k.Tile.WIDTH,k.Tile.HEIGHT),l.imageData);n.push(w)}}}this._renderer.render(r,a,e,u.current,(0,p.default)(t=[]).call(t,(0,o.default)((0,v.default)(n).call(n,(function(e){return r.bounds.contains(e.position)}))),(0,o.default)(this.sprites)))}},{key:"_extensionTileForBullet",value:function(){var e,t=this.engine.hero,n=t.weapon.frames,r=_.Direction.Confine(t.direction,!1),a=this._extensionFrameLocationForDirection(r);if(0===t._actionFrames)e=1;else if(1===t._actionFrames)e=2;else{if(2!==t._actionFrames)return t._actionFrames,null;e=1}return n[e].tiles[a]}},{key:"_bulletTileForBullet",value:function(){var e=this.engine.hero;if(3===e._actionFrames)return null;var t=e.weapon.frames,n=e.direction,r=this._frameLocationForDirection(n);return t[0].tiles[r]}},{key:"_extensionFrameLocationForDirection",value:function(e){switch(_.Direction.Confine(e,!0)){case _.Direction.SouthWest:case _.Direction.South:case _.Direction.SouthEast:return k.Char.FrameEntry.ExtensionDown;case _.Direction.NorthWest:case _.Direction.North:case _.Direction.NorthEast:return k.Char.FrameEntry.ExtensionUp;case _.Direction.East:return k.Char.FrameEntry.ExtensionRight;case _.Direction.West:return k.Char.FrameEntry.ExtensionLeft}}},{key:"_frameLocationForDirection",value:function(e){switch(_.Direction.Confine(e)){case _.Direction.South:case _.Direction.SouthWest:case _.Direction.SouthEast:return k.Char.FrameEntry.Down;case _.Direction.North:case _.Direction.NorthWest:case _.Direction.NorthEast:return k.Char.FrameEntry.Up;case _.Direction.East:return k.Char.FrameEntry.Right;case _.Direction.West:return k.Char.FrameEntry.Left}}},{key:"_moveMonsters",value:function(){var e,t=this;(0,y.default)(e=this._zone.monsters).call(e,(function(e){return x.default(e,t.zone,t.engine)}))}},{key:"prepareCamera",value:function(){this.engine.camera.zoneSize=this.zone.size,this.engine.camera.update(1/0)}},{key:"willShow",value:function(){this.camera.hero=this.engine.hero}},{key:"didShow",value:function(){this.prepareCamera()}},{key:"handleInput",value:(n=(0,u.default)(i.default.mark((function e(t){var n,r,a,o,u,l,s,d,c,f,h,p,v;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.engine,a=r.inputManager,o=r.hero,!((u=a.readInput(t))&b.InputMask.Pause)){e.next=8;break}return l=new T.default,this.engine.sceneManager.pushScene(l),e.abrupt("return",!0);case 8:if(!(u&b.InputMask.Map&&(r.settings.debug||(0,m.default)(n=r.inventory).call(n,(function(e){return e.hasAttributes(k.Tile.Attributes.Map)}))))){e.next=12;break}return s=new I.default,this.engine.sceneManager.pushScene(s),e.abrupt("return",!0);case 12:if(!o.isAttacking){e.next=14;break}return e.abrupt("return",!1);case 14:if(o.isDragging=!!(u&b.InputMask.Drag),o.isAttacking=!!(u&b.InputMask.Attack),o.isAttacking&&this._attackTriggered(),!o.isAttacking){e.next=30;break}return o._actionFrames=0,o.isWalking=!1,o.isDragging=!1,this._placeBullet(o),d=o.weapon.getWeaponIcon(),console.assert(!!d),c=_.Direction.CalculateRelativeCoordinates(o.direction,1),f=new _.Point(c.x,c.y,0),h=_.Point.add(o.location,f),this.engine.inputManager.placedTile=d,this.engine.inputManager.placedTileLocation=h,e.abrupt("return",!0);case 30:if(u&&(p=new _.Point(0,0),u&b.InputMask.Up&&(p.y-=1),u&b.InputMask.Down&&(p.y+=1),u&b.InputMask.Left&&(p.x-=1),u&b.InputMask.Right&&(p.x+=1),v=_.Direction.Confine(_.Direction.CalculateAngleFromRelativePoint(p)),isNaN(v)||o.face(v)),!(u&b.InputMask.Walk)){e.next=37;break}return e.next=34,C.default(o.direction,this.zone,this.engine,this);case 34:if(e.sent===w.ScriptResult.Done){e.next=37;break}return e.abrupt("return",!0);case 37:return e.abrupt("return",!1);case 38:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"_attackTriggered",value:function(){var e=this.engine.hero,t=e.weapon,n=this.engine.currentZone;if(!t)return e.isAttacking=!1,w.ScriptResult.Done;var r=_.Direction.CalculateRelativeCoordinates(e.direction,1),a=new _.Point(r.x,r.y,0);return _.Point.add(e.location,a).isInBounds(n.size)?void 0:(e.isAttacking=!1,w.ScriptResult.Done)}},{key:"_placeBullet",value:function(e){e.ammo--,0===e.ammo&&this.reloadWeapon()}},{key:"reloadWeapon",value:function(){var e=this.engine,t=e.inventory,n=e.hero,r=n.weapon,a=r.frames[0].extensionRight;t.removeItem(a),t.contains(a)?(e.equip(a),n.ammo=e.variant.getMaxAmmo(r)):e.equip((0,m.default)(t).call(t,(function(e){return e.hasAttributes(k.Tile.Attributes.Weapon)})))}},{key:"_handlePlacedTile",value:(t=(0,u.default)(i.default.mark((function e(){var t,n,r,a,o,u,l;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.engine,n=t.inputManager,r=n.placedTile,a=n.placedTileLocation,o=t.hero.location,r&&a){e.next=7;break}return e.abrupt("return",w.ScriptResult.Done);case 7:if(!t.variant.onPlaceTile(r,a,t)){e.next=12;break}return n.clear(),n.placedTile=null,n.placedTileLocation=null,e.abrupt("return",w.ScriptResult.UpdateScene);case 12:if(!a.isEqualTo(new _.Point(o.x,o.y))){e.next=16;break}return r.hasAttributes(k.Tile.Attributes.Weapon)?t.equip(r):r.hasAttributes(k.Tile.Attributes.Edible)?t.consume(r):(u=t.assets.get(k.Sound,t.variant.sounds.NoGo),t.mixer.play(u,D.Channel.Effect)),n.clear(),e.abrupt("return",w.ScriptResult.Done);case 16:if(!(a.distanceTo(o)>Math.sqrt(2))){e.next=19;break}return n.clear(),e.abrupt("return",w.ScriptResult.Done);case 19:if(!((l=this.engine.hpu.execute(z.HotspotExecutionMode.PlaceTile,a,r))&P.HotspotExecutionResult.Speak||l&P.HotspotExecutionResult.ChangeZone||l&P.HotspotExecutionResult.Drop)){e.next=22;break}return e.abrupt("return",w.ScriptResult.Void);case 22:return this.engine.spu.prepareExecution(w.EvaluationMode.PlaceItem,this.zone),e.next=25,this.engine.spu.run();case 25:return e.abrupt("return",e.sent);case 26:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"zone",get:function(){return this._zone},set:function(e){this._zone=e,this.engine.camera.zoneSize=e.size}},{key:"camera",get:function(){return this.engine.camera}},{key:"currentOffset",get:function(){return this.engine.camera.offset}}]),c}(M.default);t.default=R},34850:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(68190));(0,a.default)(t,"__esModule",{value:!0}),t.CalculateScoreBasedOnSolvedPuzzles=t.CalculateScoreBasedOnDifficulty=t.CalculateScoreBasedOnVisitedSectors=t.CalculateScoreBasedOnTime=void 0;var o=n(31560),u=n(17725),l=function(e){var t=e.totalPlayTime+((new Date).getTime()-e.currentPlayStart.getTime())/1e3,n=5*e.story.size.rawValue,r=u.floor(t/60)-n;return o.clamp(0,200-20*r,200)};t.CalculateScoreBasedOnTime=l;var s=function(e){var t,n,r=(0,i.default)(t=e.world.sectors).call(t,(function(e){return e.zone})).length,a=(0,i.default)(n=e.world.sectors).call(n,(function(e){return e.zone&&e.visited})).length;return o.clamp(10,10*u.ceil(a/r*10),100)};t.CalculateScoreBasedOnVisitedSectors=s;var d=function(e){var t=e.settings.difficulty;return t<0||t>100?0:40*o.clamp(1,u.ceil(t/10),10)};t.CalculateScoreBasedOnDifficulty=d;var c=function(e){var t,n=(0,i.default)(t=e.world.sectors).call(t,(function(e){return e.zone&&e.solved1&&e.solved2})).length/e.story.puzzles.length;return 3*o.clamp(10,10*u.ceil(10*n),100)};t.CalculateScoreBasedOnSolvedPuzzles=c,t.default=function(e){var t=l(e)+s(e)+d(e)+c(e);return t<1e3&&(t+=o.rand()%9),o.clamp(0,t,1e3)}},85827:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108)),o=r(n(40361)),u=r(n(7583));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var l=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;(0,o.default)(this,e),this.engine=n,this._conditions=t}var t;return(0,u.default)(e,[{key:"check",value:(t=(0,i.default)(a.default.mark((function e(t,n,r){var i;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this._conditions[t.opcode],console.assert(!!i,"Unknown condition opcode 0x".concat(t.opcode.toString(16),"!")),e.next=4,i(t.arguments,r,this.engine,n);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})}]),e}();t.default=l},38811:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017),l=n(84485);t.default={Opcode:2,Name:"bump",Arguments:[u.Type.Number,u.Type.Number,u.Type.TileID],Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r,i){var o;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!=(i&l.default.Bump)){e.next=2;break}return e.abrupt("return");case 2:if((o=r.bumpedLocation)&&o.x===t[0]&&o.y===t[1]){e.next=5;break}return e.abrupt("return",!1);case 5:if(n.getTileID(t[0],t[1],0)!==t[2]){e.next=7;break}return e.abrupt("return",!0);case 7:if(n.getTileID(t[0],t[1],1)!==t[2]){e.next=9;break}return e.abrupt("return",!0);case 9:if(n.getTileID(t[0],t[1],2)!==t[2]){e.next=11;break}return e.abrupt("return",!0);case 11:return e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e)}))),function(e,t,n,r){return o.apply(this,arguments)})}},47390:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:31,Arguments:[u.Type.Number],Description:"Current zone's `counter` value is not equal to `arg_0`",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.counter!==t[0]);case 1:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},22326:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:5,Name:"counter-is",Description:"Current zone's `counter` value is equal to `arg_0`",Arguments:[u.Type.Number],Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.counter===t[0]);case 1:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},54805:(e,t,n)=>{var r=n(92915),a=n(69159),i=n(67986),o=n(13037),u=n(29689),l=n(38468),s=l(n(63789)),d=l(n(76108));function c(e,t){var n=void 0!==i&&o(e)||e["@@iterator"];if(!n){if(u(e)||(n=function(e,t){var n;if(!e)return;if("string"==typeof e)return f(e,t);var i=r(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return a(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return f(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var l=0,s=function(){};return{s,n:function(){return l>=e.length?{done:!0}:{done:!1,value:e[l++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var d,c=!0,h=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){h=!0,d=e},f:function(){try{c||null==n.return||n.return()}finally{if(h)throw d}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}(0,l(n(68748)).default)(t,"__esModule",{value:!0});var h,p=n(14017),v=n(17766);t.default={Opcode:29,Arguments:[p.Type.ZoneX,p.Type.ZoneY],Implementation:(h=(0,d.default)(s.default.mark((function e(t,n,r){var a,i,o;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=c(n.hotspots),e.prev=1,a.s();case 3:if((i=a.n()).done){e.next=9;break}if((o=i.value).type!==v.Hotspot.Type.DropQuestItem||o.x!==t[0]||o.y!==t[1]||!o.enabled){e.next=7;break}return e.abrupt("return",!0);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),a.e(e.t0);case 14:return e.prev=14,a.f(),e.finish(14);case 17:return e.abrupt("return",!1);case 18:case"end":return e.stop()}}),e,null,[[1,11,14,17]])}))),function(e,t,n){return h.apply(this,arguments)})}},41247:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:15,Arguments:[u.Type.TileID],Description:"True if `arg_0` is equal to current goal item id",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.story.goal.item1.id===t[0]);case 1:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},3555:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(84485);t.default={Opcode:9,Arguments:[],Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r,i){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",0!=(i&u.default.ByPlane));case 1:case"end":return e.stop()}}),e)}))),function(e,t,n,r){return o.apply(this,arguments)})}},99941:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(94433)),o=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var u,l=n(14017);t.default={Opcode:22,Arguments:[l.Type.TileID],Description:"True the item provided by current zone is `arg_0`",Implementation:(u=(0,o.default)(a.default.mark((function e(t,n,r){var o,u,l;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=(0,i.default)(t,1),u=o[0],l=r.currentWorld.findSectorContainingZone(n),e.abrupt("return",null!==l.findItem&&l.findItem.id===u);case 3:case"end":return e.stop()}}),e)}))),function(e,t,n){return u.apply(this,arguments)})}},59728:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:35,Arguments:[u.Type.Number],Description:"Total games won is greater than `arg_0`",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.persistentState.gamesWon>t[0]);case 1:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},64209:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:28,Arguments:[u.Type.Number],Description:"Total games won is equal to `arg_0`",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.persistentState.gamesWon===t[0]);case 1:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},36507:(e,t,n)=>{var r,a=n(38468),i=a(n(63789)),o=a(n(76108));(0,a(n(68748)).default)(t,"__esModule",{value:!0}),t.default={Opcode:30,Arguments:[],Description:"Determines if inventory contains any of the required items needed for current zone",Implementation:(r=(0,o.default)(i.default.mark((function e(t,n,r){var a,o,u;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.currentWorld.findSectorContainingZone(n),o=a.requiredItem,u=a.additionalRequiredItem,e.abrupt("return",r.inventory.contains(o)||r.inventory.contains(u));case 2:case"end":return e.stop()}}),e)}))),function(e,t,n){return r.apply(this,arguments)})}},75890:(e,t,n)=>{var r,a=n(38468),i=a(n(63789)),o=a(n(76108));(0,a(n(68748)).default)(t,"__esModule",{value:!0}),t.default={Opcode:18,Description:"Returns true if the hero has the goal item",Arguments:[],Implementation:(r=(0,o.default)(i.default.mark((function e(t,n,r){var a,o,u;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=null===(a=r.story)||void 0===a||null===(o=a.goal)||void 0===o?void 0:o.item1){e.next=3;break}return e.abrupt("return",!1);case 3:return e.abrupt("return",r.inventory.contains(u));case 4:case"end":return e.stop()}}),e)}))),function(e,t,n){return r.apply(this,arguments)})}},49227:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:13,Arguments:[u.Type.TileID],Description:"True if inventory contains `arg_0`.\nIf `arg_0` is `-1` check if inventory contains the item provided by the current zone's puzzle",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){var i,o;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return-1===(i=t[0])&&(o=r.currentWorld.findSectorContainingZone(n)).findItem&&(i=o.findItem.id),e.abrupt("return",r.inventory.contains(i));case 3:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},54662:(e,t,n)=>{var r,a=n(38468),i=a(n(63789)),o=a(n(76108)),u=a(n(68748)),l=a(n(55903));(0,u.default)(t,"__esModule",{value:!0}),t.default={Opcode:12,Arguments:[],Implementation:(r=(0,o.default)(i.default.mark((function e(t,n,r){var a;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!(0,l.default)(a=n.monsters).call(a,(function(e){return e.enabled})));case 1:case"end":return e.stop()}}),e)}))),function(e,t,n){return r.apply(this,arguments)})}},7782:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:20,Arguments:[u.Type.Number],Description:"Hero's health is greater than `arg_0`.",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.hero.health>t[0]);case 1:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},54362:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:19,Arguments:[u.Type.Number],Description:"Hero's health is less than `arg_0`.",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.hero.health<t[0]);case 1:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},81080:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:24,Arguments:[u.Type.ZoneX,u.Type.ZoneY],Description:"True if hero's x/y position is `args_0`x`args_1`.",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.hero.location.x===t[0]&&r.hero.location.y===t[1]);case 1:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},47590:(e,t,n)=>{var r,a=n(38468),i=a(n(68748)),o=a(n(6978)),u=a(n(5459)),l=a(n(35983));(0,i.default)(t,"__esModule",{value:!0}),t.ConditionImplementations=t.ConditionsByOpcode=t.ConditionsByName=void 0;var s=n(38811),d=n(22326),c=n(47390),f=n(41247),h=n(3555),p=n(99941),v=n(64209),y=n(59728),m=n(36507),g=n(54805),_=n(49227),w=n(54662),k=n(7782),b=n(54362),S=n(81080),I=n(61968),x=n(75890),T=n(5863),M=n(35153),E=n(1391),C=n(30497),A=n(59398),D=n(2900),z=n(79276),P=n(25932),R=n(50173),L=n(53078),F=n(77822),W=n(47936),B=n(69940),N=n(42262),U=n(14712),H=n(56146),O=n(51544),Z=n(43416),q=n(35632),X={Bump:s.default,CounterIs:d.default,CounterIsNot:c.default,DropsQuestItemAt:g.default,EndingIs:f.default,EnterByPlane:h.default,FindItemIs:p.default,GamesWonIs:v.default,GamesWonIsGreaterThan:y.default,HasAnyRequiredItem:m.default,HasItem:_.default,HasNoActiveMonsters:w.default,HealthIsGreaterThan:k.default,HealthIsLessThan:b.default,HeroIsAt:S.default,IsVariable:I.default,HasGoalItem:x.default,MonsterIsDead:M.default,NoItemPlaced:T.default,PlacedItemIs:E.default,PlacedItemIsNot:C.default,RandomIs:A.default,RandomIsGreaterThan:D.default,RandomIsLessThan:z.default,RandomIsNot:P.default,RequiredItemIs:R.default,SectorCounterIs:L.default,SectorCounterIsGreaterThan:F.default,SectorCounterIsLessThan:W.default,SectorCounterIsNot:B.default,StandingOn:N.default,TileAtIs:U.default,Unused:H.default,ZoneEntered:O.default,ZoneIsSolved:Z.default,ZoneNotInitialized:q.default};t.ConditionsByName=X;var V=new Array((0,o.default)(r=(0,u.default)(X)).call(r,(function(e,t){return t.Opcode-e.Opcode})).first().Opcode);t.ConditionsByOpcode=V,X.each((function(e,t){return V[t.Opcode]=t}));var J=(0,l.default)(V).call(V,(function(e){return e.Implementation}));t.ConditionImplementations=J},61968:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:34,Arguments:[u.Type.TileID,u.Type.Number,u.Type.Number,u.Type.Number],Description:"Check if variable identified by `arg_0``arg_1``arg_2` is set to `arg_3`. Internally this is implemented as opcode 0x0a, check if tile at `arg_0`x`arg_1`x`arg_2` is equal to `arg_3`",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.getTileID(t[1],t[2],t[3])===t[0]);case 1:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},35153:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:11,Arguments:[u.Type.MonsterId],Description:"True if monster `arg_0` is dead.",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t[0]>=0&&t[0]<=n.monsters.length&&n.monsters[t[0]]&&!n.monsters[t[0]].alive);case 1:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},5863:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:17,Description:"Returns true if the user did not place an item",Arguments:[u.Type.Number,u.Type.Number,u.Type.Number,u.Type.Number,u.Type.Number],Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!r.inputManager.placedTile);case 1:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},30497:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(94433)),o=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var u,l=n(14017),s=n(84485);t.default={Opcode:23,Arguments:[l.Type.Number,l.Type.Number,l.Type.Number,l.Type.TileID,l.Type.TileID],Implementation:(u=(0,o.default)(a.default.mark((function e(t,n,r,o){var u,l,d,c,f,h,p;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o===s.default.PlaceItem){e.next=2;break}return e.abrupt("return",!1);case 2:if(u=(0,i.default)(t,5),l=u[0],d=u[1],c=u[2],f=u[3],h=u[4],!(l<0||d<0||c<0||f<0)){e.next=6;break}return console.warn("Not implemented"),e.abrupt("return",!1);case 6:return h<0&&(p=r.currentWorld.findSectorContainingZone(n),h=p.requiredItem.id),e.abrupt("return",r.inputManager.placedTileLocation.x===l&&r.inputManager.placedTileLocation.y===d&&n.getTileID(l,d,c)===f&&r.inputManager.placedTile.id!==h);case 8:case"end":return e.stop()}}),e)}))),function(e,t,n,r){return u.apply(this,arguments)})}},1391:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(94433)),o=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var u,l=n(14017),s=n(84485);t.default={Opcode:3,Arguments:[l.Type.Number,l.Type.Number,l.Type.Number,l.Type.TileID,l.Type.TileID],Implementation:(u=(0,o.default)(a.default.mark((function e(t,n,r,o){var u,l,d,c,f,h,p;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o===s.default.PlaceItem){e.next=2;break}return e.abrupt("return",!1);case 2:if(u=(0,i.default)(t,5),l=u[0],d=u[1],c=u[2],f=u[3],h=u[4],!(l<0||d<0||c<0||f<0)){e.next=6;break}return console.warn("Not implemented"),e.abrupt("return",!1);case 6:return h<0&&(p=r.currentWorld.findSectorContainingZone(n),h=p.requiredItem.id),e.abrupt("return",r.inputManager.placedTileLocation.x===l&&r.inputManager.placedTileLocation.y===d&&r.inputManager.placedTile.id===h&&n.getTileID(l,d,c)===f);case 8:case"end":return e.stop()}}),e)}))),function(e,t,n,r){return u.apply(this,arguments)})}},2900:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:7,Arguments:[u.Type.Number],Description:"Current zone's `random` value is greater than `arg_0`",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.random>t[0]);case 1:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},79276:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:8,Arguments:[u.Type.Number],Description:"Current zone's `random` value is less than `arg_0`",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.random<t[0]);case 1:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},25932:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:32,Arguments:[u.Type.Number],Description:"Current zone's `random` value is not equal to `arg_0`",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.random!==t[0]);case 1:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},59398:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:6,Arguments:[u.Type.Number],Description:"Current zone's `random` value is equal to `arg_0`",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.random===t[0]);case 1:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},50173:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:14,Arguments:[u.Type.TileID],Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){var i,o,u;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=r.currentWorld.findSectorContainingZone(n),o=i.requiredItem,u=i.additionalRequiredItem,!o||t[0]!==o.id){e.next=3;break}return e.abrupt("return",!0);case 3:if(!u||t[0]!==u.id){e.next=5;break}return e.abrupt("return",!0);case 5:return e.abrupt("return",!1);case 6:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},77822:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:27,Arguments:[u.Type.Number],Description:"Current zone's `sector-counter` value is greater than `arg_0`",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.sectorCounter>t[0]);case 1:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},47936:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:26,Arguments:[u.Type.Number],Description:"Current zone's `sector-counter` value is less than `arg_0`",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.sectorCounter<t[0]);case 1:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},69940:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:33,Arguments:[u.Type.Number],Description:"Current zone's `sector-counter` value is not equal to `arg_0`",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.sectorCounter!==t[0]);case 1:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},53078:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:25,Arguments:[u.Type.Number],Description:"Current zone's `sector-counter` value is equal to `arg_0`",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.sectorCounter===t[0]);case 1:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},42262:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:4,Arguments:[u.Type.ZoneX,u.Type.ZoneY,u.Type.TileID],Description:"Check if hero is at `arg_0`x`arg_1` and the floor tile is `arg_2`",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.hero.location.x===t[0]&&r.hero.location.y===t[1]&&n.getTileID(t[0],t[1],0)===t[2]);case 1:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},14712:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:10,Arguments:[u.Type.TileID,u.Type.Number,u.Type.Number,u.Type.Number],Description:"Check if tile at `arg_0`x`arg_1`x`arg_2` is equal to `arg_3`",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.getTileID(t[1],t[2],t[3])===t[0]);case 1:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},56146:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:21,Arguments:[u.Type.Number,u.Type.Number,u.Type.Number,u.Type.Number,u.Type.Number],Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},51544:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(84485);t.default={Opcode:1,Arguments:[],Description:"Evaluates to true if hero just entered the zone",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r,i){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",0!=(i&u.default.JustEntered));case 1:case"end":return e.stop()}}),e)}))),function(e,t,n,r){return o.apply(this,arguments)})}},43416:(e,t,n)=>{var r,a=n(38468),i=a(n(63789)),o=a(n(76108));(0,a(n(68748)).default)(t,"__esModule",{value:!0}),t.default={Opcode:16,Arguments:[],Description:"True if the current zone is solved",Implementation:(r=(0,o.default)(i.default.mark((function e(t,n,r){var a;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.currentWorld.findSectorContainingZone(n),e.abrupt("return",a&&a.solved);case 2:case"end":return e.stop()}}),e)}))),function(e,t,n){return r.apply(this,arguments)})}},35632:(e,t,n)=>{var r,a=n(38468),i=a(n(63789)),o=a(n(76108));(0,a(n(68748)).default)(t,"__esModule",{value:!0}),t.default={Opcode:0,Arguments:[],Description:"Evaluates to true exactly once (used for initialization)",Implementation:(r=(0,o.default)(i.default.mark((function e(t,n,r){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!n.actionsInitialized);case 1:case"end":return e.stop()}}),e)}))),function(e,t,n){return r.apply(this,arguments)})}},84485:(e,t,n)=>{var r;(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),function(e){e[e.Initialize=1]="Initialize",e[e.JustEntered=2]="JustEntered",e[e.ByPlane=4]="ByPlane",e[e.Bump=8]="Bump",e[e.Walk=16]="Walk",e[e.PlaceItem=32]="PlaceItem"}(r||(r={})),t.default=r},57266:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.HotspotExecutionMode=void 0,function(e){e[e.Initialize=0]="Initialize",e[e.Bump=1]="Bump",e[e.PlaceTile=2]="PlaceTile",e[e.Stand=3]="Stand",e[e.Walk=4]="Walk"}(t.HotspotExecutionMode||(t.HotspotExecutionMode={}))},33683:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.HotspotExecutionResult=void 0,function(e){e[e.Void=0]="Void",e[e.ChangeZone=1]="ChangeZone",e[e.Speak=2]="Speak",e[e.Drop=4]="Drop",e[e.Inventory=8]="Inventory",e[e.Sounds=16]="Sounds"}(t.HotspotExecutionResult||(t.HotspotExecutionResult={}))},57534:(e,t,n)=>{var r=n(92915),a=n(69159),i=n(67986),o=n(13037),u=n(29689),l=n(38468),s=l(n(40361)),d=l(n(7583)),c=l(n(68748)),f=l(n(64094)),h=l(n(9805)),p=l(n(42601)),v=l(n(67093));function y(e,t){var n=void 0!==i&&o(e)||e["@@iterator"];if(!n){if(u(e)||(n=function(e,t){var n;if(!e)return;if("string"==typeof e)return m(e,t);var i=r(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return a(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return m(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var l=0,s=function(){};return{s,n:function(){return l>=e.length?{done:!0}:{done:!1,value:e[l++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var d,c=!0,f=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){f=!0,d=e},f:function(){try{c||null==n.return||n.return()}finally{if(f)throw d}}}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}(0,c.default)(t,"__esModule",{value:!0});var g=n(57266),_=n(33683),w=n(92540),k=n(17766),b=n(65170),S=n(55348),I=n(67418),x=n(33866),T=n(81897),M=n(45318),E=n(48925),C=n(42276),A=n(78126),D=function(){function e(t){(0,s.default)(this,e),this.initializeTypes=new f.default([k.Hotspot.Type.DropMap,k.Hotspot.Type.DropItem,k.Hotspot.Type.DropWeapon,k.Hotspot.Type.DropQuestItem,k.Hotspot.Type.DropUniqueWeapon,k.Hotspot.Type.NPC,k.Hotspot.Type.SpawnLocation]),this.standDispatch=new h.default([[k.Hotspot.Type.VehicleTo,C.default],[k.Hotspot.Type.VehicleBack,C.default],[k.Hotspot.Type.ShipToPlanet,T.default],[k.Hotspot.Type.ShipFromPlanet,x.default]]),this.walkDispatch=new h.default([[k.Hotspot.Type.DoorIn,S.default],[k.Hotspot.Type.DoorOut,I.default],[k.Hotspot.Type.Teleporter,E.default]]),this.bumpDispatch=new h.default([[k.Hotspot.Type.SpawnLocation,M.default],[k.Hotspot.Type.DropItem,b.default],[k.Hotspot.Type.DropMap,b.default],[k.Hotspot.Type.DropQuestItem,b.default],[k.Hotspot.Type.DropUniqueWeapon,b.default],[k.Hotspot.Type.DropWeapon,b.default]]),this._engine=t}return(0,d.default)(e,[{key:"execute",value:function(e,t,n){var r,a=this,i=this._engine.currentZone;switch(t=t||this._engine.hero.location,e){case g.HotspotExecutionMode.Initialize:(0,p.default)(r=i.hotspots).call(r,(function(e){return a._laydownHotspotItem(i,e)}));break;case g.HotspotExecutionMode.Bump:return this.executeHotspots(t,this.bumpDispatch);case g.HotspotExecutionMode.PlaceTile:return this.executePlacedTileHotspots(t,n);case g.HotspotExecutionMode.Stand:return this.executeHotspots(t,this.standDispatch);case g.HotspotExecutionMode.Walk:return this.executeHotspots(t,this.walkDispatch)}return _.HotspotExecutionResult.Void}},{key:"executeHotspots",value:function(e,t){var n,r=this._engine,a=y(r.currentZone.hotspots);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(i.enabled&&(t.has(i.type)&&i.location.isEqualTo(e)))return t.get(i.type)(r,i)}}catch(e){a.e(e)}finally{a.f()}return _.HotspotExecutionResult.Void}},{key:"executePlacedTileHotspots",value:function(e,t){var n=this._engine,r=n.story,a=this._engine.currentZone,i=n.findSectorContainingZone(a).sector,o=i.puzzleIndex;if(o<0||i.solved1){var u,l=(0,v.default)(u=a.hotspots).call(u,(function(t){return t.location.isEqualTo(e)}));return l&&l.enabled?(l.type!==k.Hotspot.Type.Lock||i.requiredItem!==t||(i.solved1=!0,n.inventory.removeItem(t)),_.HotspotExecutionResult.Void):_.HotspotExecutionResult.Void}var s=(i.usedAlternateStrain?r.puzzles[0]:r.puzzles[1])[o];if(!s)return _.HotspotExecutionResult.Void;if(s.type===k.Puzzle.Type.Use){var d;if(i.requiredItem!==t)return _.HotspotExecutionResult.Void;var c=a.getTile(e.x,e.y,k.Zone.Layer.Object),f=(0,v.default)(d=a.hotspots).call(d,(function(t){return t.location.isEqualTo(e)}));if(i.npc===c&&f&&f.enabled){var h=i.findItem;n.inventory.removeItem(t);var p=s.strings[1];return n.speak(p,e).then((function(){return n.dropItem(h,e)})).then((function(){i.solved1=!0,i.solved2=!0})),_.HotspotExecutionResult.Speak|_.HotspotExecutionResult.Drop|_.HotspotExecutionResult.Inventory}var y=n.assets.get(k.Sound,n.variant.sounds.NoGo);return n.mixer.play(y,A.Channel.Effect),_.HotspotExecutionResult.Sounds}if(s.type===k.Puzzle.Type.Trade){var m,g;if(!(0,v.default)(m=a.hotspots).call(m,(function(n){return n.location.isEqualTo(e)&&n.enabled&&n.type===k.Hotspot.Type.Lock&&n.arg===t.id}))){var w=n.assets.get(k.Sound,n.variant.sounds.NoGo);return n.mixer.play(w,A.Channel.Effect),_.HotspotExecutionResult.Sounds}i.solved1=!0,n.inventory.removeItem(t);var b=i.findItem;return b&&(0,v.default)(g=a.hotspots).call(g,(function(e){return e.type===k.Hotspot.Type.DropQuestItem&&e.enabled&&e.arg===b.id}))?(i.solved2=!0,n.dropItem(b,e),_.HotspotExecutionResult.Inventory|_.HotspotExecutionResult.Drop):_.HotspotExecutionResult.Inventory}console.log("unhandled case for puzzle type",s.type.name)}},{key:"_laydownHotspotItem",value:function(e,t){if(t.enabled&&-1!==t.arg&&this.initializeTypes.has(t.type)){var n=t.location.clone();if(n.z=k.Zone.Layer.Object,!e.getTile(n)){var r=this._engine.assets.get(k.Tile,t.arg,w.NullIfMissing);e.setTile(r,n)}}}}]),e}();t.default=D},55348:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(67093));(0,a.default)(t,"__esModule",{value:!0});var o=n(17766),u=n(63806),l=n(31560),s=n(92540),d=n(33683);t.default=function(e,t){var n;console.assert(e.sceneManager.currentScene instanceof u.ZoneScene);var r=e.currentZone,a=e.assets.get(o.Zone,t.arg,s.NullIfMissing),c=(0,i.default)(n=a.hotspots).call(n,(function(e){return e.type===o.Hotspot.Type.DoorOut&&(-1===e.arg||e.arg===r.id)}));console.assert(!!c,"Found no way to return to current zone");var f=e.findLocationOfZone(a),h=f.world,p=f.location;a.doorInLocation=t.location,c.arg=r.id,e.sceneManager.currentScene instanceof u.RoomTransitionScene&&e.sceneManager.popScene();var v=new u.RoomTransitionScene;return v.destinationHeroLocation=new l.Point(c.x,c.y),v.destinationZone=a,v.scene=e.sceneManager.currentScene,v.destinationWorld=h,v.destinationSector=p,e.sceneManager.pushScene(v),d.HotspotExecutionResult.ChangeZone}},67418:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(17766),a=n(63806),i=n(33683);t.default=function(e,t){console.assert(-1!==t.arg,"This is not where we're coming from!"),console.assert(e.sceneManager.currentScene instanceof a.ZoneScene);var n=e.currentZone,o=e.assets.get(r.Zone,t.arg),u=e.findLocationOfZone(o),l=u.world,s=u.location;e.sceneManager.currentScene instanceof a.RoomTransitionScene&&e.sceneManager.popScene();var d=new a.RoomTransitionScene;return d.destinationHeroLocation=n.doorInLocation,d.destinationZone=o,d.scene=e.sceneManager.currentScene,d.destinationWorld=l,d.destinationSector=s,e.sceneManager.pushScene(d),i.HotspotExecutionResult.ChangeZone}},65170:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(17766),a=n(33683);t.default=function(e,t){var n=e.currentZone,i=n.getTile(t.x,t.y,r.Zone.Layer.Object);return i?i.id!==t.arg?a.HotspotExecutionResult.Void:(n.setTile(null,t.location.x,t.location.y,r.Zone.Layer.Object),e.dropItem(i,t.location).then((function(){if(t.type===r.Hotspot.Type.DropQuestItem){var a=e.findSectorContainingZone(n).sector;console.assert(!!a),a.solved1=!0,a.solved2=!0}})),t.enabled=!1,a.HotspotExecutionResult.Drop):a.HotspotExecutionResult.Void}},33866:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(17766),a=n(63806),i=n(31560),o=n(33683);t.default=function(e,t){console.assert(-1!==t.arg,"This is not where we're coming from!");var n=e.assets.get(r.Zone,t.arg),u=n.hotspots.withType(r.Hotspot.Type.ShipToPlanet).first(),l=e.dagobah.findLocationOfZone(n);console.assert(null!==u,"Zone does not have a proper target spot"),console.assert(null!==l,"ShipFromPlanet destination must not be on main world!"),console.assert(e.sceneManager.currentScene instanceof a.ZoneScene),e.sceneManager.currentScene instanceof a.RoomTransitionScene&&e.sceneManager.popScene();var s=new a.RoomTransitionScene;return s.destinationHeroLocation=new i.Point(u.x,u.y),s.destinationZone=n,s.scene=e.sceneManager.currentScene,s.destinationWorld=e.dagobah,s.destinationSector=l,e.sceneManager.pushScene(s),o.HotspotExecutionResult.ChangeZone}},81897:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(67093));(0,a.default)(t,"__esModule",{value:!0});var o=n(17766),u=n(63806),l=n(31560),s=n(33683);t.default=function(e,t){var n;console.assert(-1!==t.arg,"This is not where we're coming from!");var r=e.assets.get(o.Zone,t.arg),a=(0,i.default)(n=r.hotspots).call(n,(function(e){return e.type===o.Hotspot.Type.ShipFromPlanet}));console.assert(null!==a);var d=new u.RoomTransitionScene;d.destinationHeroLocation=new l.Point(a.x,a.y),d.destinationZone=r,console.assert(e.sceneManager.currentScene instanceof u.ZoneScene),d.scene=e.sceneManager.currentScene,e.sceneManager.currentScene instanceof u.RoomTransitionScene&&e.sceneManager.popScene();var c=e.world.findLocationOfZone(r);return console.assert(null!==c,"ShipToPlanet destination must be on the main world!"),d.destinationWorld=e.world,d.destinationSector=c,e.sceneManager.pushScene(d),s.HotspotExecutionResult.ChangeZone}},45318:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(17766),a=n(33683);t.default=function(e,t){var n=e.currentZone,i=e.findSectorContainingZone(n),o=i.world,u=i.sector,l=e.story,s=n.getTile(t.x,t.y,r.Zone.Layer.Object);if(!s)return a.HotspotExecutionResult.Void;if(s!==u.npc)return a.HotspotExecutionResult.Void;if(o===e.dagobah){var d=u.usedAlternateStrain?l.puzzles[0]:l.puzzles[1],c=d.last();if(console.assert(!!c),u.solved1){var f=c.strings[2];return e.speak(f,t.location),a.HotspotExecutionResult.Speak}var h=c.strings[3],p=d.first();return console.assert(!!p),e.speak(h,t.location).then((function(){return e.dropItem(p.item1,t.location)})).then((function(){u.solved1=!0})).then((function(){u.solved2=!0})),a.HotspotExecutionResult.Drop|a.HotspotExecutionResult.Speak}var v=u.puzzleIndex;if(-1===v)return a.HotspotExecutionResult.Void;if(u.solved1){var y=(u.usedAlternateStrain?l.puzzles[0]:l.puzzles[1])[v];console.assert(!!y);var m=y.strings[1];return e.speak(m,t.location),a.HotspotExecutionResult.Speak}var g=u.usedAlternateStrain?l.puzzles[0]:l.puzzles[1],_=g[v];console.assert(!!_);var w=[_.strings[0],g[v+1].strings[2]].join(" ");return e.speak(w,t.location),a.HotspotExecutionResult.Speak}},48925:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(67093));(0,a.default)(t,"__esModule",{value:!0});var o=n(17766),u=n(63806),l=n(33683);t.default=function(e,t){var n;if(!(0,i.default)(n=e.inventory).call(n,(function(e){return e.hasAttributes(o.Tile.Attributes.Map)})))return l.HotspotExecutionResult.Void;var r=new u.TeleportScene;return e.sceneManager.pushScene(r),l.HotspotExecutionResult.ChangeZone}},42276:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(17766),a=n(63806),i=n(33683);t.default=function(e,t){var n=t.type===r.Hotspot.Type.VehicleTo?r.Hotspot.Type.VehicleBack:r.Hotspot.Type.VehicleTo,o=e.assets.get(r.Zone,t.arg),u=e.currentWorld.findLocationOfZone(o),l=o.hotspots.withType(n).first().location;e.sceneManager.currentScene instanceof a.RoomTransitionScene&&e.sceneManager.popScene();var s=new a.RoomTransitionScene;return s.destinationHeroLocation=l,s.destinationZone=o,s.scene=e.sceneManager.currentScene,s.destinationWorld=e.currentWorld,s.destinationSector=u,e.sceneManager.pushScene(s),i.HotspotExecutionResult.ChangeZone}},83608:(e,t,n)=>{var r=n(38468)(n(68748));(0,r.default)(t,"__esModule",{value:!0}),t.HotspotProcessingUnit=t.Conditions=t.Instructions=t.EvaluationMode=t.ScriptResult=t.ConditionImplementations=t.ScriptProcessingUnit=t.ConditionsByName=t.ConditionsByOpcode=t.InstructionsByName=t.InstructionsByOpcode=t.InstructionExecutor=t.ConditionChecker=t.Result=t.Type=void 0;var a=n(85827);t.ConditionChecker=a.default;var i=n(47590);(0,r.default)(t,"ConditionImplementations",{enumerable:!0,get:function(){return i.ConditionImplementations}}),(0,r.default)(t,"ConditionsByName",{enumerable:!0,get:function(){return i.ConditionsByName}}),(0,r.default)(t,"ConditionsByOpcode",{enumerable:!0,get:function(){return i.ConditionsByOpcode}});var o=n(30885);t.InstructionExecutor=o.default;var u=n(14017);(0,r.default)(t,"Result",{enumerable:!0,get:function(){return u.Result}}),(0,r.default)(t,"ScriptResult",{enumerable:!0,get:function(){return u.ScriptResult}}),(0,r.default)(t,"Type",{enumerable:!0,get:function(){return u.Type}});var l=n(35288);(0,r.default)(t,"InstructionsByName",{enumerable:!0,get:function(){return l.InstructionsByName}}),(0,r.default)(t,"InstructionsByOpcode",{enumerable:!0,get:function(){return l.InstructionsByOpcode}});var s=n(84485);t.EvaluationMode=s.default;var d=n(17438);t.ScriptProcessingUnit=d.default;var c=n(57534);t.HotspotProcessingUnit=c.default;var f=n(35288);t.Instructions=f;var h=n(47590);t.Conditions=h},30885:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108)),o=r(n(40361)),u=r(n(7583));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var l=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;(0,o.default)(this,e),this.action=null,this._instructions=t,this.engine=n}var t;return(0,u.default)(e,[{key:"execute",value:(t=(0,i.default)(a.default.mark((function e(t){var n;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._instructions[t.opcode],console.assert(!!n,"Unknown instruction opcode 0x".concat(t.opcode.toString(16),"!")),e.next=4,n(t,this.engine,this.action);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}();t.default=l},37192:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:37,Arguments:[u.Type.Number],Description:"Increase hero's health by `arg_0`. New health is capped at hero's max health (0x300).",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.hero.health+=t.arguments[0],e.abrupt("return",u.Result.Void);case 2:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},3689:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017),l=n(17766);t.default={Opcode:28,Arguments:[u.Type.TileID],Description:"Add item with id `arg_0` to inventory",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){var i,o,s;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.arguments,o=n.currentWorld.findSectorContainingZone(r.zone),s=-1!==i[0]?n.assets.get(l.Tile,i[0]):o.findItem,n.inventory.addItem(s),e.abrupt("return",u.Result.Void);case 5:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},31990:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:14,Arguments:[u.Type.Number],Description:"Add `arg_0` to current zone's `counter` value",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.zone.counter+=t.arguments[0],e.abrupt("return",u.Result.Void);case 2:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},70307:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:35,Arguments:[u.Type.Number],Description:"Add `arg_0` to current zone's `sector-counter` value",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.zone.sectorCounter+=t.arguments[0],e.abrupt("return",u.Result.Void);case 2:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},38461:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(94433)),o=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var u,l=n(14017),s=n(17766),d=n(31560),c=n(63806);t.default={Opcode:33,Arguments:[l.Type.ZoneID,l.Type.ZoneX,l.Type.ZoneY],Description:"Change current zone to `arg_0`. Hero will be placed at `arg_1`x`arg_2` in the new zone.",Implementation:(u=(0,o.default)(a.default.mark((function e(t,n,r){var o,u,f,h,p,v,y,m,g,_;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=(0,i.default)(t.arguments,3),u=o[0],f=o[1],h=o[2],p=n.assets.get(s.Zone,u),v=new d.Point(f,h),y=n.findLocationOfZone(p),m=y.world,g=y.location,n.sceneManager.currentScene instanceof c.RoomTransitionScene&&n.sceneManager.popScene(),(_=new c.RoomTransitionScene).destinationHeroLocation=v,_.destinationZone=p,_.destinationWorld=null!=m?m:n.currentWorld,_.destinationSector=g,_.scene=n.sceneManager.currentScene,n.sceneManager.pushScene(_),e.abrupt("return",l.Result.UpdateZone);case 13:case"end":return e.stop()}}),e)}))),function(e,t,n){return u.apply(this,arguments)})}},77647:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:20,Arguments:[],Description:"Disable current action",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.enabled=!1,e.abrupt("return",u.Result.Void);case 2:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},59713:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108)),o=r(n(68748)),u=r(n(42601));(0,o.default)(t,"__esModule",{value:!0});var l,s=n(14017);t.default={Opcode:26,Arguments:[],Description:"Disable all monsters",Implementation:(l=(0,i.default)(a.default.mark((function e(t,n,r){var i;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,u.default)(i=r.zone.monsters).call(i,(function(e){return e.enabled=!1})),e.abrupt("return",s.Result.Void);case 2:case"end":return e.stop()}}),e)}))),function(e,t,n){return l.apply(this,arguments)})}},14100:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:22,Arguments:[u.Type.HotspotID],Description:"Disable hotspot `arg_0`",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){var i,o;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=r.zone,!(o=i.hotspots[t.arguments[0]])){e.next=5;break}return o.enabled=!1,e.abrupt("return",u.Result.Void);case 5:return e.abrupt("return",u.Result.Void);case 6:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},48674:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:24,Arguments:[u.Type.MonsterId],Description:"Disable monster `arg_0`",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){var i,o;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.zone,(o=i.monsters[t.arguments[0]])&&(o.enabled=!1),e.abrupt("return",u.Result.Void);case 4:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},29795:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:3,Arguments:[u.Type.Number,u.Type.Number,u.Type.Number,u.Type.Number,u.Type.Number],Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",u.Result.Void);case 1:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},77678:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(94433)),o=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var u,l=n(14017),s=n(17766),d=n(31560);t.default={Opcode:27,Arguments:[l.Type.TileID,l.Type.ZoneX,l.Type.ZoneY],Description:"Drops item `arg_0` for pickup at `arg_1`x`arg_2`. If the item is -1, it drops the current sector's find item. instead",Implementation:(u=(0,o.default)(a.default.mark((function e(t,n,r){var o,u,c,f,h;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=(0,i.default)(t.arguments,3),u=o[0],c=o[1],f=o[2],-1===u&&(h=n.currentWorld.findSectorContainingZone(r.zone),u=h.findItem.id),n.dropItem(n.assets.get(s.Tile,u),new d.Point(c,f)),e.abrupt("return",l.Result.UpdateScene);case 4:case"end":return e.stop()}}),e)}))),function(e,t,n){return u.apply(this,arguments)})}},41087:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108)),o=r(n(68748)),u=r(n(42601));(0,o.default)(t,"__esModule",{value:!0});var l,s=n(14017);t.default={Opcode:25,Arguments:[],Description:"Enable all monsters",Implementation:(l=(0,i.default)(a.default.mark((function e(t,n,r){var i;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,u.default)(i=r.zone.monsters).call(i,(function(e){return e.enabled=!0})),e.abrupt("return",s.Result.Void);case 2:case"end":return e.stop()}}),e)}))),function(e,t,n){return l.apply(this,arguments)})}},14367:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:21,Arguments:[u.Type.HotspotID],Description:"Enable hotspot `arg_0`",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){var i,o;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.zone,(o=i.hotspots[t.arguments[0]])&&(o.enabled=!0),e.abrupt("return",u.Result.Void);case 4:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},60584:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:23,Arguments:[u.Type.MonsterId],Description:"Enable monster `arg_0`",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){var i,o;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.zone,(o=i.monsters[t.arguments[0]])&&(o.enabled=!0),e.abrupt("return",u.Result.Void);case 4:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},32776:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:16,Arguments:[],Description:"Hide hero",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.hero.visible=!1,e.abrupt("return",u.Result.Void);case 2:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},35288:(e,t,n)=>{var r,a=n(38468),i=a(n(68748)),o=a(n(6978)),u=a(n(5459)),l=a(n(35983));(0,i.default)(t,"__esModule",{value:!0}),t.InstructionImplementations=t.InstructionsByOpcode=t.InstructionsByName=void 0;var s=n(37192),d=n(3689),c=n(31990),f=n(70307),h=n(38461),p=n(77647),v=n(59713),y=n(14100),m=n(48674),g=n(29795),_=n(77678),w=n(41087),k=n(14367),b=n(60584),S=n(32776),I=n(85831),x=n(43377),T=n(56873),M=n(89227),E=n(57311),C=n(40256),A=n(98598),D=n(902),z=n(93020),P=n(85601),R=n(52298),L=n(31136),F=n(88124),W=n(86153),B=n(11167),N=n(20987),U=n(22465),H=n(73556),O=n(1463),Z=n(97522),q=n(90202),X=n(95577),V=n(89936),J={AddHealth:s.default,AddItem:d.default,AddToCounter:c.default,AddToSectorCounter:f.default,ChangeZone:h.default,DisableAction:p.default,DisableAllMonsters:v.default,DisableHotspot:y.default,DisableMonster:m.default,DrawTile:g.default,DropItem:_.default,EnableAllMonsters:w.default,EnableHotspot:k.default,EnableMonster:b.default,HideHero:S.default,LoseGame:I.default,MarkAsSolved:x.default,MoveHeroBy:T.default,MoveHeroTo:F.default,MoveTile:M.default,PlaceTile:E.default,PlaySound:A.default,Redraw:D.default,RemoveItem:z.default,RemoveTile:P.default,RollDice:R.default,SetCounter:L.default,SetRandom:B.default,SetRectNeedsDisplay:N.default,SetSectorCounter:W.default,SetTileNeedsDisplay:U.default,SetVariable:C.default,ShowHero:H.default,SpeakHero:O.default,SpeakNpc:Z.default,StopSound:q.default,Wait:X.default,WinGame:V.default};t.InstructionsByName=J;var G=new Array((0,o.default)(r=(0,u.default)(J)).call(r,(function(e,t){return t.Opcode-e.Opcode})).first().Opcode);t.InstructionsByOpcode=G,J.each((function(e,t){return G[t.Opcode]=t}));var Y=(0,l.default)(G).call(G,(function(e){return e.Implementation}));t.InstructionImplementations=Y},85831:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(82127),l=n(63806),s=n(14017);t.default={Opcode:32,Arguments:[],Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.gameState=u.default.Lost,n.sceneManager.pushScene(new l.LoseScene),e.abrupt("return",s.Result.UpdateScene);case 3:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},43377:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:30,Arguments:[],Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){var i;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=n.currentWorld.findSectorContainingZone(r.zone)).solved1=!0,i.solved2=!0,i.solved3=!0,i.solved4=!0,e.abrupt("return",u.Result.Void);case 6:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},56873:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(94433)),o=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var u,l=n(14017);t.default={Opcode:19,Arguments:[l.Type.Number,l.Type.Number,l.Type.Number,l.Type.Number,l.Type.Number],Implementation:(u=(0,o.default)(a.default.mark((function e(t,n,r){var o,u,s,d,c;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=(0,i.default)(t.arguments,4),u=o[0],s=o[1],d=o[2],c=o[3],n.hero.location.x+=u,-1!==d&&(n.hero.location.x=d),n.hero.location.y+=s,-1!==c&&(n.hero.location.y=c),e.abrupt("return",l.Result.Void);case 6:case"end":return e.stop()}}),e)}))),function(e,t,n){return u.apply(this,arguments)})}},88124:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:18,Arguments:[u.Type.ZoneX,u.Type.ZoneY],Description:"Set hero's position to `arg_0`x`arg_1` ignoring impassable tiles. Execute hotspot actions, redraw the current scene and move camera if the hero is not hidden.",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.hero.location.x=t.arguments[0],n.hero.location.y=t.arguments[1],e.abrupt("return",u.Result.Void);case 3:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},89227:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(94433)),o=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var u,l=n(14017);t.default={Opcode:2,Arguments:[l.Type.ZoneX,l.Type.ZoneY,l.Type.ZoneZ,l.Type.ZoneX,l.Type.ZoneY],Description:"Move Tile at `arg_0`x`arg_0`x`arg_2` to `arg_3`x`arg_4`x`arg_2`. *Note that this can not be used to move tiles between layers!*",Implementation:(u=(0,o.default)(a.default.mark((function e(t,n,r){var o,u,s,d,c,f,h,p;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=r.zone,u=(0,i.default)(t.arguments,5),s=u[0],d=u[1],c=u[2],f=u[3],h=u[4],p=o.getTile(s,d,c),o.setTile(p,f,h,c),o.setTile(null,s,d,c),e.abrupt("return",l.Result.Void);case 6:case"end":return e.stop()}}),e)}))),function(e,t,n){return u.apply(this,arguments)})}},57311:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017),l=n(17766);t.default={Opcode:0,Arguments:[u.Type.ZoneX,u.Type.ZoneY,u.Type.ZoneZ,u.Type.TileID],Description:"Place tile `arg_3` at `arg_0`x`arg_1`x`arg_2`. To remove a tile the id -1 is used.",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){var i,o,s;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.arguments,o=r.zone,s=n.assets.get(l.Tile,i[3]),o.setTile(s,i[0],i[1],i[2]),e.abrupt("return",u.Result.Void);case 5:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},98598:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017),l=n(78126),s=n(17766),d=n(92540);t.default={Opcode:10,Arguments:[u.Type.SoundID],Description:"Play sound specified by `arg_0`",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){var i;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.assets.get(s.Sound,t.arguments[0],d.NullIfMissing),n.mixer.play(i,l.Channel.Effect),e.abrupt("return",u.Result.Void);case 3:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},902:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:9,Arguments:[],Description:"Redraw the whole scene immediately",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",u.Result.Void);case 1:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},93020:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017),l=n(17766);t.default={Opcode:29,Arguments:[u.Type.TileID],Description:"Remove one instance of item `arg_0` from the inventory",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){var i,o,s,d,c;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.arguments,o=r.zone,s=n.currentWorld.findSectorContainingZone(o),d=i[0]<0?s.requiredItem.id:i[0],c=n.assets.get(l.Tile,d),n.inventory.removeItem(c),e.abrupt("return",u.Result.Void);case 7:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},85601:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(94433)),o=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var u,l=n(14017);t.default={Opcode:1,Arguments:[l.Type.ZoneX,l.Type.ZoneY,l.Type.ZoneZ],Description:"Remove tile at `arg_0`x`arg_1`x`arg_2`",Implementation:(u=(0,o.default)(a.default.mark((function e(t,n,r){var o,u,s,d;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=(0,i.default)(t.arguments,3),u=o[0],s=o[1],d=o[2],r.zone.setTile(null,u,s,d),e.abrupt("return",l.Result.Void);case 4:case"end":return e.stop()}}),e)}))),function(e,t,n){return u.apply(this,arguments)})}},52298:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017),l=n(31560);t.default={Opcode:12,Arguments:[u.Type.Number],Description:"Set current zone's `random` to a random value between 1 and `arg_0`.",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){var i;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.arguments,r.zone.random=1+l.randmod(i[0]),e.abrupt("return",u.Result.Void);case 4:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},31136:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:13,Arguments:[u.Type.Number],Description:"Set current zone's `counter` value to a `arg_0`",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.zone.counter=t.arguments[0],e.abrupt("return",u.Result.Void);case 2:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},11167:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:36,Arguments:[u.Type.Number],Description:"Set current zone's `random` value to a `arg_0`",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.zone.random=t.arguments[0],e.abrupt("return",u.Result.Void);case 2:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},20987:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:7,Arguments:[u.Type.ZoneX,u.Type.ZoneY,u.Type.Number,u.Type.Number],Description:"Redraw the part of the current scene, specified by a rectangle positioned at `arg_0`x`arg_1` with width `arg_2` and height `arg_3`.",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",u.Result.Void);case 1:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},86153:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:34,Arguments:[u.Type.Number],Description:"Set current zone's `sector-counter` value to a `arg_0`",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.zone.sectorCounter=t.arguments[0],e.abrupt("return",u.Result.Void);case 2:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},22465:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:6,Arguments:[u.Type.ZoneX,u.Type.ZoneY],Description:"Redraw tile at `arg_0`x`arg_1`",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",u.Result.Void);case 1:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},40256:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017),l=n(17766);t.default={Opcode:15,Arguments:[u.Type.ZoneX,u.Type.ZoneY,u.Type.ZoneZ,u.Type.TileID],Description:"Set variable identified by `arg_0``arg_1``arg_2` to `arg_3`. Internally this is implemented as opcode 0x00, setting tile at `arg_0`x`arg_1`x`arg_2` to `arg_3`.",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){var i,o,s;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.arguments,o=r.zone,s=n.assets.get(l.Tile,i[3]),o.setTile(s,i[0],i[1],i[2]),e.abrupt("return",u.Result.Void);case 5:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},73556:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:17,Arguments:[],Description:"Show hero",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.hero.visible=!0,e.abrupt("return",u.Result.Void);case 2:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},1463:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:4,Arguments:[],UsesText:!0,Description:"Show speech bubble next to hero. _Uses `text` attribute_.",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.speak(t.text,n.hero.location),e.abrupt("return",u.Result.UpdateText);case 2:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},97522:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(94433)),o=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var u,l=n(14017),s=n(31560);t.default={Opcode:5,Arguments:[l.Type.ZoneX,l.Type.ZoneY],UsesText:!0,Description:"Show speech bubble at `arg_0`x`arg_1`. _Uses `text` attribute_. The characters `` and `` are used as placeholders for provided and required items of the current zone, respectively.",Implementation:(u=(0,o.default)(a.default.mark((function e(t,n,r){var o,u,d;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=(0,i.default)(t.arguments,2),u=o[0],d=o[1],n.speak(t.text,new s.Point(u,d)),e.abrupt("return",l.Result.UpdateText);case 3:case"end":return e.stop()}}),e)}))),function(e,t,n){return u.apply(this,arguments)})}},90202:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:11,Arguments:[],Description:"Stop playing sounds. _TODO: check if only music need to be stopped`",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",u.Result.Void);case 1:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},95577:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(14017);t.default={Opcode:8,Arguments:[],Description:"Pause script execution for one tick.",Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",u.Result.Wait);case 1:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},89936:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o,u=n(63806),l=n(82127),s=n(14017);t.default={Opcode:31,Arguments:[],Implementation:(o=(0,i.default)(a.default.mark((function e(t,n,r){var i;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.gameState=l.default.Won,i=n.persistentState.lastScore,n.sceneManager.pushScene(new u.WinScene(i)),e.abrupt("return",s.Result.UpdateScene);case 4:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})}},17438:(e,t,n)=>{var r=n(92915),a=n(69159),i=n(67986),o=n(13037),u=n(29689),l=n(38468),s=l(n(63789)),d=l(n(68748)),c=l(n(76108)),f=l(n(40361)),h=l(n(7583)),p=l(n(19765)),v=l(n(81581));function y(e,t){var n=void 0!==i&&o(e)||e["@@iterator"];if(!n){if(u(e)||(n=function(e,t){var n;if(!e)return;if("string"==typeof e)return m(e,t);var i=r(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return a(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return m(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var l=0,s=function(){};return{s,n:function(){return l>=e.length?{done:!0}:{done:!1,value:e[l++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var d,c=!0,f=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){f=!0,d=e},f:function(){try{c||null==n.return||n.return()}finally{if(f)throw d}}}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}(0,d.default)(t,"__esModule",{value:!0});var g=n(14017),_=n(85827),w=n(30885),k=n(84485),b=function(){function e(t,n,r){(0,f.default)(this,e),this._inUse=!1,this._executor=null,this._instructionExecutor=new w.default(n,t),this._conditionChecker=new _.default(r,t),this._engine=t}var t;return(0,h.default)(e,[{key:"prepareExecution",value:function(e,t){console.assert(!this._inUse,"Executor is already prepared!"),this._executor=this._buildExecutor(e,t)}},{key:"_buildExecutor",value:function(e,t){var n=this;return(0,v.default)(s.default.mark((function r(){var a,i,o,u,l,d,c,f,h,v;return s.default.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:console.assert(!n._inUse,"Executor is already in use!"),n._inUse=!0,a=y(t.actions),r.prev=3,a.s();case 5:if((i=a.n()).done){r.next=55;break}if((o=i.value).enabled){r.next=9;break}return r.abrupt("continue",53);case 9:n._instructionExecutor.action=o,u=y(o.conditions),r.prev=11,u.s();case 13:if((l=u.n()).done){r.next=21;break}return d=l.value,r.next=17,(0,p.default)(n._conditionChecker.check(d,e,t));case 17:if(r.sent){r.next=19;break}return r.abrupt("continue",53);case 19:r.next=13;break;case 21:r.next=26;break;case 23:r.prev=23,r.t0=r.catch(11),u.e(r.t0);case 26:return r.prev=26,u.f(),r.finish(26);case 29:c=y(o.instructions),r.prev=30,c.s();case 32:if((f=c.n()).done){r.next=45;break}return h=f.value,r.next=36,(0,p.default)(n._instructionExecutor.execute(h));case 36:if(r.t1=r.sent,r.t1){r.next=39;break}r.t1=g.Result.Void;case 39:if((v=r.t1)===g.Result.Void){r.next=43;break}return r.next=43,v;case 43:r.next=32;break;case 45:r.next=50;break;case 47:r.prev=47,r.t2=r.catch(30),c.e(r.t2);case 50:return r.prev=50,c.f(),r.finish(50);case 53:r.next=5;break;case 55:r.next=60;break;case 57:r.prev=57,r.t3=r.catch(3),a.e(r.t3);case 60:return r.prev=60,a.f(),r.finish(60);case 63:return t.actionsInitialized=!0,e===k.default.PlaceItem&&(n._engine.inputManager.placedTile=null,n._engine.inputManager.placedTileLocation=null),n._inUse=!1,r.abrupt("return",g.ScriptResult.Done);case 67:case"end":return r.stop()}}),r,null,[[3,57,60,63],[11,23,26,29],[30,47,50,53]])})))()}},{key:"run",value:(t=(0,c.default)(s.default.mark((function e(){var t,n,r;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._executor){e.next=2;break}return e.abrupt("return",g.ScriptResult.Done);case 2:return e.next=4,this._executor.next();case 4:if(t=e.sent,(n=t.value||g.ScriptResult.Done)&g.ScriptResult.Done?this._executor=null:this._engine.camera.update(1/0),this._executor){e.next=9;break}return e.abrupt("return",n);case 9:if(n!==g.Result.UpdateZone){e.next=21;break}case 10:return e.next=12,this._executor.next();case 12:if(r=e.sent){e.next=15;break}return e.abrupt("break",20);case 15:if(r.value){e.next=17;break}return e.abrupt("break",20);case 17:if(!(r.value&g.ScriptResult.Done)){e.next=19;break}return e.abrupt("break",20);case 19:if(this._executor){e.next=10;break}case 20:this._executor=null;case 21:return e.abrupt("return",n);case 22:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"drain",value:function(){this._executor=null,this._inUse=!1}}]),e}();t.default=b},14017:(e,t,n)=>{var r,a,i=n(38468),o=i(n(40361));(0,i(n(68748)).default)(t,"__esModule",{value:!0}),t.ScriptResult=t.Type=t.Result=void 0,function(e){e[e.Void=0]="Void",e[e.UpdateText=1]="UpdateText",e[e.UpdateZone=2]="UpdateZone",e[e.Wait=4]="Wait",e[e.UpdateScene=8]="UpdateScene"}(r||(r={})),t.Result=r,function(e){e[e.Void=0]="Void",e[e.UpdateText=1]="UpdateText",e[e.UpdateZone=2]="UpdateZone",e[e.Wait=4]="Wait",e[e.UpdateScene=8]="UpdateScene",e[e.Done=1024]="Done"}(a||(a={})),t.ScriptResult=a;var u=function e(){(0,o.default)(this,e)};t.Type=u,u.Number=new u,u.TileID=new u,u.ZoneX=new u,u.ZoneY=new u,u.ZoneZ=new u,u.MonsterId=new u,u.ZoneID=new u,u.HotspotID=new u,u.SoundID=new u,u.Unused=new u},21156:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o=n(17766),u=function(){function e(){(0,a.default)(this,e),this.isGoal=-1,this.findItem=null,this.npc=null,this.additionalRequiredItem=null,this.additionalGainItem=null,this.requiredItem=null,this.puzzleIndex=-1,this.visited=!1,this.solved1=!1,this.solved2=!1,this.solved3=!1,this.solved4=!1,this.zone=null,this.zoneType=null}return(0,i.default)(e,[{key:"containsZone",value:function(e,t){return!!this.zone&&(e===this.zone||this.zone.leadsTo(e,t))}},{key:"solved",get:function(){if(!this.zone)return!1;switch(this.zone.type){case o.Zone.Type.Empty:case o.Zone.Type.Town:return!1;case o.Zone.Type.BlockadeNorth:case o.Zone.Type.BlockadeSouth:case o.Zone.Type.BlockadeEast:case o.Zone.Type.BlockadeWest:case o.Zone.Type.TravelStart:case o.Zone.Type.TravelEnd:return this.solved1;case o.Zone.Type.Goal:return this.solved1&&this.solved2;case o.Zone.Type.Find:case o.Zone.Type.FindUniqueWeapon:return this.solved1;case o.Zone.Type.Trade:case o.Zone.Type.Use:return this.solved2;case o.Zone.Type.Load:case o.Zone.Type.Room:case o.Zone.Type.Win:case o.Zone.Type.Lose:case o.Zone.Type.None:default:return!1}}}]),e}();t.default=u},76523:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o=n(78256),u=n(31560),l=function(){function e(t,n,r){(0,a.default)(this,e),this._world=null,this._dagobah=null,this._reseeded=!1,this._puzzles=[[],[]],this._seed=t,this._planet=n,this._size=r}return(0,i.default)(e,[{key:"seed",get:function(){return this._seed}},{key:"planet",get:function(){return this._planet}},{key:"size",get:function(){return this._size}},{key:"world",get:function(){return this._world}},{key:"dagobah",get:function(){return this._dagobah}},{key:"puzzles",get:function(){return this._puzzles}},{key:"generateWorld",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=[],a=this.seed,i=0;i<n;i++){try{return this.tryGenerateWorld(a,e,t)}catch(l){if(!(l instanceof o.WorldGenerationError))throw l;r.push({seed:a,error:l})}this._reseeded=!0,a=u.rand()}var l=new o.WorldGenerationError("Too many reseeds");throw l.history=r,l.iterations=n,l.seed=this.seed,l.planet=this.planet,l.size=this.size,l}},{key:"tryGenerateWorld",value:function(e,t,n){var r=new o.WorldGenerator(this.size,this.planet,t,n);r.generate(e),this.goal=r.goalPuzzle,this._puzzles=r.puzzles,this._setupWorld(r),this._setupDagobah(r,t)}},{key:"_setupWorld",value:function(e){this._world=e.world}},{key:"_setupDagobah",value:function(e,t){var n=new o.DagobahGenerator(t);n.generate(e),this._dagobah=n.world}}]),e}();t.default=l},63239:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o=n(17766),u=function(){function e(){(0,a.default)(this,e)}return(0,i.default)(e,[{key:"canBeEquipped",value:function(e){return e.hasAttributes(o.Tile.Attributes.Weapon)}}]),e}();t.default=u},23754:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583)),o=r(n(68748)),u=r(n(41870)),l=r(n(75356));(0,o.default)(t,"__esModule",{value:!0});var s=n(31560),d=n(21156),c=n(17725),f=function(){function e(t){(0,a.default)(this,e);for(var n=new Array(e.Size.width*e.Size.height),r=0;r<e.Size.width*e.Size.height;r++)n[r]=new d.default;this._sectors=n,this._assets=t}return(0,i.default)(e,[{key:"findSectorContainingZone",value:function(e){var t=this.findLocationOfZone(e);return t?this.at(t):null}},{key:"findLocationOfZone",value:function(t){var n,r=this,a=(0,u.default)(n=this._sectors).call(n,(function(e){return e.containsZone(t,r._assets)}));return-1===a?null:new s.Point(a%e.Size.width,c.floor(a/e.Size.height))}},{key:"at",value:function(e,t){return this._sectors[this._pointToIndex(e,t)]||null}},{key:"locationOfSector",value:function(e){var t,n=(0,l.default)(t=this._sectors).call(t,e);return new s.Point(n%10,c.floor(n/10))}},{key:"replaceSector",value:function(e,t,n){var r=this._pointToIndex(new s.Point(e,t));this._sectors[r]=n}},{key:"_pointToIndex",value:function(t,n){return"number"==typeof t&&void 0===n?t:"number"==typeof t?n*e.Size.width+t:t.y*e.Size.width+t.x}},{key:"sectors",get:function(){return this._sectors}},{key:"bounds",get:function(){return new s.Rectangle(new s.Point(0,0),e.Size)}}]),e}();f.Size=new s.Size(10,10),t.default=f},94819:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.readUint32=t.readUint16=t.readUint8=t.readString=void 0;var r=n(36828);t.readString=r.default;var a=n(67974);t.readUint16=a.default;var i=n(34440);t.readUint32=i.default;var o=n(33872);t.readUint8=o.default},36828:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(37572),a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;if(0===t)return"";var n=new r.Uint8Array(this,e,t||this.length);return String.fromCharCode.apply(null,n)};r.ArrayBuffer.prototype.readString=r.ArrayBuffer.prototype.readString||a,t.default=a},67974:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(92915));(0,a.default)(t,"__esModule",{value:!0});var o=n(37572),u=function(e){return(e%o.Uint16Array.BYTES_PER_ELEMENT!=0?new o.Uint16Array((0,i.default)(this).call(this,e,e+o.Uint16Array.BYTES_PER_ELEMENT)):new o.Uint16Array(this,e,o.Uint16Array.BYTES_PER_ELEMENT))[0]};o.ArrayBuffer.prototype.readUint16=o.ArrayBuffer.prototype.readUint16||u,t.default=u},34440:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(92915));(0,a.default)(t,"__esModule",{value:!0});var o=n(37572),u=function(e){return(e%o.Uint32Array.BYTES_PER_ELEMENT!=0?new o.Uint32Array((0,i.default)(this).call(this,e,e+o.Uint32Array.BYTES_PER_ELEMENT)):new o.Uint32Array(this,e,1))[0]};o.ArrayBuffer.prototype.readUint32=o.ArrayBuffer.prototype.readUint32||u,t.default=u},33872:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(37572),a=function(e){return new r.Uint8Array(this,e,r.Uint8Array.BYTES_PER_ELEMENT)[0]};r.ArrayBuffer.prototype.readUint8=r.ArrayBuffer.prototype.readUint8||a,t.default=a},62875:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(31920));(0,a.default)(t,"__esModule",{value:!0});var o=n(37572),u=function(){(0,i.default)(this).call(this,0,this.length)};o.Array.prototype.clear=o.Array.prototype.clear||u,t.default=u},17361:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(37572),a=function(){return this.length?this[0]:null};r.Array.prototype.first=r.Array.prototype.first||a,t.default=a},47032:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(47053));(0,a.default)(t,"__esModule",{value:!0});var o=n(37572),u=function(){return(0,i.default)(o.Array.prototype).apply([],this)};o.Array.prototype.flatten=o.Array.prototype.flatten||u,t.default=u},69383:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(92915));(0,a.default)(t,"__esModule",{value:!0});var o=n(37572),u=function(e){return(0,i.default)(o.Array.prototype).call(e)};o.Array.from=o.Array.from||u,t.default=u},62489:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(5459)),o=r(n(7273));(0,a.default)(t,"__esModule",{value:!0});var u=n(37572),l=function(e){return(0,i.default)((0,o.default)(this).call(this,(function(t,n){var r=e(n);return(t[r]=t[r]||[]).push(n),t}),{}))};u.Array.prototype.groupedBy=u.Array.prototype.groupedBy||l,t.default=l},81893:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.random=t.groupedBy=t.unique=t.shuffle=t.rest=t.resize=t.repeat=t.last=t.insert=t.from=t.flatten=t.first=t.clear=t.padEnd=t.remove=t.withType=void 0;var r=n(62875);t.clear=r.default;var a=n(17361);t.first=a.default;var i=n(47032);t.flatten=i.default;var o=n(69383);t.from=o.default;var u=n(62489);t.groupedBy=u.default;var l=n(71929);t.insert=l.default;var s=n(88774);t.last=s.default;var d=n(35309);t.padEnd=d.default;var c=n(41836);t.remove=c.default;var f=n(17573);t.repeat=f.default;var h=n(28581);t.resize=h.default;var p=n(61729);t.rest=p.default;var v=n(64051);t.shuffle=v.default;var y=n(91121);t.unique=y.default;var m=n(28151);t.withType=m.default;var g=n(12594);t.random=g.default},71929:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(31920));(0,a.default)(t,"__esModule",{value:!0});var o=n(37572),u=function(e,t){(0,i.default)(this).call(this,e,0,t)};o.Array.prototype.insert=o.Array.prototype.insert||u,t.default=u},88774:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(37572),a=function(){return this.length?this[this.length-1]:null};r.Array.prototype.last=r.Array.prototype.last||a,t.default=a},35309:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(92915)),o=r(n(39694));(0,a.default)(t,"__esModule",{value:!0});var u=n(37572),l=function(e,t){for(var n=(0,i.default)(this).call(this);n.length<e;)n.push(t);return n};u.Array.prototype.padEnd=(0,o.default)(u.Array.prototype)||l,t.default=l},12594:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(37572),a=n(17725);r.Array.prototype.random=r.Array.prototype.random||function(){return this[a.floor(a.random()*this.length)]},t.default=a.random},41836:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(75356)),o=r(n(31920));(0,a.default)(t,"__esModule",{value:!0});var u=n(37572),l=function(e){var t=(0,i.default)(this).call(this,e);return!!~t&&((0,o.default)(this).call(this,t,1),!0)};u.Array.prototype.remove=u.Array.prototype.remove||l,t.default=l},17573:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(72398));(0,a.default)(t,"__esModule",{value:!0});var o=n(37572),u=function(e,t){var n;return(0,i.default)(n=o.Array(t)).call(n,e)};o.Array.Repeat=o.Array.Repeat||u,t.default=u},28581:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(31920));(0,a.default)(t,"__esModule",{value:!0});var o=n(37572),u=function(e,t){(0,i.default)(this).call(this,0,this.length);for(var n=0;n<e;n++)this.push(t)};o.Array.prototype.resize=o.Array.prototype.resize||u,t.default=u},61729:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(92915));(0,a.default)(t,"__esModule",{value:!0});var o=n(37572),u=function(){return(0,i.default)(this).call(this,1)};o.Array.prototype.rest=o.Array.prototype.rest||u,t.default=u},64051:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(37572),a=n(31560),i=function(){var e=this.length;if(0===e)return this;if(1===e)return a.rand(),this;for(var t=new r.Array(e),n=0,i=0;i<e;i++)void 0===t[n=a.rand()%e]&&(t[n]=this[i],this[i]=void 0);for(var o=e-1;0!==o;o--)for(;;){for(var u=!1,l=0;!u&&l<e;l++)u=void 0===t[l];if(!u)break;if(void 0===t[n=a.rand()%e]){t[n]=this[o],this[o]=void 0;break}}for(var s=0;s<e;s++)this[s]=t[s];return this};r.Array.prototype.shuffle=r.Array.prototype.shuffle||i,t.default=i},91121:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(68190)),o=r(n(6978));(0,a.default)(t,"__esModule",{value:!0});var u=n(37572),l=function(){var e;return(0,i.default)(e=(0,o.default)(this).call(this)).call(e,(function(e,t,n){return!t||e!==n[t-1]}))};u.Array.prototype.unique=u.Array.prototype.unique||l,t.default=l},28151:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(68190));(0,a.default)(t,"__esModule",{value:!0});var o=function(e){return(0,i.default)(this).call(this,(function(t){return t.type===e}))};Array.prototype.withType=Array.prototype.withType||o,t.default=o},60312:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(28061),a=function(e){this.appendChild(this.ownerDocument.createTextNode(e))};r.Element&&(r.Element.prototype.append=r.Element.prototype.append||a),t.default=a},49766:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.append=void 0;var r=n(60312);t.append=r.default},64047:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.readAsText=t.readAsImage=t.readAsArrayBuffer=t.provideInputStream=void 0;var r=n(80451);t.provideInputStream=r.default;var a=n(3255);t.readAsArrayBuffer=a.default;var i=n(91081);t.readAsImage=i.default;var o=n(13813);t.readAsText=o.default},80451:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o=n(28061),u=n(31560),l=function(){var e=(0,i.default)(a.default.mark((function e(){var t;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.readAsArrayBuffer();case 2:return t=e.sent,e.abrupt("return",new u.InputStream(t));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}();o.File&&(o.File.prototype.provideInputStream=o.File.prototype.provideInputStream||l),t.default=l},3255:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(79302));(0,a.default)(t,"__esModule",{value:!0});var o=n(28061),u=n(28061),l=function(){var e=this;return new i.default((function(t,n){var r=new u.FileReader;r.onload=function(e){return t(e.target.result)},r.onerror=function(e){return n(e.error)},r.readAsArrayBuffer(e)}))};o.File&&(o.File.prototype.readAsArrayBuffer=o.File.prototype.readAsArrayBuffer||l),t.default=l},91081:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108)),o=r(n(68748)),u=r(n(79302)),l=r(n(89292));(0,o.default)(t,"__esModule",{value:!0});var s=n(28061),d=function(){var e=(0,i.default)(a.default.mark((function e(){var t;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.readAsArrayBuffer();case 2:return t=e.sent,e.abrupt("return",new u.default(function(){var e=(0,i.default)(a.default.mark((function e(n,r){var i;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(i=document.createElement("img")).onload=function(){return n(i)},i.onerror=function(e){return r(e)},i.src=l.default.createObjectURL(new Blob([t]));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}();s.File.prototype.readAsImage=s.File.prototype.readAsImage||d,t.default=d},13813:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(79302));(0,a.default)(t,"__esModule",{value:!0});var o=n(28061),u=n(28061),l=function(){var e=this;return new i.default((function(t,n){var r=new u.FileReader;r.onload=function(e){return t(e.target.result)},r.onerror=function(e){return n(e.error)},r.readAsText(e)}))};o.File.prototype.readAsText=o.File.prototype.readAsText||l,t.default=l},17665:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(67093));(0,a.default)(t,"__esModule",{value:!0});var o=n(28061),u=function(e){for(var t=0,n=this.length;t<n;t++)if(e(this[t]))return this[t];return null};o.HTMLCollection&&(o.HTMLCollection.prototype.find=(0,i.default)(o.HTMLCollection.prototype)||u),t.default=u},30137:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(42601));(0,a.default)(t,"__esModule",{value:!0});var o=n(28061),u=function(e){for(var t=0;t<this.length;t++)e.call(this,this[t],t,this)};o.HTMLCollection&&(o.HTMLCollection.prototype.forEach=(0,i.default)(o.HTMLCollection.prototype)||u),t.default=u},7283:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(75356));(0,a.default)(t,"__esModule",{value:!0});var o=n(37572),u=n(28061),l=function(e){var t;return(0,i.default)(t=o.Array.from(this)).call(t,e)};u.HTMLCollection&&(u.HTMLCollection.prototype.indexOf=(0,i.default)(u.HTMLCollection.prototype)||l),t.default=l},37639:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.forEach=t.indexOf=t.map=t.find=void 0;var r=n(17665);t.find=r.default;var a=n(30137);t.forEach=a.default;var i=n(7283);t.indexOf=i.default;var o=n(9860);t.map=o.default},9860:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(35983));(0,a.default)(t,"__esModule",{value:!0});var o=n(28061),u=function(e){for(var t=[],n=0,r=this.length;n<r;n++)t.push(e(this[n],n,this));return t};o.HTMLCollection&&(o.HTMLCollection.prototype.map=(0,i.default)(o.HTMLCollection.prototype)||u),t.default=u},23699:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.toImageData=void 0;var r=n(96331);t.toImageData=r.default},96331:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(28061),a=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=document.createElement("canvas");t.width=this.width,t.height=this.height,t.classList.add("pixelated");var n=t.getContext("2d");return e&&(n.imageSmoothingEnabled=!1),n.drawImage(this,0,0),n.getImageData(0,0,t.width,t.height)};r.HTMLImageElement.prototype.toImageData=r.HTMLImageElement.prototype.toImageData||a,t.default=a},77487:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.open=void 0;var r=n(40339);t.open=r.default},40339:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(79302)),o=r(n(73035));(0,a.default)(t,"__esModule",{value:!0});var u=n(28061);function l(){var e=this;return new i.default((function(t,n){return(0,o.default)((function(){if(u.document.createEvent){var r=u.document.createEvent("MouseEvents");r.initMouseEvent("mousedown",!1,!0,u.window,0,0,0,0,0,!1,!1,!1,!1,0,null),e.dispatchEvent(r),t()}else e.fireEvent?(e.fireEvent("onmousedown"),t()):n("Select box can't be opened automatically")}))}))}u.HTMLSelectElement&&(u.HTMLSelectElement.prototype.open=u.HTMLSelectElement.prototype.open||l),t.default=l},54883:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.toImage=void 0;var r=n(90508);t.toImage=r.default},90508:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108)),o=r(n(68748)),u=r(n(79302));(0,o.default)(t,"__esModule",{value:!0});var l=n(28061);function s(){return d.apply(this,arguments)}function d(){return(d=(0,i.default)(a.default.mark((function e(){var t,n=this,r=arguments;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!(r.length>0&&void 0!==r[0])||r[0],e.abrupt("return",new u.default((function(e,r){var a=document.createElement("canvas");a.width=n.width,a.height=n.height;var i=a.getContext("2d");t&&(i.imageSmoothingEnabled=!1),i.putImageData(n,0,0);var o=document.createElement("img");o.onload=function(){return e(o)},o.onerror=function(e){return r(e)},o.src=a.toDataURL("image/png")})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}l.ImageData&&(l.ImageData.prototype.toImage=l.ImageData.prototype.toImage||s),t.default=s},79937:(e,t,n)=>{var r=n(38468)(n(68748));(0,r.default)(t,"__esModule",{value:!0});var a=n(28061),i='data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg"></svg>';(0,r.default)(a.Image,"blankImage",{value:i,writable:!1,enumerable:!1,configurable:!1}),t.default=i},57818:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.blankImage=void 0;var r=n(79937);t.blankImage=r.default},80413:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.Uint8Array=t.Uint32Array=t.Uint16Array=t.String=t.Storage=t.Set=t.RegExp=t.Object_=t.Number=t.NodeList=t.MouseEvent=t.Int8Array=t.Int32Array=t.Int16Array=t.ImageData=t.Image=t.HTMLSelectElement=t.HTMLImageElement=t.HTMLCollection=t.File=t.Element=t.ArrayBuffer=t.Array=void 0;var r=n(81893);t.Array=r;var a=n(94819);t.ArrayBuffer=a;var i=n(49766);t.Element=i;var o=n(64047);t.File=o;var u=n(37639);t.HTMLCollection=u;var l=n(77487);t.HTMLSelectElement=l;var s=n(23699);t.HTMLImageElement=s;var d=n(57818);t.Image=d;var c=n(54883);t.ImageData=c;var f=n(93214);t.MouseEvent=f;var h=n(46646);t.NodeList=h;var p=n(71639);t.Number=p;var v=n(74434);t.Object_=v;var y=n(88523);t.RegExp=y;var m=n(9590);t.Set=m;var g=n(27430);t.Storage=g;var _=n(24117);t.String=_;var w=n(59749);t.Uint32Array=w;var k=n(7792);t.Uint16Array=k;var b=n(61486);t.Uint8Array=b;var S=n(77085);t.Int32Array=S;var I=n(11733);t.Int16Array=I;var x=n(13304);t.Int8Array=x},11733:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.mapArray=void 0;var r=n(86386);t.mapArray=r.default},86386:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(4753);Int16Array.prototype.mapArray=r.default,t.default=r.default},77085:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.mapArray=void 0;var r=n(78138);t.mapArray=r.default},78138:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(4753);Int32Array.prototype.mapArray=r.default,t.default=r.default},13304:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.mapArray=void 0;var r=n(68602);t.mapArray=r.default},68602:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(4753);Int8Array.prototype.mapArray=r.default,t.default=r.default},4753:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.default=function(e){for(var t=[],n=this.length,r=0;r<n;r++)t.push(e(this[r],r,this));return t}},93214:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.offsetIn=void 0;var r=n(78922);t.offsetIn=r.default},78922:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(28061),a=n(31560),i=function(e){if(this.target===e)return new a.Point(this.offsetX,this.offsetY);var t=e.getBoundingClientRect();return new a.Point(this.clientX-t.left,this.clientY-t.top)};r.MouseEvent&&(r.MouseEvent.prototype.offsetIn=r.MouseEvent.prototype.offsetIn||i),t.default=i},91739:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(67093));(0,a.default)(t,"__esModule",{value:!0});var o=n(37572),u=n(28061),l=function(e){var t;return(0,i.default)(t=o.Array.from(this)).call(t,e)||null};u.NodeList&&(u.NodeList.prototype.find=(0,i.default)(u.NodeList.prototype)||l),t.default=l},89204:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(42601));(0,a.default)(t,"__esModule",{value:!0});var o=n(28061),u=function(e){for(var t=0;t<this.length;t++)e.call(this,this[t],t,this)};o.NodeList&&(o.NodeList.prototype.forEach=(0,i.default)(o.NodeList.prototype)||u),t.default=u},23172:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(75356));(0,a.default)(t,"__esModule",{value:!0});var o=n(37572),u=n(28061),l=function(e){var t;return(0,i.default)(t=o.Array.from(this)).call(t,e)};u.NodeList&&(u.NodeList.prototype.indexOf=(0,i.default)(u.NodeList.prototype)||l),t.default=l},46646:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.find=t.indexOf=t.map=t.forEach=void 0;var r=n(91739);t.find=r.default;var a=n(89204);t.forEach=a.default;var i=n(23172);t.indexOf=i.default;var o=n(20333);t.map=o.default},20333:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(35983));(0,a.default)(t,"__esModule",{value:!0});var o=n(28061),u=function(e){for(var t=[],n=0;n<this.length;n++)t.push(e.call(this,this[n],n,this));return t};o.NodeList&&(o.NodeList.prototype.map=(0,i.default)(o.NodeList.prototype)||u),t.default=u},71639:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.toHex=t.times=t.isInRange=void 0;var r=n(57966);t.isInRange=r.default;var a=n(33095);t.times=a.default;var i=n(44717);t.toHex=i.default},57966:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=function(e,t){return this>=e&&this<=t};Number.prototype.isInRange=Number.prototype.isInRange||r,t.default=r},33095:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=function(e){for(var t=new Array(this),n=0;n<this;n++)t[n]=e(n);return t};Number.prototype.times=Number.prototype.times||r,t.default=r},44717:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(61399));(0,a.default)(t,"__esModule",{value:!0});var o=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return"0x".concat((0,i.default)(e=this.toString(16)).call(e,t,"0"))};Number.prototype.toHex=Number.prototype.toHex||o,t.default=o},36799:(e,t,n)=>{var r=n(38468)(n(68748));(0,r.default)(t,"__esModule",{value:!0});var a=function(e){for(var t in this)this.hasOwnProperty(t)&&e(t,this[t])};(0,r.default)(Object.prototype,"each",{value:a,writable:!0,enumerable:!1,configurable:!0}),t.default=a},74434:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.each=void 0;var r=n(36799);t.each=r.default},63641:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=function(e){return e.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")};RegExp.escape=RegExp.escape||r,t.default=r},88523:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.escape=void 0;var r=n(63641);t.escape=r.default},59569:(e,t,n)=>{var r=n(38468),a=r(n(61822)),i=r(n(68748)),o=r(n(67093)),u=r(n(55933)),l=r(n(36687));(0,i.default)(t,"__esModule",{value:!0});var s=function(e){var t;return(0,o.default)(t=(0,a.default)((0,u.default)(this).call(this))).call(t,e)};l.default.prototype.find=(0,o.default)(l.default.prototype)||s,t.default=s},9590:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.some=t.find=void 0;var r=n(59569);t.find=r.default;var a=n(39987);t.some=a.default},39987:(e,t,n)=>{var r=n(38468),a=r(n(61822)),i=r(n(68748)),o=r(n(55903)),u=r(n(55933)),l=r(n(36687));(0,i.default)(t,"__esModule",{value:!0});var s=function(e){var t;return(0,o.default)(t=(0,a.default)((0,u.default)(this).call(this))).call(t,e)};l.default.prototype.some=(0,o.default)(l.default.prototype)||s,t.default=s},65018:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(28061),a=function(e){return null!==this.getItem(e)};r.Storage.prototype.has=r.Storage.prototype.has||a,t.default=a},27430:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.prefixedWith=t.store=t.load=t.has=void 0;var r=n(65018);t.has=r.default;var a=n(43136);t.load=a.default;var i=n(72281);t.prefixedWith=i.default;var o=n(92179);t.store=o.default},43136:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(28061),a=function(e){try{if(this.has(e))return JSON.parse(this.getItem(e))}catch(t){console.warn("Invalid item in Storage: ",this.getItem(e))}return null};r.Storage.prototype.load=r.Storage.prototype.load||a,t.default=a},72281:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(31560),a=function(e){return new r.PrefixedStorage(this,e)};Storage.prototype.prefixedWith=Storage.prototype.prefixedWith||a,t.default=a},92179:(e,t,n)=>{var r=n(38468),a=r(n(88225)),i=r(n(68748)),o=r(n(25097));(0,i.default)(t,"__esModule",{value:!0});var u=function(e,t){try{"object"===(0,a.default)(t)&&null!==t&&t.toString!==Array.prototype.toString&&t.toString!==Object.prototype.toString?this.setItem(e,(0,o.default)(t.toString())):this.setItem(e,(0,o.default)(t))}catch(e){console.warn("Unable to store item: ",e)}return t};Storage.prototype.store=Storage.prototype.store||u,t.default=u},58430:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(35983)),o=r(n(92915));(0,a.default)(t,"__esModule",{value:!0});var u=function(){var e;return this.length?(0,i.default)(e=this.split("-")).call(e,(function(e){return e.charAt(0).toUpperCase()+(0,o.default)(e).call(e,1)})).join(""):""};String.prototype.camelize=String.prototype.camelize||u,t.default=u},64795:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(75356));(0,a.default)(t,"__esModule",{value:!0});var o=function(e){return-1!==(0,i.default)(this).call(this,e)};String.prototype.contains=String.prototype.contains||o,t.default=o},93382:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=/[A-Z](?:(?=[^A-Z])|[A-Z]*(?=[A-Z][^A-Z]|$))/g,a=function(){return this.replace(r,(function(e,t){return(t>0?"-":"")+e.toLowerCase()}))};String.prototype.dasherize=String.prototype.dasherize||a,t.default=a},86280:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(39907));(0,a.default)(t,"__esModule",{value:!0});var o=function(e){return(0,i.default)(this).call(this,e)?this:this+e};String.prototype.ensureTail=String.prototype.ensureTail||o,t.default=o},24117:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.ensureTail=t.camelize=t.dasherize=t.contains=t.trimCharacter=t.uuid=t.padStart=t.padEnd=t.parseInt=void 0;var r=n(58430);t.camelize=r.default;var a=n(64795);t.contains=a.default;var i=n(93382);t.dasherize=i.default;var o=n(23525);t.padEnd=o.default;var u=n(61583);t.padStart=u.default;var l=n(98384);t.parseInt=l.default;var s=n(95785);t.trimCharacter=s.default;var d=n(84567);t.uuid=d.default;var c=n(86280);t.ensureTail=c.default},23525:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(92915)),o=r(n(39694));(0,a.default)(t,"__esModule",{value:!0});var u=function(e){for(var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ",r=(0,i.default)(t=this).call(t);r.length<e;)r+=n;return r};String.prototype.padEnd=(0,o.default)(String.prototype)||u,t.default=u},61583:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(92915)),o=r(n(61399));(0,a.default)(t,"__esModule",{value:!0});var u=function(e){for(var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ",r=(0,i.default)(t=this).call(t);r.length<e;)r=n+r;return r};String.prototype.padStart=(0,o.default)(String.prototype)||u,t.default=u},98384:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(37572);function a(){return/^0x/i.test(this)?r.parseInt(this.substr(2),16):/^0b/i.test(this)?r.parseInt(this.substr(2),2):r.parseInt(this,10)}String.prototype.parseInt=String.prototype.parseInt||a,t.default=a},95785:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(92915)),o=r(n(75356));(0,a.default)(t,"__esModule",{value:!0});var u=function(){for(var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:" ",n=(0,i.default)(e=this).call(e);~(0,o.default)(t).call(t,n[0]);)n=(0,i.default)(n).call(n,1);for(;~(0,o.default)(t).call(t,n[n.length-1]);)n=(0,i.default)(n).call(n,0,-1);return n};String.prototype.trimCharacter=String.prototype.trimCharacter||u,t.default=u},84567:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=function(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()};String.UUID=String.UUID||r,t.default=r},28621:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),Uint16Array.prototype.get=Int16Array.prototype.get=function(e,t){return e<0||e>9||t<0||t>9?-1:this[e+10*t]},t.default=Uint16Array.prototype.get},7792:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.mapArray=t.set=t.get=void 0;var r=n(28621);t.get=r.default;var a=n(37892);t.set=a.default;var i=n(45174);t.mapArray=i.default},45174:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(4753);Uint16Array.prototype.mapArray=r.default,t.default=r.default},37892:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=function(e,t,n){this[e+10*t]=n};Uint16Array.prototype.set=r,Int16Array.prototype.set=r,t.default=Uint16Array.prototype.set},59749:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.mapArray=void 0;var r=n(60483);t.mapArray=r.default},60483:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(4753);Uint32Array.prototype.mapArray=r.default,t.default=r.default},73274:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=function(){return String.fromCharCode.apply(null,this)};Uint8Array.prototype.asString=r,t.default=r},61486:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.mapArray=t.asString=void 0;var r=n(73274);t.asString=r.default;var a=n(45880);t.mapArray=a.default},45880:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(4753);Uint8Array.prototype.mapArray=r.default,t.default=r.default},45933:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.UX=t.Util=t.UI=t.Std=t.Settings=t.Extension=t.Engine=t.App=void 0;var r=n(80885);t.App=r;var a=n(20779);t.Engine=a;var i=n(80413);t.Extension=i;var o=n(37572);t.Std=o;var u=n(88607);t.UI=u;var l=n(31560);t.Util=l;var s=n(48387);t.UX=s;var d=n(50177);t.Settings=d},50177:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(97948));(0,a.default)(t,"__esModule",{value:!0}),t.defaultSettings=void 0;var o=n(31560),u=n(8087),l=n(78256),s=n(17766);t.defaultSettings={mobile:u(!1).isAndroid()||u(!1).isIPhone(),pwa:"pwa"===new i.default(window.location.search).get("source"),debug:!1,drawDebugStats:!1,drawHotspots:!1,drawHeroTile:!1,drawMonsterState:!1,skipDialogs:!1,skipTransitions:!1,skipWinScene:!1,pickupItemsAutomatically:!1,lookTowardsMouse:!0,autosaveTestOnZoneChange:!0,autostartEngine:!0,revealWorld:!1,playEffects:!1,playMusic:!1,difficulty:50,worldSize:l.WorldSize.Medium.rawValue,tickDuration:100,lastPlanet:s.Zone.Planet.None.rawValue,logLevel:o.LogLevel.Debug,issueTracker:"https://github.com/cyco/WebFun/issues/new",debuggerActive:!1}},28061:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.localStorage=t.navigator=t.window=t.document=t.XMLHttpRequest=t.Storage=t.NodeList=t.Node=t.MouseEvent=t.ImageData=t.Image=t.HTMLSelectElement=t.HTMLImageElement=t.HTMLElement=t.HTMLCollection=t.FileReader=t.File=t.Event=t.Element=t.CustomEvent=void 0;var r=n(37572);t.CustomEvent=r.global.CustomEvent,t.Element=r.global.Element,t.Event=r.global.Event,t.File=r.global.File,t.FileReader=r.global.FileReader,t.HTMLCollection=r.global.HTMLCollection,t.HTMLElement=r.global.HTMLElement,t.HTMLImageElement=r.global.HTMLImageElement,t.HTMLSelectElement=r.global.HTMLSelectElement,t.Image=r.global.Image,t.ImageData=r.global.ImageData,t.MouseEvent=r.global.MouseEvent,t.Node=r.global.Node,t.NodeList=r.global.NodeList,t.Storage=r.global.Storage,t.XMLHttpRequest=r.global.XMLHttpRequest,t.document=r.global.document,t.window=r.global.window,t.navigator=r.global.navigator,t.localStorage=t.window.localStorage||new r.global.Storage},37572:(e,t,n)=>{var r,a=n(38468),i=a(n(68748)),o=a(n(7401));(0,i.default)(t,"__esModule",{value:!0}),t.TextDecoder=t.Error=t.performance=t.cancelAnimationFrame=t.requestAnimationFrame=t.Uint32Array=t.Uint16Array=t.Uint8Array=t.DataView=t.Promise=t.ArrayBuffer=t.Array=t.parseInt=t.console=t.encodeURIComponent=t.setTimeout=t.global=void 0,t.global=Function("return this")(),t.global.window||(t.global.window=t.global);var u=(0,o.default)(r=t.global.setTimeout).call(r,t.global);t.setTimeout=u,t.encodeURIComponent=t.global.encodeURIComponent,t.console=t.global.console,t.parseInt=t.global.parseInt,t.Array=t.global.Array,t.ArrayBuffer=t.global.ArrayBuffer,t.Promise=t.global.Promise,t.DataView=t.global.DataView,t.Uint8Array=t.global.Uint8Array,t.Uint16Array=t.global.Uint16Array,t.Uint32Array=t.global.Uint32Array,t.requestAnimationFrame=t.global.requestAnimationFrame,t.cancelAnimationFrame=t.global.cancelAnimationFrame,t.performance=t.global.performance,t.Error=t.global.Error,t.TextDecoder=t.global.TextDecoder},17725:(e,t,n)=>{var r;(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.sin=t.signbit=t.sign=t.scale=t.round=t.random=t.radians=t.pow=t.min=t.max=t.log10=t.log2=t.log1p=t.log=t.isubh=t.imulh=t.imul=t.iaddh=t.hypot=t.fscale=t.fround=t.floor=t.expm1=t.exp=t.degrees=t.cosh=t.cos=t.clz32=t.ceil=t.cbrt=t.atanh=t.atan2=t.atan=t.asinh=t.asin=t.acosh=t.acos=t.abs=t.SQRT2=t.SQRT1_2=t.RAD_PER_DEG=t.PI=t.MIN_VALUE=t.MAX_VALUE=t.LOG10E=t.LOG2E=t.LN10=t.LN2=t.E=t.DEG_PER_RAD=void 0,t.umulh=t.trunc=t.tanh=t.tan=t.sqrt=t.sinh=void 0,r=n(37572).global.Math,t.DEG_PER_RAD=r.DEG_PER_RAD,t.E=r.E,t.LN2=r.LN2,t.LN10=r.LN10,t.LOG2E=r.LOG2E,t.LOG10E=r.LOG10E,t.MAX_VALUE=r.MAX_VALUE,t.MIN_VALUE=r.MIN_VALUE,t.PI=r.PI,t.RAD_PER_DEG=r.RAD_PER_DEG,t.SQRT1_2=r.SQRT1_2,t.SQRT2=r.SQRT2,t.abs=r.abs,t.acos=r.acos,t.acosh=r.acosh,t.asin=r.asin,t.asinh=r.asinh,t.atan=r.atan,t.atan2=r.atan2,t.atanh=r.atanh,t.cbrt=r.cbrt,t.ceil=r.ceil,t.clz32=r.clz32,t.cos=r.cos,t.cosh=r.cosh,t.degrees=r.degrees,t.exp=r.exp,t.expm1=r.expm1,t.floor=r.floor,t.fround=r.fround,t.fscale=r.fscale,t.hypot=r.hypot,t.iaddh=r.iaddh,t.imul=r.imul,t.imulh=r.imulh,t.isubh=r.isubh,t.log=r.log,t.log1p=r.log1p,t.log2=r.log2,t.log10=r.log10,t.max=r.max,t.min=r.min,t.pow=r.pow,t.radians=r.radians,t.random=r.random,t.round=r.round,t.scale=r.scale,t.sign=r.sign,t.signbit=r.signbit,t.sin=r.sin,t.sinh=r.sinh,t.sqrt=r.sqrt,t.tan=r.tan,t.tanh=r.tanh,t.trunc=r.trunc,t.umulh=r.umulh},1799:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.AudioContext=void 0;var r=n(37572),a=r.global.AudioContext||r.global.webkitAudioContext;t.AudioContext=a},81340:(e,t,n)=>{var r=n(92915),a=n(69159),i=n(67986),o=n(13037),u=n(29689),l=n(38468),s=l(n(94433)),d=l(n(40361)),c=l(n(7583)),f=l(n(68748)),h=l(n(42601)),p=l(n(68190));function v(e,t){var n=void 0!==i&&o(e)||e["@@iterator"];if(!n){if(u(e)||(n=function(e,t){var n;if(!e)return;if("string"==typeof e)return y(e,t);var i=r(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return a(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return y(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var l=0,s=function(){};return{s,n:function(){return l>=e.length?{done:!0}:{done:!1,value:e[l++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var d,c=!0,f=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){f=!0,d=e},f:function(){try{c||null==n.return||n.return()}finally{if(f)throw d}}}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}(0,f.default)(t,"__esModule",{value:!0});var m=n(31560),g=function(){function e(){(0,d.default)(this,e)}return(0,c.default)(e,[{key:"render",value:function(e,t){var n;if("string"==typeof e)n=document.createElement(e);else if(e instanceof Function)n=document.createElement(e.tagName);else if(e instanceof Node)return e;if(t){var r,a=v(m.iterate(t));try{for(a.s();!(r=a.n()).done;){var i=(0,s.default)(r.value,2),o=i[0],u=i[1];if("style"===o&&"string"!=typeof u){var l,d=v(m.iterate(u));try{for(d.s();!(l=d.n()).done;){var c=(0,s.default)(l.value,2),f=c[0],y=c[1];n.style[f]=y}}catch(e){d.e(e)}finally{d.f()}}else n[o]=u}}catch(e){a.e(e)}finally{a.f()}}for(var g=arguments.length,_=new Array(g>2?g-2:0),w=2;w<g;w++)_[w-2]=arguments[w];if(_){var k=function e(t){if("number"==typeof t)n.appendChild(document.createTextNode(t.toString(10)));else if("string"==typeof t)n.appendChild(document.createTextNode(t));else if(t instanceof Node)n.appendChild(t);else if(t instanceof Array){var r;(0,h.default)(r=(0,p.default)(t).call(t,(function(e){return e}))).call(r,e)}else console.error("don't know how to append",t)};k(_)}return n}}]),e}();t.default=g},13319:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583)),o=r(n(68748)),u=r(n(42601)),l=r(n(68190)),s=r(n(5459));(0,o.default)(t,"__esModule",{value:!0});var d=function(){function e(){(0,a.default)(this,e),this.components={}}return(0,i.default)(e,[{key:"registerComponents",value:function(e){var t,n,r=this;(0,u.default)(t=(0,l.default)(n=(0,s.default)(e)).call(n,(function(e){return e.tagName}))).call(t,(function(e){return r.registerComponent(e)}))}},{key:"registerComponent",value:function(e){console.assert(!!e.tagName,"ComponentDefinitions must define a tag to be used!"),console.assert(!this.components[e.tagName],"A component with tag '".concat(e.tagName,"' is already registered!")),window.customElements.define(e.tagName,e),this.components[e.tagName]=e}},{key:"contains",value:function(e){return!!this.components[e.tagName]}}],[{key:"sharedRegistry",get:function(){return this.registry||(this.registry=new this)}}]),e}();t.default=d},83722:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244)),d=a(n(46386));function c(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0});var f=function(e){(0,u.default)(n,e);var t=c(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return(0,o.default)(n,[{key:"adoptedCallback",value:function(){}},{key:"connectedCallback",value:function(){}},{key:"disconnectedCallback",value:function(){}},{key:"attributeChangedCallback",value:function(e,t,n){}}]),n}((0,d.default)(HTMLElement));t.default=f},41457:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244));function c(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(49158);var f=function(e){(0,l.default)(n,e);var t=c(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments))._icon=WebFun.JSX.render("i",null),e._checkDisabled=function(t){return e.hasAttribute("disabled")&&t.stopImmediatePropagation()},e}return(0,o.default)(n,[{key:"icon",get:function(){return this._iconName},set:function(e){this._iconName=e,this._icon.className="fa fa-".concat(e)}},{key:"disabled",get:function(){return this.hasAttribute("disabled")},set:function(e){e?this.setAttribute("disabled",""):this.removeAttribute("disabled")}},{key:"connectedCallback",value:function(){(0,u.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this),this._icon.parentNode||this.appendChild(this._icon),this.addEventListener("click",this._checkDisabled,{capture:!0})}},{key:"disconnectedCallback",value:function(){this.removeEventListener("click",this._checkDisabled,{capture:!0}),(0,u.default)((0,d.default)(n.prototype),"disconnectedCallback",this).call(this)}},{key:"attributeChangedCallback",value:function(e,t,n){"icon"===e&&(this._icon.classList.remove("fa-".concat(t)),this._icon.classList.add("fa-".concat(n)),this._iconName=n)}}]),n}(n(83722).default);f.observedAttributes=["icon"],t.default=f},9488:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244)),d=a(n(68748)),c=a(n(42601)),f=a(n(35983)),h=a(n(73035));function p(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,d.default)(t,"__esModule",{value:!0});var v=n(83722);n(26606);var y=n(29680),m=n(48387),g=n(31560),_="searchbar-visible",w="search",k="scroll",b=function(e){(0,u.default)(n,e);var t=p(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments))._bar=WebFun.JSX.render(y.default,null),e._content=WebFun.JSX.render("div",null),e._items=[],e._cells=[],e._lastSearchValue="",e._state=new g.DiscardingStorage,e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){var e=this;if(this.searchDelegate&&!this._bar.parentElement&&this.insertBefore(this._bar,this.firstElementChild),this.rebuild(),this.searchDelegate){var t=m.ShortcutManager.sharedManager;this._shortcut=t.registerShortcut((function(){return e.showBar(!0)}),{keyCode:70,node:this,metaKey:!0}),this.state.load(_)&&this.showBar(!1),this._content.scrollTop=this._state.load(k)}}},{key:"showBar",value:function(e){var t=this;this._bar.setAttribute("visible",""),this._bar.onsearch=function(){return t.setNeedsRefiltering()},this._bar.onclose=function(){return t.hideBar(!0)},this._bar.focus();var n=m.ShortcutManager.sharedManager;this._closeSearchbarShortcut=n.registerShortcut((function(){return t.hideBar(!0)}),{keyCode:27,node:this._bar}),e&&(this.state.store(_,!0),this.refilter())}},{key:"hideBar",value:function(e){this._bar.removeAttribute("visible"),this._bar.onsearch=null,this._bar.onclose=null,m.ShortcutManager.sharedManager.unregisterShortcut(this._closeSearchbarShortcut),e&&(this.state.store(_,!1),this.refilter())}},{key:"disconnectedCallback",value:function(){this._bar.remove(),this.hideBar(!1),m.ShortcutManager.sharedManager.unregisterShortcut(this._shortcut)}},{key:"rebuild",value:function(){var e,t,n=this,r=this._content,a=this._state.load(k);this._content=document.createElement("div"),this._content.addEventListener("scroll",(function(){n.state.store(k,n._content.scrollTop)}),{passive:!0}),this._lastSearchValue="",(0,c.default)(e=this._cells).call(e,(function(e){return e.remove()})),this._cells=(0,f.default)(t=this._items).call(t,(function(e){return n.addItem(e)})),this.refilter(),r.parentElement?r.parentElement.replaceChild(this._content,r):this.appendChild(this._content),this._content.scrollTop=a}},{key:"setNeedsRefiltering",value:function(){var e=this;this._filterTimeout||(this._filterTimeout=(0,h.default)((function(){return e.refilter()}),100))}},{key:"refilter",value:function(){var e,t=this;this._filterTimeout&&clearTimeout(this._filterTimeout),this._filterTimeout=null;var n,r=this.searchDelegate,a=this._bar.searchString;if(this.state.store(w,a),!a||!r||!this._bar.isVisible)return this._lastSearchValue="",void(0,c.default)(n=this._cells).call(n,(function(e){return e.style.display=""}));if(this._lastSearchValue!==a){this._lastSearchValue=a;var i=r.prepareListSearch(a,this);(0,c.default)(e=this._cells).call(e,(function(e){var n=r.includeListItem(i,e.data,e,t);e.style.display=n?"":"none"}))}}},{key:"addItem",value:function(e){var t=this.cell.cloneNode(!0);return t.data=e,this._content.appendChild(t),t}},{key:"items",get:function(){return this._items},set:function(e){this._items=e,this.rebuild()}},{key:"state",get:function(){return this._state},set:function(e){this._state=e,this._bar.searchString=e.load(w)||"",e.load(_)?this._bar.setAttribute("visible",""):this._bar.removeAttribute("visible"),this.isConnected&&this.items.length&&(this._content.scrollTop=e.load(k))}}]),n}(v.default);b.observedAttributes=[],t.default=b},72908:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244)),c=a(n(68748)),f=a(n(42601));function h(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,c.default)(t,"__esModule",{value:!0}),n(40148);var p=n(33284),v=n(83722),y=n(79860),m=n(34749),g=n(55344),_=function(e){(0,l.default)(n,e);var t=h(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments)).onclose=function(){},e._menu=null,e}return(0,o.default)(n,[{key:"menu",get:function(){return this._menu},set:function(e){!e||e instanceof y.default||(e=new y.default(e)),this._menu=e,this.isConnected&&(this.removeItemNodes(),this.addItemNodes())}},{key:"connectedCallback",value:function(){(0,u.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this),this.removeItemNodes(),this.addItemNodes()}},{key:"disconnectedCallback",value:function(){this.removeItemNodes(),(0,u.default)((0,d.default)(n.prototype),"disconnectedCallback",this).call(this)}},{key:"close",value:function(){this.remove(),this.onclose instanceof Function&&this.onclose(new CustomEvent("close"))}},{key:"addItemNodes",value:function(){var e,t=this;this.menu&&(0,f.default)(e=this.menu.items).call(e,(function(e){e===p.Separator||e.isSeparator?t.addSeparatorNode():t.addItemNode(e)}))}},{key:"addItemNode",value:function(e){var t=document.createElement(m.default.tagName);return t.item=e,this.appendChild(t),t}},{key:"addSeparatorNode",value:function(){var e=document.createElement(g.default.tagName);return this.appendChild(e),e}},{key:"removeItemNodes",value:function(){this.textContent=""}}]),n}(v.default);t.default=_},48991:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244));function c(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(40144);var f=n(72908),h=n(49762),p=n(31560),v=function(e){(0,l.default)(n,e);var t=c(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments)).stack=null,e}return(0,o.default)(n,[{key:"show",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h.default.sharedStack,r=null;if(e instanceof p.Point&&(t=e),e instanceof Element){var a=e.getBoundingClientRect();t=new p.Point(a.left,a.bottom+1).add(window.scrollX,window.scrollY),r=a.width}console.assert(!!t,"Expected location to be either Point or Element"),this.style.left="".concat(t.x,"px"),this.style.top="".concat(t.y,"px"),r&&(this.style.minWidth="".concat(r,"px")),n.push(this),this.stack=n}},{key:"close",value:function(){(0,u.default)((0,d.default)(n.prototype),"close",this).call(this),this.stack=null}}]),n}(f.default);t.default=v},21042:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(80655)),u=a(n(20497)),l=a(n(75244));function s(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(62196);var d=function(e){(0,o.default)(n,e);var t=s(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return n}(n(46095).default);t.default=d},46095:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244)),c=a(n(68748)),f=a(n(59047));function h(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,c.default)(t,"__esModule",{value:!0}),t.Event=void 0,n(33676);var p=n(28061),v=n(31560),y=n(83722),m=n(9311);t.Event={DidClose:"didClose"};var g=function(e){(0,l.default)(r,e);var n=h(r);function r(){var e;return(0,i.default)(this,r),(e=n.call(this))._x=0,e._y=0,e._titlebar=document.createElement(m.default.tagName),e._content=document.createElement("div"),e._content.classList.add("content"),e}return(0,o.default)(r,[{key:"content",get:function(){return this._content},set:function(e){e.classList.add("content"),this._content.replaceWith(e),this._content=e}},{key:"x",get:function(){return this.isConnected?(0,f.default)(this.style.left):this._x}},{key:"origin",get:function(){return new v.Point(this._x,this._y)},set:function(e){this._x=e.x,this._y=e.y,this._update()}},{key:"y",get:function(){return this.isConnected?(0,f.default)(this.style.top):this._y}},{key:"menu",get:function(){return this._titlebar.menu},set:function(e){this._titlebar.menu=e}},{key:"closable",get:function(){return this._titlebar.closable},set:function(e){this._titlebar.closable=e}},{key:"movable",get:function(){return this._titlebar.movable},set:function(e){this._titlebar.movable=e}},{key:"pinnable",get:function(){return this._titlebar.pinnable},set:function(e){this._titlebar.pinnable=e}},{key:"pinned",get:function(){return this._titlebar.pinned},set:function(e){this._titlebar.pinned=e}},{key:"title",get:function(){return this._titlebar.title},set:function(e){this._titlebar.title=e}},{key:"onclose",get:function(){return this._titlebar.onclose},set:function(e){this._titlebar.onclose=e}},{key:"onpin",get:function(){return this._titlebar.onpin},set:function(e){this._titlebar.onpin=e}},{key:"connectedCallback",value:function(){(0,u.default)((0,d.default)(r.prototype),"connectedCallback",this).call(this),this.addEventListener("mousedown",this),this.addEventListener("dragstart",this),this._titlebar.window=this,this.appendChild(this._titlebar),this.appendChild(this._content),this._update()}},{key:"handleEvent",value:function(e){e.preventDefault()}},{key:"disconnectedCallback",value:function(){this.removeEventListener("mousedown",this),this.removeEventListener("dragstart",this),(0,u.default)((0,d.default)(r.prototype),"disconnectedCallback",this).call(this)}},{key:"center",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.document.documentElement,t=e.clientWidth,n=e.clientHeight,r=window.getComputedStyle(this);this._x=(t-(0,f.default)(r.width))/2,this._y=(n-(0,f.default)(r.height))/2,this._update()}},{key:"close",value:function(){this.remove(),this.onclose(new CustomEvent("close")),this.dispatchEvent(new CustomEvent(t.Event.DidClose,{bubbles:!1}))}},{key:"_update",value:function(){this.isConnected&&(this.style.top="".concat(0|this._y,"px"),this.style.left="".concat(0|this._x,"px"),p.localStorage.store(this.stateKey,{x:this._x,y:this._y}))}},{key:"autosaveName",get:function(){return this._autosaveName},set:function(e){this._autosaveName=e;var t=p.localStorage.load(this.stateKey);t&&(this._x=t.x,this._y=t.y,this._update())}},{key:"hasStoredState",get:function(){return p.localStorage.has(this.stateKey)}},{key:"stateKey",get:function(){return"window-state.".concat(this._autosaveName)}},{key:"addTitlebarButton",value:function(e){this._titlebar.addButton(e)}}]),r}(y.default);g.Event=t.Event,t.default=g},6314:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244));function c(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(64875);var f=function(e){(0,l.default)(n,e);var t=c(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments)).ontouchstart=function(){},e._label=WebFun.JSX.render("span",{style:{display:"none"}}),e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){(0,u.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this),this.appendChild(document.createElement("div")),this.appendChild(this._label),this.attributeChangedCallback("label",this.getAttribute("label"),this.getAttribute("label"))}},{key:"attributeChangedCallback",value:function(e,t,r){"label"===e&&(this._label.textContent=r,this._label.style.display=this._label.textContent.length?"":"none"),(0,u.default)((0,d.default)(n.prototype),"attributeChangedCallback",this).call(this,e,t,r)}},{key:"active",get:function(){return this.hasAttribute("active")},set:function(e){e?this.setAttribute("active",""):this.removeAttribute("active")}},{key:"label",get:function(){return this.getAttribute("label")},set:function(e){this.setAttribute("label",e)}}]),n}(n(41457).default);f.tagName="wf-button",f.observedAttributes=["icon","label"],t.default=f},18583:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244));function d(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0});var c=function(e){(0,u.default)(n,e);var t=d(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return(0,o.default)(n,[{key:"data",get:function(){return this._data},set:function(e){this._data=e}}]),n}(n(83722).default);c.observedAttributes=[],t.default=c},93458:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244));function c(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(31279);var f=function(e){(0,l.default)(n,e);var t=c(n);function n(){var e;(0,i.default)(this,n),e=t.call(this);var r=String.UUID(),a=document.createElement("input");a.type="checkbox",a.id=r,e._box=a;var o=document.createElement("label");return o.setAttribute("for",r),e._label=o,e}return(0,o.default)(n,[{key:"title",get:function(){return this._label.textContent},set:function(e){this._label.textContent="",this._label.appendChild(document.createTextNode(e))}},{key:"checked",get:function(){return this._box.checked},set:function(e){this._box.checked=e}},{key:"onchange",get:function(){return this._box.onchange},set:function(e){this._box.onchange=e}},{key:"connectedCallback",value:function(){(0,u.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this),this.appendChild(this._box),this.appendChild(this._label)}},{key:"disconnectedCallback",value:function(){this.textContent="",(0,u.default)((0,d.default)(n.prototype),"disconnectedCallback",this).call(this)}}]),n}(n(83722).default);f.tagName="wf-checkbox",t.default=f},97941:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244)),c=a(n(68748)),f=a(n(42601));function h(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,c.default)(t,"__esModule",{value:!0}),n(86236);var p=n(46095),v=n(6314),y=function(e){(0,l.default)(n,e);var t=h(n);function n(){var e;return(0,i.default)(this,n),(e=t.call(this))._confirmButton=document.createElement(v.default.tagName),e._confirmButton.onclick=function(){return e.onconfirm()},e._abortButton=document.createElement(v.default.tagName),e._abortButton.onclick=function(){return e.onabort()},e.onclose=function(){return e.onabort()},e.title="WebFun",e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){var e=this,t=document.createElement("div");if(t.classList.add("buttons"),t.appendChild(this._confirmButton),t.appendChild(this._abortButton),this.content.appendChild(t),this.onkeydown=function(t){13===t.keyCode&&e.onconfirm(),27===t.keyCode&&e.onabort(),13!==t.keyCode&&27!==t.keyCode||(t.preventDefault(),t.stopPropagation())},"string"==typeof this._customContent){var r=document.createElement("div");r.classList.add("text"),r.textContent=this._customContent,this.content.insertBefore(r,t)}else if(this._customContent instanceof Array){var a;(0,f.default)(a=this._customContent).call(a,(function(n){return e.content.insertBefore(n,t)}))}else this.content.insertBefore(this._customContent,t);(0,u.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this)}},{key:"disconnectedCallback",value:function(){for(;this.content.firstChild;)this.content.removeChild(this.content.firstChild);this.onkeydown=function(){},(0,u.default)((0,d.default)(n.prototype),"disconnectedCallback",this).call(this)}},{key:"attributeChangedCallback",value:function(e,t,r){"confirm-text"===e?this._confirmButton.setAttribute("label",r):"abort-text"===e?this._abortButton.setAttribute("label",r):(0,u.default)((0,d.default)(n.prototype),"attributeChangedCallback",this).call(this,e,t,r)}},{key:"confirmText",get:function(){return this.getAttribute("confirm-text")},set:function(e){this.setAttribute("confirm-text",e)}},{key:"abortText",get:function(){return this.getAttribute("abort-text")},set:function(e){this.setAttribute("abort-text",e)}},{key:"customContent",get:function(){return this._customContent},set:function(e){this._customContent=e}}]),n}(p.default);y.tagName="wf-confirmation-window",y.observedAttributes=["confirm-text","abort-text"],t.default=y},17261:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244));function c(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(61089);var f=n(48991),h=n(34749),p=function(e){(0,l.default)(n,e);var t=c(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return(0,o.default)(n,[{key:"connectedCallback",value:function(){(0,u.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this),document.addEventListener("mousemove",this),document.addEventListener("mousedown",this),document.addEventListener("mouseup",this),document.addEventListener("contextmenu",this,{capture:!0}),document.addEventListener("keydown",this)}},{key:"handleEvent",value:function(e){if("mouseup"===e.type){var t=e.target.closest(h.default.tagName);t&&t.item.enabled&&(this.stack.clear(),t.item.callback&&t.item.callback())}e.stopPropagation(),e.preventDefault()}},{key:"disconnectedCallback",value:function(){document.removeEventListener("mousemove",this),document.removeEventListener("mousedown",this),document.removeEventListener("mouseup",this),document.removeEventListener("contextmenu",this,{capture:!0}),document.removeEventListener("keydown",this),(0,u.default)((0,d.default)(n.prototype),"disconnectedCallback",this).call(this)}}]),n}(f.default);p.tagName="wf-context-menu",t.default=p},20248:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(80655)),u=a(n(20497)),l=a(n(75244));function s(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(46533);var d=function(e){(0,o.default)(n,e);var t=s(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return n}(n(46095).default);d.tagName="wf-fullscreen-window",t.default=d},26710:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(80655)),u=a(n(20497)),l=a(n(75244));function s(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(97712);var d=function(e){(0,o.default)(n,e);var t=s(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return n}(n(83722).default);d.tagName="wf-group",t.default=d},94423:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(80655)),u=a(n(20497)),l=a(n(75244));function s(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(58192);var d=function(e){(0,o.default)(n,e);var t=s(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return n}(n(41457).default);d.tagName="wf-icon-button",t.default=d},5008:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.AbstractList=t.SegmentedProgressBar=t.Cell=t.List=t.Selector=t.SpeechBubble=t.ProgressBar=t.Textbox=t.Slider=t.WindowTitlebar=t.Window=t.SubmenuWindow=t.RadioButton=t.MenuWindow=t.MenuItem=t.MenuView=t.MenuItemSeparator=t.Menubar=t.IconButton=t.Group=t.Checkbox=t.Button=t.ConfirmationWindow=t.Label=t.SearchBar=t.FullscreenWindow=t.Panel=t.Segment=t.SegmentControl=t.ProgressIndicator=t.Popover=t.InlineSelector=t.ContextMenu=t.AbstractPanel=t.AbstractMenuView=t.AbstractIconButton=t.AbstractWindow=void 0;var r=n(46095);t.AbstractWindow=r.default;var a=n(9488);t.AbstractList=a.default;var i=n(41457);t.AbstractIconButton=i.default;var o=n(72908);t.AbstractMenuView=o.default;var u=n(21042);t.AbstractPanel=u.default;var l=n(6314);t.Button=l.default;var s=n(93458);t.Checkbox=s.default;var d=n(97941);t.ConfirmationWindow=d.default;var c=n(26710);t.Group=c.default;var f=n(94423);t.IconButton=f.default;var h=n(34749);t.MenuItem=h.default;var p=n(55344);t.MenuItemSeparator=p.default;var v=n(4782);t.MenuView=v.default;var y=n(72594);t.MenuWindow=y.default;var m=n(85435);t.Menubar=m.default;var g=n(15861);t.RadioButton=g.default;var _=n(11997);t.Slider=_.default;var w=n(50049);t.SubmenuWindow=w.default;var k=n(54619);t.Window=k.default;var b=n(9311);t.WindowTitlebar=b.default;var S=n(85e3);t.Textbox=S.default;var I=n(19615);t.ProgressBar=I.default;var x=n(23998);t.SpeechBubble=x.default;var T=n(31490);t.Selector=T.default;var M=n(30104);t.List=M.default;var E=n(18583);t.Cell=E.default;var C=n(90163);t.Label=C.default;var A=n(29680);t.SearchBar=A.default;var D=n(20248);t.FullscreenWindow=D.default;var z=n(21919);t.Panel=z.default;var P=n(53748);t.SegmentControl=P.default;var R=n(45100);t.Segment=R.default;var L=n(73223);t.ProgressIndicator=L.default;var F=n(66920);t.Popover=F.default;var W=n(17261);t.ContextMenu=W.default;var B=n(12164);t.InlineSelector=B.default;var N=n(29132);t.SegmentedProgressBar=N.default},12164:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244)),c=a(n(68748)),f=a(n(35983)),h=a(n(67093)),p=a(n(41870));function v(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,c.default)(t,"__esModule",{value:!0}),n(42458);var y=n(83722),m=n(31560),g=function(e){(0,l.default)(n,e);var t=v(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments))._options=[],e._value=null,e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){(0,u.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this),this.addEventListener("mousedown",this),this.addEventListener("mouseup",this),this.addEventListener("click",this)}},{key:"handleEvent",value:function(e){var t=this;if(e.stopPropagation(),e.stopImmediatePropagation(),"mousedown"===e.type&&e.target===this){var n,r=this.indexOfSelectedOption(),a=WebFun.JSX.render("select",{value:r.toString(),onchange:function(e){t.value=t.options[+a.value].value,a.remove(),e.stopPropagation(),t.dispatchEvent(new CustomEvent("change"))},onblur:function(){return a.remove()}},(0,f.default)(n=this.options).call(n,(function(e,t){var n=e.label;return WebFun.JSX.render("option",{selected:t===r,value:t.toString()},n)})));this.appendChild(a),m.dispatch((function(){return a.open()}))}}},{key:"disconnectedCallback",value:function(){this.removeEventListener("mousedown",this),this.removeEventListener("mouseup",this),this.removeEventListener("click",this),(0,u.default)((0,d.default)(n.prototype),"disconnectedCallback",this).call(this)}},{key:"options",get:function(){return this._options},set:function(e){this._options=e}},{key:"value",get:function(){return this._value},set:function(e){var t,n=(0,h.default)(t=this.options).call(t,(function(t){return t.value===e}))||this.options.first();this._value=n.value,this.textContent=n.label}},{key:"indexOfSelectedOption",value:function(){var e,t=this;return(0,p.default)(e=this.options).call(e,(function(e){return e.value===t.value}))||0}}]),n}(y.default);g.tagName="wf-inline-selector",t.default=g},90163:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(6060)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244));function c(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(29793);var f=n(83722),h=n(48387),p=function(e){(0,l.default)(n,e);var t=c(n);function n(){var e;return(0,i.default)(this,n),(e=t.call(this)).maxLength=0,e.addEventListener("dblclick",(0,u.default)(e)),e}return(0,o.default)(n,[{key:"handleEvent",value:function(e){"dblclick"===e.type&&(this._editor||(e.preventDefault(),this.beginEditing()))}},{key:"_triggerOnChange",value:function(){this.dispatchEvent(new Event("change"))}},{key:"beginEditing",value:function(){var e=this;if(!this._editor){var t=new h.FieldEditor(this);t.maxLength=this.maxLength,t.onconfirm=function(){return e._triggerOnChange()},t.onend=function(){return e.endEditing()},this._editor=t}}},{key:"endEditing",value:function(){this._editor&&(this._editor=null,this.scrollLeft=0,this.scrollTop=0)}}]),n}(f.default);p.tagName="wf-label",p.observedAttributes=[],t.default=p},30104:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(80655)),u=a(n(20497)),l=a(n(75244));function s(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(17674);var d=function(e){(0,o.default)(n,e);var t=s(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return n}(n(9488).default);d.tagName="wf-list",t.default=d},55344:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244));function c(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(86578);var f=function(e){(0,l.default)(n,e);var t=c(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments)).menu=null,e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){(0,u.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this),this.textContent="",this.appendChild(document.createElement("div"))}}]),n}(n(83722).default);f.tagName="wf-menu-item-separator",t.default=f},34749:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244));function c(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(35629);var f=n(83722),h=n(43995),p=function(e){(0,l.default)(n,e);var t=c(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments))._item=null,e}return(0,o.default)(n,[{key:"item",get:function(){return this._item},set:function(e){this._item&&this._reset(),this._item=e,this._item&&this._rebuild()}},{key:"_reset",value:function(){this.onmouseup=null}},{key:"connectedCallback",value:function(){(0,u.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this),this._rebuild()}},{key:"disconnectedCallback",value:function(){this.textContent="",(0,u.default)((0,d.default)(n.prototype),"disconnectedCallback",this).call(this)}},{key:"_rebuild",value:function(){this.textContent="";var e=this.item||{};this.appendChild(WebFun.JSX.render("span",{className:"state"}));var t=this.evaluate(e.state,h.default.Off);this._reflectState(t),this.evaluate(e.enabled,!0)?this.removeAttribute("disabled"):this.setAttribute("disabled","");var n=this.buildTitle(e.title,e.mnemonic);n.classList.add("title"),this.appendChild(n),e.beta&&this.appendChild(WebFun.JSX.render("span",{className:"beta"},"Beta")),e.submenu?(this.setAttribute("submenu",""),this.appendChild(WebFun.JSX.render("span",{className:"submenu"},WebFun.JSX.render("i",{className:"fa fa-caret-right"})))):this.removeAttribute("submenu")}},{key:"buildTitle",value:function(e,t){var n=this.evaluate(e,""),r=document.createElement("span");if(void 0===t)return r.innerText=n,r;var a=n.substring(0,t),i=n.substring(t,t+1),o=n.substring(t+1),u=document.createElement("span");return u.classList.add("mnemonic"),u.appendChild(document.createTextNode(i)),r.appendChild(document.createTextNode(a)),r.appendChild(u),r.appendChild(document.createTextNode(o)),r}},{key:"_reflectState",value:function(e){switch(e){case h.default.Mixed:this.setAttribute("state","mixed");break;case h.default.On:this.setAttribute("state","on");break;default:this.removeAttribute("state")}}},{key:"evaluate",value:function(e,t){return e instanceof Function?e():void 0!==e?e:t}}]),n}(f.default);p.tagName="wf-menu-item",t.default=p},4782:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(80655)),u=a(n(20497)),l=a(n(75244));function s(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(29238);var d=function(e){(0,o.default)(n,e);var t=s(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return n}(n(72908).default);d.tagName="wf-menu-view",t.default=d},72594:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(80655)),u=a(n(20497)),l=a(n(75244));function s(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(67862);var d=function(e){(0,o.default)(n,e);var t=s(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return n}(n(48991).default);d.tagName="wf-menu-window",t.default=d},85435:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244)),c=a(n(68748)),f=a(n(41870)),h=a(n(69159));function p(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,c.default)(t,"__esModule",{value:!0}),n(8223);var v=n(72908),y=n(34749),m=n(49762),g=n(72594),_=n(48387),w=n(31560),k=function(e){(0,l.default)(n,e);var t=p(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments))._currentItem=-1,e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){var e=this;(0,u.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this),this.onmousedown=function(t){return e.startMouseHandling(t)}}},{key:"startMouseHandling",value:function(e){var t=this,n=this._findItemAt(new w.Point(e.pageX,e.pageY));if(-1!==n){var r=this.menu.items[n];if(r.submenu){var a=new _.ModalSession;a.onmousemove=function(e){return t._mouseMoved(e)},a.onend=function(){window.removeEventListener("mouseup",t._mouseDownHandler),t._mouseDownHandler=null;var e=t.querySelector("[open]");e&&e.removeAttribute("open"),m.default.sharedStack.clear()},this._modalSession=a,this._registerMouseUpHandler=function(){t._mouseDownHandler=function(){return a.end(0)},window.addEventListener("mouseup",t._mouseDownHandler),window.removeEventListener("mouseup",t._registerMouseUpHandler)},window.addEventListener("mouseup",this._registerMouseUpHandler),a.run(),this._showMenuForItem(n)}else r.callback instanceof Function&&r.callback()}}},{key:"_mouseMoved",value:function(e){var t=new w.Point(e.pageX,e.pageY);if(this._elementContainsPoint(this,t)){var n=this._findItemAt(t);n!==this._currentItem&&-1!==n&&(this._closeMenuForItem(this._currentItem),this._showMenuForItem(n))}}},{key:"_closeMenuForItem",value:function(e){if(-1!==e){var t=this.children[e];this._currentItem=-1,t.removeAttribute("open"),m.default.sharedStack.clear()}}},{key:"handleEvent",value:function(e){if("mouseup"===e.type){var t=e.target.closest(y.default.tagName);if(!t)return;var n=t.item;if(!n||!n.enabled)return;this._closeMenuForItem(this._currentItem),this._modalSession.end(0),n.callback&&n.callback(),e.preventDefault(),e.stopPropagation()}}},{key:"_showMenuForItem",value:function(e){if(-1!==e){var t=this.children[e],n=this.menu.items[e];if(t.setAttribute("open",""),n&&n.submenu){var r=document.createElement(g.default.tagName);r.menu=n.submenu,r.show(t),r.addEventListener("mouseup",this),this._currentItem=e}else this._currentItem=-1}}},{key:"_elementContainsPoint",value:function(e,t){var n=e.getBoundingClientRect();return t.x>=n.left+window.scrollX&&t.x<=n.right+window.scrollX&&t.y>=n.top+window.scrollY&&t.y<=n.bottom+window.scrollY}},{key:"_findItemAt",value:function(e){var t,n=this;return(0,f.default)(t=(0,h.default)(this.children)).call(t,(function(t){return n._elementContainsPoint(t,e)}))}}]),n}(v.default);k.tagName="wf-menubar",t.default=k},21919:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(80655)),u=a(n(20497)),l=a(n(75244));function s(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(47096);var d=function(e){(0,o.default)(n,e);var t=s(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return n}(n(46095).default);d.tagName="wf-panel",t.default=d},66920:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244));function c(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(13114);var f=function(e){(0,l.default)(n,e);var t=c(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments)).content=WebFun.JSX.render("div",null),e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){(0,u.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this),this.appendChild(this.content)}},{key:"disconnectedCallback",value:function(){(0,u.default)((0,d.default)(n.prototype),"disconnectedCallback",this).call(this),this.content.remove()}}]),n}(n(83722).default);f.tagName="wf-popover",t.default=f},19615:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244));function c(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(94301);var f=function(e){(0,l.default)(n,e);var t=c(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments))._indicator=WebFun.JSX.render("div",null),e._value=0,e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){(0,u.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this),this.appendChild(this._indicator)}},{key:"value",get:function(){return this._value},set:function(e){this._value=e,this._indicator.style.width="".concat((100*e).toString(),"%")}}]),n}(n(83722).default);f.tagName="wf-progress-bar",t.default=f},73223:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244));function c(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(8718);var f=function(e){(0,l.default)(n,e);var t=c(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return(0,o.default)(n,[{key:"connectedCallback",value:function(){(0,u.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this),this.appendChild(WebFun.JSX.render("span",null,WebFun.JSX.render("div",null),WebFun.JSX.render("div",null),WebFun.JSX.render("div",null),WebFun.JSX.render("div",null),WebFun.JSX.render("div",null),WebFun.JSX.render("div",null),WebFun.JSX.render("div",null),WebFun.JSX.render("div",null),WebFun.JSX.render("div",null),WebFun.JSX.render("div",null),WebFun.JSX.render("div",null),WebFun.JSX.render("div",null)))}},{key:"disconnectedCallback",value:function(){this.textContent="",(0,u.default)((0,d.default)(n.prototype),"disconnectedCallback",this).call(this)}}]),n}(n(83722).default);f.tagName="wf-progress-indicator",t.default=f},15861:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244));function c(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),t.Group=void 0;var f=n(83722),h=n(53486);t.Group=h.default;var p=function(e){(0,l.default)(n,e);var t=c(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments))._id=String.UUID(),e._radio=WebFun.JSX.render("input",{type:"radio",id:e._id}),e._label=WebFun.JSX.render("label",{htmlFor:e._id}),e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){(0,u.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this),this.appendChild(this._radio),this.appendChild(this._label)}},{key:"disconnectedCallback",value:function(){this._label.remove(),this._radio.remove(),(0,u.default)((0,d.default)(n.prototype),"disconnectedCallback",this).call(this)}},{key:"title",get:function(){return this._label.textContent},set:function(e){this._label.textContent=e}},{key:"checked",get:function(){return this._radio.hasAttribute("checked")},set:function(e){e?this._radio.setAttribute("checked",""):this._radio.removeAttribute("checked")}},{key:"onchange",get:function(){return this._radio.onchange},set:function(e){this._radio.onchange=e}},{key:"groupID",get:function(){return this._radio.name},set:function(e){this._radio.name=e}}]),n}(f.default);p.Group=h.default,p.tagName="wf-radio-button",t.default=p},53486:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244)),d=a(n(68748)),c=a(n(42601));function f(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,d.default)(t,"__esModule",{value:!0});var h=function(e){(0,u.default)(n,e);var t=f(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(0,i.default)(this,n),(e=t.call(this))._buttons=[],e._id=String.UUID(),(0,c.default)(r).call(r,(function(t){return e.addButton(t)})),e}return(0,o.default)(n,[{key:"buttons",get:function(){return this._buttons}},{key:"addButton",value:function(e){this._buttons.push(e),e.groupID=this._id}}]),n}(n(31560).EventTarget);t.default=h},29680:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244));function d(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(22846);var c=function(e){(0,u.default)(n,e);var t=d(n);function n(){var e;return(0,i.default)(this,n),(e=t.call(this))._inputField=document.createElement("input"),e._inputField.type="search",e._inputField.oninput=function(){return e.onsearch&&e.onsearch(e._inputField.value)},e._button=document.createElement("button"),e._button.textContent="Done",e._button.onclick=function(){return e.onclose&&e.onclose()},e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){this.appendChild(this._inputField),this.appendChild(this._button)}},{key:"disconnectedCallback",value:function(){this._inputField.remove(),this._button.remove()}},{key:"focus",value:function(){this._inputField.focus()}},{key:"searchString",get:function(){return this._inputField.value},set:function(e){this._inputField.value=e}},{key:"isVisible",get:function(){return this.hasAttribute("visible")}}]),n}(n(83722).default);c.tagName="wf-search-bar",c.observedAttributes=[],t.default=c},53748:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244)),c=a(n(68748)),f=a(n(42601)),h=a(n(69159)),p=a(n(67093)),v=a(n(75356));function y(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,c.default)(t,"__esModule",{value:!0}),n(33814);var m=n(83722),g=n(31560),_=function(e){(0,l.default)(n,e);var t=y(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments)).state=new g.DiscardingStorage,e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){var e,t,r=this;(0,u.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this),(0,f.default)(e=(0,h.default)(this.children)).call(e,(function(e){return e.addEventListener("click",r)})),this.currentSegment=(0,p.default)(t=(0,h.default)(this.children)).call(t,(function(e){return e.hasAttribute("selected")}))||this.childNodes[this.state.load("active-segment")]||this.firstElementChild}},{key:"handleEvent",value:function(e){this.currentSegment=e.currentTarget}},{key:"disconnectedCallback",value:function(){var e,t=this;(0,f.default)(e=(0,h.default)(this.children)).call(e,(function(e){return e.removeEventListener("click",t)})),(0,u.default)((0,d.default)(n.prototype),"disconnectedCallback",this).call(this)}},{key:"currentSegment",set:function(e){var t;e!==this._currentSegment&&(this._currentSegment&&this._currentSegment.removeAttribute("selected"),this._currentSegment=e,this.state.store("active-segment",(0,v.default)(t=this.childNodes).call(t,e)),this._currentSegment&&this._currentSegment.setAttribute("selected",""),this.onsegmentchange instanceof Function&&this.onsegmentchange(this._currentSegment))}}]),n}(m.default);_.tagName="wf-segmented-control",t.default=_},45100:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244));function d(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(8798);var c=function(e){(0,u.default)(n,e);var t=d(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments))._selected=!1,e}return(0,o.default)(n,[{key:"attributeChangedCallback",value:function(){this.selected=this.hasAttribute("selected")}},{key:"selected",get:function(){return this._selected},set:function(e){e!==this._selected&&(this._selected=e,e?this.setAttribute("selected",""):this.removeAttribute("selected"))}}]),n}(n(83722).default);c.tagName="wf-segment",c.observedAttributes=["selected"],t.default=c},29132:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244));function d(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0}),n(91572);var c=function(e){(0,u.default)(n,e);var t=d(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments))._value=0,e.numberOfSegments=24,e}return(0,o.default)(n,[{key:"value",get:function(){return this._value},set:function(e){for(var t=Math.min(Math.round(e*this.numberOfSegments),this.numberOfSegments);this.children.length<t;)this.appendChild(WebFun.JSX.render("div",null));for(;this.children.length>t;)this.firstElementChild.remove();this._value=e,this.dataset&&(this.dataset.value="".concat(e))}}]),n}(n(83722).default);c.tagName="wf-segmented-progress-bar",t.default=c},31490:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244)),c=a(n(68748)),f=a(n(42601)),h=a(n(67093));function p(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,c.default)(t,"__esModule",{value:!0}),n(87791);var v=function(e){(0,l.default)(n,e);var t=p(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments)).element=WebFun.JSX.render("select",null),e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){(0,u.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this),this.appendChild(this.element),this.appendChild(WebFun.JSX.render("i",{className:"fa fa-caret-down"}))}},{key:"focus",value:function(){this.element.focus()}},{key:"onchange",get:function(){return this.element.onchange},set:function(e){this.element.onchange=e}},{key:"value",get:function(){return this.element.value},set:function(e){var t,n;this.element.value=e,(0,f.default)(t=this.element.options).call(t,(function(e){return e.selected=!1}));var r=(0,h.default)(n=this.element.options).call(n,(function(t){return t.value===e}));r&&(r.selected=!0)}},{key:"addOption",value:function(e,t){this.element.appendChild(WebFun.JSX.render("option",{selected:t===this.value,value:void 0!==t?t:e},e||t))}},{key:"options",set:function(e){var t=this;(0,f.default)(e).call(e,(function(e){return"string"==typeof e?t.addOption(e,e):t.addOption(e.label,e.value)}))}},{key:"removeAllOptions",value:function(){this.element.textContent=""}},{key:"removeOption",value:function(e){var t,n=(0,h.default)(t=this.element.options).call(t,(function(t){return t.value===e}));n&&this.element.removeChild(n)}},{key:"borderless",get:function(){return this.hasAttribute("borderless")},set:function(e){e?this.setAttribute("borderless",""):this.removeAttribute("borderless")}}]),n}(n(83722).default);v.tagName="wf-selector",t.default=v},11997:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244)),c=a(n(68748)),f=a(n(60388)),h=a(n(73035));function p(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,c.default)(t,"__esModule",{value:!0}),n(5568);var v=n(83722),y=n(31560),m=n(17725),g=function(e){(0,l.default)(n,e);var t=p(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments))._value=0,e._min=0,e._max=0,e._steps=0,e._snapToIntegers=!1,e._continuous=!1,e._onChange=null,e._repeat=null,e._knob=WebFun.JSX.render("div",{className:"knob thumb"},WebFun.JSX.render("div",null)),e._left=WebFun.JSX.render("div",{className:"knob left"},WebFun.JSX.render("div",null)),e._right=WebFun.JSX.render("div",{className:"knob right"},WebFun.JSX.render("div",null)),e.mouseCoordinates={x:0,y:0},e.buttonCoordinates={x:0,y:0},e}return(0,o.default)(n,[{key:"min",get:function(){return this._min},set:function(e){this._min=e,this.layout()}},{key:"value",get:function(){return this._value},set:function(e){this._value=y.clamp(this._min,e,this._max),this.layout()}},{key:"max",get:function(){return this._max},set:function(e){this._max=e,this.layout()}},{key:"minText",get:function(){return this._minText},set:function(e){this._minText=e}},{key:"midText",get:function(){return this._midText},set:function(e){this._midText=e}},{key:"maxText",get:function(){return this._maxText},set:function(e){this._maxText=e}},{key:"continuous",get:function(){return this._continuous},set:function(e){this._continuous=e}},{key:"onChange",get:function(){return this._onChange},set:function(e){this._onChange=e}},{key:"snapToIntegers",get:function(){return this._snapToIntegers},set:function(e){this._snapToIntegers=e}},{key:"steps",get:function(){return this._steps},set:function(e){this._steps=e}},{key:"connectedCallback",value:function(){(0,u.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this),this._right.addEventListener("mousedown",this),this._left.addEventListener("mousedown",this),this._knob.addEventListener("mousedown",this),this.appendChild(this._right),this.appendChild(this._left),this.appendChild(this._knob),this.layout()}},{key:"disconnectedCallback",value:function(){this._right.removeEventListener("mousedown",this),this._left.removeEventListener("mousedown",this),this._knob.removeEventListener("mousedown",this),document.removeEventListener("mouseup",this),window.removeEventListener("mousemove",this),window.removeEventListener("mouseup",this),(0,u.default)((0,d.default)(n.prototype),"disconnectedCallback",this).call(this)}},{key:"handleEvent",value:function(e){var t=e.type,n=e.currentTarget;if("mousedown"===t&&n===this._left&&(this._tickLeft(),document.addEventListener("mouseup",this),e.preventDefault(),e.stopPropagation()),"mousedown"===t&&n===this._right&&(this._tickRight(),document.addEventListener("mouseup",this),e.preventDefault(),e.stopPropagation()),"mousedown"===t&&n===this._knob&&(this.mouseCoordinates.x=e.pageX,this.mouseCoordinates.y=e.pageY,this.buttonCoordinates.x=(0,f.default)(this._knob.style.left),this.buttonCoordinates.y=(0,f.default)(this._knob.style.top),window.addEventListener("mouseup",this),window.addEventListener("mousemove",this),e.preventDefault(),e.stopPropagation()),"mousedown"===t&&n===this&&(e.preventDefault(),e.stopPropagation()),"mousemove"===t&&n===window){var r=e.pageX-this.mouseCoordinates.x,a=this.buttonCoordinates.x+r,i=this.sliderLength;a=m.max(18,a),a=m.min(18+i,a),this._value=this._min+(a-18)/i*(this._max-this._min),this._snapToIntegers&&(this._value=m.round(this._value)),this.layout(),this.continuous&&this._postChangeNotification()}"mouseup"===e.type&&e.currentTarget===window&&(window.removeEventListener("mousemove",this),window.removeEventListener("mouseup",this),this._snapToIntegers&&this.layout(),this._postChangeNotification()),"mouseup"===t&&(document.removeEventListener("mouseup",this),clearTimeout(this._repeat),e.stopPropagation())}},{key:"_tickLeft",value:function(){var e=this,t=this._snapToIntegers?1:.02;this.value-=t,this._repeat&&clearTimeout(this._repeat),this._repeat=(0,h.default)((function(){return e._tickLeft()}),80)}},{key:"_tickRight",value:function(){var e=this,t=this._snapToIntegers?1:.02;this.value+=t,this._repeat&&clearTimeout(this._repeat),this._repeat=(0,h.default)((function(){return e._tickRight()}),80)}},{key:"layout",value:function(){if(this.isConnected){var e=(this._value-this._min)/(this._max-this._min);this._knob.style.left=y.px(m.round(18+this.sliderLength*e))}}},{key:"sliderLength",get:function(){return this.getBoundingClientRect().width-18-18-20}},{key:"_postChangeNotification",value:function(){this._onChange instanceof Function&&this._onChange(new CustomEvent("change"))}}]),n}(v.default);g.tagName="wf-slider",t.default=g},23998:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(25867)),o=a(n(40361)),u=a(n(7583)),l=a(n(18582)),s=a(n(80655)),d=a(n(20497)),c=a(n(75244)),f=a(n(68748)),h=a(n(42601)),p=a(n(60388)),v=a(n(35983)),y=a(n(92915)),m=a(n(73035));function g(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,d.default)(this,n)}}(0,f.default)(t,"__esModule",{value:!0}),t.Event=void 0,n(80668);var _=n(6314),w=n(83722),k=n(31560),b=n(48387);t.Event={End:"end"};var S,I=16;!function(e){e[e.None=32]="None",e[e.Top=2]="Top",e[e.Bottom=4]="Bottom",e[e.Left=8]="Left",e[e.Right=16]="Right",e[e.Horizontal=24]="Horizontal",e[e.Vertical=6]="Vertical"}(S||(S={}));var x={fontSize:"11px",fontFamily:'"Trueno", sans-serif',lineHeight:"12px"},T=function(e){(0,s.default)(n,e);var t=g(n);function n(){var e;return(0,o.default)(this,n),(e=t.call(this))._width=170,e._arrowStyle=S.Top,e._up=WebFun.JSX.render(_.default,{className:"up",icon:"caret-up",onmousedown:function(){return e.scrollUp()}}),e._down=WebFun.JSX.render(_.default,{className:"down",icon:"caret-down",onmousedown:function(){return e.scrollDown()}}),e._end=WebFun.JSX.render(_.default,{className:"end",icon:"circle",onclick:function(){return e.end()}}),e._text=WebFun.JSX.render("div",{className:"text",style:x}),e._keepScrolling=-1,e._origin=new k.Point(0,0),e.shortcutManager=b.ShortcutManager.sharedManager,e.shortcuts=[],WebFun.JSX.render("div",{className:"text-container"}).appendChild(e._text),e}return(0,u.default)(n,[{key:"connectedCallback",value:function(){var e=this;(0,l.default)((0,c.default)(n.prototype),"connectedCallback",this).call(this),this.style.setProperty("--font-family",x.fontFamily),this.style.setProperty("--line-height",x.lineHeight),this.style.setProperty("--current-line","0"),this.style.width=this._width+"px",this.appendChild(this._text.parentNode),this.shortcuts=[this.shortcutManager.registerShortcut((function(){return e.scrollUp()}),{key:"ArrowUp"}),this.shortcutManager.registerShortcut((function(){return e.scrollDown()}),{key:"ArrowDown"}),this.shortcutManager.registerShortcut((function(){return e.end()}),{key:" "})],this.text=this.text||""}},{key:"disconnectedCallback",value:function(){var e,t=this;(0,h.default)(e=this.shortcuts).call(e,(function(e){return t.shortcutManager.unregisterShortcut(e)})),(0,l.default)((0,c.default)(n.prototype),"disconnectedCallback",this).call(this)}},{key:"rebuild",value:function(){if(this.isConnected){this.appendChild(this._text.parentNode),this._setupButtons(),this._setupBackground(),this._setupBackground(),this._updateButtonVisibility(),this._scrollTo(0);var e=this.origin;this._arrowStyle===S.Bottom&&(e.y-=(0,p.default)(this.style.height)),this.style.left=e.x-(0,p.default)(this._width+"")/2+"px",this.style.top=e.y+"px"}}},{key:"text",get:function(){return this._text.textContent},set:function(e){this._text.textContent=e.replace(/(?:\r\n|\r|\n)/g,"\n"),this.rebuild()}},{key:"origin",get:function(){return this._origin},set:function(e){this._origin=e,this.rebuild()}},{key:"arrowStyle",get:function(){return this._arrowStyle},set:function(e){this._arrowStyle=e,this.rebuild()}},{key:"_setupButtons",value:function(){this._end.setAttribute("disabled",""),this.appendChild(WebFun.JSX.render("div",{className:"controls"},this._up,this._down,this._end))}},{key:"_setupBackground",value:function(){var e=this.querySelector("svg");e&&e.remove(),1===this._calculateNumberOfLines(!1)?this.classList.add("singleline"):this.classList.remove("singleline");var t=this._width,n=this._calculateHeight(),r="http://www.w3.org/2000/svg",a=document.createElementNS(r,"svg"),i=document.createElementNS(r,"path");i.style.fill="#FFFFFF",i.style.stroke="#000000",i.setAttribute("d",this._buildPath()),a.appendChild(i),this.insertBefore(a,this.firstChild),this._arrowStyle&S.Vertical?(this.style.height=n+I+"px",this.style.width=t+"px",a.setAttribute("height","".concat(n+I)),a.setAttribute("width",""+t)):this._arrowStyle&S.Horizontal?(this.style.height=n+"px",this.style.width=t+I+"px",a.setAttribute("height",""+n),a.setAttribute("width","".concat(t+I))):this._arrowStyle&S.None&&(this.style.height=n+"px",this.style.width=t+"px",a.setAttribute("height",""+n),a.setAttribute("width","".concat(t)));var o=this._arrowStyle&S.Left?I:0,u=this._arrowStyle&S.Right?I:0,l=this._arrowStyle&S.Top?I:0,s=this._arrowStyle&S.Bottom?I:0;this._text.parentElement.style.left=7+o+"px",this._text.parentElement.style.top=7+l+"px",this._text.parentElement.style.bottom=7+s+"px",this._text.parentElement.style.right=28+u+"px",this._end.parentElement.style.bottom=5+s+"px"}},{key:"_buildPath",value:function(){var e=this._width,t=this._calculateHeight(),n=this._arrowStyle&S.Top?16:0,r=this._arrowStyle&S.Right?16:0,a=n+t,o=r+e,u=[];if(u.push(["M",r+5,n]),this._arrowStyle&S.Top){var l=(o-r)/2-8-8,s=!!(1&this._arrowStyle)?l:l+I;u.push(["L",l,n]),u.push(["L",s,n-I]),u.push(["L",l+I,n])}if(u.push(["L",o-5,n]),u.push(["A",5,5,0,0,1,o,n+5]),u.push(["L",o,a-5]),u.push(["A",5,5,0,0,1,e-5,a]),this._arrowStyle&S.Bottom){var d=(o-r)/2-8-8,c=!!(1&this._arrowStyle)?d:d+I;u.push(["L",d+I,t]),u.push(["L",c,a+I]),u.push(["L",d,a])}return u.push(["L",r+5,a]),u.push(["A",5,5,0,0,1,r,a-5]),u.push(["L",r,n+5]),u.push(["A",5,5,0,0,1,r+5,n]),u.push(["Z"]),(0,v.default)(u).call(u,(function(e){var t=(0,i.default)(e);return t[0]+(0,y.default)(t).call(t,1).join(",")})).join(" ")}},{key:"scrollDown",value:function(){var e=this;this._scrollBy(1),this._keepScrolling=(0,m.default)((function(){return e.scrollDown()}),100),this.stopScrollingOnMouseUp(),this.stopScrollingOnKeyUp()}},{key:"scrollUp",value:function(){var e=this;this._scrollBy(-1),this._keepScrolling=(0,m.default)((function(){return e.scrollUp()}),100),this.stopScrollingOnMouseUp(),this.stopScrollingOnKeyUp()}},{key:"end",value:function(){clearTimeout(this._keepScrolling),this.remove(),this.dispatchEvent(new CustomEvent(n.Event.End)),this.onend&&this.onend(new CustomEvent(n.Event.End))}},{key:"stopScrollingOnMouseUp",value:function(){var e=this;document.addEventListener("mouseup",(function(){return clearTimeout(e._keepScrolling)}),{capture:!0,passive:!0,once:!0})}},{key:"stopScrollingOnKeyUp",value:function(){var e=this;document.addEventListener("keyup",(function(){return clearTimeout(e._keepScrolling)}),{capture:!0,passive:!0,once:!0})}},{key:"show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body;e.appendChild(this)}},{key:"_scrollBy",value:function(e){var t=0|(0,p.default)(this._text.style.getPropertyValue("--current-line"));this._scrollTo(t+e)}},{key:"_scrollTo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this._calculateNumberOfLines(!0);e=Math.min(e,t-5),e=Math.max(e,0),this._text.style.setProperty("--current-line","".concat(e)),this._updateButtonStates()}},{key:"_calculateHeight",value:function(){return 7+this._calculateNumberOfLines(!1)*(0,p.default)(x.lineHeight)+7}},{key:"_calculateNumberOfLines",value:function(e){var t=Math.ceil(this._text.getBoundingClientRect().height/(0,p.default)(x.lineHeight)),n=Math.max(1,t);return e?n:Math.min(n,5)}},{key:"_updateButtonVisibility",value:function(){this._calculateNumberOfLines(!0)>5?(this._up.removeAttribute("hidden"),this._down.removeAttribute("hidden")):(this._up.setAttribute("hidden",""),this._down.setAttribute("hidden",""))}},{key:"_updateButtonStates",value:function(){var e=(0,p.default)(this._text.style.getPropertyValue("--current-line")),t=this._calculateNumberOfLines(!0)-5;this._up.removeAttribute("disabled"),this._down.removeAttribute("disabled"),e<=0&&this._up.setAttribute("disabled",""),e>=t&&(this._down.setAttribute("disabled",""),this._end.removeAttribute("disabled"))}}]),n}(w.default);T.ArrowStyle=S,T.Event=t.Event,T.tagName="wf-speech-bubble",t.default=T},50049:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(80655)),u=a(n(20497)),l=a(n(75244));function s(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0});var d=function(e){(0,o.default)(n,e);var t=s(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return n}(n(48991).default);d.tagName="wf-submenu-window",t.default=d},85e3:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244)),c=a(n(68748)),f=a(n(60388));function h(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,c.default)(t,"__esModule",{value:!0}),n(16818);var p=function(e){(0,l.default)(n,e);var t=h(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments))._element=document.createElement("input"),e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){(0,u.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this),this._element.type="text",this.appendChild(this._element)}},{key:"focus",value:function(){this._element.focus()}},{key:"select",value:function(){this._element.select()}},{key:"editable",get:function(){return!this._element.hasAttribute("readonly")},set:function(e){e?this._element.removeAttribute("readonly"):this._element.setAttribute("readonly","")}},{key:"width",get:function(){return(0,f.default)(this._element.style.width)},set:function(e){this._element.style.width=e+"px"}},{key:"height",get:function(){return(0,f.default)(this._element.style.height)},set:function(e){this._element.style.height=e+"px"}},{key:"value",get:function(){return this._element.value},set:function(e){this._element.value=e}},{key:"align",get:function(){return this._element.style.textAlign||"left"},set:function(e){this._element.style.textAlign=e}},{key:"onchange",get:function(){return this._element.onchange},set:function(e){this._element.onchange=e}}]),n}(n(83722).default);p.tagName="wf-textbox",p.observedAttributes=["readonly"],t.default=p},9311:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244)),c=a(n(68748)),f=a(n(42601));function h(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,c.default)(t,"__esModule",{value:!0}),n(51389);var p=n(31560),v=n(83722),y=n(85435),m=function(e){(0,l.default)(n,e);var t=h(n);function n(){var e;return(0,i.default)(this,n),(e=t.call(this)).onclose=p.identity,e.onpin=p.identity,e.movable=!0,e._menubar=null,e._titleNode=null,e._buttons=[],e._closeButton=document.createElement("div"),e._closeButton.classList.add("close-button"),e._closeButton.style.display="",e}return(0,o.default)(n,[{key:"window",get:function(){return this._window},set:function(e){var t=this;this._window=e,this._closeButton.onclick=function(){return t._window.close()},this.movable&&this._setupDragging(e)}},{key:"menu",get:function(){var e;return(null===(e=this._menubar)||void 0===e?void 0:e.menu)||null},set:function(e){this._menubar&&(this._menubar.remove(),this._menubar=null),e&&(this._menubar=document.createElement(y.default.tagName),this._menubar.menu=e,this.isConnected&&this.appendChild(this._menubar)),this._menubar&&this._titleNode&&(this._titleNode.style.display=this._menubar?"none":"")}},{key:"title",get:function(){return this._titleNode?this._titleNode.innerText:""},set:function(e){this._titleNode&&(this._titleNode.remove(),this._titleNode=null),e&&(this.menu&&(this._titleNode.style.display="none"),this._titleNode=document.createElement("span"),this._titleNode.innerText=e,this.insertBefore(this._titleNode,null))}},{key:"closable",get:function(){return"none"!==this._closeButton.style.display},set:function(e){this._closeButton.style.display=e?"":"none"}},{key:"connectedCallback",value:function(){var e,t=this;(0,u.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this),this.appendChild(this._closeButton),this._menubar&&this.appendChild(this._menubar),(0,f.default)(e=this._buttons).call(e,(function(e){return t.appendChild(e)}))}},{key:"_setupDragging",value:function(e){var t,n=this,r=function(n){e.origin=new p.Point(n.clientX-t.x,n.clientY-t.y),n.preventDefault(),n.stopImmediatePropagation()},a=function e(){document.removeEventListener("mouseup",e),document.removeEventListener("mousemove",r)};this.addEventListener("mousedown",(function(i){if(i.target===n&&0===i.button){t=new p.Point(i.clientX-e.x,i.clientY-e.y),document.addEventListener("mouseup",a),document.addEventListener("mousemove",r),i.preventDefault(),i.stopImmediatePropagation();var o=n.windowManager;o&&o.focus(n._window)}}))}},{key:"pinnable",get:function(){return!!this._pinButton},set:function(e){var t=this;e!==!!this._pinButton&&(e?(this._pinButton=document.createElement("i"),this._pinButton.classList.add("fa"),this._pinButton.classList.add("fa-thumb-tack"),this._pinButton.classList.add("pin"),this._pinButton.onclick=function(){return t.pinned=!t.pinned},this.addButton(this._pinButton)):(this._pinButton.remove(),this._buttons.remove(this._pinButton),this._pinButton=null))}},{key:"pinned",get:function(){return this.pinnable&&this._pinButton.classList.contains("on")},set:function(e){this.pinnable&&(e?this._pinButton.classList.add("on"):this._pinButton.classList.remove("on"),this.onpin instanceof Function&&this.onpin(new CustomEvent("pin")))}},{key:"addButton",value:function(e){this._buttons.push(e),this.isConnected&&this.appendChild(e)}},{key:"windowManager",get:function(){return this._window.manager}}]),n}(v.default);m.tagName="wf-window-titlebar",t.default=m},54619:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(80655)),u=a(n(20497)),l=a(n(75244)),s=a(n(68748));function d(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}(0,s.default)(t,"__esModule",{value:!0}),t.Event=void 0,n(73543);var c=n(46095);(0,s.default)(t,"Event",{enumerable:!0,get:function(){return c.Event}});var f=function(e){(0,o.default)(n,e);var t=d(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return n}(c.default);f.tagName="wf-window",t.default=f},13398:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108)),o=r(n(40361)),u=r(n(7583)),l=r(n(68748)),s=r(n(79302)),d=r(n(35983)),c=r(n(75356)),f=r(n(69159));(0,l.default)(t,"__esModule",{value:!0});var h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,o.default)(this,e),this.allowsMultipleFiles=!1,this.allowedTypes=[],void 0!==t.allowsMultipleFiles&&(this.allowsMultipleFiles=t.allowsMultipleFiles),void 0!==t.allowedTypes&&(this.allowedTypes=t.allowedTypes)}var t,n;return(0,u.default)(e,[{key:"pickFile",value:(n=(0,i.default)(a.default.mark((function e(){var t=this;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new s.default((function(e){var n,r=document.createElement("input");r.type="file",r.style.opacity="0.0",t.allowedTypes.length&&(r.accept=(0,d.default)(n=t.allowedTypes).call(n,(function(e){return-1===(0,c.default)(e).call(e,"/")?e:"."+e})).join(",")),t.allowsMultipleFiles&&r.setAttribute("multiple","");var a=function(){var t=r.files,n=(0,f.default)(t||[]);e(n),r.remove(),document.body.onfocus=null};r.onchange=a,document.body.onfocus=a,document.body.appendChild(r),r.click()})));case 1:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})}],[{key:"Pick",value:(t=(0,i.default)(a.default.mark((function t(n){var r;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=new e(n),t.next=3,r.pickFile();case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)}))),function(e){return t.apply(this,arguments)})}]),e}();t.default=h},88607:(e,t,n)=>{var r=n(38468)(n(68748));(0,r.default)(t,"__esModule",{value:!0}),t.WindowMenuItem=t.WindowManager=t.MenuStack=t.MenuItemState=t.MenuItemSeparator=t.MenuItem=t.Menu=t.FilePicker=t.Components=t.ComponentJSXRenderer=t.ComponentRegistry=t.Component=void 0;var a=n(5008);t.Components=a;var i=n(83722);t.Component=i.default;var o=n(13319);t.ComponentRegistry=o.default;var u=n(13398);t.FilePicker=u.default;var l=n(79860);t.Menu=l.default;var s=n(33284);t.MenuItem=s.default,(0,r.default)(t,"MenuItemSeparator",{enumerable:!0,get:function(){return s.Separator}}),(0,r.default)(t,"MenuItemState",{enumerable:!0,get:function(){return s.State}});var d=n(49762);t.MenuStack=d.default;var c=n(46652);t.WindowManager=c.default;var f=n(14835);t.WindowMenuItem=f.default;var h=n(81340);t.ComponentJSXRenderer=h.default},79067:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r={title:"",state:n(43995).default.None,callback:null,mnemonic:void 0,submenu:null,enabled:!0,beta:!1};t.default=r},43995:(e,t,n)=>{var r;(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),function(e){e[e.None=0]="None",e[e.On=1]="On",e[e.Off=2]="Off",e[e.Mixed=3]="Mixed"}(r||(r={})),t.default=r},33284:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244)),d=a(n(68748)),c=a(n(20778));function f(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,d.default)(t,"__esModule",{value:!0}),t.Separator=t.State=void 0;var h=n(31560),p=n(79860),v=n(79067),y=n(43995);t.State=y.default;var m=function(e){(0,u.default)(n,e);var t=f(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,i.default)(this,n),(e=t.call(this)).isSeparator=!1;var a=(0,c.default)({},v.default,r);return e.title=a.title,e._state=a.state,e.callback=a.callback,e._enabled=a.enabled,e._beta=a.beta,a.submenu&&(e.submenu=a.submenu instanceof p.default?a.submenu:new p.default(a.submenu)),e.mnemonic=a.mnemonic,e}return(0,o.default)(n,[{key:"enabled",get:function(){return!(!this.callback&&!this.hasSubmenu)&&(this._enabled instanceof Function?this._enabled():this._enabled)},set:function(e){this._enabled=e}},{key:"hasSubmenu",get:function(){return!!this.submenu}},{key:"state",get:function(){return this._state instanceof Function?this._state():this._state}},{key:"beta",get:function(){return this._beta}},{key:"submenu",get:function(){return this._submenu},set:function(e){this._submenu=e}}]),n}(h.EventTarget);m.State=y.default;var g=new m;t.Separator=g,g.isSeparator=!0,t.default=m},49762:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244)),d=a(n(68748)),c=a(n(75356));function f(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,d.default)(t,"__esModule",{value:!0});var h=n(31560),p=null,v=function(e){(0,u.default)(n,e);var t=f(n);function n(){var e;return(0,i.default)(this,n),(e=t.call(this)).baseIndex=1001,e._stack=[],e._overlay=document.createElement("div"),e._overlay.style.backgroundColor="black",e._overlay.style.opacity="0",e._overlay.style.zIndex="".concat(e.baseIndex),e._overlay.style.top="0",e._overlay.style.left="0",e._overlay.style.bottom="0",e._overlay.style.right="0",e._overlay.style.width="auto",e._overlay.style.height="auto",e._overlay.style.position="fixed",e._overlay.addEventListener("mousedown",(function(){return e.clear()})),e}return(0,o.default)(n,[{key:"size",get:function(){return this._stack.length}},{key:"push",value:function(e){this._stack.push(e),e.style.zIndex="".concat(this.baseIndex+this._stack.length),1===this._stack.length&&document.body.appendChild(this._overlay),document.body.appendChild(e)}},{key:"pop",value:function(e){var t,n=(0,c.default)(t=this._stack).call(t,e);if(-1!==n){for(var r=this._stack.length;r>n;r--){this._stack[r-1].close(),this._stack.pop()}0===this._stack.length&&this._overlay.remove()}}},{key:"clear",value:function(){for(;this._stack.length;)this.pop(this._stack.last())}}],[{key:"sharedStack",get:function(){return p=p||new n}}]),n}(h.EventTarget);t.default=v},79860:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583)),o=r(n(68748)),u=r(n(35983));(0,o.default)(t,"__esModule",{value:!0});var l=n(33284),s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];(0,a.default)(this,e);var n=function(e){return e instanceof l.default?e:new l.default(e)};this._items=(0,u.default)(t).call(t,n)}return(0,i.default)(e,[{key:"items",get:function(){return this._items},set:function(e){this._items=e}}]),e}();t.default=s},46652:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583)),o=r(n(68748)),u=r(n(75356)),l=r(n(31920)),s=r(n(7273));(0,o.default)(t,"__esModule",{value:!0});var d=n(5008),c=function(){function e(t){(0,a.default)(this,e),this._windows=[],this._topIndex=0,this._container=t}return(0,i.default)(e,[{key:"showWindow",value:function(e){var t;~(0,u.default)(t=this._windows).call(t,e)||(e.manager=this,e.addEventListener(d.AbstractWindow.Event.DidClose,this),this._windows.push(e),this._container.appendChild(e)),this.focus(e)}},{key:"handleEvent",value:function(e){var t,n;console.assert(e.type===d.AbstractWindow.Event.DidClose);var r=e.target;r.manager=null,r.removeEventListener(d.AbstractWindow.Event.DidClose,this);var a=(0,u.default)(t=this._windows).call(t,r);if(console.assert(-1!==a),(0,l.default)(n=this._windows).call(n,a,1),r===this._topMostWindow){var i,o=(0,s.default)(i=this._windows).call(i,(function(e,t){return e&&e.style.zIndex>=t.style.zIndex?e:t}),null);o?this.focus(o):this._topMostWindow=null}}},{key:"focus",value:function(e){e!==this._topMostWindow&&(e.style.zIndex="".concat(this._topIndex++),this._topMostWindow=e)}},{key:"windows",get:function(){return this._windows}},{key:"topMostWindow",get:function(){return this._topMostWindow}}]),e}();t.default=c},14835:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244)),d=a(n(68748)),c=a(n(35983));function f(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,d.default)(t,"__esModule",{value:!0});var h=n(79860),p=n(33284),v=n(43995),y=function(e){(0,u.default)(n,e);var t=f(n);function n(e){var r;return(0,i.default)(this,n),(r=t.call(this)).title="Window",r.mnemonic=0,r.windowManager=e,r}return(0,o.default)(n,[{key:"submenu",get:function(){var e,t=this,n=(0,c.default)(e=this.windowManager.windows).call(e,(function(e){return t._buildWindowItem(e)}));return n.length||(n=[new p.default({title:"No Windows",mnemonic:-1})]),new h.default(n)},set:function(e){}},{key:"_buildWindowItem",value:function(e){var t=this;return new p.default({title:e.title,state:e===this.windowManager.topMostWindow?v.default.On:v.default.Off,callback:function(){return t.windowManager.focus(e)}})}},{key:"hasSubmenu",get:function(){return!0}}]),n}(p.default);t.default=y},34345:(e,t,n)=>{var r=n(92915),a=n(69159),i=n(67986),o=n(13037),u=n(29689),l=n(38468),s=l(n(68748)),d=l(n(36687)),c=l(n(23982)),f=l(n(31920));function h(e,t){var n=void 0!==i&&o(e)||e["@@iterator"];if(!n){if(u(e)||(n=function(e,t){var n;if(!e)return;if("string"==typeof e)return p(e,t);var i=r(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return a(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return p(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var l=0,s=function(){};return{s,n:function(){return l>=e.length?{done:!0}:{done:!1,value:e[l++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var d,c=!0,f=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){f=!0,d=e},f:function(){try{c||null==n.return||n.return()}finally{if(f)throw d}}}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function v(e,t){for(var n=[t];e.has(t);)t=e.get(t),n.unshift(t);return n}(0,s.default)(t,"__esModule",{value:!0}),t.default=function(e,t,n,r,a){var i=new d.default([e]),o=[e],u=new c.default,l=new c.default,s=new c.default;function p(e,t){for(var n=function(e){return s.get(e)},r=n(t),a=0,i=e.length;a<i;){var o=a+i>>>1;n(e[o])<r?a=o+1:i=o}return a}for(l.set(e,0),s.set(e,a(e));o.length;){var y=o.shift();if(i.has(y)){if(y===t)return v(u,y);i.delete(y);var m,g=h(n(y));try{for(g.s();!(m=g.n()).done;){var _=m.value,w=l.get(y)+r(y,_);(!l.has(_)||w<l.get(_))&&(u.set(_,y),l.set(_,w),s.set(_,w+a(_)),i.add(_),(0,f.default)(o).call(o,p(o,_),0,_))}}catch(e){g.e(e)}finally{g.f()}}}return null}},11559:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.default=function(e,t){return e+t}},46158:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(17725);t.default=function(e,t,n){return e>n?r.min(r.max(n,t),e):r.min(r.max(e,t),n)}},21975:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583)),o=r(n(94433)),u=r(n(68748)),l=r(n(47053)),s=r(n(35983)),d=r(n(60388)),c=r(n(59047));(0,u.default)(t,"__esModule",{value:!0}),t.rgb2hsv=t.hsv2rgb=t.rgb2rgba=t.rgb=t.rgba=void 0;var f=n(17725),h=function(e,t,n,r){var a,i,o;return(0,l.default)(a=(0,l.default)(i=(0,l.default)(o="rgba(".concat(e,",")).call(o,t,",")).call(i,n,",")).call(a,r,")")};t.rgba=h;t.rgb=function(e,t,n){var r,a;return(0,l.default)(r=(0,l.default)(a="rgb(".concat(e,",")).call(a,t,",")).call(r,n,")")};var p=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,s.default)(t).call(t,(function(e){return f.round(255*e)}))};t.rgb2rgba=function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(0,l.default)(e=[]).call(e,n,[1])};var v=function(e,t,n){for(e%=360;e<0;)e+=360;var r=(1-t)*n,a=n-r,i=e%60;switch(f.floor(e/60)){case 0:return p(n,a*e/60+r,r);case 1:return p(a*(60-i)/60+r,n,r);case 2:return p(r,n,a*i/60+r);case 3:return p(r,a*(60-i)/60+r,n);case 4:return p(a*i/60+r,r,n);case 5:return p(n,r,a*(60-i)/60+r)}};t.hsv2rgb=v;var y=function(e,t,n){var r,a=(0,s.default)(r=[e,t,n]).call(r,(function(e){return e/255})),i=(0,o.default)(a,3);e=i[0],t=i[1],n=i[2];var u=f.min(e,t,n),l=f.max(e,t,n);return u===l?[0,0,u]:[60*((e===u?3:n===u?1:5)-(e===u?t-n:n===u?e-t:n-e)/(l-u)),(l-u)/l,l]};t.rgb2hsv=y;var m=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i,g=/^rgb\((\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/i,_=/^rgba\((\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+(\.\d+)?)\s*\)$/i,w=/^hsv\((\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/i,k=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if((0,a.default)(this,e),"string"==typeof t){var u=this._parseColor(t),l=(0,o.default)(u,4);t=l[0],n=l[1],r=l[2],i=l[3]}if(t instanceof e){var s=(0,o.default)(t.rgbaComponents,4);t=s[0],n=s[1],r=s[2],i=s[3]}null===t&&(t=0,n=0,r=0,i=1),this._red=t,this._green=n,this._blue=r,this._alpha=i}return(0,i.default)(e,[{key:"_parseColor",value:function(e){e=e.toLowerCase();var t=m.exec(e);if(t)return[(0,d.default)(t[1],16),(0,d.default)(t[2],16),(0,d.default)(t[3],16),1];if(t=g.exec(e))return[(0,d.default)(t[1]),(0,d.default)(t[2]),(0,d.default)(t[3]),1];if(t=_.exec(e))return[(0,d.default)(t[1]),(0,d.default)(t[2]),(0,d.default)(t[3]),(0,c.default)(t[4])];if(t=w.exec(e)){var n=[(0,d.default)(t[1]),(0,d.default)(t[2]),(0,d.default)(t[3])],r=v(n[0],n[1],n[2]),a=(0,o.default)(r,3);return[a[0],a[1],a[2],1]}throw new Error('Unable to read color from "'.concat(e,'".'))}},{key:"rgbComponents",get:function(){return[this._red,this._green,this._blue]}},{key:"rgbaComponents",get:function(){return[this._red,this._green,this._blue,this._alpha]}},{key:"hsvComponents",get:function(){return y(this._red,this._green,this._blue)}},{key:"toString",value:function(){return h(this._red,this._green,this._blue,this._alpha)}}],[{key:"FromHSV",value:function(t,n,r){var a=v(t,n,r),i=(0,o.default)(a,3);return new e(i[0],i[1],i[2])}}]),e}();t.default=k},45188:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.default=function(e){return function(){return e}}},32228:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(17725);t.default=function(e){return e*r.PI/180}},38933:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o=n(76013),u=n(17725),l=function(){function e(){throw(0,a.default)(this,e),"static class"}return(0,i.default)(e,null,[{key:"Normalize",value:function(e){var t=e%360;return t<0&&(t+=360),t}},{key:"Confine",value:function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.Normalize(45*u.round(t/45));if(!n)switch(r){case e.East:return e.East;case e.SouthEast:case e.South:case e.SouthWest:return e.South;case e.West:return e.West;case e.NorthWest:case e.North:case e.NorthEast:return e.North}return r}},{key:"CalculateAngleFromRelativePoint",value:function(e){return e.x<0?180-180*u.atan(e.y/-e.x)/u.PI:180*u.atan(e.y/e.x)/u.PI}},{key:"CalculateRelativeCoordinates",value:function(e,t){var n=e*u.PI/180;return new o.default(t*u.round(u.cos(n)),t*u.round(u.sin(n)))}}]),e}();l.East=0,l.SouthEast=45,l.South=90,l.SouthWest=135,l.West=180,l.NorthWest=225,l.North=270,l.NorthEast=315,t.default=l},84553:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244));function d(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0});var c=n(12199),f=n(93128),h=function(e){(0,u.default)(n,e);var t=d(n);function n(){var e;return(0,i.default)(this,n),(e=t.call(this,0)).endianness=f.default.Endian.Little,e}return(0,o.default)(n,[{key:"buffer",get:function(){return null}},{key:"writeUint8",value:function(e){this._offset+=Uint8Array.BYTES_PER_ELEMENT}},{key:"writeUint16",value:function(e){this._offset+=Uint16Array.BYTES_PER_ELEMENT}},{key:"writeUint32",value:function(e){this._offset+=Uint32Array.BYTES_PER_ELEMENT}},{key:"writeInt8",value:function(e){this._offset+=Uint8Array.BYTES_PER_ELEMENT}},{key:"writeInt16",value:function(e){this._offset+=Uint16Array.BYTES_PER_ELEMENT}},{key:"writeInt32",value:function(e){this._offset+=Uint32Array.BYTES_PER_ELEMENT}},{key:"writeCharacters",value:function(e){for(var t=0,n=e.length;t<n;t++)this.writeUint8(e.charCodeAt(t))}},{key:"writeNullTerminatedString",value:function(e){this.writeCharacters(e),this.writeUint8(0)}},{key:"writeLengthPrefixedString",value:function(e){this.writeUint16(e.length),this.writeCharacters(e)}},{key:"writeLengthPrefixedNullTerminatedString",value:function(e){this.writeUint16(e.length+1),this.writeCharacters(e),this.writeUint8(0)}},{key:"writeUint8Array",value:function(e){for(var t=0,n=e.length;t<n;t++)this.writeUint8(e[t])}},{key:"writeUint16Array",value:function(e){for(var t=0,n=e.length;t<n;t++)this.writeUint16(e[t])}},{key:"writeInt16Array",value:function(e){for(var t=0,n=e.length;t<n;t++)this.writeInt16(e[t])}},{key:"writeUint32Array",value:function(e){for(var t=0,n=e.length;t<n;t++)this.writeUint32(e[t])}}]),n}(c.default);t.default=h},66585:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o=n(27430),u=function(){function e(){(0,a.default)(this,e),this.has=o.has,this.load=o.load,this.store=o.store,this.length=0}return(0,i.default)(e,[{key:"clear",value:function(){}},{key:"getItem",value:function(e){return null}},{key:"key",value:function(e){return null}},{key:"removeItem",value:function(e){}},{key:"setItem",value:function(e,t){}},{key:"prefixedWith",value:function(e){return this}}]),e}();t.default=u},72064:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108)),o=r(n(68748)),u=r(n(79302)),l=r(n(73035));(0,o.default)(t,"__esModule",{value:!0});t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new u.default((function(n,r){(0,l.default)((0,i.default)(a.default.mark((function t(){return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.t0=n,t.next=4,e();case 4:t.t1=t.sent,(0,t.t0)(t.t1),t.next=11;break;case 8:t.prev=8,t.t2=t.catch(0),r(t.t2);case 11:case"end":return t.stop()}}),t,null,[[0,8]])}))),t)}))}},23807:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o=n(97962),u=function(){var e=(0,i.default)(a.default.mark((function e(t,n){var r,i,u,l,s=arguments;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=s.length>2&&void 0!==s[2]?s[2]:"png",t){e.next=3;break}return e.abrupt("return");case 3:return(i=document.createElement("canvas")).width=t.width,i.height=t.height,i.getContext("2d").putImageData(t,0,0),u=i.toDataURL("image/".concat(r)),(l=document.createElement("a")).setAttribute("href",u),l.setAttribute("download",n),l.click(),e.next=14,o.default(0);case 14:return e.abrupt("return",e.sent);case 15:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();t.default=u},87567:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(89292));(0,a.default)(t,"__esModule",{value:!0});var o=n(97962);t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"application/octet-stream";"string"==typeof e&&(e=(new TextEncoder).encode(e));var r=document.createElement("a");return r.setAttribute("href",i.default.createObjectURL(new Blob([e],{type:n}))),r.setAttribute("download",t),r.click(),o.default(0)}},41677:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583)),o=r(n(68748)),u=r(n(31920)),l=r(n(75356)),s=r(n(7401));(0,o.default)(t,"__esModule",{value:!0});var d=function(){function e(){(0,a.default)(this,e),this.listeners={}}return(0,i.default)(e,[{key:"addEventListener",value:function(e,t){var n=this.listeners[e];n||(n=this.listeners[e]=[]),(0,u.default)(n).call(n,0,0,t)}},{key:"removeEventListener",value:function(e,t){if(t){var n,r=this.listeners[e];if(!r)return;var a=(0,l.default)(r).call(r,t);if(-1===a)return;(0,u.default)(n=this.listeners[e]).call(n,a,1)}else delete this.listeners[e]}},{key:"dispatchEvent",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n.target=n.target||this;var r=this,a=new Proxy(t instanceof Event?t:new CustomEvent(t,{detail:n}),{get:function(e,t){if("target"===t)return r;var n=e[t];return n instanceof Function?(0,s.default)(n).call(n,e):n}});this["on"+t]instanceof Function&&this["on"+t](a);var i=this.listeners[t instanceof Event?a.type:t];for(var o in i)if(i.hasOwnProperty(o)){var u=i[o];u instanceof Function?u.call(this,a):u.handleEvent(a)}this!==e.globalInstance&&e.globalInstance.dispatchEvent(t,n)}},{key:"registerEvents",value:function(e){var t=this;e.each((function(n){t["on"+e[n]]=null}))}}],[{key:"addEventListener",value:function(t,n){e.globalInstance.addEventListener(t,n)}},{key:"removeEventListener",value:function(t,n){e.globalInstance.removeEventListener(t,n)}},{key:"dispatchEvent",value:function(t,n){e.globalInstance.dispatchEvent(t,n)}}]),e}();d.globalInstance=new d,t.default=d},94686:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(79406)),o=r(n(62279));function u(e,t){var n=this.__proto__.constructor;return(0,i.default)(Event,[e,t],n)}(0,a.default)(t,"__esModule",{value:!0}),(0,o.default)(u,Event),(0,o.default)(u.prototype,Event.prototype),t.default=u},18941:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244)),d=a(n(68748)),c=a(n(20778)),f=a(n(60388));function h(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,d.default)(t,"__esModule",{value:!0});var p=n(68352),v=p.default.DefaultOptions,y=function(e){(0,u.default)(n,e);var t=h(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,i.default)(this,n),(a=(0,c.default)({},v,a)).expectedSize=null!==(r=n.determineTotalSize(e))&&void 0!==r?r:a.expectedSize,t.call(this,e.body.getReader(),a)}return(0,o.default)(n,null,[{key:"isSupported",value:function(){return"fetch"in window&&p.default.isSupported()}},{key:"determineTotalSize",value:function(e){if(!e.ok)throw Error(e.status+" "+e.statusText);if(!e.body)throw Error("ReadableStream not yet supported in this browser.");var t=e.headers.get("content-encoding"),n=e.headers.get(t?"x-file-size":"content-length");if(null===n)return null;var r=(0,f.default)(n,10);return isNaN(r)?null:r}}]),n}(p.default);y.DefaultOptions=v,t.default=y},73595:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(63789)),o=a(n(76108)),u=a(n(40361)),l=a(n(7583)),s=a(n(80655)),d=a(n(20497)),c=a(n(75244)),f=a(n(68748)),h=a(n(20778)),p=a(n(79302));function v(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,d.default)(this,n)}}(0,f.default)(t,"__esModule",{value:!0}),t.Event=void 0;var y=n(41677),m=n(55056);t.Event={Start:"start",Progress:"progress",Load:"load",Fail:"fail"};var g={expectedSize:1/0},_=function(e){(0,s.default)(a,e);var n,r=v(a);function a(e,t){var n;return(0,u.default)(this,a),(n=r.call(this))._path=e,n._options=(0,h.default)({},g,t),n}return(0,l.default)(a,[{key:"load",value:function(){var e=this,n=new XMLHttpRequest;n.open("GET",this._path,!0),n.responseType="arraybuffer",this._didProgress(0),n.onload=function(t){var n=t.target;return e._didLoad(n)},n.onerror=function(t){return e._didFail(t)},n.onprogress=function(t){return e._didProgress(t.loaded/(0===t.total?e._options.expectedSize:t.total))},n.send(void 0),this.dispatchEvent(t.Event.Start)}},{key:"_didLoad",value:function(e){if(e.status>=300)return this._didFail(new ErrorEvent("error",{error:e.status}));this._didProgress(1);var n=new m.default(e.response);this.dispatchEvent(t.Event.Load,{stream:n,arraybuffer:e.response})}},{key:"_didFail",value:function(e){this.dispatchEvent(t.Event.Fail,{reason:e})}},{key:"_didProgress",value:function(e){this.dispatchEvent(t.Event.Progress,{progress:e})}}],[{key:"loadAsStream",value:(n=(0,o.default)(i.default.mark((function e(n,r){var a,o=this,u=arguments;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=u.length>2&&void 0!==u[2]?u[2]:{},e.abrupt("return",new p.default((function(e,i){var u=new o(n,a);u.onload=function(t){return e(t.detail.stream)},u.onfail=i,r&&u.addEventListener(t.Event.Progress,(function(e){return r(e.detail.progress)})),u.load()})));case 2:case"end":return e.stop()}}),e)}))),function(e,t){return n.apply(this,arguments)})}]),a}(y.default);t.default=_},64230:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(16825)),o=r(n(55903));(0,a.default)(t,"__esModule",{value:!0}),t.greaterThan=t.lessThan=t.equal=t.or=t.and=t.not=void 0;t.not=function(e){return function(){return!e.apply(void 0,arguments)}};t.and=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(0,i.default)(t).call(t,(function(e){return e.apply(void 0,n)}))}};t.or=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(0,o.default)(t).call(t,(function(e){return e.apply(void 0,n)}))}};t.equal=function(e,t){return e===t};t.lessThan=function(e,t){return e<t};t.greaterThan=function(e,t){return e>t}},15250:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244));function c(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0});var f=n(76013),h=function(e){(0,l.default)(n,e);var t=c(n);function n(e,r,a){return(0,i.default)(this,n),t.call(this,e,a,r,a)}return(0,o.default)(n,[{key:"iterate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;(0,u.default)((0,d.default)(n.prototype),"iterate",this).call(this,e,new f.default(t,0))}},{key:"find",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(0,u.default)((0,d.default)(n.prototype),"find",this).call(this,e,new f.default(t,0))}}]),n}(n(93354).default);t.default=h},24413:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.default=function(e){return e}},31560:(e,t,n)=>{var r=n(38468)(n(68748));(0,r.default)(t,"__esModule",{value:!0}),t.srand=t.sleep=t.rgba=t.rgb2rgba=t.rgb2hsv=t.rgb=t.randmod=t.rand=t.rad2deg=t.px=t.polar2xy=t.persistent=t.observable=t.iterate=t.identity=t.hsv2rgb=t.downloadImage=t.download=t.dispatch=t.deg2rad=t.constantly=t.clamp=t.astar=t.add=t.VerticalPointRange=t.Stream=t.Size=t.Scanner=t.Rectangle=t.ReaderStream=t.Range=t.QueryString=t.PropertyChangeEvent=t.PrefixedStorage=t.PointRange=t.Point=t.OutputStream=t.MouseButton=t.Logger=t.LogLevel=t.InputStream=t.HorizontalPointRange=t.FileLoader=t.FetchInputStream=t.EventTarget=t.Event=t.DiscardingStorage=t.DiscardingOutputStream=t.Direction=t.Color=void 0,t.xy2polar=void 0;var a=n(21975);t.Color=a.default,(0,r.default)(t,"hsv2rgb",{enumerable:!0,get:function(){return a.hsv2rgb}}),(0,r.default)(t,"rgb",{enumerable:!0,get:function(){return a.rgb}}),(0,r.default)(t,"rgb2hsv",{enumerable:!0,get:function(){return a.rgb2hsv}}),(0,r.default)(t,"rgb2rgba",{enumerable:!0,get:function(){return a.rgb2rgba}}),(0,r.default)(t,"rgba",{enumerable:!0,get:function(){return a.rgba}});var i=n(54148);(0,r.default)(t,"rand",{enumerable:!0,get:function(){return i.rand}}),(0,r.default)(t,"randmod",{enumerable:!0,get:function(){return i.randmod}}),(0,r.default)(t,"srand",{enumerable:!0,get:function(){return i.srand}});var o=n(38933);t.Direction=o.default;var u=n(84553);t.DiscardingOutputStream=u.default;var l=n(66585);t.DiscardingStorage=l.default;var s=n(94686);t.Event=s.default;var d=n(81302);t.PropertyChangeEvent=d.default;var c=n(41677);t.EventTarget=c.default;var f=n(18941);t.FetchInputStream=f.default;var h=n(73595);t.FileLoader=h.default;var p=n(15250);t.HorizontalPointRange=p.default;var v=n(55056);t.InputStream=v.default;var y=n(70785);t.LogLevel=y.default;var m=n(77213);t.Logger=m.default;var g=n(12199);t.OutputStream=g.default;var _=n(76013);t.Point=_.default;var w=n(93354);t.PointRange=w.default;var k=n(81143);t.PrefixedStorage=k.default;var b=n(3059);t.QueryString=b.default;var S=n(78466);t.Range=S.default;var I=n(68352);t.ReaderStream=I.default;var x=n(55049);t.Rectangle=x.default;var T=n(87023);t.Scanner=T.default;var M=n(35926);t.Size=M.default;var E=n(93128);t.Stream=E.default;var C=n(71651);t.VerticalPointRange=C.default;var A=n(11559);t.add=A.default;var D=n(34345);t.astar=D.default;var z=n(46158);t.clamp=z.default;var P=n(45188);t.constantly=P.default;var R=n(32228);t.deg2rad=R.default;var L=n(72064);t.dispatch=L.default;var F=n(87567);t.download=F.default;var W=n(23807);t.downloadImage=W.default;var B=n(24413);t.identity=B.default;var N=n(9225);t.iterate=N.default;var U=n(97674);t.persistent=U.default;var H=n(30416);t.observable=H.default;var O=n(75387);t.polar2xy=O.default;var Z=n(61441);t.rad2deg=Z.default;var q=n(97962);t.sleep=q.default;var X=n(13305);t.xy2polar=X.default;t.px=function(e){return"".concat(e,"px")}},55056:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244)),d=a(n(68748)),c=a(n(92915));function f(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,d.default)(t,"__esModule",{value:!0});var h=n(37572),p=n(93128),v="utf-8",y=function(e){(0,u.default)(n,e);var t=f(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p.default.Endian.Little;return(0,i.default)(this,n),(r=t.call(this)).endianness=a,r.arrayBuffer=r._makeArrayBuffer(e),r.dataView=new h.DataView(r.arrayBuffer),r}return(0,o.default)(n,[{key:"length",get:function(){return this.arrayBuffer.byteLength}},{key:"isAtEnd",value:function(){return this.offset===this.length}},{key:"_makeArrayBuffer",value:function(e){if("string"==typeof e){for(var t=atob(e),n=t.length,r=new Uint8Array(n),a=0;a<n;a++)r[a]=t.charCodeAt(a);return r.buffer}return e}},{key:"readCharacter",value:function(){return String.fromCharCode(this.readUint8())}},{key:"readUint8",value:function(){var e=this.dataView.getUint8(this._offset);return this._offset+=Uint8Array.BYTES_PER_ELEMENT,e}},{key:"readUint16",value:function(){var e=this.dataView.getUint16(this._offset,this.littleEndian);return this._offset+=Uint16Array.BYTES_PER_ELEMENT,e}},{key:"readUint32",value:function(){var e=this.dataView.getUint32(this._offset,this.littleEndian);return this._offset+=Uint32Array.BYTES_PER_ELEMENT,e}},{key:"readInt8",value:function(){var e=this.dataView.getInt8(this._offset);return this._offset+=Uint8Array.BYTES_PER_ELEMENT,e}},{key:"readInt16",value:function(){var e=this.dataView.getInt16(this._offset,this.littleEndian);return this._offset+=Uint16Array.BYTES_PER_ELEMENT,e}},{key:"readInt32",value:function(){var e=this.dataView.getInt32(this._offset,this.littleEndian);return this._offset+=Uint32Array.BYTES_PER_ELEMENT,e}},{key:"readCharacters",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v;if(0===e)return"";var n=new Uint8Array(this.arrayBuffer,this._offset,e);this._offset+=e;var r=new h.TextDecoder(t);return r.decode(n)}},{key:"readCStringWithLength",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v,n=this.readUint8Array(e),r=0;r<n.length&&0!==n[r];)r++;var a=new h.TextDecoder(t);return a.decode((0,c.default)(n).call(n,0,r))}},{key:"readNullTerminatedString",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v,n=new Uint8Array(this.arrayBuffer,this._offset,e),r=0;n[r];)r++;return this.readCharacters(r,t)}},{key:"readLengthPrefixedString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=this.readUint16();return this.readCharacters(t,e)}},{key:"readUint8Array",value:function(e){var t=new Uint8Array(this.arrayBuffer,this._offset,e);return this._offset+=e,t}},{key:"readUint16Array",value:function(e){var t;if(this._offset%2!=0){var n,r=(0,c.default)(n=this.arrayBuffer).call(n,this._offset,this._offset+2*e);t=new Uint16Array(r)}else t=new Uint16Array(this.arrayBuffer,this._offset,e);return this._offset+=2*e,t}},{key:"readInt16Array",value:function(e){var t;if(this._offset%2!=0){var n,r=(0,c.default)(n=this.arrayBuffer).call(n,this._offset,this._offset+2*e);t=new Int16Array(r)}else t=new Int16Array(this.arrayBuffer,this._offset,e);return this._offset+=2*e,t}},{key:"readUint32Array",value:function(e){var t;if(this._offset%4!=0){var n,r=(0,c.default)(n=this.arrayBuffer).call(n,this._offset,this._offset+4*e);t=new Uint32Array(r)}else t=new Uint32Array(this.arrayBuffer,this._offset,e);return this._offset+=4*e,t}},{key:"readInt32Array",value:function(e){var t;if(this._offset%4!=0){var n,r=(0,c.default)(n=this.arrayBuffer).call(n,this._offset,this._offset+4*e);t=new Int32Array(r)}else t=new Int32Array(this.arrayBuffer,this._offset,e);return this._offset+=4*e,t}},{key:"buffer",get:function(){var e;return(0,c.default)(e=this.arrayBuffer).call(e,0,this.length)}}]),n}(p.default);t.default=y},9225:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(68748)),o=r(n(95753));(0,i.default)(t,"__esModule",{value:!0});var u=a.default.mark((function e(t){var n,r;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=(0,o.default)(t),r=0;case 2:if(!(r<n.length)){e.next=8;break}return e.next=5,[n[r],t[n[r]]];case 5:r++,e.next=2;break;case 8:case"end":return e.stop()}}),e)}));t.default=u},70785:(e,t,n)=>{var r;(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),function(e){e[e.Off=0]="Off",e[e.Debug=1]="Debug",e[e.Info=2]="Info",e[e.Warning=3]="Warning",e[e.Error=4]="Error"}(r||(r={})),t.default=r},77213:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583)),o=r(n(68748)),u=r(n(47053));(0,o.default)(t,"__esModule",{value:!0});var l=n(70785),s=n(24413),d=n(37572),c=function(){function e(){(0,a.default)(this,e),this.level=l.default.Warning,this.prefix=null}return(0,i.default)(e,[{key:"log",value:function(e){var t,n;if(!(e<this.level)){for(var r=this._pickLoggingFacility(e),a=arguments.length,i=new Array(a>1?a-1:0),o=1;o<a;o++)i[o-1]=arguments[o];this.prefix?r.call.apply(r,(0,u.default)(t=[d.console,this.prefix]).call(t,i)):r.call.apply(r,(0,u.default)(n=[d.console]).call(n,i))}}},{key:"off",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this.log.apply(this,(0,u.default)(e=[l.default.Off]).call(e,n))}},{key:"debug",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this.log.apply(this,(0,u.default)(e=[l.default.Debug]).call(e,n))}},{key:"info",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this.log.apply(this,(0,u.default)(e=[l.default.Info]).call(e,n))}},{key:"warn",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this.log.apply(this,(0,u.default)(e=[l.default.Warning]).call(e,n))}},{key:"error",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this.log.apply(this,(0,u.default)(e=[l.default.Error]).call(e,n))}},{key:"_pickLoggingFacility",value:function(e){switch(e){case l.default.Off:return s.default;case l.default.Warning:return d.console.warn;case l.default.Error:return d.console.error;default:return d.console.log}}}]),e}();t.default=c},30416:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(7401));(0,a.default)(t,"__esModule",{value:!0});var o=n(41677),u=n(81302);t.default=function(e){var t=new o.default;return new Proxy(e,{get:function(e,n,r){var a,o,u;return"addEventListener"===n?(0,i.default)(a=t.addEventListener).call(a,t):"removeEventListener"===n?(0,i.default)(o=t.removeEventListener).call(o,t):"dispatchEvent"===n?(0,i.default)(u=t.dispatchEvent).call(u,t):e[n]},set:function(e,n,r,a){return e[n]=r,t.dispatchEvent(new u.default(n,r,e)),!0}})}},12199:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244)),d=a(n(68748)),c=a(n(92915));function f(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,d.default)(t,"__esModule",{value:!0});var h=n(93128),p=function(e){(0,u.default)(n,e);var t=f(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h.default.Endian.Little;return(0,i.default)(this,n),(r=t.call(this)).endianness=a,r._arrayBuffer=new ArrayBuffer(e),r._dataView=new DataView(r._arrayBuffer),r}return(0,o.default)(n,[{key:"buffer",get:function(){var e;return(0,c.default)(e=this._arrayBuffer).call(e,0,this._offset)}},{key:"writeUint8",value:function(e){this._dataView.setUint8(this._offset,e),this._offset+=Uint8Array.BYTES_PER_ELEMENT}},{key:"writeUint16",value:function(e){this._dataView.setUint16(this._offset,e,this.endianness===h.default.Endian.Little),this._offset+=Uint16Array.BYTES_PER_ELEMENT}},{key:"writeUint32",value:function(e){this._dataView.setUint32(this._offset,e,this.endianness===h.default.Endian.Little),this._offset+=Uint32Array.BYTES_PER_ELEMENT}},{key:"writeInt8",value:function(e){this._dataView.setInt8(this._offset,e),this._offset+=Uint8Array.BYTES_PER_ELEMENT}},{key:"writeInt16",value:function(e){this._dataView.setInt16(this._offset,e,this.endianness===h.default.Endian.Little),this._offset+=Uint16Array.BYTES_PER_ELEMENT}},{key:"writeInt32",value:function(e){this._dataView.setInt32(this._offset,e,this.endianness===h.default.Endian.Little),this._offset+=Uint32Array.BYTES_PER_ELEMENT}},{key:"writeCharacters",value:function(e){for(var t=0,n=e.length;t<n;t++)this.writeUint8(e.charCodeAt(t))}},{key:"writeNullTerminatedString",value:function(e){this.writeCharacters(e),this.writeUint8(0)}},{key:"writeLengthPrefixedString",value:function(e){this.writeUint16(e.length),this.writeCharacters(e)}},{key:"writeLengthPrefixedNullTerminatedString",value:function(e){this.writeUint16(e.length+1),this.writeCharacters(e),this.writeUint8(0)}},{key:"writeUint8Array",value:function(e){for(var t=0,n=e.length;t<n;t++)this.writeUint8(e[t])}},{key:"writeInt8Array",value:function(e){for(var t=0,n=e.length;t<n;t++)this.writeInt8(e[t])}},{key:"writeUint16Array",value:function(e){for(var t=0,n=e.length;t<n;t++)this.writeUint16(e[t])}},{key:"writeInt16Array",value:function(e){for(var t=0,n=e.length;t<n;t++)this.writeInt16(e[t])}},{key:"writeUint32Array",value:function(e){for(var t=0,n=e.length;t<n;t++)this.writeUint32(e[t])}},{key:"writeInt32Array",value:function(e){for(var t=0,n=e.length;t<n;t++)this.writeInt32(e[t])}}]),n}(h.default);t.default=p},97674:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(47053));(0,a.default)(t,"__esModule",{value:!0});var o=n(28061);t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.localStorage,r=function(e){var n;return t?(0,i.default)(n="".concat(t,".")).call(n,e):e};return new Proxy(e,{get:function(e,t,a){console.assert("string"==typeof t);var i=t;return n.has(r(i))?n.load(r(i)):e[i]},set:function(e,t,a,i){console.assert("string"==typeof t);var o=t;return n.store(r(o),a),e[o]=a,!0}})}},93354:(e,t,n)=>{var r=n(38468),a=r(n(88225)),i=r(n(40361)),o=r(n(7583));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var u=n(76013),l=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;(0,i.default)(this,e),"object"!==(0,a.default)(t)&&(t=new u.default(t,n),n=new u.default(r,o)),this.from=t,this.to=n}return(0,o.default)(e,[{key:"iterate",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new u.default(1,1),n=new u.default(this.from),r={stop:!1,step:t},a=t.x>=0?function(e,t){return e.x<=t.x}:function(e,t){return t.x<=e.x},i=t.y>=0?function(e,t){return e.y<=t.y}:function(e,t){return t.y<=e.y};a(n,this.to)&&i(n,this.to);){if(e(n,r),r.stop)return;n.add(t)}}},{key:"find",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new u.default(1,1),n=new u.default(this.from),r=t.x>=0?function(e,t){return e.x<=t.x}:function(e,t){return t.x<=e.x},a=t.y>=0?function(e,t){return e.y<=t.y}:function(e,t){return t.y<=e.y};r(n,this.to)&&a(n,this.to);){if(e(n))return n;n.add(t)}return null}}]),e}();t.default=l},76013:(e,t,n)=>{var r=n(38468),a=r(n(88225)),i=r(n(40361)),o=r(n(7583)),u=r(n(68748)),l=r(n(47053));(0,u.default)(t,"__esModule",{value:!0});var s=n(17725),d=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;(0,i.default)(this,e),"object"===(0,a.default)(t)&&(n=t.y,r=t.z,t=t.x),this.x=t,this.y=n,this.z=r}return(0,o.default)(e,[{key:"clone",value:function(){return new e(this.x,this.y,this.z)}},{key:"add",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return"object"===(0,a.default)(e)&&(t=e.y,e=e.x),this.x+=e,this.y+=t,this}},{key:"comparedTo",value:function(t){var n=0,r=0;return this.x!==t.x&&(n=this.x<t.x?-1:1),this.y!==t.y&&(r=this.y<t.y?-1:1),new e(n,r)}},{key:"byAdding",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new e(this).add(t,n)}},{key:"subtract",value:function(e,t){return"object"===(0,a.default)(e)&&(t=e.y,e=e.x),this.x-=e,this.y-=t,this}},{key:"bySubtracting",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new e(this).subtract(t,n)}},{key:"scaleBy",value:function(e){return this.x*=e,this.y*=e,this}},{key:"dividedBy",value:function(t){return new e(this.x/t.width,this.y/t.height,this.z)}},{key:"byScalingBy",value:function(t){return new e(this).scaleBy(t)}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}},{key:"byFlooring",value:function(){return new e(this).floor()}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}},{key:"byCeiling",value:function(){return new e(this).ceil()}},{key:"abs",value:function(){return this.x=s.abs(this.x),this.y=s.abs(this.y),this}},{key:"byAbsing",value:function(){return new e(this).abs()}},{key:"isEqualTo",value:function(e){return!(!e||this.x!==e.x||this.y!==e.y||null!==this.z&&void 0!==this.z&&null!==e.z&&void 0!==e.z&&this.z!==e.z)}},{key:"isUnidirectional",value:function(){return 0===this.x||0===this.y}},{key:"isInBounds",value:function(e){return this.x>=0&&this.y>=0&&this.x<e.width&&this.y<e.height}},{key:"isZeroPoint",value:function(){return 0===this.x&&0===this.y}},{key:"distanceTo",value:function(e){var t=this.x-e.x,n=this.y-e.y;return Math.sqrt(Math.pow(t,2)+Math.pow(n,2))}},{key:"manhattanDistanceTo",value:function(e){return s.abs(this.x-e.x)+s.abs(this.y-e.y)}},{key:"toString",value:function(){var e;return(0,l.default)(e="Point {".concat(this.x,"x")).call(e,this.y,"}")}}],[{key:"add",value:function(t,n){return new e(t.x+n.x,t.y+n.y,t.z)}},{key:"subtract",value:function(t,n){return new e(t.x-n.x,t.y-n.y,t.z)}}]),e}();t.default=d},75387:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});t.default=function(e,t){return[e*Math.cos(t),-e*Math.sin(t)]}},81143:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583)),o=r(n(68748)),u=r(n(47053));(0,o.default)(t,"__esModule",{value:!0});var l=n(27430),s=function(){function e(t,n){(0,a.default)(this,e),this.has=l.has,this.load=l.load,this.store=l.store,this.length=0,this._storage=t,this._prefix=n}return(0,i.default)(e,[{key:"prefixedWith",value:function(t){return new e(this._storage,this._buildKey(t))}},{key:"clear",value:function(){}},{key:"getItem",value:function(e){return this._storage.getItem(this._buildKey(e))}},{key:"key",value:function(e){return null}},{key:"removeItem",value:function(e){this._storage.removeItem(this._buildKey(e))}},{key:"setItem",value:function(e,t){this._storage.setItem(this._buildKey(e),t)}},{key:"_buildKey",value:function(e){var t;return(0,u.default)(t="".concat(this.prefix,".")).call(t,e)}},{key:"prefix",get:function(){return this._prefix}}]),e}();t.default=s},81302:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(80655)),u=a(n(20497)),l=a(n(75244)),s=a(n(46386));function d(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0});var c=function(e){(0,o.default)(n,e);var t=d(n);function n(e,r,a){return(0,i.default)(this,n),t.call(this,n.type,{detail:{property:e,value:r,target:a}})}return n}((0,s.default)(CustomEvent));c.type="propertyChanged",t.default=c},3059:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583)),o=r(n(68748)),u=r(n(95753));(0,o.default)(t,"__esModule",{value:!0});var l=function(){function e(){(0,a.default)(this,e)}return(0,i.default)(e,null,[{key:"Compose",value:function(e){for(var t="",n=0,r=(0,u.default)(e);n<r.length;n++){var a=r[n];t&&(t+="&"),t+=encodeURIComponent(a),t+="=",t+=encodeURIComponent(e[a])}return t}}]),e}();t.default=l},61441:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var r=n(17725);t.default=function(e){return 180*e/r.PI}},54148:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(63918));(0,a.default)(t,"__esModule",{value:!0}),t.randmod=t.rand=t.srand=void 0;var o=n(37572);o.global.lastRandom=0;t.srand=function(e){o.global.lastRandom=e};t.rand=function(){return o.global.lastRandom=(0,i.default)(o.global.lastRandom,214013)+2531011&4294967295,o.global.lastRandom>>16&32767};t.randmod=function(e){return t.rand()%e}},78466:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o=n(54148),u=function(){function e(t,n){(0,a.default)(this,e),this.min=t,this.max=n}return(0,i.default)(e,[{key:"randomElement",value:function(){return this.min+o.rand()%(this.max-this.min+1)}}]),e}();t.default=u},68352:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(63789)),o=a(n(76108)),u=a(n(40361)),l=a(n(7583)),s=a(n(80655)),d=a(n(20497)),c=a(n(75244)),f=a(n(68748)),h=a(n(20778));function p(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,d.default)(this,n)}}(0,f.default)(t,"__esModule",{value:!0});var v=n(17725),y=n(55056),m={expectedSize:1e6,reallocStrategy:function(e,t){return v.max(2*t,e+t)}},g=function(e){(0,s.default)(r,e);var t,n=p(r);function r(e){var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,u.default)(this,r);var i=(0,h.default)({},m,a);return(t=n.call(this,new ArrayBuffer(i.expectedSize))).loaded=0,t.total=i.expectedSize,t._error=null,t.onload=null,t.onprogress=null,t.onerror=null,t._bufferView=new Uint8Array(t.arrayBuffer),t._options=i,t._reader=e,t.read(),t}return(0,l.default)(r,[{key:"read",value:(t=(0,o.default)(i.default.mark((function e(){var t,n,r;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._reader.read();case 3:if(t=e.sent,n=t.done,r=t.value,!n){e.next=11;break}return this._reader=null,this.total=this.loaded,this.onload&&this.onload(),e.abrupt("return");case 11:this.append(r),this.onprogress&&this.onprogress(),this.read(),e.next=21;break;case 16:e.prev=16,e.t0=e.catch(0),this._reader=null,this._error=e.t0,this.onerror&&this.onerror();case 21:case"end":return e.stop()}}),e,this,[[0,16]])}))),function(){return t.apply(this,arguments)})},{key:"append",value:function(e){var t=this.arrayBuffer.byteLength-(this.loaded+e.byteLength);t<0&&this.realloc(-t),this._bufferView.set(e,this.loaded),this.loaded+=e.byteLength,this.total=v.max(this.total,this.loaded)}},{key:"realloc",value:function(e){var t=this._options.reallocStrategy(e,this.arrayBuffer.byteLength),n=new ArrayBuffer(t),r=new Uint8Array(n);r.set(this._bufferView,0),this.arrayBuffer=n,this._bufferView=r,this.dataView=new DataView(this.arrayBuffer)}},{key:"cancel",value:function(){this._reader.cancel()}},{key:"length",get:function(){return this.loaded}},{key:"bytesAvailable",get:function(){return this.loaded}},{key:"bytesTotal",get:function(){return this.total}},{key:"done",get:function(){return null===this._reader}},{key:"error",get:function(){return this._error}}],[{key:"isSupported",value:function(){return"ReadableStream"in window}}]),r}(y.default);g.DefaultOptions=m,t.default=g},55049:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583));(0,r(n(68748)).default)(t,"__esModule",{value:!0});var o=n(35926),u=function(){function e(t,n){(0,a.default)(this,e),this.origin=t,this.size=n}return(0,i.default)(e,[{key:"minX",get:function(){return this.origin.x}},{key:"maxX",get:function(){return this.origin.x+this.size.width}},{key:"minY",get:function(){return this.origin.y}},{key:"maxY",get:function(){return this.origin.y+this.size.height}},{key:"area",get:function(){return this.size.area}},{key:"inset",value:function(t,n){return new e(this.origin.byAdding(t,n),new o.default(this.size.width-2*t,this.size.height-2*n))}},{key:"contains",value:function(e){return this.minX<=e.x&&e.x<this.maxX&&this.minY<=e.y&&e.y<this.maxY}}]),e}();t.default=u},87023:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583)),o=r(n(68748)),u=r(n(92915));(0,o.default)(t,"__esModule",{value:!0});var l=function(){function e(t){(0,a.default)(this,e),this._string=t,this._offset=0}return(0,i.default)(e,[{key:"peek",value:function(){return this._string.charAt(this._offset)}},{key:"poke",value:function(){var e=this._string.charAt(this._offset);return this._offset++,e}},{key:"skipWhitespace",value:function(){for(;this.isAtWhitespace();)this.poke()}},{key:"isAtWhitespace",value:function(){var e=this.peek();return" "===e||("\t"===e||("\n"===e||"\r"===e))}},{key:"isAtEnd",value:function(){return this._offset===this._string.length}},{key:"offset",get:function(){return this._offset}},{key:"rest",get:function(){var e;return(0,u.default)(e=this._string).call(e,this._offset)}}]),e}();t.default=l},35926:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583)),o=r(n(68748)),u=r(n(47053));(0,o.default)(t,"__esModule",{value:!0});var l=function(){function e(t,n){(0,a.default)(this,e),this.width=t,this.height=n}return(0,i.default)(e,[{key:"area",get:function(){return this.width*this.height}},{key:"scaleBy",value:function(t){return new e(this.width*t,this.height*t)}},{key:"toString",value:function(){var e;return(0,u.default)(e="Size {".concat(this.width,"x")).call(e,this.height,"}")}}]),e}();t.default=l},97962:(e,t,n)=>{var r=n(38468),a=r(n(68748)),i=r(n(79302));(0,a.default)(t,"__esModule",{value:!0});var o=n(37572);t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return new i.default((function(t){return o.setTimeout(t,e)}))}},93128:(e,t,n)=>{var r=n(38468),a=r(n(40361)),i=r(n(7583));(0,r(n(68748)).default)(t,"__esModule",{value:!0}),t.Endian=t.Seek=void 0,t.Seek={Set:0,Cur:1},t.Endian={Little:0,Big:1};var o=function(){function e(){(0,a.default)(this,e),this.endianness=e.Endian.Big,this._offset=0}return(0,i.default)(e,[{key:"littleEndian",get:function(){return this.endianness===e.Endian.Little}},{key:"offset",get:function(){return this._offset}},{key:"seek",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.Seek.Cur;switch(n){case e.Seek.Set:this._offset=t;break;case e.Seek.Cur:this._offset+=t}}}]),e}();o.Seek=t.Seek,o.Endian=t.Endian,t.default=o},71651:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244));function c(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0});var f=n(76013),h=function(e){(0,l.default)(n,e);var t=c(n);function n(e,r,a){return(0,i.default)(this,n),t.call(this,a,e,a,r)}return(0,o.default)(n,[{key:"iterate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;(0,u.default)((0,d.default)(n.prototype),"iterate",this).call(this,e,new f.default(0,t))}},{key:"find",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(0,u.default)((0,d.default)(n.prototype),"find",this).call(this,e,new f.default(0,t))}}]),n}(n(93354).default);t.default=h},13305:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});t.default=function(e,t){return[Math.sqrt(e*e+t*t),Math.atan2(-t,e)]}},60207:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244)),d=a(n(68748)),c=a(n(92915));function f(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,d.default)(t,"__esModule",{value:!0}),t.Event=void 0;var h=n(17725),p=n(31560);t.Event={DidConfirm:"DidConfirm",DidCancel:"DidCancel",DidEnd:"DidEnd"};var v=function(e){(0,u.default)(r,e);var n=f(r);function r(e){var t;return(0,i.default)(this,r),(t=n.call(this)).maxLength=0,t._prepareNode(e),t._setFocus(),t}return(0,o.default)(r,[{key:"_prepareNode",value:function(e){var t=this;this._originalContent=e.innerHTML,this._originalOnBlur=e.onblur,this._originalOnKeyDown=e.onkeydown,this._originalOnKeyUp=e.onkeyup,this._originalOnPaste=e.onpaste,e.setAttribute("contenteditable","true"),e.onblur=function(e){return t.confirm(e)},e.onkeydown=function(e){return t._onKeyDown(e)},e.onpaste=function(e){e.preventDefault();var t=e.clipboardData.getData("text/plain");document.execCommand("insertHTML",!1,t)},e.style.textOverflow="clip",e.focus(),this._node=e}},{key:"_restoreNode",value:function(){this._node.removeAttribute("contenteditable"),this._node.onblur=this._originalOnBlur,this._node.onpaste=this._originalOnPaste,this._node.onkeydown=this._originalOnKeyDown,this._node.onkeyup=this._originalOnKeyUp,this._node.style.textOverflow="",this._node.blur()}},{key:"_restoreNodeContents",value:function(){this._node.innerHTML=this._originalContent}},{key:"_setFocus",value:function(){var e=this._node,t=document.getSelection();t.removeAllRanges();var n=document.createRange();n.selectNodeContents(e),t.addRange(n)}},{key:"_onKeyDown",value:function(e){"Enter"===e.code?this.confirm(e):"Escape"===e.code&&this.cancel(e)}},{key:"confirm",value:function(e){e&&e.preventDefault(),this.enforceMaxLength(),this.dispatchEvent(new CustomEvent(t.Event.DidConfirm)),this.onconfirm instanceof Function&&this.onconfirm(),this._restoreNode(),this.dispatchEvent(new CustomEvent(t.Event.DidEnd)),this.onend instanceof Function&&this.onend()}},{key:"cancel",value:function(e){e&&e.preventDefault(),this.dispatchEvent(new CustomEvent(t.Event.DidCancel)),this.oncancel instanceof Function&&this.oncancel(),this._restoreNode(),this._restoreNodeContents(),this.dispatchEvent(new CustomEvent(t.Event.DidEnd)),this.onend instanceof Function&&this.onend()}},{key:"abort",value:function(){this._restoreNode(),this._restoreNodeContents()}},{key:"enforceMaxLength",value:function(){var e;0!==this.maxLength&&(this._node.textContent=(0,c.default)(e=this._node.textContent).call(e,0,h.min(this._node.textContent.length,this.maxLength)))}}]),r}(p.EventTarget);t.default=v},50204:(e,t,n)=>{var r=n(92915),a=n(69159),i=n(67986),o=n(13037),u=n(29689),l=n(38468),s=l(n(40361)),d=l(n(7583)),c=l(n(68748)),f=l(n(69159));function h(e,t){var n=void 0!==i&&o(e)||e["@@iterator"];if(!n){if(u(e)||(n=function(e,t){var n;if(!e)return;if("string"==typeof e)return p(e,t);var i=r(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return a(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return p(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var l=0,s=function(){};return{s,n:function(){return l>=e.length?{done:!0}:{done:!1,value:e[l++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var d,c=!0,f=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){f=!0,d=e},f:function(){try{c||null==n.return||n.return()}finally{if(f)throw d}}}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}(0,c.default)(t,"__esModule",{value:!0});var v=n(28061),y=function(){function e(t){(0,s.default)(this,e),this._handlers={},this.preview=WebFun.JSX.render("div",{style:{visibility:"hidden",top:"0px",left:"0px",bottom:"0px",right:"0px",position:"fixed",border:"1px solid yellow",zIndex:"100000"}}),this._root=t,this._root.appendChild(this.preview),window.addEventListener("dragenter",this),window.addEventListener("dragleave",this),window.addEventListener("dragover",this),window.addEventListener("drop",this)}return(0,d.default)(e,[{key:"addHandler",value:function(e,t){this._handlers[e.toLowerCase()]=t}},{key:"handleEvent",value:function(e){if("dragenter"===e.type&&(this.preview.style.visibility="visible"),e.target===this.preview){if("dragleave"===e.type&&(this.preview.style.visibility="hidden"),"drop"===e.type){var t,n=!1,r=h((0,f.default)(e.dataTransfer.files));try{for(r.s();!(t=r.n()).done;){var a=t.value,i=a.name.split(".").last().toLowerCase(),o=this._handlers[i];o&&(n=!0,o(a))}}catch(e){r.e(e)}finally{r.f()}if(this.preview.style.visibility="hidden",!n)return}e.dataTransfer.dropEffect="copy",e.preventDefault(),e.stopPropagation()}}},{key:"removeHandler",value:function(e){delete this._handlers[e]}},{key:"uninstall",value:function(){this.preview.style.visibility="hidden",window.removeEventListener("dragenter",this),window.removeEventListener("dragleave",this),window.removeEventListener("dragover",this),window.removeEventListener("drop",this),this._root=null}}],[{key:"defaultHandler",get:function(){return this._defaultHandler=this._defaultHandler||new e(v.document.body)}}]),e}();t.default=y},48387:(e,t,n)=>{var r=n(38468)(n(68748));(0,r.default)(t,"__esModule",{value:!0}),t.WindowModalSession=t.UndoOperation=t.UndoManager=t.UndoBatchOperation=t.ShortcutManager=t.PopoverModalSession=t.ModalSession=t.ModalPrompt=t.ModalConfirm=t.GlobalFileDrop=t.FieldEditor=t.ConfirmationResult=void 0;var a=n(60207);t.FieldEditor=a.default;var i=n(50204);t.GlobalFileDrop=i.default;var o=n(44947);t.ModalConfirm=o.default,(0,r.default)(t,"ConfirmationResult",{enumerable:!0,get:function(){return o.Result}});var u=n(67012);t.ModalPrompt=u.default;var l=n(64370);t.ModalSession=l.default;var s=n(79907);t.PopoverModalSession=s.default;var d=n(15436);t.ShortcutManager=d.default;var c=n(59317);t.UndoBatchOperation=c.default;var f=n(44443);t.UndoManager=f.default;var h=n(45389);t.UndoOperation=h.default;var p=n(4345);t.WindowModalSession=p.default},64370:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108)),o=r(n(40361)),u=r(n(7583)),l=r(n(68748)),s=r(n(42601)),d=r(n(79302));(0,l.default)(t,"__esModule",{value:!0}),n(37389);var c=n(31560),f=n(28061),h=function(){function e(){(0,o.default)(this,e),this._overlayContainer=window.document.body,this._eventNode=window;var t=f.document.createElement("div");t.classList.add("modal-session"),this._overlay=t}var t;return(0,u.default)(e,[{key:"lastMouseLocation",get:function(){return this._lastMouseLocation}},{key:"style",get:function(){return this._overlay.style}},{key:"cursor",set:function(e){var t=this,n=e?"url("+e+") 16 16, auto":"";c.dispatch((function(){return t._overlay&&(t._overlay.style.cursor=n)}))}},{key:"onclick",set:function(e){this._overlay.onclick=e}},{key:"onmousemove",set:function(e){this._overlay.onmousemove=e}},{key:"onmousedown",set:function(e){this._overlay.onmousedown=e}},{key:"onmouseup",set:function(e){this._overlay.onmouseup=e}},{key:"onend",get:function(){return this._endHandler},set:function(e){this._endHandler=e}},{key:"run",value:function(){this._overlay.classList.add("global"),this.setupEvents()}},{key:"runForWindow",value:function(e){this._overlayContainer=e,this._eventNode=e;var t=e.getBoundingClientRect(),n=t.width,r=t.height;this._overlay.style.width="".concat(n,"px"),this._overlay.style.height="".concat(r,"px"),this._overlay.classList.add("attached"),this.setupEvents()}},{key:"setupEvents",value:function(){var e,t=this;this._overlayContainer.appendChild(this._overlay),this._locationHandler=function(e){return t._lastMouseLocation=new c.Point(e.clientX,e.clientY)},(0,s.default)(e=["mouseup","mousedown","mousemove"]).call(e,(function(e){return t._eventNode.addEventListener(e,t._locationHandler)}))}},{key:"end",value:(t=(0,i.default)(a.default.mark((function e(t){var n,r=this;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,s.default)(n=["mouseup","mousedown","mousemove"]).call(n,(function(e){return r._eventNode.removeEventListener(e,r._locationHandler)})),this.cursor=null,e.next=4,c.dispatch((function(){return r._overlay&&r._overlay.remove()}),10);case 4:return e.abrupt("return",new d.default((function(e){return r._whenOverlayIsGone((function(){r._overlay=null,r.onend&&r.onend(t),e()}))})));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"_whenOverlayIsGone",value:function(e){var t=this;f.document.elementFromPoint(0,0)!==this._overlay?e():c.dispatch((function(){return t._whenOverlayIsGone(e)}),1)}}]),e}();t.default=h},44947:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108)),o=r(n(68748)),u=r(n(79302));(0,o.default)(t,"__esModule",{value:!0}),t.Result=void 0;var l,s=n(5008),d=n(4345),c=n(31560);!function(e){e[e.Aborted=0]="Aborted",e[e.Confirmed=1]="Confirmed",e[e.Other=2]="Other"}(l=t.Result||(t.Result={}));var f=function(e){return{component:e.component||s.ConfirmationWindow.tagName,confirmText:e.confirmText||"Yes",abortText:e.abortText||"No"}};t.default=function(){var e=(0,i.default)(a.default.mark((function e(t){var n,r,i,o=arguments;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:{},n=f(n),(r=document.createElement(n.component)).setAttribute("confirm-text",n.confirmText),r.setAttribute("abort-text",n.abortText),r.customContent=t,i=new d.default(r),r.onconfirm=function(){return i.end(l.Confirmed)},r.onabort=function(){return i.end(l.Aborted)},e.abrupt("return",new u.default((function(e){i.onend=function(t){return c.dispatch((function(){return e(t)}))},i.run()})));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},67012:(e,t,n)=>{var r=n(38468),a=r(n(63789)),i=r(n(76108)),o=r(n(68748)),u=r(n(79302));(0,o.default)(t,"__esModule",{value:!0});var l=n(5008),s=n(4345),d=n(31560),c=function(e){return{component:e.component||l.ConfirmationWindow.tagName,confirmText:e.confirmText||"OK",abortText:e.abortText||"No",defaultValue:e.defaultValue||"",options:e.options||null}};t.default=function(){var e=(0,i.default)(a.default.mark((function e(t){var n,r,i,o,f=arguments;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=f.length>1&&void 0!==f[1]?f[1]:{},n=c(n),r=WebFun.JSX.render(l.ConfirmationWindow,{confirmText:n.confirmText,abortText:n.abortText,customContent:WebFun.JSX.render("div",null,t,WebFun.JSX.render("br",null),n.options?WebFun.JSX.render(l.Selector,{value:n.defaultValue,options:n.options}):WebFun.JSX.render(l.Textbox,{value:n.defaultValue}))}),i=r.customContent.querySelector([l.Textbox.tagName,l.Selector.tagName,"input"].join(",")),o=new s.default(r),r.onconfirm=function(){return o.end(1)},r.onabort=function(){return o.end(0)},d.dispatch((function(){"focus"in i&&i.focus(),"select"in i&&i.select()})),e.abrupt("return",new u.default((function(e){o.onend=function(t){return d.dispatch((function(){return e(0===t?null:i.value)}))},o.run()})));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},79907:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244));function c(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0});var f=n(64370),h=n(31560),p=function(e){(0,l.default)(n,e);var t=c(n);function n(e){var r;return(0,i.default)(this,n),(r=t.call(this))._popover=e,r}return(0,o.default)(n,[{key:"run",value:function(){return this._overlay.appendChild(this._popover),(0,u.default)((0,d.default)(n.prototype),"run",this).call(this)}},{key:"_whenOverlayIsGone",value:function(e){var t=this;document.elementFromPoint(0,0)!==this._overlay?(this._popover.remove(),e()):h.dispatch((function(){return t._whenOverlayIsGone(e)}),1)}}]),n}(f.default);t.default=p},15436:(e,t,n)=>{var r=n(38468),a=r(n(94433)),i=r(n(40361)),o=r(n(7583)),u=r(n(68748)),l=r(n(75356)),s=r(n(67093));(0,u.default)(t,"__esModule",{value:!0});var d=n(64230),c=n(24413),f=function(){function e(){(0,i.default)(this,e),this._plainKeyShortcutCount=0,this._shortcuts=[],window.addEventListener("keydown",this,!0),window.addEventListener("focus",this,!0),window.addEventListener("mousedown",this,!0)}return(0,o.default)(e,[{key:"registerShortcut",value:function(e,t){var n,r=(0,l.default)(n=this._shortcuts).call(n,null);return-1===r&&(r=this._shortcuts.length,this._shortcuts.push(null)),t.metaKey||t.ctrlKey||this._plainKeyShortcutCount++,this._shortcuts[r]=[t,e],r}},{key:"unregisterShortcut",value:function(e){var t=this._shortcuts[e];t&&(t[0].metaKey||t[0].ctrlKey||this._plainKeyShortcutCount--,this._shortcuts[e]=null)}},{key:"handleEvent",value:function(e){var t,n=this;if(e instanceof MouseEvent||e instanceof FocusEvent)this._node=e.target instanceof Node?e.target:null;else{var r=e.key,i=e.keyCode,o=e.metaKey,u=e.ctrlKey;if(u||o||0!==this._plainKeyShortcutCount){var l=(0,s.default)(t=this._shortcuts).call(t,d.and(c.default,(function(e){var t=(0,a.default)(e,1)[0].key;return void 0===t||t===r}),(function(e){var t=(0,a.default)(e,1)[0].keyCode;return void 0===t||t===i}),(function(e){var t=(0,a.default)(e,1)[0].ctrlKey;return void 0===t||t===u}),(function(e){var t=(0,a.default)(e,1)[0].metaKey;return void 0===t||t===o}),(function(e){var t=(0,a.default)(e,1)[0].node;return!t||n._node&&t.contains(n._node)})))||[null,null],f=(0,a.default)(l,2)[1];f instanceof Function&&(f(),e.preventDefault(),e.stopImmediatePropagation())}}}}],[{key:"sharedManager",get:function(){return this._sharedManager=this._sharedManager||new e}}]),e}();t.default=f},59317:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244)),d=a(n(68748)),c=a(n(42601)),f=a(n(58831)),h=a(n(92915));function p(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,d.default)(t,"__esModule",{value:!0});var v=function(e){(0,u.default)(n,e);var t=p(n);function n(e){var r;(0,i.default)(this,n);return(r=t.call(this,(function(){var e,t,n;return(0,c.default)(e=(0,f.default)(t=(0,h.default)(n=r._operations).call(n)).call(t)).call(e,(function(e){return e.undo()}))}),(function(){var e;return(0,c.default)(e=r._operations).call(e,(function(e){return e.redo()}))})))._operations=e,r}return(0,o.default)(n,[{key:"add",value:function(e){this._operations.push(e)}}]),n}(n(45389).default);t.default=v},44443:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244)),d=a(n(68748)),c=a(n(31920));function f(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,d.default)(t,"__esModule",{value:!0});var h=n(31560),p=n(59317),v=n(45389),y=function(e){(0,u.default)(n,e);var t=f(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments))._stack=[],e._stackPointer=-1,e._batchStack=[],e}return(0,o.default)(n,[{key:"undo",value:function(){this.canUndo()&&this._stack[this._stackPointer--].undo()}},{key:"redo",value:function(){this.canRedo()&&this._stack[++this._stackPointer].redo()}},{key:"note",value:function(e,t){e instanceof v.default||(e=new v.default(e,t));var n,r=this._batchStack.last();r?r.add(e):((0,c.default)(n=this._stack).call(n,this._stackPointer+1,this._stack.length),this._stack.push(e),this._stackPointer++)}},{key:"beginBatch",value:function(){this._batchStack.push(new p.default([]))}},{key:"cancelBatch",value:function(){var e=this._batchStack.pop();console.assert(!!e,"No batch operation in progress!")}},{key:"endBatch",value:function(){var e=this._batchStack.pop();console.assert(!!e,"No batch operation in progress!"),this._stack.push(e),this._stackPointer++}},{key:"canUndo",value:function(){return-1!==this._stackPointer}},{key:"canRedo",value:function(){return this._stackPointer+1!==this._stack.length}}]),n}(h.EventTarget);t.default=y},45389:(e,t,n)=>{var r=n(38468),a=r(n(40361));(0,r(n(68748)).default)(t,"__esModule",{value:!0});t.default=function e(t,n){(0,a.default)(this,e),this.undo=t,this.redo=n}},4345:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244));function c(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0});var f=n(64370),h=n(31560),p=function(e){(0,l.default)(n,e);var t=c(n);function n(e){var r;return(0,i.default)(this,n),(r=t.call(this))._window=e,r}return(0,o.default)(n,[{key:"run",value:function(){this._overlay.appendChild(this._window),(0,u.default)((0,d.default)(n.prototype),"run",this).call(this),this._window.center()}},{key:"runForWindow",value:function(e){(0,u.default)((0,d.default)(n.prototype),"runForWindow",this).call(this,e),this._overlay.appendChild(this._window),this._window.center(e)}},{key:"_whenOverlayIsGone",value:function(e){var t=this;document.elementFromPoint(0,0)!==this._overlay?(this._window.remove(),e()):h.dispatch((function(){return t._whenOverlayIsGone(e)}),1)}}]),n}(f.default);t.default=p},46e3:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.YodaDemo=t.IndyDemo=t.Yoda=t.Indy=void 0;var r=n(24441),a=n(19123);t.Indy=new r.Indy,t.Yoda=new a.Yoda,t.IndyDemo=new r.IndyDemo,t.YodaDemo=new a.YodaDemo},76062:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(80655)),u=a(n(20497)),l=a(n(75244));function s(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0});var d=function(e){(0,o.default)(n,e);var t=s(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return n}(n(36104).default);t.default=d},24441:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.IndyDemo=t.Indy=void 0;var r=n(36104);t.Indy=r.default;var a=n(76062);t.IndyDemo=a.default},36104:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244));function d(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,a(n(68748)).default)(t,"__esModule",{value:!0});var c=n(78256),f=n(31560),h=n(17766),p=n(63239),v=n(20779),y=n(69924),m=n(25013),g=function(e){(0,u.default)(n,e);var t=d(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments)).slowColorCycles=[[238,6],[244,2]],e.fastColorCycles=[[160,8],[224,5],[229,9]],e.mapKey="KeyM",e.saveGameMagic="INDYSAV44",e.mapTileId=443,e.weaponTileId=450,e}return(0,o.default)(n,[{key:"locatorTile",get:function(){return new y.default}},{key:"sounds",get:function(){return m.default}},{key:"getHealthBonus",value:function(e){return 0}},{key:"getMaxAmmo",value:function(e){return-1}},{key:"getEquipSound",value:function(e){return 0}},{key:"createNewStory",value:function(e){var t=e.settings.worldSize;return new v.Story(f.rand(),h.Zone.Planet.None,c.WorldSize.isWorldSize(t)?c.WorldSize.fromNumber(t):[c.WorldSize.Small,c.WorldSize.Medium,c.WorldSize.Large].random())}},{key:"save",value:function(e){throw new Error("Method not implemented.")}},{key:"onPlaceTile",value:function(e,t,n){return!1}}]),n}(p.default);t.default=g},69924:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244)),d=a(n(68748)),c=a(n(67093));function f(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,d.default)(t,"__esModule",{value:!0});var h=n(28732),p=n(19384),v=n(43090),y=n(31560),m=function(e){(0,u.default)(n,e);var t=f(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return(0,o.default)(n,[{key:"here",get:function(){return 639}},{key:"backgroundColor",get:function(){return y.rgb(79,79,15)}},{key:"forZone",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e)return-1;if(!n&&(!1===t||void 0===t&&!e.visited))return 1138;switch(e.type){case p.default.Type.Empty:return this._hasTeleporterHotspot(e)?[1139,1131]:377;case p.default.Type.Town:return[375];case p.default.Type.Goal:return[408,376];case p.default.Type.TravelStart:case p.default.Type.TravelEnd:return[365,366];case p.default.Type.BlockadeEast:return[369,370];case p.default.Type.BlockadeWest:return[373,374];case p.default.Type.BlockadeNorth:return[367,368];case p.default.Type.BlockadeSouth:return[371,372];case p.default.Type.Use:case p.default.Type.Trade:case p.default.Type.Find:case p.default.Type.FindUniqueWeapon:return[363,364];default:return 377}}},{key:"_hasTeleporterHotspot",value:function(e){var t;return!!(0,c.default)(t=e.hotspots).call(t,(function(e){return e.type===h.default.Type.Teleporter}))}}]),n}(v.default);t.default=m},25013:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});t.default={Hurt:4,NoGo:6}},77124:(e,t,n)=>{var r;(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),function(e){e[e.TheForce=13]="TheForce",e[e.Blaster=9]="Blaster",e[e.BlasterRifle=10]="BlasterRifle",e[e.Blank=1]="Blank",e[e.Jawa=2]="Jawa",e[e.MadJawa=43]="MadJawa",e[e.Ewok=53]="Ewok",e[e.R2Unit=61]="R2Unit",e[e.Vader=68]="Vader"}(r||(r={})),t.default=r},59137:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244)),d=a(n(68748)),c=a(n(42601)),f=a(n(7478));function h(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,d.default)(t,"__esModule",{value:!0});var p=n(23121),v=n(17766),y=n(20779),m=n(78256),g=n(31560),_=n(13378),w=function(e){(0,u.default)(n,e);var t=h(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return(0,o.default)(n,[{key:"createNewStory",value:function(e){var t,n=e.settings.worldSize,r=e.assets.get(v.Puzzle,_.default.HIDDEN_FACTORY);return(0,c.default)(t=e.assets.getFiltered(v.Zone,(function(e){var t,n;return!(e.type!==v.Zone.Type.Goal||(0,f.default)(t=e.providedItems).call(t,r.item1)&&(0,f.default)(n=e.providedItems).call(n,r.item2))}))).call(t,(function(e){return e.type=v.Zone.Type.None})),new y.Story(g.rand(),v.Zone.Planet.Hoth,m.WorldSize.isWorldSize(n)?m.WorldSize.fromNumber(n):[m.WorldSize.Small,m.WorldSize.Medium,m.WorldSize.Large].random())}}]),n}(p.default);t.default=w},9679:(e,t,n)=>{var r=n(79406),a=n(92915),i=n(69159),o=n(67986),u=n(13037),l=n(29689),s=n(38468),d=s(n(63789)),c=s(n(76108)),f=s(n(40361)),h=s(n(7583)),p=s(n(80655)),v=s(n(20497)),y=s(n(75244)),m=s(n(68748)),g=s(n(42601)),_=s(n(68190)),w=s(n(35983));function k(e,t){var n=void 0!==o&&u(e)||e["@@iterator"];if(!n){if(l(e)||(n=function(e,t){var n;if(!e)return;if("string"==typeof e)return b(e,t);var r=a(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return i(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return b(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,s=function(){};return{s,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var d,c=!0,f=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){f=!0,d=e},f:function(){try{c||null==n.return||n.return()}finally{if(f)throw d}}}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function S(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,y.default)(e);if(t){var i=(0,y.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,v.default)(this,n)}}(0,m.default)(t,"__esModule",{value:!0});var I=n(36310),x=n(17766),T=n(27778),M=n(17725),E=[514,1073,1074,1075],C=function(e){(0,p.default)(r,e);var t,n=S(r);function r(){var e;return(0,f.default)(this,r),(e=n.apply(this,arguments))._detonatorFrames=null,e._ticks=-1,e.detonatorLocation=null,e}return(0,h.default)(r,[{key:"willShow",value:function(){this._ticks=0,this.cacheDetonatorFrames()}},{key:"willHide",value:function(){this._ticks=-1,this.detonatorLocation=null}},{key:"update",value:(t=(0,c.default)(d.default.mark((function e(){return d.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(-1!==this._ticks){e.next=2;break}return e.abrupt("return");case 2:this._ticks++,this._ticks>=this._detonatorFrames.length&&(this._dealDamage(),this._ticks=-1,this.engine.sceneManager.popScene());case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"_dealDamage",value:function(){for(var e=this,t=this.engine.currentZone,n=t.bounds,r=-1;r<=1;r++)for(var a=function(a){var i,o,u,l,s,d=10-2*M.abs(a)-2*M.abs(r),c=e.detonatorLocation.byAdding(a,r);if(!n.contains(c))return"continue";(0,g.default)(i=(0,_.default)(o=(0,w.default)(u=(0,_.default)(l=(0,_.default)(s=t.monsters).call(s,(function(e){return e.enabled}))).call(l,(function(e){return e.position.isEqualTo(c)}))).call(u,(function(e){return e.damageTaken+=d,e}))).call(o,(function(e){return!e.alive}))).call(i,(function(e){t.setTile(null,e.position),e.enabled=!1}))},i=-1;i<=1;i++)a(i)}},{key:"render",value:function(e){if(!(this._ticks>=this._detonatorFrames.length||this._ticks<0)){var t=this._detonatorFrames[this._ticks],n=this.cameraOffset.byAdding(this.detonatorLocation).byScalingBy(x.Tile.WIDTH);e.renderImage(t,n.x,n.y)}}},{key:"cacheDetonatorFrames",value:function(){var e=this;if(this.engine&&!this._detonatorFrames){this._detonatorFrames=[];var t,n=k(E);try{for(n.s();!(t=n.n()).done;){var r=t.value;T.drawTileImageData(this.engine.assets.get(x.Tile,r),this.engine.palette.original).toImage().then((function(t){return e._detonatorFrames.push(t)}))}}catch(e){n.e(e)}finally{n.f()}}}}]),r}(I.default);t.default=C},13378:(e,t,n)=>{var r;(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),function(e){e[e.FALCON=85]="FALCON",e[e.GENERAL_MARUTZ=103]="GENERAL_MARUTZ",e[e.HIDDEN_FACTORY=108]="HIDDEN_FACTORY",e[e.HAN=115]="HAN",e[e.FIND_LEIA=131]="FIND_LEIA",e[e.IMPERIAL_BATTLE_CODE=132]="IMPERIAL_BATTLE_CODE",e[e.RELAY_STATION=133]="RELAY_STATION",e[e.IMPERIAL_BATTLE_STATION=134]="IMPERIAL_BATTLE_STATION",e[e.WARN_THE_REBELS=135]="WARN_THE_REBELS",e[e.AMULET=185]="AMULET",e[e.RESCUE_YODA=189]="RESCUE_YODA",e[e.LANTERN_OF_SACRED_LIGHT=198]="LANTERN_OF_SACRED_LIGHT",e[e.ADEGAN_CRYSTAL=199]="ADEGAN_CRYSTAL",e[e.THREEPIOS_PARTS=201]="THREEPIOS_PARTS",e[e.CAR=197]="CAR"}(r||(r={})),t.default=r},19123:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.YodaDemo=t.Yoda=void 0;var r=n(23121);t.Yoda=r.default;var a=n(59137);t.YodaDemo=a.default},12312:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(80655)),l=a(n(20497)),s=a(n(75244)),d=a(n(68748)),c=a(n(67093));function f(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}(0,d.default)(t,"__esModule",{value:!0});var h=n(28732),p=n(19384),v=n(43090),y=n(31560),m=function(e){(0,u.default)(n,e);var t=f(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return(0,o.default)(n,[{key:"here",get:function(){return 837}},{key:"backgroundColor",get:function(){return y.rgb(0,0,0)}},{key:"forZone",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e)return 836;if(!n&&(!1===t||void 0===t&&!e.visited))return 835;switch(e.type){case p.default.Type.Empty:return this._hasTeleporterHotspot(e)?[833,834]:832;case p.default.Type.Town:return[829];case p.default.Type.Goal:return[831,830];case p.default.Type.TravelStart:case p.default.Type.TravelEnd:return[819,820];case p.default.Type.BlockadeEast:return[823,824];case p.default.Type.BlockadeWest:return[827,828];case p.default.Type.BlockadeNorth:return[821,822];case p.default.Type.BlockadeSouth:return[825,826];case p.default.Type.Use:case p.default.Type.Trade:case p.default.Type.Find:case p.default.Type.FindUniqueWeapon:return[817,818];default:return 832}}},{key:"_hasTeleporterHotspot",value:function(e){var t;return!!(0,c.default)(t=e.hotspots).call(t,(function(e){return e.type===h.default.Type.Teleporter}))}}]),n}(v.default);t.default=m},33289:(e,t,n)=>{(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});t.default={Schwing:0,Push:1,Switch7:2,Shpoonk:3,Hurt:4,Eep:5,NoGo:6,Blaster:7,Rifle:8,SaberSwg:9,Force:10,BangLrg:11,BangMed:12,BangHuge:14,DoorElec:15,DoorPnum:16,Hugedoor:17,Switch4:18,ChestSml:19,ChestLrg:20,Blip:21,Chirp:22,Switch6:23,BuzzLow:24,BuzzHigh:25,Switch2:26,Switch3:27,Moverock:29,SaberOut:31,Armed:32,Grenade:33,Locator:34,MapCls:35,ImpBlst:36,Vader:37,XWingIn:38,XWingOut:39,XWingBy:40,TieBy:41,R2d21:42,R2d22:43,Wookie:44,Speeder:46,TruckOut:47,Walker:48,Transprt:49,Splash:50,BleepSml:51,ArmForce:52,BuzzMed:53,Bong:54,Cantina:55,Crash:56,Truckin:57,Flourish:58,EmpTheme:59,Mystery:60,Opening:61,TryAgain:62,YouWin:63}},43919:(e,t,n)=>{var r;(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),function(e){e[e.Yoda=780]="Yoda",e[e.YodasBack=1993]="YodasBack",e[e.YodasSeat=2034]="YodasSeat",e[e.R2D2=794]="R2D2",e[e.TeleporterInactive=536]="TeleporterInactive",e[e.TeleporterActive=537]="TeleporterActive",e[e.MedicalDroid=797]="MedicalDroid",e[e.XWingPart1=948]="XWingPart1",e[e.XWingPart2=949]="XWingPart2",e[e.XWingPart3=950]="XWingPart3",e[e.Locator=421]="Locator",e[e.Locator817=817]="Locator817",e[e.Locator818=818]="Locator818",e[e.Locator819=819]="Locator819",e[e.Locator824=824]="Locator824",e[e.Locator825=825]="Locator825",e[e.Locator826=826]="Locator826",e[e.Locator831=831]="Locator831",e[e.Locator832=832]="Locator832",e[e.Locator833=833]="Locator833",e[e.Locator820=820]="Locator820",e[e.Locator821=821]="Locator821",e[e.Locator822=822]="Locator822",e[e.Locator823=823]="Locator823",e[e.Locator827=827]="Locator827",e[e.Locator828=828]="Locator828",e[e.Locator829=829]="Locator829",e[e.Locator830=830]="Locator830",e[e.Locator834=834]="Locator834",e[e.Locator835=835]="Locator835",e[e.Locator836=836]="Locator836",e[e.Locator837=837]="Locator837",e[e.QRations=507]="QRations",e[e.IceMushroom=1196]="IceMushroom",e[e.ScrubRoot=1198]="ScrubRoot",e[e.RebelFirstAidKit=505]="RebelFirstAidKit",e[e.ImperialFirstAidKit=506]="ImperialFirstAidKit",e[e.BactaFluid=480]="BactaFluid",e[e.Mushroom=1197]="Mushroom",e[e.CharkRoot=482]="CharkRoot",e[e.TheForce=511]="TheForce",e[e.Blaster=512]="Blaster",e[e.BlasterRifle=513]="BlasterRifle",e[e.LightsaberGreen=510]="LightsaberGreen",e[e.LightsaberBlue=18]="LightsaberBlue",e[e.ThermalDetonator=514]="ThermalDetonator",e[e.Explosion1073=1073]="Explosion1073",e[e.Explosion1074=1074]="Explosion1074",e[e.Explosion1075=1075]="Explosion1075",e[e.SpiritHeart=1432]="SpiritHeart"}(r||(r={})),t.default=r},23121:(e,t,n)=>{var r=n(79406),a=n(38468),i=a(n(40361)),o=a(n(7583)),u=a(n(18582)),l=a(n(80655)),s=a(n(20497)),d=a(n(75244)),c=a(n(68748)),f=a(n(35983)),h=a(n(75356)),p=a(n(31920)),v=a(n(95753)),y=a(n(67093)),m=a(n(7478));function g(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}(0,c.default)(t,"__esModule",{value:!0});var _=n(12312),w=n(33289),k=n(77124),b=n(13378),S=n(77998),I=n(43919),x=n(63239),T=n(17766),M=n(20779),E=n(31560),C=n(78256),A=n(95451),D=n(61334),z=n(9679),P=n(92540),R=function(e){(0,l.default)(n,e);var t=g(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments)).slowColorCycles=[[198,2],[200,2],[215,9],[229,9],[244,2]],e.fastColorCycles=[[10,6],[202,2],[204,2],[206,2],[224,5],[238,6]],e.saveGameMagic="YODASAV44",e.mapKey="KeyL",e.locatorTile=new _.default,e.sounds=w.default,e.goalIDs=b.default,e.zoneIDs=S.default,e.charIDs=k.default,e.tileIDs=I.default,e.mapTileId=I.default.Locator,e.weaponTileId=I.default.TheForce,e}return(0,o.default)(n,[{key:"canBeEquipped",value:function(e){return(0,u.default)((0,d.default)(n.prototype),"canBeEquipped",this).call(this,e)&&e.id!==I.default.ThermalDetonator}},{key:"getHealthBonus",value:function(e){switch(e.id){case I.default.QRations:return 25;case I.default.IceMushroom:case I.default.ScrubRoot:case I.default.Mushroom:case I.default.BactaFluid:case I.default.CharkRoot:return 50;case I.default.RebelFirstAidKit:case I.default.ImperialFirstAidKit:return 100;default:return 0}}},{key:"getMaxAmmo",value:function(e){if(!e)return-1;switch(e.frames[0].extensionRight.id){case I.default.BlasterRifle:return 10;case I.default.TheForce:return 15;case I.default.Blaster:return 30;case I.default.LightsaberGreen:case I.default.LightsaberBlue:case I.default.ThermalDetonator:default:return-1}}},{key:"getEquipSound",value:function(e){switch(e.frames[0].extensionRight.id){case I.default.BlasterRifle:case I.default.Blaster:return w.default.Armed;case I.default.LightsaberGreen:case I.default.LightsaberBlue:return w.default.SaberOut;case I.default.TheForce:return w.default.ArmForce;default:return-1}}},{key:"createNewStory",value:function(e){var t=e.persistentState.gamesWon,n=e.settings.worldSize,r=e.settings.lastPlanet;t>=1&&(e.assets.get(T.Puzzle,this.goalIDs.RESCUE_YODA).type=T.Puzzle.Type.End);t>=10&&(e.assets.get(T.Puzzle,this.goalIDs.CAR).type=T.Puzzle.Type.End);var a=[T.Zone.Planet.Endor,T.Zone.Planet.Hoth,T.Zone.Planet.Tatooine];return r&&T.Zone.Planet.isPlanet(r)&&a.remove(T.Zone.Planet.fromNumber(r)),new M.Story(E.rand(),a.random(),C.WorldSize.isWorldSize(n)?C.WorldSize.fromNumber(n):[C.WorldSize.Small,C.WorldSize.Medium,C.WorldSize.Large].random())}},{key:"save",value:function(e){var t,n,r,a,i,o,u,l=new A.SaveState;return l.type=e.variant,l.seed=e.story.seed,l.planet=e.story.planet,l.puzzleIDs1=new Int16Array((0,f.default)(t=e.story.puzzles[0]).call(t,(function(e){return e.id}))),l.puzzleIDs2=new Int16Array((0,f.default)(n=e.story.puzzles[1]).call(n,(function(e){return e.id}))),l.goalPuzzle=null!==(r=null===(a=e.story.goal)||void 0===a?void 0:a.id)&&void 0!==r?r:-1,l.dagobah=e.dagobah,l.world=e.world,l.onDagobah=e.currentWorld===e.dagobah,l.positionOnWorld=e.currentWorld.locationOfSector(e.currentSector),l.currentZoneID=e.currentZone.id,l.positionOnZone=e.hero.location,l.damageTaken=e.hero.damage,l.livesLost=e.hero.lives,l.inventoryIDs=new Int16Array((0,f.default)(i=e.inventory.items).call(i,(function(e){return e.id}))),l.currentWeapon=null!==(o=null===(u=e.hero.weapon)||void 0===u?void 0:u.id)&&void 0!==o?o:-1,l.currentAmmo=e.hero.ammo,l.forceAmmo=e.hero.getAmmoForWeapon(e.assets.get(T.Char,k.default.TheForce)),l.blasterAmmo=e.hero.getAmmoForWeapon(e.assets.get(T.Char,k.default.Blaster)),l.blasterRifleAmmo=e.hero.getAmmoForWeapon(e.assets.get(T.Char,k.default.BlasterRifle)),l.difficulty=e.settings.difficulty,l.timeElapsed=e.totalPlayTime,l.worldSize=0,l.unknownCount=0,l.unknownSum=0,l}},{key:"onPlaceTile",value:function(e,t,n){if(e.id===I.default.ThermalDetonator){var r=new z.default;return r.detonatorLocation=t,n.inventory.removeItem(I.default.ThermalDetonator),n.inputManager.clear(),n.inputManager.placedTile=null,n.inputManager.placedTileLocation=null,n.sceneManager.pushScene(r),!0}if(e.id===I.default.R2D2){var a=new D.Sprite(new E.Point(t.x,t.y,2),new E.Size(T.Tile.WIDTH,T.Tile.HEIGHT),e.imageData),i=n.sceneManager.currentScene;i.sprites.push(a);var o=this.findDescription(t,n),u=n.assets.get(String,o).toString();return n.speak(u,t).then((function(){var e,t,n=(0,h.default)(e=i.sprites).call(e,a);(0,p.default)(t=i.sprites).call(t,n,1)})),!0}return!1}},{key:"findDescription",value:function(e,t){var n,r,a;!function(e){e[e.AboutWalking=57383]="AboutWalking",e[e.AboutFinding=57384]="AboutFinding",e[e.AboutUsing=57385]="AboutUsing",e[e.AboutWeapons=57386]="AboutWeapons",e[e.AboutHealth=57387]="AboutHealth",e[e.Yoda=57382]="Yoda",e[e.Hero=57395]="Hero",e[e.Vader=57388]="Vader",e[e.MedicalDroid=57398]="MedicalDroid",e[e.TeleporterActive=57396]="TeleporterActive",e[e.TeleporterInactive=57397]="TeleporterInactive",e[e.Draggable=57380]="Draggable",e[e.Weapon=57400]="Weapon",e[e.Enemy=57378]="Enemy",e[e.NPC=57381]="NPC",e[e.Ewok=57391]="Ewok",e[e.Jawa=57392]="Jawa",e[e.Droid=57393]="Droid",e[e.xWing=57377]="xWing",e[e.Storage=57376]="Storage",e[e.Door=57379]="Door",e[e.Win=37389]="Win",e[e.Lose=57390]="Lose"}(a||(a={}));var i=[258,16,1165,633,635,636,1765],o=[70,71,72,73,74,75,76,145,149,152,153,220,221,223,231,232,233,350,582,584,586,588,702,709,755,756,759,760,804,806,983,984,1047,1048,1081,1112,1120,1259,1461,1462,1472,1473,1539,1544,1858];if(e.isEqualTo(t.hero.location))return a.Hero;for(var u=0,l=(0,v.default)(a);u<l.length;u++){var s=l[u];if("number"==typeof s)t.assets.get(String,s,P.NullIfMissing)||console.warn("String ",s,a[s],"does not exist!")}var d=t.currentZone,c=null!==(n=d.getTile(e.x,e.y,1))&&void 0!==n?n:d.getTile(e.x,e.y,0),f=(0,y.default)(r=d.monsters).call(r,(function(t){var n=t.x,r=t.y;return e.isEqualTo({x:n,y:r,z:null})}));if(f&&f.face&&f.alive){var h=f.face.id;if(h===k.default.Vader)return a.Vader;if(h===k.default.Blank)return a.Jawa;if(h===k.default.Jawa)return a.Jawa;if(h===k.default.MadJawa)return a.Jawa;if(h===k.default.Ewok)return a.Ewok;if(h===k.default.R2Unit)return a.Droid}return c.id===I.default.Yoda?a.Yoda:c.id===I.default.MedicalDroid?a.MedicalDroid:c.id===I.default.TeleporterInactive?a.TeleporterInactive:c.id===I.default.TeleporterActive?a.TeleporterActive:c.id===I.default.XWingPart1||c.id===I.default.XWingPart2||c.id===I.default.XWingPart3?a.xWing:(0,m.default)(i).call(i,c.id)?a.Storage:(0,m.default)(o).call(o,c.id)?a.Door:c.hasAttributes(T.Tile.Attributes.Draggable)?a.Draggable:c.hasAttributes(T.Tile.Attributes.Weapon)?a.Weapon:c.hasAttributes(T.Tile.Attributes.Enemy)?a.Enemy:c.hasAttributes(T.Tile.Attributes.NPC)?a.NPC:[a.AboutWalking,a.AboutUsing,a.AboutFinding,a.AboutWeapons,a.AboutHealth].random()}}]),n}(x.default);R.goalIDs=b.default,R.zoneIDs=S.default,R.charIDs=k.default,R.tileIDs=I.default,t.default=R},77998:(e,t,n)=>{var r;(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),function(e){e[e.YodasHut=535]="YodasHut",e[e.DagobahNorthWest=94]="DagobahNorthWest",e[e.DagobahNorthEast=95]="DagobahNorthEast",e[e.DagobahSouthWest=93]="DagobahSouthWest",e[e.DagobahSouthEast=96]="DagobahSouthEast",e[e.Load=0]="Load",e[e.Win=76]="Win",e[e.Lose=77]="Lose"}(r||(r={})),t.default=r},66822:(e,t,n)=>{n.r(t)},28453:(e,t,n)=>{n.r(t)},71347:(e,t,n)=>{n.r(t)},93809:(e,t,n)=>{n.r(t)},16407:(e,t,n)=>{n.r(t)},83058:(e,t,n)=>{n.r(t)},6165:(e,t,n)=>{n.r(t)},78581:(e,t,n)=>{n.r(t)},59184:(e,t,n)=>{n.r(t)},20695:(e,t,n)=>{n.r(t)},39870:(e,t,n)=>{n.r(t)},77079:(e,t,n)=>{n.r(t)},42937:(e,t,n)=>{n.r(t)},60663:(e,t,n)=>{n.r(t)},33682:(e,t,n)=>{n.r(t)},93824:(e,t,n)=>{n.r(t)},60753:(e,t,n)=>{n.r(t)},13426:(e,t,n)=>{n.r(t)},47881:(e,t,n)=>{n.r(t)},38753:(e,t,n)=>{n.r(t)},94224:(e,t,n)=>{n.r(t)},76057:(e,t,n)=>{n.r(t)},54532:(e,t,n)=>{n.r(t)},58482:(e,t,n)=>{n.r(t)},29447:(e,t,n)=>{n.r(t)},7523:(e,t,n)=>{n.r(t)},76343:(e,t,n)=>{n.r(t)},96788:(e,t,n)=>{n.r(t)},75148:(e,t,n)=>{n.r(t)},92029:(e,t,n)=>{n.r(t)},48349:(e,t,n)=>{n.r(t)},98586:(e,t,n)=>{n.r(t)},50994:(e,t,n)=>{n.r(t)},75837:(e,t,n)=>{n.r(t)},22223:(e,t,n)=>{n.r(t)},25653:(e,t,n)=>{n.r(t)},3509:(e,t,n)=>{n.r(t)},65008:(e,t,n)=>{n.r(t)},48563:(e,t,n)=>{n.r(t)},72157:(e,t,n)=>{n.r(t)},49158:(e,t,n)=>{n.r(t)},26606:(e,t,n)=>{n.r(t)},40148:(e,t,n)=>{n.r(t)},40144:(e,t,n)=>{n.r(t)},62196:(e,t,n)=>{n.r(t)},33676:(e,t,n)=>{n.r(t)},64875:(e,t,n)=>{n.r(t)},31279:(e,t,n)=>{n.r(t)},86236:(e,t,n)=>{n.r(t)},61089:(e,t,n)=>{n.r(t)},46533:(e,t,n)=>{n.r(t)},97712:(e,t,n)=>{n.r(t)},58192:(e,t,n)=>{n.r(t)},42458:(e,t,n)=>{n.r(t)},29793:(e,t,n)=>{n.r(t)},17674:(e,t,n)=>{n.r(t)},86578:(e,t,n)=>{n.r(t)},35629:(e,t,n)=>{n.r(t)},29238:(e,t,n)=>{n.r(t)},67862:(e,t,n)=>{n.r(t)},8223:(e,t,n)=>{n.r(t)},47096:(e,t,n)=>{n.r(t)},13114:(e,t,n)=>{n.r(t)},94301:(e,t,n)=>{n.r(t)},8718:(e,t,n)=>{n.r(t)},22846:(e,t,n)=>{n.r(t)},33814:(e,t,n)=>{n.r(t)},8798:(e,t,n)=>{n.r(t)},91572:(e,t,n)=>{n.r(t)},87791:(e,t,n)=>{n.r(t)},5568:(e,t,n)=>{n.r(t)},80668:(e,t,n)=>{n.r(t)},16818:(e,t,n)=>{n.r(t)},51389:(e,t,n)=>{n.r(t)},73543:(e,t,n)=>{n.r(t)},37389:(e,t,n)=>{n.r(t)}},n={};function r(e){var a=n[e];if(void 0!==a)return a.exports;var i=n[e]={id:e,loaded:!1,exports:{}};return t[e].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports}r.m=t,e=[],r.O=(t,n,a,i)=>{if(!n){var o=1/0;for(s=0;s<e.length;s++){for(var[n,a,i]=e[s],u=!0,l=0;l<n.length;l++)(!1&i||o>=i)&&Object.keys(r.O).every((e=>r.O[e](n[l])))?n.splice(l--,1):(u=!1,i<o&&(o=i));u&&(e.splice(s--,1),t=a())}return t}i=i||0;for(var s=e.length;s>0&&e[s-1][2]>i;s--)e[s]=e[s-1];e[s]=[n,a,i]},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={198:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var a,i,[o,u,l]=n,s=0;for(a in u)r.o(u,a)&&(r.m[a]=u[a]);if(l)var d=l(r);for(t&&t(n);s<o.length;s++)i=o[s],r.o(e,i)&&e[i]&&e[i][0](),e[o[s]]=0;return r.O(d)},n=self.webpackChunkwebfun=self.webpackChunkwebfun||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var a=r.O(void 0,[736,189,711],(()=>r(87898)));a=r.O(a)})();