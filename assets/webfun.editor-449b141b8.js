(self.webpackChunkwebfun=self.webpackChunkwebfun||[]).push([[189],{96288:(e,t,n)=>{"use strict";(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.Writer=t.Reader=void 0;var a=n(127);t.Writer=a.default;var r=n(7544);t.Reader=r.default},7544:(e,t,n)=>{"use strict";var a=n(38468),r=a(n(40361)),i=a(n(7583));(0,a(n(68748)).default)(t,"__esModule",{value:!0});var o=n(20779),l=n(31560),s=function(){function e(){(0,r.default)(this,e)}return(0,i.default)(e,[{key:"read",value:function(e){if("BM"!==e.readCharacters(2))throw"Invalid file format";var t=e.readUint32();if(0!==e.readUint16())throw"Invalid magic 1";if(0!==e.readUint16())throw"Invalid magic 2";var n=e.readUint32();if(12!==e.readUint32())throw"Invalid header size";var a=e.readUint16(),r=e.readUint16();if(1!==e.readUint16())throw"Invalid magic 3";if(8!==e.readUint16())throw"Invalid bits per pixels";for(var i=e.readUint8Array(n-e.offset),s=o.ColorPalette.FromRGB8(i),u=t-e.offset,c=new l.OutputStream(u),d=0;d<r;d++)c.seek((r-d-1)*a,l.InputStream.Seek.Set),c.writeUint8Array(e.readUint8Array(a));return c.seek(u,l.InputStream.Seek.Set),[new l.Size(a,r),new Uint8Array(c.buffer),s]}}]),e}();t.default=s},127:(e,t,n)=>{"use strict";var a=n(38468),r=a(n(40361)),i=a(n(7583)),o=a(n(68748)),l=a(n(92915));(0,o.default)(t,"__esModule",{value:!0});var s=n(31560),u=function(){function e(){(0,r.default)(this,e)}return(0,i.default)(e,[{key:"write",value:function(e,t,n){var a=26+3*t.length+e.length,r=26+3*t.length,i=new s.OutputStream(a);i.writeCharacters("BM"),i.writeUint32(a),i.writeUint16(0),i.writeUint16(0),i.writeUint32(r),i.writeUint32(12),i.writeUint16(n.width),i.writeUint16(n.height),i.writeUint16(1),i.writeUint16(8),i.writeUint8(117),i.writeUint8(20),i.writeUint8(104);for(var o=1;o<t.length;o++)i.writeUint8(t[o]>>16&255),i.writeUint8(t[o]>>8&255),i.writeUint8(t[o]>>0&255);for(var u=n.height-1;u>=0;u--)i.writeUint8Array((0,l.default)(e).call(e,u*n.width,u*n.width+n.width));return i.buffer}}]),e}();t.default=u},14157:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(40361)),o=r(n(7583)),l=r(n(18582)),s=r(n(80655)),u=r(n(20497)),c=r(n(75244)),d=r(n(68748)),f=r(n(67093));function h(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}(0,d.default)(t,"__esModule",{value:!0}),n(39146);var v=n(27726),p=n(88607),y=n(31560),m=n(5008),_=n(79586),g=function(e){(0,s.default)(n,e);var t=h(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments)).onchange=function(){},e._state=new y.DiscardingStorage,e._tiles=null,e._tile=null,e._tileView=WebFun.JSX.render(_.default,null),e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){(0,l.default)((0,c.default)(n.prototype),"connectedCallback",this).call(this),this.addEventListener("click",this),this.appendChild(this._tileView)}},{key:"disconnectedCallback",value:function(){this.removeEventListener("click",this),(0,l.default)((0,c.default)(n.prototype),"disconnectedCallback",this).call(this)}},{key:"handleEvent",value:function(e){var t=this;if(!this._window){var n=WebFun.JSX.render(m.Panel,null),a=WebFun.JSX.render(v.default,{tiles:this.tiles,palette:this._palette,tile:this.tile,style:{width:"300px",height:"400px"},state:this.state.prefixedWith("popout-tile-picker")});a.addEventListener(v.Events.TileDidChange,(function(e){t.pickerOnChange(a,e)})),n.content.appendChild(a),this._window=n,e.stopPropagation()}this.windowManager.showWindow(this._window)}},{key:"windowManager",get:function(){for(var e=this;e=e.parentElement;)if(e instanceof m.AbstractWindow)return e.manager;return null}},{key:"palette",get:function(){return this._palette},set:function(e){this._palette=e,this._tileView.palette=e}},{key:"state",get:function(){return this._state},set:function(e){this._state=e,this.restoreTileFromState()}},{key:"tiles",get:function(){return this._tiles},set:function(e){this._tiles=e,this.restoreTileFromState()}},{key:"tile",get:function(){return this._tile},set:function(e){this._tile=e,this._tileView.tile=e,this._state.store("tile",e?e.id:-1)}},{key:"restoreTileFromState",value:function(){var e;if(this._state&&this._tiles&&this._state.has("tile")){var t=+this._state.load("tile"),n=(0,f.default)(e=this.tiles).call(e,(function(e){return e.id===t}));this._tile=n,this._tileView.tile=n}}}]),n}(p.Component);g.observedAttributes=[],t.default=g},87800:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(40361)),o=r(n(7583)),l=r(n(18582)),s=r(n(80655)),u=r(n(20497)),c=r(n(75244)),d=r(n(68748)),f=r(n(67093));function h(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}(0,d.default)(t,"__esModule",{value:!0}),n(44556);var v=n(27726),p=n(88607),y=n(31560),m=n(5008),_=n(48387),g=n(79586),w=function(e){(0,s.default)(n,e);var t=h(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments)).onchange=function(){},e._state=new y.DiscardingStorage,e._tiles=null,e._tile=null,e._tileView=WebFun.JSX.render(g.default,null),e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){(0,l.default)((0,c.default)(n.prototype),"connectedCallback",this).call(this),this.addEventListener("click",this),this.appendChild(this._tileView)}},{key:"disconnectedCallback",value:function(){this.removeEventListener("click",this),(0,l.default)((0,c.default)(n.prototype),"disconnectedCallback",this).call(this)}},{key:"handleEvent",value:function(e){var t=this,n=this.getBoundingClientRect(),a=n.left,r=n.top,i=WebFun.JSX.render(m.Popover,{style:{position:"absolute",left:"".concat(a.toString(),"px"),top:"".concat(r.toString(),"px")}}),o=new _.PopoverModalSession(i),l=WebFun.JSX.render(v.default,{tiles:this.tiles,palette:this._palette,tile:this.tile,style:{width:"300px",height:"400px"},state:this.state.prefixedWith("popover-tile-picker")});l.addEventListener(v.Events.TileDidChange,(function(e){t.pickerOnChange(l,e),o.end(1)})),i.content.appendChild(l),o.onclick=function(e){return!e.target.closest(m.Popover.tagName)&&o.end(0)},o.run(),l.focus(),e.stopPropagation()}},{key:"palette",get:function(){return this._palette},set:function(e){this._palette=e,this._tileView.palette=e}},{key:"state",get:function(){return this._state},set:function(e){this._state=e,this.restoreTileFromState()}},{key:"tiles",get:function(){return this._tiles},set:function(e){this._tiles=e,this.restoreTileFromState()}},{key:"tile",get:function(){return this._tile},set:function(e){this._tile=e,this._tileView.tile=e,this._state.store("tile",e?e.id:-1)}},{key:"restoreTileFromState",value:function(){var e;if(this._state&&this._tiles&&this._state.has("tile")){var t=+this._state.load("tile"),n=(0,f.default)(e=this.tiles).call(e,(function(e){return e.id===t}));this._tile=n,this._tileView.tile=n}}}]),n}(p.Component);w.observedAttributes=[],t.default=w},16167:(e,t,n)=>{"use strict";var a=n(38468),r=a(n(40361)),i=a(n(7583)),o=a(n(68748)),l=a(n(20778)),s=a(n(69159)),u=a(n(42601));(0,o.default)(t,"__esModule",{value:!0});var c=n(83608),d=n(31560),f=function(){function e(t){(0,r.default)(this,e),this.definitions=(0,l.default)({},c.ConditionsByName,c.InstructionsByName),this._data=t}return(0,i.default)(e,[{key:"process",value:function(e){var t=this,n=(0,s.default)(e.querySelectorAll(".symbol"));return(0,u.default)(n).call(n,(function(e){var n=e.textContent.camelize(),a=t.definitions[n];a&&t.enrichArguments(e,a.Arguments)})),e}},{key:"enrichArguments",value:function(e,t){for(var n=this.collectArgumentNodes(e,t.length),a=0;a<t.length;a++){var r,i,o=n[a],l=t[a];if(l===c.Type.SoundID)o.sound=-1==+o?null:null!==(r=null===(i=this._data.sounds[+o])||void 0===i?void 0:i.file)&&void 0!==r?r:"<unknown>";l===c.Type.TileID&&(o.tile=-1==+o?null:this._data.tiles[+o]),l===c.Type.ZoneX&&(o.point=new d.Point(+o.textContent,+o.nextElementSibling.textContent,0)),l===c.Type.ZoneY&&(o.point=new d.Point(+o.previousElementSibling.textContent,+o.textContent,0)),l===c.Type.ZoneZ&&(o.point=new d.Point(+o.previousElementSibling.previousElementSibling.textContent,+o.previousElementSibling.textContent,+o.textContent))}}},{key:"collectArgumentNodes",value:function(e,t){for(var n=[],a=e;t;)a=a.nextElementSibling,n.push(a),t--;return n}}]),e}();t.default=f},52398:(e,t,n)=>{"use strict";var a,r,i,o,l,s=n(79406),u=n(38468),c=u(n(94433)),d=u(n(61822)),f=u(n(75538)),h=u(n(25867)),v=u(n(7583)),p=u(n(40361)),y=u(n(80655)),m=u(n(20497)),_=u(n(75244)),g=u(n(46386)),w=u(n(68748)),b=u(n(92915)),k=u(n(47053)),S=u(n(35983)),C=u(n(20778)),x=u(n(16825));function T(e){var t=function(){if("undefined"==typeof Reflect||!s)return!1;if(s.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(s(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,_.default)(e);if(t){var r=(0,_.default)(this).constructor;n=s(a,arguments,r)}else n=a.apply(this,arguments);return(0,m.default)(this,n)}}(0,w.default)(t,"__esModule",{value:!0}),t.AssemblerInputError=void 0;var I=n(233),W=n(47590),F=n(35288),E=n(76500),D=n(29081),z=function(e){(0,y.default)(n,e);var t=T(n);function n(e,a){var r;return(0,p.default)(this,n),(r=t.call(this,e)).input=a,r}return n}((0,g.default)(Error));t.AssemblerInputError=z;var L=W.ConditionsByName,P=F.InstructionsByName,A=function(){function e(){(0,p.default)(this,e),this.checkArgumentCount=!1}return(0,v.default)(e,[{key:"assemble",value:function(e){var t,n=new E.MutableAction,i=this.validateInputStructure(e),o=(0,h.default)(i),l=o[0],s=o[1],u=(0,b.default)(o).call(o,2);(console.assert(l===I.s(a||(a=(0,f.default)(["defaction"])))),"string"==typeof s)?n.name=s:u=(0,k.default)(t=[s]).call(t,(0,d.default)(u));1===u.length&&(u=u.first());var v=[],p=[];if(!(u instanceof Array))throw new z("Expected function call",u);if(u.first()===I.s(r||(r=(0,f.default)(["and"])))){var y=this.parseAnd((0,b.default)(u).call(u)),m=(0,c.default)(y,2);v=m[0],p=m[1]}else p=[this.parseInstruction((0,b.default)(u).call(u))];return n.conditions=v,n.instructions=p,n}},{key:"validateInputStructure",value:function(e){var t=e;if(!(e instanceof Array))throw new z("Input must be an array.",e);if(t[0]!==I.s(i||(i=(0,f.default)(["defaction"]))))throw new z("Input must be an action definition using defaction.",e);return(0,b.default)(e).call(e)}},{key:"parseAnd",value:function(e){var t,n=this;if(e.shift()!==I.s(o||(o=(0,f.default)(["and"]))))throw new z("Invalid input",e);var a,r=e.pop();if(!(r instanceof Array))throw new z("Invalid input",e);r.first()!==I.s(l||(l=(0,f.default)(["progn"])))?t=[this.parseInstruction(r)]:t=(0,S.default)(a=(0,b.default)(r).call(r,1)).call(a,(function(e){return n.parseInstruction(e)}));return[(0,S.default)(e).call(e,(function(e){return n.parseCondition(e)})),t]}},{key:"parseInstruction",value:function(e){return(0,C.default)(this.parseOpcode(e,P),{isInstruction:!0})}},{key:"parseCondition",value:function(e){return(0,C.default)(this.parseOpcode(e,L),{isCondition:!0})}},{key:"parseOpcode",value:function(e,t){if(!(e instanceof Array))throw new z("Invalid input.",e);var n=(0,h.default)(e),a=n[0],r=(0,b.default)(n).call(n,1);if(!(a instanceof D.default))throw new z("Expected valid name.",e);var i=t[a.name.camelize()];if(!i)throw new z("Unknown method name encountered.",e);var o,l=i.UsesText?r.pop():"";if(this.checkArgumentCount&&~i.Arguments&&r.length!==i.Arguments.length)throw new z((0,k.default)(o="Expected ".concat(i.Arguments," arguments but found ")).call(o,r.length,"."),e);if("string"!=typeof l)throw new z("Expected last argument to be a string.",e);if(!(0,x.default)(r).call(r,(function(e){return"number"==typeof e})))throw new z("Expected arguments to be of type number.",e);if(!(0,x.default)(r).call(r,(function(e){return e>=-1*Math.pow(2,15)&&e<=Math.pow(2,15)-1})))throw new z("Arguments must fit into a 16bit signed integer.",e);return{opcode:i.Opcode,text:l,arguments:r}}}]),e}();t.default=A},233:(e,t,n)=>{"use strict";var a=n(38468),r=a(n(68748)),i=a(n(32839)),o=a(n(47053));(0,r.default)(t,"__esModule",{value:!0}),t.s=void 0;var l=n(29081);t.s=function(e){for(var t,n=arguments.length,a=new Array(n>1?n-1:0),r=1;r<n;r++)a[r-1]=arguments[r];return new l.default(i.default.apply(String,(0,o.default)(t=[e]).call(t,a)))}},65091:(e,t,n)=>{"use strict";var a,r,i,o,l,s=n(38468),u=s(n(75538)),c=s(n(61822)),d=s(n(40361)),f=s(n(7583)),h=s(n(68748)),v=s(n(47053)),p=s(n(35983)),y=s(n(67093)),m=s(n(95753)),_=s(n(92915));(0,h.default)(t,"__esModule",{value:!0});var g=n(233),w=n(47590),b=n(35288),k=function(){function e(){(0,d.default)(this,e)}return(0,f.default)(e,[{key:"disassemble",value:function(e){var t,n,o,l,s,d=this;return(0,v.default)(t=[g.s(a||(a=(0,u.default)(["defaction"])))]).call(t,(0,c.default)(e.name.length?[e.name]:[]),[(0,v.default)(n=[g.s(r||(r=(0,u.default)(["and"])))]).call(n,(0,c.default)((0,p.default)(o=e.conditions).call(o,(function(e){return d._disassembleCondition(e)}))),[(0,v.default)(l=[g.s(i||(i=(0,u.default)(["progn"])))]).call(l,(0,c.default)((0,p.default)(s=e.instructions).call(s,(function(e){return d._disassembleInstruction(e)}))))])])}},{key:"_disassembleCondition",value:function(e){var t,n,a,r=(0,y.default)(t=(0,m.default)(w.ConditionsByName)).call(t,(function(t){return w.ConditionsByName[t].Opcode===e.opcode}))||"".concat(e.opcode),i=(r?w.ConditionsByName[r]:null).Arguments.length,l=(0,_.default)(n=e.arguments).call(n,0,i);return(0,v.default)(a=[g.s(o||(o=(0,u.default)(["",""])),r.dasherize())]).call(a,(0,c.default)(l))}},{key:"_disassembleInstruction",value:function(e){var t,n,a,r=(0,y.default)(t=(0,m.default)(b.InstructionsByName)).call(t,(function(t){return b.InstructionsByName[t].Opcode===e.opcode}))||"".concat(e.opcode),i=r?b.InstructionsByName[r]:null,o=i.Arguments.length,s=(0,_.default)(n=e.arguments).call(n,0,o);return(0,v.default)(a=[g.s(l||(l=(0,u.default)(["",""])),r.dasherize())]).call(a,(0,c.default)(s),(0,c.default)(i.UsesText?[e.text]:[]))}}]),e}();t.default=k},97033:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(40361)),o=r(n(7583)),l=r(n(18582)),s=r(n(80655)),u=r(n(20497)),c=r(n(75244)),d=r(n(68748)),f=r(n(35983)),h=r(n(42601));function v(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}(0,d.default)(t,"__esModule",{value:!0}),n(6604);var p=n(52398),y=n(49675),m=n(16167),_=n(83722),g=n(65091),w=n(76500),b=n(85926),k=n(15436),S=n(96950),C=function(e){(0,s.default)(n,e);var t=v(n);function n(){var e;return(0,i.default)(this,n),(e=t.call(this))._errorArea=document.createElement("div"),e._errorArea.classList.add("error-area"),e._errorArea.style.display="none",e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){(0,l.default)((0,c.default)(n.prototype),"connectedCallback",this).call(this),this.registerShortcuts()}},{key:"registerShortcuts",value:function(){var e=this;this._shortcuts=[];var t=k.default.sharedManager.registerShortcut((function(){return e.save()}),{node:this,metaKey:!0,keyCode:83});this._shortcuts.push(t)}},{key:"save",value:function(){var e=this,t=new y.default,n=new p.default,a=this._editorArea.textContent,r=t.parse(a),i=[],o=(0,f.default)(r).call(r,(function(t,a){try{var r=new w.MutableAction(n.assemble(t));return r.id=a,r.zone=e._zone,r}catch(e){return i.push(e),null}}));this._showErrors(i),i.length||(this._zone.actions=o,this.actions=o)}},{key:"unregisterShortcuts",value:function(){var e,t=k.default.sharedManager;(0,h.default)(e=this._shortcuts).call(e,(function(e){return t.unregisterShortcut(e)})),this._shortcuts=[]}},{key:"disconnectedCallback",value:function(){(0,l.default)((0,c.default)(n.prototype),"disconnectedCallback",this).call(this),this.unregisterShortcuts()}},{key:"zone",get:function(){return this._zone},set:function(e){this._zone=e,this.actions=e.actions}},{key:"actions",set:function(e){var t;this._actions=e;var n=document.createElement("div");n.classList.add("editor-area"),n.spellcheck=!1,n.setAttribute("contenteditable","");var a=new b.default;a.tagName=S.default.tagName;var r=new g.default,i=new m.default(this.data),o=[];(0,h.default)(t=this._actions).call(t,(function(e,t){try{var i=r.disassemble(e);n.innerHTML+=(0===t?"":"<br><br>")+a.pprint(i)}catch(e){o.push(e)}})),this._showErrors(o),this.textContent="",this._editorArea=i.process(n),this.appendChild(this._errorArea),this.appendChild(n)}},{key:"_showErrors",value:function(e){if(!e||0===e.length)return this._errorArea.style.display="none",void this.style.setProperty("--error-height","0px");this._errorArea.textContent=(0,f.default)(e).call(e,(function(e){return console.log(e),e instanceof y.ParserError?"SyntaxError: "+e.message:e instanceof p.AssemblerInputError?"Assembler Error: "+e.message:"Error: "+e.message})).join("\n"),this._errorArea.style.display="",this.style.setProperty("--error-height",this._errorArea.getBoundingClientRect().height+"px")}}]),n}(_.default);C.tagName="wf-action-editor",C.observedAttributes=[],t.default=C},64730:(e,t,n)=>{"use strict";(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.Token=t.Editor=void 0;var a=n(97033);t.Editor=a.default;var r=n(96950);t.Token=r.default},84504:(e,t,n)=>{"use strict";var a=n(38468),r=a(n(40361)),i=a(n(7583));(0,a(n(68748)).default)(t,"__esModule",{value:!0});var o=function(){function e(){(0,r.default)(this,e),this._lines=[],this._currentLine=""}return(0,i.default)(e,[{key:"put",value:function(e){for(var t=e.split("\n");t.length;)this._currentLine+=t.shift(),t.length&&this.endLine()}},{key:"endLine",value:function(){this._currentLine.length&&(this._lines.push(this._currentLine),this._currentLine="")}},{key:"currentLineLength",get:function(){return this._currentLine.length}},{key:"string",get:function(){return this._lines.join("\n")}}]),e}();t.default=o},49675:(e,t,n)=>{"use strict";var a,r=n(79406),i=n(38468),o=i(n(75538)),l=i(n(7583)),s=i(n(40361)),u=i(n(80655)),c=i(n(20497)),d=i(n(75244)),f=i(n(46386)),h=i(n(68748)),v=i(n(60388));function p(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,c.default)(this,n)}}(0,h.default)(t,"__esModule",{value:!0}),t.ParserError=void 0;var y=n(233),m=n(31560),_=function(e){(0,u.default)(n,e);var t=p(n);function n(){return(0,s.default)(this,n),t.apply(this,arguments)}return n}((0,f.default)(Error));t.ParserError=_;var g=function(){function e(){(0,s.default)(this,e)}return(0,l.default)(e,[{key:"parse",value:function(e){for(var t=new m.Scanner(e),n=[];!t.isAtEnd();){var a=this.read(t);a&&n.push(a)}return n}},{key:"read",value:function(e){e.skipWhitespace();var t=e.peek();return'"'===t?this.readString(e):"-"===t||/\d/.test(t)?this.readNumber(e):"("===t?this.readList(e):"["===t?this.readArray(e):this.readSymbol(e)}},{key:"readString",value:function(e){var t,n="",a=e.offset;for(e.poke();;){if('"'===(t=e.poke()))break;if(!t)throw new _("Unterminated string, starting at ".concat(a,"."));"\\"===t&&(t=this.escapedCharacter(e.poke())),n+=t}return n}},{key:"escapedCharacter",value:function(e){if("t"===e)return"\t";if("r"===e)return"\r";if("n"===e)return"\n";if('"'===e)return'"';throw new _("Invalid escape sequence \\".concat(e," encountered"))}},{key:"readNumber",value:function(e){var t,n="",a=e.offset,r=1;for("-"!==(t=e.peek())&&"+"!==t||(e.poke(),r="-"===t?-1:1);;){if(e.isAtWhitespace())break;if("("===(t=e.peek())||")"===t)break;if(t=e.poke(),!/\d/.test(t))throw new _("Invalid number starting at ".concat(a,"."));n+=t}return(0,v.default)(n)*r}},{key:"readList",value:function(e){var t,n=[],a=e.offset;for(e.poke();;){if(e.skipWhitespace(),!(t=e.peek()))throw new _("Unterminated list starting at ".concat(a,"."));if(")"===t){e.poke();break}n.push(this.read(e))}return n}},{key:"readArray",value:function(e){var t,n=[],a=e.offset;for(e.poke();;){if(e.skipWhitespace(),!(t=e.peek()))throw new _("Unterminated list starting at ".concat(a,"."));if("]"===t){e.poke();break}var r=this.read(e);n.push(r)}return n}},{key:"readSymbol",value:function(e){for(var t,n="",r=e.offset;;){if("("===(t=e.peek())||")"===t||"["===t||"]"===t)break;if(e.isAtWhitespace())break;if(e.isAtEnd())break;n+=e.poke()}if(0===n.length)throw new _("Expected symbol staring at ".concat(r,"."));return"nil"!==n.toLowerCase()&&("t"===n.toLowerCase()||y.s(a||(a=(0,o.default)(["",""])),n))}}]),e}();t.default=g},85926:(e,t,n)=>{"use strict";var a=n(38468),r=a(n(40361)),i=a(n(7583)),o=a(n(68748)),l=a(n(49477)),s=a(n(25097)),u=a(n(92915)),c=a(n(7478));(0,o.default)(t,"__esModule",{value:!0});var d=n(29081),f=n(7765),h=["defn","and","progn"],v=function(){function e(){(0,r.default)(this,e),this.indent=4,this.tagName="span"}return(0,i.default)(e,[{key:"pprint",value:function(e){return this._buffer=new f.default,this._buffer.tagName=this.tagName,this.putSimple(e,0),this._buffer.endLine(),this._buffer.string}},{key:"putSimple",value:function(e,t){var n=(0,l.default)(" ").call(" ",t);if(this._buffer.put(n),"boolean"!=typeof e)if("number"!=typeof e)if("string"!=typeof e){if(this.isKeyword(e))this._buffer.put(e.name,"keyword");else if(e instanceof d.default)this._buffer.put(e.name,"symbol");else if(e instanceof Array){var a=e.first(),r=0,i=0;if(a instanceof d.default){if("defaction"===a.name)r="string"==typeof e[1]?2:1,i=2;"and"===a.name&&(r=2),"progn"===a.name&&(r=1,i=2)}this.putList((0,u.default)(e).call(e),r,i)}}else this._buffer.put((0,s.default)(e),"string");else this._buffer.put("".concat(e),"number");else this._buffer.put(e?"T":"NIL","boolean")}},{key:"putList",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._buffer.put("(");for(var a=0!==t,r=a?this._buffer.currentLineLength+n:1;t>1;)this.putSimple(e.shift(),0),this._buffer.put(" "),t--;for(a&&0===n&&(r=this._buffer.currentLineLength),this.putSimple(e.shift(),0),a&&this._buffer.endLine();e.length;)this.putSimple(e.shift(),r),a&&e.length&&this._buffer.endLine();this._buffer.put(")")}},{key:"isKeyword",value:function(e){return e instanceof d.default&&(0,c.default)(h).call(h,e.name)}}]),e}();t.default=v},29081:(e,t,n)=>{"use strict";var a=n(38468),r=a(n(40361)),i=a(n(7583));(0,a(n(68748)).default)(t,"__esModule",{value:!0});var o=function(){function e(t){if((0,r.default)(this,e),e.symbols[t])return e.symbols[t];this._name=t,e.symbols[t]=this}return(0,i.default)(e,[{key:"name",get:function(){return this._name}},{key:"toString",value:function(){return"Symbol(".concat(this.name,")")}}]),e}();o.symbols={},t.default=o},7765:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(40361)),o=r(n(7583)),l=r(n(18582)),s=r(n(80655)),u=r(n(20497)),c=r(n(75244)),d=r(n(68748)),f=r(n(47053));function h(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}(0,d.default)(t,"__esModule",{value:!0});var v=function(e){(0,s.default)(n,e);var t=h(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments)).tagName="span",e._tagLines=[],e._currentTagLine="",e}return(0,o.default)(n,[{key:"put",value:function(e,t){(0,l.default)((0,c.default)(n.prototype),"put",this).call(this,e);for(var a=e.split("\n");a.length;){var r,i,o,s=a.shift();this._currentTagLine+=t?(0,f.default)(r=(0,f.default)(i=(0,f.default)(o="<".concat(this.tagName,' class="')).call(o,t,'">')).call(i,s.split(" ").join("&nbsp;"),"</")).call(r,this.tagName,">"):s,a.length&&this.endLine()}}},{key:"endLine",value:function(){this._currentLine.length&&((0,l.default)((0,c.default)(n.prototype),"endLine",this).call(this),this._tagLines.push(this._currentTagLine),this._currentTagLine="")}},{key:"string",get:function(){return this._tagLines.join("<br>")}}]),n}(n(84504).default);t.default=v},96950:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(40361)),o=r(n(7583)),l=r(n(18582)),s=r(n(80655)),u=r(n(20497)),c=r(n(75244));function d(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}(0,r(n(68748)).default)(t,"__esModule",{value:!0}),n(15961);var f=function(e){(0,s.default)(n,e);var t=d(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return(0,o.default)(n,[{key:"connectedCallback",value:function(){(0,l.default)((0,c.default)(n.prototype),"connectedCallback",this).call(this),this.addEventListener("mouseenter",this),this.addEventListener("mouseleave",this)}},{key:"handleEvent",value:function(e){if("mouseenter"===e.type)return this._details&&this._details.remove(),void(this._details=null);this._details&&this.appendChild(this._details)}},{key:"disconnectedCallback",value:function(){(0,l.default)((0,c.default)(n.prototype),"disconnectedCallback",this).call(this),this.removeEventListener("mouseover",this),this.removeEventListener("mouseenter",this),this.removeEventListener("mouseleave",this)}},{key:"point",get:function(){return this._point},set:function(e){this._point=e}},{key:"tile",get:function(){return this._tile},set:function(e){this._tile=e}},{key:"sound",get:function(){return this._sound},set:function(e){this._sound=e}}]),n}(n(88607).Component);f.tagName="wf-action-editor-token",t.default=f},31123:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(40361)),o=r(n(7583)),l=r(n(18582)),s=r(n(80655)),u=r(n(20497)),c=r(n(75244)),d=r(n(68748)),f=r(n(35983)),h=r(n(68190));function v(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}(0,d.default)(t,"__esModule",{value:!0}),n(82027);var p=n(88607),y=n(94381),m=n(17766),_=n(76500),g=function(e){(0,s.default)(n,e);var t=v(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments))._currentPreviewFrame=0,e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){(0,l.default)((0,c.default)(n.prototype),"connectedCallback",this).call(this),this._rebuild()}},{key:"_rebuild",value:function(){if(this.isConnected){this.textContent="";var e=this.render();this._framePreview=e.querySelector(y.default.tagName),this.appendChild(e)}}},{key:"render",value:function(){var e,t,n,a=this,r=this.weapons||[],i=this.sounds||[],o=this.tiles||[],l=this._character||{reference:-1,health:-1,damage:-1,type:m.Char.Type.Hero,movementType:m.Char.MovementType.None,frames:[null,null,null]},s=l.reference,u=l.health,c=l.damage,d=l.type,v=l.movementType,p=l.frames;return WebFun.JSX.render("div",null,WebFun.JSX.render(y.default,{frame:p[this._currentPreviewFrame],palette:this._palette,tiles:o,onchange:function(e){var t=e.detail,n=t.idx,r=t.tile;return a._character.frames[a._currentPreviewFrame%3].tiles[n]=r}}),WebFun.JSX.render("button",{onclick:function(){return a._framePreview.frame=a._character.frames[++a._currentPreviewFrame%3]}},"Step"),WebFun.JSX.render("label",null,WebFun.JSX.render("span",null,"Type:"),WebFun.JSX.render("select",{className:"type",onchange:function(e){var t=e.currentTarget.value.parseInt();a._character.type=m.Char.Type.fromNumber(t),a._character.reference=-1,a._rebuild()}},(0,f.default)(e=(0,h.default)(t=m.Char.Type.knownTypes).call(t,(function(e){return e}))).call(e,(function(e){return WebFun.JSX.render("option",{value:e.rawValue.toString(),selected:d===e},e.name)})))),WebFun.JSX.render("label",null,WebFun.JSX.render("span",null,"Move:"),WebFun.JSX.render("select",{className:"movement-type",value:v.rawValue.toString(),onchange:function(e){var t=e.currentTarget.value.parseInt();a._character.movementType=m.Char.MovementType.fromNumber(t),a._rebuild()}},(0,f.default)(n=m.Char.MovementType.knownTypes).call(n,(function(e){return WebFun.JSX.render("option",{value:e.rawValue.toString(),selected:e===v},e.name)})))),WebFun.JSX.render("label",null,WebFun.JSX.render("span",null,"Damage:"),WebFun.JSX.render("input",{type:"text",onchange:function(e){var t=e.currentTarget;return a._character.damage=t.value.parseInt()},value:c.toString()})),WebFun.JSX.render("label",null,WebFun.JSX.render("span",null,"Health:"),WebFun.JSX.render("input",{type:"text",onchange:function(e){var t=e.currentTarget;return a._character.health=t.value.parseInt()},value:u.toString()})),WebFun.JSX.render("div",{style:{height:"10px"}}),WebFun.JSX.render("label",null,WebFun.JSX.render("span",null,"Reference:")),WebFun.JSX.render("label",null,WebFun.JSX.render("span",null),WebFun.JSX.render("div",{className:"tile"}),WebFun.JSX.render("select",{className:"weapon",disabled:d!==m.Char.Type.Hero&&d!==m.Char.Type.Enemy,onchange:function(e){var t=e.currentTarget;a._character.reference=t.value.parseInt(),a._rebuild()}},WebFun.JSX.render("option",{value:"-1"},"None"),(0,f.default)(r).call(r,(function(e){return WebFun.JSX.render("option",{value:e.id.toString(),selected:(d===m.Char.Type.Hero||d===m.Char.Type.Enemy)&&s===e.id},e.id," ",e.name)})))),WebFun.JSX.render("label",null,WebFun.JSX.render("span",null," "),WebFun.JSX.render("select",{className:"sound",disabled:d!==m.Char.Type.Weapon,onchange:function(e){var t=e.currentTarget;a._character.reference=t.value.parseInt(),a._rebuild()}},WebFun.JSX.render("option",{value:"-1"},"None"),(0,f.default)(i).call(i,(function(e,t){return WebFun.JSX.render("option",{value:"".concat(t),selected:d===m.Char.Type.Weapon&&s===t},t," ",e)})))))}},{key:"disconnectedCallback",value:function(){this.textContent="",(0,l.default)((0,c.default)(n.prototype),"disconnectedCallback",this).call(this)}},{key:"palette",get:function(){return this._palette},set:function(e){this._palette=e,this._rebuild()}},{key:"character",get:function(){return this._character},set:function(e){e instanceof _.MutableChar||(e=new _.MutableChar(e)),this._character=e,this._currentPreviewFrame=0,this._rebuild()}},{key:"sounds",get:function(){return this._sounds},set:function(e){this._sounds=e,this._rebuild()}},{key:"weapons",get:function(){return this._weapons},set:function(e){this._weapons=e,this._rebuild()}},{key:"tiles",get:function(){return this._tiles},set:function(e){this._tiles=e,this._rebuild()}}]),n}(p.Component);g.tagName="wf-character-details",g.observedAttributes=[],t.default=g},94381:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(40361)),o=r(n(7583)),l=r(n(18582)),s=r(n(80655)),u=r(n(20497)),c=r(n(75244)),d=r(n(68748)),f=r(n(42601));function h(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}(0,d.default)(t,"__esModule",{value:!0}),n(94742);var v=n(88607),p=n(20999),y=function(e){(0,s.default)(n,e);var t=h(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments)).onchange=function(){},e._pickers=8..times((function(t){return WebFun.JSX.render(p.default,{onchange:function(n){var a=n.currentTarget;return e.dispatchEvent(new CustomEvent("change",{detail:{idx:t,tile:a.tile}}))}})})),e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){var e,t=this;(0,l.default)((0,c.default)(n.prototype),"connectedCallback",this).call(this),(0,f.default)(e=this._pickers).call(e,(function(e){return t.appendChild(e)})),this._rebuild()}},{key:"disconnectedCallback",value:function(){this.textContent="",(0,l.default)((0,c.default)(n.prototype),"disconnectedCallback",this).call(this)}},{key:"_rebuild",value:function(){var e,t=this._frame?this._frame.tiles:8..times((function(){return null}));(0,f.default)(e=this._pickers).call(e,(function(e,n){return e.tile=t[n]}))}},{key:"tiles",get:function(){return this._pickers.first().tiles},set:function(e){var t;(0,f.default)(t=this._pickers).call(t,(function(t){return t.tiles=e}))}},{key:"palette",get:function(){return this._pickers[0].palette},set:function(e){var t;(0,f.default)(t=this._pickers).call(t,(function(t){return t.palette=e}))}},{key:"frame",get:function(){return this._frame},set:function(e){this._frame=e,this._rebuild()}}]),n}(v.Component);y.tagName="wf-character-frame-preview",y.observedAttributes=[],t.default=y},6735:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(40361)),o=r(n(7583)),l=r(n(18582)),s=r(n(80655)),u=r(n(20497)),c=r(n(75244)),d=r(n(68748)),f=r(n(42601));function h(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}(0,d.default)(t,"__esModule",{value:!0}),n(39906);var v=n(5008),p=n(79586),y=function(e){(0,s.default)(n,e);var t=h(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments)).onremove=function(e){},e}return(0,o.default)(n,[{key:"cloneNode",value:function(e){var t=(0,l.default)((0,c.default)(n.prototype),"cloneNode",this).call(this,e);return t.palette=this.palette,t.onclick=this.onclick,t.onchange=this.onchange,t.onremove=this.onremove,t}},{key:"connectedCallback",value:function(){var e,t=this,n=this.data.frames[0].extensionRight;(0,f.default)(e=[WebFun.JSX.render(p.default,{palette:this.palette,tile:n}),WebFun.JSX.render(v.IconButton,{className:"fa fa-remove",onclick:function(){return t.onremove(new CustomEvent("remove",{detail:{cell:t}}))}}),WebFun.JSX.render("div",{className:"text"},WebFun.JSX.render("span",{className:"id"},this.data.id.toString()),WebFun.JSX.render(v.Label,{className:"name",onchange:function(e){return t.dispatchEvent(new CustomEvent("change",{detail:{cell:t,name:e.target.textContent}}))},maxLength:15},this.data.name))]).call(e,(function(e){return t.appendChild(e)}))}}]),n}(v.Cell);y.tagName="wf-character-inspector-cell",y.observedAttributes=[],t.default=y},68274:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(94433)),o=r(n(40361)),l=r(n(7583)),s=r(n(18582)),u=r(n(80655)),c=r(n(20497)),d=r(n(75244)),f=r(n(68748)),h=r(n(47053));function v(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,c.default)(this,n)}}(0,f.default)(t,"__esModule",{value:!0}),n(78719);var p=n(31560),y=n(14284),m=n(88607),_=n(5008),g=function(e){(0,u.default)(n,e);var t=v(n);function n(){var e;return(0,o.default)(this,n),(e=t.call(this))._color=new p.Color(255,255,255,1),e._buildWheel(),e._buildBrightnessSlider(),e._buildRGBFields(),e._buildColorPreview(),e}return(0,l.default)(n,[{key:"connectedCallback",value:function(){(0,s.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this);var e=document.createElement(_.Group.tagName);e.appendChild(this._wheel),e.appendChild(this._brightnessInput),this.appendChild(e),this.appendChild(this._redInput.parentElement),this.appendChild(this._greenInput.parentElement),this.appendChild(this._blueInput.parentElement),this.appendChild(this._rgbPreview),this.color=this._color}},{key:"disconnectedCallback",value:function(){this.textContent="",(0,s.default)((0,d.default)(n.prototype),"disconnectedCallback",this).call(this)}},{key:"_buildColorPreview",value:function(){this._rgbPreview=document.createElement("div"),this._rgbPreview.classList.add("preview")}},{key:"_buildWheel",value:function(){var e=this;this._wheel=document.createElement(y.default.tagName),this._wheel.style.height="100px",this._wheel.style.width="100px",this._wheel.onchange=function(){e.color=e._wheel.color,e.dispatchEvent(new CustomEvent("change"))}}},{key:"_buildBrightnessSlider",value:function(){var e=this;this._brightnessInput=document.createElement("input"),this._brightnessInput.type="range",this._brightnessInput.min="0",this._brightnessInput.max="255",this._brightnessInput.onchange=function(t){return e._updateBrightness(+e._brightnessInput.value/255)},this._brightnessInput.oninput=function(t){return e._updateBrightness(+e._brightnessInput.value/255)}}},{key:"_updateBrightness",value:function(e){this._wheel.adjustBrightness(e),this._color=new p.Color(this._wheel.color),this.updateState(),this.dispatchEvent(new CustomEvent("change"))}},{key:"_buildRGBFields",value:function(){this._redInput=this._buildInput("R"),this._greenInput=this._buildInput("G"),this._blueInput=this._buildInput("B")}},{key:"_buildInput",value:function(e){var t=this,n=document.createElement("label");n.appendChild(document.createTextNode(e));var a=document.createElement("input");return a.type="number",a.max="255",a.min="0",a.onchange=function(){return t._buildColorFromRGBs()},n.appendChild(a),a}},{key:"_buildColorFromRGBs",value:function(){var e,t;this.color=(0,h.default)(e=(0,h.default)(t="rgb(".concat(this._redInput.value,", ")).call(t,this._greenInput.value,", ")).call(e,this._blueInput.value,")"),this.dispatchEvent(new CustomEvent("change"))}},{key:"attributeChangedCallback",value:function(e,t,n){"color"===e&&t!==n&&(this.color=n)}},{key:"updateState",value:function(){var e,t,n=(0,i.default)(this._color.rgbComponents,3),a=n[0],r=n[1],o=n[2];this._redInput.value="".concat(a),this._greenInput.value="".concat(r),this._blueInput.value="".concat(o),this._rgbPreview.style.backgroundColor=(0,h.default)(e=(0,h.default)(t="rgb(".concat(a,",")).call(t,r,",")).call(e,o,")")}},{key:"color",get:function(){return this._color},set:function(e){this._color=new p.Color(e);var t=(0,i.default)(this._color.hsvComponents,3)[2];this._brightnessInput.value="".concat(Math.round(255*t)),this._wheel.setAttribute("color","".concat(this._color)),this.updateState()}}]),n}(m.Component);g.tagName="wf-color-picker",g.observedAttributes=["color"],t.default=g},14284:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(94433)),o=r(n(40361)),l=r(n(7583)),s=r(n(80655)),u=r(n(20497)),c=r(n(75244));function d(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}(0,r(n(68748)).default)(t,"__esModule",{value:!0}),n(3532);var f=n(31560),h=function(e){(0,s.default)(n,e);var t=d(n);function n(){var e;return(0,o.default)(this,n),(e=t.call(this)).size=new f.Size(100,100),e.radius=e.size.width/2,e._crosshairColor=f.rgba(0,0,0,.9),e._interactionInProgress=!1,e._canvas=document.createElement("canvas"),e._crosshair=document.createElement("canvas"),e._crosshair.width=30,e._crosshair.height=30,e._crosshair.style.width="15px",e._crosshair.style.height="15px",e.color=new f.Color(0,0,0,0),e}return(0,l.default)(n,[{key:"connectedCallback",value:function(){this.appendChild(this._canvas),this.appendChild(this._crosshair),this.drawCrosshair(),this.update(),this.addEventListener("mousedown",this)}},{key:"update",value:function(){if(this.isConnected){var e=this._canvas.getContext("2d"),t=this.size.scaleBy(window.devicePixelRatio);this._image||(this.style.width="".concat(this.size.width,"px"),this.style.height="".concat(this.size.height,"px"),this._canvas.style.width="".concat(this.size.width,"px"),this._canvas.style.height="".concat(this.size.height,"px"),this._canvas.width=t.width,this._canvas.height=t.height,this._image=this.createColorWheelImage(e,t)),e.clearRect(0,0,t.width,t.height),e.putImageData(this._image,0,0),e.fillStyle=f.rgba(0,0,0,1-this._brightness),e.fillRect(0,0,t.width,t.height),this._crosshair.style.filter=this._brightness<=.5?"invert()":""}}},{key:"handleEvent",value:function(e){var t=this;if(e instanceof MouseEvent){"mousedown"===e.type&&(this._interactionInProgress=!0,document.addEventListener("mousemove",this),document.addEventListener("mouseup",this)),"mouseup"===e.type&&(f.dispatch((function(){return t._interactionInProgress=!1})),document.removeEventListener("mousemove",this),document.removeEventListener("mouseup",this));var n=this.getBoundingClientRect(),a=e.clientX-n.left,r=e.clientY-n.top;this._moveCrosshair(a,r),e.preventDefault(),e.stopImmediatePropagation()}}},{key:"_moveCrosshair",value:function(e,t){var n=f.xy2polar(e-this.size.width/2,t-this.size.height/2),a=(0,i.default)(n,2),r=a[0],o=a[1];r=Math.min(r/this.radius,1),this._hue=f.rad2deg(o),this._saturation=r,this._moveCrosshairToCurrentColor(),this.dispatchEvent(new Event("change"))}},{key:"_moveCrosshairToCurrentColor",value:function(){var e=f.polar2xy(this._saturation*this.radius,f.deg2rad(this._hue)),t=(0,i.default)(e,2),n=t[0],a=t[1];this._crosshair.style.left=n+this.size.width/2-7.5+"px",this._crosshair.style.top=a+this.size.height/2-7.5+"px"}},{key:"createColorWheelImage",value:function(e,t){for(var n=t.width/2,a=t.width,r=t.height,o=2*n,l=e.createImageData(a,r),s=l.data,u=(a-o)/2,c=(a-o)/2,d=0;d<r;d++)for(var h=0;h<a;h++){var v=h-n-u,p=d-n-c,y=f.xy2polar(v,p),m=(0,i.default)(y,2),_=m[0],g=m[1];if(!(_>n)){var w=f.hsv2rgb(f.rad2deg(g),_/n,1),b=(0,i.default)(w,3),k=b[0],S=b[1],C=b[2],x=d*a+h;s[4*x]=k,s[4*x+1]=S,s[4*x+2]=C,s[4*x+3]=255}}return l}},{key:"drawCrosshair",value:function(){var e=this._crosshair.getContext("2d");e.strokeStyle=this._crosshairColor,e.beginPath(),e.ellipse(15,15,11,11,0,0,2*Math.PI),e.moveTo(0,15),e.lineTo(30,15),e.moveTo(15,0),e.lineTo(15,30),e.stroke()}},{key:"disconnectedCallback",value:function(){this._canvas.remove(),this.removeEventListener("mousedown",this),this.textContent=""}},{key:"attributeChangedCallback",value:function(e,t,n){"color"===e&&(this.color=n)}},{key:"adjustBrightness",value:function(e){e!==this._brightness&&(this._brightness=e,this.update())}},{key:"color",get:function(){return f.Color.FromHSV(this._hue,this._saturation,this._brightness)},set:function(e){var t=this,n=new f.Color(e),a=(0,i.default)(n.hsvComponents,3),r=a[0],o=a[1],l=a[2];if(this._hue=r,this._saturation=o,l!==this._brightness&&(this._brightness=l,this.update()),!this._interactionInProgress){this._crosshair.classList.add("animated");this._crosshair.addEventListener("transitionend",(function e(){t._crosshair.classList.remove("animated"),t._crosshair.removeEventListener("transitionend",e)}))}this._moveCrosshairToCurrentColor()}}]),n}(n(88607).Component);h.tagName="wf-color-wheel",h.observedAttributes=["color"],t.default=h},24677:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(40361)),o=r(n(7583)),l=r(n(80655)),s=r(n(20497)),u=r(n(75244));function c(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,u.default)(e);if(t){var i=(0,u.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}(0,r(n(68748)).default)(t,"__esModule",{value:!0}),n(24744);var d=function(e){(0,l.default)(n,e);var t=c(n);function n(){var e;return(0,i.default)(this,n),(e=t.call(this)).onexpand=function(){return null},e.oncollapse=function(){return null},e.ontoggle=function(){return null},e.element=null,e.icon="chevron-right",e.onclick=function(){return e.toggle()},e}return(0,o.default)(n,[{key:"toggle",value:function(){this.expandableElement.classList.contains("expanded")?this.collapse():this.expand()}},{key:"expand",value:function(){this.expandableElement.classList.contains("expanded")||(this.expandableElement.classList.add("expanded"),this.onexpand instanceof Function&&this.onexpand(),this.ontoggle instanceof Function&&this.ontoggle())}},{key:"collapse",value:function(){this.expandableElement.classList.contains("expanded")&&(this.expandableElement.classList.remove("expanded"),this.oncollapse instanceof Function&&this.oncollapse(),this.ontoggle instanceof Function&&this.ontoggle())}},{key:"expandableElement",get:function(){return this.element||this.parentElement}}]),n}(n(5008).AbstractIconButton);d.tagName="wf-editor-expand-button",t.default=d},99670:(e,t,n)=>{"use strict";var a=n(38468)(n(68748));(0,a.default)(t,"__esModule",{value:!0}),t.TileLayer=t.ZoneInspectorCell=t.ZoneEditorWindow=t.ZoneEditorView=t.ZoneEditorTool=t.ZoneEditorSidebarLayerCell=t.ZoneEditorSidebarLayer=t.ZoneEditorSidebarCell=t.ZoneEditorSidebar=t.ZoneEditorAction=t.TilePickerCell=t.TilePicker=t.SymbolicCoverage=t.SourceLevelCoverage=t.SoundInspectorCell=t.PuzzleInspectorCell=t.PopoverTilePicker=t.PopoverCharacterPicker=t.PopoutTilePicker=t.PaletteImageEditor=t.PaletteColorPicker=t.MonsterLayerMonster=t.MonsterLayer=t.HotspotLayer=t.ExpandButton=t.ColorWheel=t.ColorPicker=t.CharacterInspectorCell=t.CharacterFramePreview=t.CharacterDetails=t.ActionEditorToken=t.ActionEditor=void 0;var r=n(8775);t.SoundInspectorCell=r.default;var i=n(9007);t.PaletteImageEditor=i.default;var o=n(66605);t.PaletteColorPicker=o.default;var l=n(68274);t.ColorPicker=l.default;var s=n(14284);t.ColorWheel=s.default;var u=n(18150);t.ZoneInspectorCell=u.default;var c=n(6735);t.CharacterInspectorCell=c.default;var d=n(31123);t.CharacterDetails=d.default;var f=n(94381);t.CharacterFramePreview=f.default;var h=n(24677);t.ExpandButton=h.default;var v=n(51140);t.PuzzleInspectorCell=v.default;var p=n(27726);t.TilePicker=p.default;var y=n(16301);t.TilePickerCell=y.default;var m=n(20999);t.PopoverTilePicker=m.default;var _=n(12139);t.PopoutTilePicker=_.default;var g=n(19629);t.PopoverCharacterPicker=g.default;var w=n(80254);t.SourceLevelCoverage=w.default;var b=n(81623);t.SymbolicCoverage=b.default;var k=n(12604);(0,a.default)(t,"ZoneEditorAction",{enumerable:!0,get:function(){return k.Action}}),(0,a.default)(t,"HotspotLayer",{enumerable:!0,get:function(){return k.HotspotLayer}}),(0,a.default)(t,"MonsterLayer",{enumerable:!0,get:function(){return k.MonsterLayer}}),(0,a.default)(t,"MonsterLayerMonster",{enumerable:!0,get:function(){return k.MonsterLayerMonster}}),(0,a.default)(t,"ZoneEditorSidebar",{enumerable:!0,get:function(){return k.Sidebar}}),(0,a.default)(t,"ZoneEditorSidebarCell",{enumerable:!0,get:function(){return k.SidebarCell}}),(0,a.default)(t,"ZoneEditorSidebarLayer",{enumerable:!0,get:function(){return k.SidebarLayer}}),(0,a.default)(t,"ZoneEditorSidebarLayerCell",{enumerable:!0,get:function(){return k.SidebarLayersCell}}),(0,a.default)(t,"TileLayer",{enumerable:!0,get:function(){return k.TileLayer}}),(0,a.default)(t,"ZoneEditorTool",{enumerable:!0,get:function(){return k.Tool}}),(0,a.default)(t,"ZoneEditorView",{enumerable:!0,get:function(){return k.View}}),(0,a.default)(t,"ZoneEditorWindow",{enumerable:!0,get:function(){return k.Window}});var S=n(64730);(0,a.default)(t,"ActionEditor",{enumerable:!0,get:function(){return S.Editor}}),(0,a.default)(t,"ActionEditorToken",{enumerable:!0,get:function(){return S.Token}})},66605:(e,t,n)=>{"use strict";var a,r=n(79406),i=n(38468),o=i(n(94433)),l=i(n(40361)),s=i(n(7583)),u=i(n(18582)),c=i(n(80655)),d=i(n(20497)),f=i(n(75244)),h=i(n(68748)),v=i(n(35983));function p(e){var t=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,f.default)(e);if(t){var i=(0,f.default)(this).constructor;n=r(a,arguments,i)}else n=a.apply(this,arguments);return(0,d.default)(this,n)}}(0,h.default)(t,"__esModule",{value:!0}),n(86568);var y=n(31560),m=n(15695),_=n(17725),g=(0,v.default)(a=new Uint8Array(256)).call(a,(function(e,t){return t})),w=function(e){(0,c.default)(n,e);var t=p(n);function n(){var e;return(0,l.default)(this,n),(e=t.call(this)).highlighter=WebFun.JSX.render("div",{className:"highlighter"}),e._colorIndex=0,e.image=g,e}return(0,s.default)(n,[{key:"connectedCallback",value:function(){(0,u.default)((0,f.default)(n.prototype),"connectedCallback",this).call(this),this.addEventListener("mousedown",this),this.appendChild(this.highlighter)}},{key:"handleEvent",value:function(e){if(1===e.which){"mouseup"===e.type&&(document.removeEventListener("mousemove",this),document.removeEventListener("mouseup",this));var t=new y.Point(e.clientX,e.clientY),n=this.getBoundingClientRect(),a=n.width,r=n.height,i=n.top,o=n.left,l=new y.Rectangle(new y.Point(o,i),new y.Size(a,r));if(l.contains(t)){"mousedown"===e.type&&(document.addEventListener("mousemove",this),document.addEventListener("mouseup",this));var s=t.subtract(l.origin).dividedBy(this.pixelSize).floor();if(new y.Rectangle(new y.Point(0,0),this.size).contains(s)){var u=s.x+s.y*this.size.width;e.preventDefault(),e.stopPropagation(),u!==this._colorIndex&&(this._colorIndex=u,this._highlightCurrentColor(),this.dispatchEvent(new CustomEvent("change")))}}}}},{key:"disconnectedCallback",value:function(){document.removeEventListener("mousemove",this),document.removeEventListener("mouseup",this),this.removeEventListener("mousedown",this),this.highlighter.remove(),(0,u.default)((0,f.default)(n.prototype),"disconnectedCallback",this).call(this)}},{key:"_moveHighlightTo",value:function(e){var t=this.pixelSize,n=t.width,a=t.height;this.highlighter.style.width="".concat(n+2,"px"),this.highlighter.style.height="".concat(a+2,"px"),this.highlighter.style.left="".concat(n*e.x-1,"px"),this.highlighter.style.top="".concat(a*e.y-1,"px")}},{key:"color",get:function(){var e=this.palette[this._colorIndex];return new y.Color(e>>16&255,e>>8&255,255&e,0===this._colorIndex?0:1)},set:function(e){this._colorIndex=this._findColorIndex(new y.Color(e)),this._highlightCurrentColor()}},{key:"colorIndex",get:function(){return this._colorIndex}},{key:"updateCurrentColor",value:function(e){var t=this.palette,n=this._colorIndex,a=(0,o.default)(new y.Color(e).rgbaComponents,4);t[4*n+2]=a[0],t[4*n+1]=a[1],t[4*n+0]=a[2],t[4*n+3]=a[3],this.redraw(new y.Point(this._colorIndex%this.size.width,_.floor(this._colorIndex/this.size.width)))}},{key:"_highlightCurrentColor",value:function(){if(this.palette&&this.image){if(-1===this._colorIndex)return this.highlighter.style.opacity="0",this._moveHighlightTo(new y.Point(0,0)),void(this._colorIndex=0);var e=this._findPositionForColorIndex(this._colorIndex);e?(this.highlighter.style.opacity="1",this._moveHighlightTo(e)):console.warn("color",this._colorIndex,"could not be found")}}},{key:"_findColorIndex",value:function(e){for(var t=this.palette,n=(0,o.default)(e.rgbaComponents,4),a=n[0],r=n[1],i=n[2],l=n[3],s=0;s<t.length;s+=4)if(a===t[s+2]&&r===t[s+1]&&i===t[s+0]&&l===t[s+3])return s;return-1}},{key:"_findPositionForColorIndex",value:function(e){for(var t=0;t<this.size.height;t++)for(var n=0;n<this.size.width;n++){var a=t*this.size.width+n;if(this.image[a]===e)return new y.Point(n,t)}return null}}]),n}(m.AbstractPaletteView);w.tagName="wf-editor-palette-color-picker",t.default=w},9007:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(40361)),o=r(n(7583)),l=r(n(18582)),s=r(n(80655)),u=r(n(20497)),c=r(n(75244));function d(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}(0,r(n(68748)).default)(t,"__esModule",{value:!0}),n(64969);var f=n(31560),h=function(e){(0,s.default)(n,e);var t=d(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments)).colorIndex=0,e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){(0,l.default)((0,c.default)(n.prototype),"connectedCallback",this).call(this),this.addEventListener("mousedown",this)}},{key:"handleEvent",value:function(e){if(1===e.which){"mouseup"===e.type&&(document.removeEventListener("mousemove",this),document.removeEventListener("mouseup",this));var t=new f.Point(e.clientX,e.clientY),n=this.getBoundingClientRect(),a=n.width,r=n.height,i=n.top,o=n.left,l=new f.Rectangle(new f.Point(o,i),new f.Size(a,r));if(l.contains(t)){"mousedown"===e.type&&(document.addEventListener("mousemove",this),document.addEventListener("mouseup",this));var s=t.subtract(l.origin).dividedBy(this.pixelSize).floor();if(new f.Rectangle(new f.Point(0,0),this.size).contains(s)){var u=s.x+s.y*this.size.width;this.image[u]=this.colorIndex,e.preventDefault(),e.stopPropagation(),this.dispatchEvent(new CustomEvent("change")),this.redraw(s)}}}}},{key:"disconnectedCallback",value:function(){document.removeEventListener("mousemove",this),document.removeEventListener("mouseup",this),this.removeEventListener("mousedown",this),(0,l.default)((0,c.default)(n.prototype),"disconnectedCallback",this).call(this)}}]),n}(n(15695).AbstractPaletteView);h.tagName="wf-editor-palette-image-editor",t.default=h},12139:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(40361)),o=r(n(7583)),l=r(n(80655)),s=r(n(20497)),u=r(n(75244));function c(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,u.default)(e);if(t){var i=(0,u.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}(0,r(n(68748)).default)(t,"__esModule",{value:!0}),n(14713);var d=function(e){(0,l.default)(n,e);var t=c(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return(0,o.default)(n,[{key:"pickerOnChange",value:function(e,t){this.tile=t.detail.tile,this.dispatchEvent(new CustomEvent("change",{detail:{tile:this.tile},bubbles:!0}))}}]),n}(n(14157).default);d.tagName="wf-resource-editor-popout-tile-picker",t.default=d},19629:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(40361)),o=r(n(7583)),l=r(n(80655)),s=r(n(20497)),u=r(n(75244)),c=r(n(68748)),d=r(n(35983));function f(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,u.default)(e);if(t){var i=(0,u.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}(0,c.default)(t,"__esModule",{value:!0});var h=function(e){(0,l.default)(n,e);var t=f(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return(0,o.default)(n,[{key:"pickerOnChange",value:function(e,t){this.character=this._characters[t.detail.index],this.dispatchEvent(new CustomEvent("change",{detail:{character:this.character},bubbles:!0}))}},{key:"characters",get:function(){return this._characters},set:function(e){this._characters=e,this.tiles=(0,d.default)(e).call(e,(function(e){return e.frames[0].extensionRight}))}},{key:"character",get:function(){return this._character},set:function(e){this._character=e,this.tile=e?e.frames[0].extensionRight:null}}]),n}(n(87800).default);h.tagName="wf-resource-editor-popover-character-picker",t.default=h},20999:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(40361)),o=r(n(7583)),l=r(n(80655)),s=r(n(20497)),u=r(n(75244));function c(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,u.default)(e);if(t){var i=(0,u.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}(0,r(n(68748)).default)(t,"__esModule",{value:!0}),n(14109);var d=function(e){(0,l.default)(n,e);var t=c(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return(0,o.default)(n,[{key:"pickerOnChange",value:function(e,t){this.tile=t.detail.tile,this.dispatchEvent(new CustomEvent("change",{detail:{tile:this.tile},bubbles:!0}))}}]),n}(n(87800).default);d.tagName="wf-resource-editor-popover-tile-picker",t.default=d},51140:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(40361)),o=r(n(7583)),l=r(n(18582)),s=r(n(80655)),u=r(n(20497)),c=r(n(75244)),d=r(n(68748)),f=r(n(47053));function h(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}(0,d.default)(t,"__esModule",{value:!0}),n(51850);var v=n(5008),p=n(99670),y=function(e){(0,s.default)(n,e);var t=h(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return(0,o.default)(n,[{key:"cloneNode",value:function(e){var t=(0,l.default)((0,c.default)(n.prototype),"cloneNode",this).call(this,e);return t.palette=this.palette,t.tiles=this.tiles,t}},{key:"connectedCallback",value:function(){this.build()}},{key:"disconnectedCallback",value:function(){this.textContent=""}},{key:"build",value:function(){var e,t,n=this,a=this.data.strings;this.appendChild(WebFun.JSX.render("div",null,WebFun.JSX.render(p.PopoutTilePicker,{tile:this.data.item1,tiles:this.tiles,palette:this.palette,onchange:function(e){return n.changeTile(0,e)}}),WebFun.JSX.render(p.PopoutTilePicker,{tile:this.data.item2,tiles:this.tiles,palette:this.palette,onchange:function(e){return n.changeTile(1,e)}}),WebFun.JSX.render("div",{className:"title"},(0,f.default)(e=(0,f.default)(t="".concat(this.data.id.toHex(2)," ")).call(t,this.data.name,"\n\t\t\t")).call(e,this.data.type.name)),WebFun.JSX.render("div",{className:"unknowns"},WebFun.JSX.render("div",null,this.data.item1Class.name),WebFun.JSX.render("div",null,this.data.item2Class.name),WebFun.JSX.render("div",null,this.data.unknown3.toHex(2))),WebFun.JSX.render("div",{className:"dialogs"},WebFun.JSX.render("div",{className:"dialog"},WebFun.JSX.render("span",{className:"s s1"},"ask"),WebFun.JSX.render(v.Label,{onchange:function(e){return n.changeText(0,e)}},"".concat(a[0]))),WebFun.JSX.render("div",{className:"dialog"},WebFun.JSX.render("span",{className:"s s2"},"thx"),WebFun.JSX.render(v.Label,{onchange:function(e){return n.changeText(1,e)}},"".concat(a[1]))),WebFun.JSX.render("div",{className:"dialog"},WebFun.JSX.render("span",{className:"s s3"},"offer"),WebFun.JSX.render(v.Label,{onchange:function(e){return n.changeText(2,e)}},"".concat(a[2]))),WebFun.JSX.render("div",{className:"dialog"},WebFun.JSX.render("span",{className:"s s4"},"mission"),WebFun.JSX.render(v.Label,{onchange:function(e){return n.changeText(3,e)}},"".concat(a[3]))),WebFun.JSX.render("div",{className:"dialog"},WebFun.JSX.render("span",{className:"s s5"},"unused"),WebFun.JSX.render(v.Label,{onchange:function(e){return n.changeText(4,e)}},"".concat(a[4]))))))}},{key:"changeText",value:function(e,t){this.data.strings[e]=t.target.textContent}},{key:"changeTile",value:function(e,t){var n=t.target.tile,a=this.data;0===e?a.item1=n:a.item2=n}}]),n}(v.Cell);y.tagName="wf-puzzle-inspector-cell",y.observedAttributes=[],t.default=y},8775:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(40361)),o=r(n(7583)),l=r(n(6060)),s=r(n(18582)),u=r(n(80655)),c=r(n(20497)),d=r(n(75244));function f(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,c.default)(this,n)}}(0,r(n(68748)).default)(t,"__esModule",{value:!0}),n(82388);var h=n(5008),v=n(37572),p=function(e){(0,u.default)(n,e);var t=f(n);function n(){var e;return(0,i.default)(this,n),(e=t.call(this)).onchange=function(){},e.onrevealreferences=function(){},e.onremove=function(){},e._playing=!1,e._id=WebFun.JSX.render("span",{className:"id"}),e._file=WebFun.JSX.render(h.Label,{className:"file",onchange:function(t){return e.onchange(new CustomEvent("change",{detail:{sound:e.data,cell:(0,l.default)(e),label:e._file.textContent},bubbles:!0}))}}),e._play=WebFun.JSX.render("span",{className:"play"}),e._playButton=WebFun.JSX.render("i",{className:"fa fa-play-circle",onclick:function(){return e.togglePlaying()}}),e._play.appendChild(e._playButton),e._revealButton=WebFun.JSX.render("i",{className:"fa fa-search",onclick:function(){return e.onrevealreferences(new CustomEvent("RevealReferences",{detail:{sound:e.data,cell:(0,l.default)(e)},bubbles:!0}))}}),e._play.appendChild(e._revealButton),e._removeButton=WebFun.JSX.render("i",{className:"fa fa-remove",onclick:function(){return e.onremove(new CustomEvent("Remove",{detail:{sound:e.data,cell:(0,l.default)(e)},bubbles:!0}))}}),e._play.appendChild(e._removeButton),e}return(0,o.default)(n,[{key:"cloneNode",value:function(e){var t=(0,s.default)((0,d.default)(n.prototype),"cloneNode",this).call(this,e);return t.onchange=this.onchange,t.onrevealreferences=this.onrevealreferences,t.onremove=this.onremove,t}},{key:"connectedCallback",value:function(){this._id.textContent="".concat(this.data.id),this.appendChild(this._id),this._file.textContent="".concat(this.data.file),this.appendChild(this._file),this.appendChild(this._play)}},{key:"togglePlaying",value:function(){var e=this;if(!this._sound){var t=[JSON.parse('[{"title":"Yoda Stories from archive.org","variant":"yoda","sfx-format":"wav","exe":"https://cors.archive.org/download/Star_Wars_-_Yoda_Stories_1997_LucasArts/Star%20Wars%20-%20Yoda%20Stories%20%281997%29%28LucasArts%29.iso/Yoda%2FYodesk.exe","sfx":"https://cors.archive.org/download/Star_Wars_-_Yoda_Stories_1997_LucasArts/Star%20Wars%20-%20Yoda%20Stories%20%281997%29%28LucasArts%29.iso/Yoda%2Fsfx%2F","data":"https://cors.archive.org/download/Star_Wars_-_Yoda_Stories_1997_LucasArts/Star%20Wars%20-%20Yoda%20Stories%20%281997%29%28LucasArts%29.iso/Yoda%2Fyodesk.dta","help":"https://cors.archive.org/download/Star_Wars_-_Yoda_Stories_1997_LucasArts/Star%20Wars%20-%20Yoda%20Stories%20%281997%29%28LucasArts%29.iso/Yoda%2FYodesk.hlp"},{"title":"Yoda Stories Demo (archive.org)","variant":"yoda-demo","sfx-format":"wav","exe":"https://cors.archive.org/download/StarWarsYodaStories_1020/YodaDemo.zip/YodaDemo%2FYodaDemo.exe","sfx":"https://archive.org/download/StarWarsYodaStories_1020/YodaDemo.zip/YodaDemo%2Fsfx%2F","data":"https://cors.archive.org/download/StarWarsYodaStories_1020/YodaDemo.zip/YodaDemo%2FYodaDemo.dta","help":"https://cors.archive.org/download/StarWarsYodaStories_1020/YodaDemo.zip/YodaDemo%2FYodaDemo.hlp"}]')[0].sfx,v.encodeURIComponent(this.data.file)].join("/");return this._sound=new Audio(t),this._sound.autoplay=!0,this._playButton.classList.remove("fa-play-circle"),this._playButton.classList.remove("fa-pause-circle"),this._playButton.classList.add("fa-spinner"),this._sound.onplay=function(){e._playing=!0,e._playButton.classList.remove("fa-play-circle"),e._playButton.classList.remove("fa-spinner"),e._playButton.classList.add("fa-pause-circle")},void(this._sound.onended=function(){e._playing=!1,e._playButton.classList.add("fa-play-circle"),e._playButton.classList.remove("fa-pause-circle")})}this._sound.readyState===HTMLMediaElement.HAVE_ENOUGH_DATA&&(this._playing?this._sound.pause():(this._sound.currentTime=0,this._playing=!0,this._sound.play(),this._playButton.classList.add("fa-pause-circle")))}},{key:"label",get:function(){return this._file.textContent}}]),n}(h.Cell);p.tagName="wf-sound-inspector-cell",p.observedAttributes=[],t.default=p},80254:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(94433)),o=r(n(40361)),l=r(n(7583)),s=r(n(18582)),u=r(n(80655)),c=r(n(20497)),d=r(n(75244)),f=r(n(68748)),h=r(n(7273)),v=r(n(35983)),p=r(n(6978)),y=r(n(47053)),m=r(n(55903)),_=r(n(41870));function g(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,c.default)(this,n)}}(0,f.default)(t,"__esModule",{value:!0}),n(99302);var w=n(88607),b=n(31560);function k(e){return function(t,n){return t[e]-n[e]}}function S(e){return(100*e).toFixed(2).replace(".00","")+"%"}function C(e){return e.toString()}function x(e){return isNaN(e)||e>.75?"high":e>.5?"medium":"low"}var T="sort-column",I="sort-inverted",W=function(e){(0,u.default)(n,e);var t=g(n);function n(){var e;return(0,o.default)(this,n),(e=t.call(this))._state=new b.DiscardingStorage,e._coverage=null,e._invertSortDescriptor=!1,e._columns=[["",k("zone")],["Total",k("total")],["",k("total")],["Actions",k("actions")],["",k("actionsTotal")],["Conditions",k("conditions")],["",k("conditionsTotal")],["Instructions",k("instructions")],["",k("instructionsTotal")]],e._sortDescriptor=e._columns[0][1],e}return(0,l.default)(n,[{key:"connectedCallback",value:function(){(0,s.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this),this.rebuild()}},{key:"disconnectedCallback",value:function(){this.firstElementChild.remove(),this.firstElementChild.remove(),(0,s.default)((0,d.default)(n.prototype),"disconnectedCallback",this).call(this)}},{key:"rebuild",value:function(){this.isConnected&&(this.textContent="",this.appendChild(this.renderOverview()),this.appendChild(this.renderCoverageTable()))}},{key:"renderOverview",value:function(){var e,t,n,a,r,i,o,l=(0,h.default)(e=this.datapoints).call(e,(function(e,t){return e+(t.actionsCovered>0?1:0)}),0),s=this.datapoints.length,u=(0,h.default)(t=this.datapoints).call(t,(function(e,t){return e+t.actionsCovered}),0),c=(0,h.default)(n=this.datapoints).call(n,(function(e,t){return e+t.actionsTotal}),0),d=(0,h.default)(a=this.datapoints).call(a,(function(e,t){return e+t.instructionsCovered}),0),f=(0,h.default)(r=this.datapoints).call(r,(function(e,t){return e+t.instructionsTotal}),0),v=(0,h.default)(i=this.datapoints).call(i,(function(e,t){return e+t.conditionsCovered}),0),p=(0,h.default)(o=this.datapoints).call(o,(function(e,t){return e+t.conditionsTotal}),0);return WebFun.JSX.render("div",null,WebFun.JSX.render("span",null,WebFun.JSX.render("span",{className:"percentage"},S(l/s))," Zones"," ",WebFun.JSX.render("span",{className:"details"},C(l),"/",C(s))),WebFun.JSX.render("span",null,WebFun.JSX.render("span",{className:"percentage"},S(u/c))," Actions"," ",WebFun.JSX.render("span",{className:"details"},C(u),"/",C(c))),WebFun.JSX.render("span",null,WebFun.JSX.render("span",{className:"percentage"},S(v/p))," Conditions"," ",WebFun.JSX.render("span",{className:"details"},C(v),"/",C(p))),WebFun.JSX.render("span",null,WebFun.JSX.render("span",{className:"percentage"},S(d/f))," ","Instructions"," ",WebFun.JSX.render("span",{className:"details"},C(d),"/",C(f))))}},{key:"renderCoverageTable",value:function(){var e,t,n,a=this;return WebFun.JSX.render("table",null,WebFun.JSX.render("thead",null,WebFun.JSX.render("tr",null,(0,v.default)(e=this._columns).call(e,(function(e){var t=(0,i.default)(e,2),n=t[0],r=t[1];return WebFun.JSX.render("th",{className:""===n?"extend-previous-cell":"",onclick:function(){return a.sortDescriptor=r}},n)})))),WebFun.JSX.render("tbody",null,(0,v.default)(t=(0,p.default)(n=this.datapoints).call(n,this.sortDescriptor)).call(t,(function(e){return a.row(e)}))))}},{key:"datapoints",get:function(){var e,t=this;return this._datapoints||(this._datapoints=(0,v.default)(e=this.data.currentData.zones).call(e,(function(e){var n,a=(0,v.default)(n=e.actions).call(n,(function(n,a){var r;return t._coverage.actions[(0,y.default)(r="".concat(e.id,"_")).call(r,a)]})),r=e.actions.length,i=(0,h.default)(a).call(a,(function(e,t){var n,a;return e+((0,m.default)(n=t.conditions).call(n,(function(e){return e>0}))||(0,m.default)(a=t.instructions).call(a,(function(e){return e>0}))?1:0)}),0),o=0===e.actions.length?1:i/e.actions.length,l=(0,h.default)(a).call(a,(function(e,t){return e+t.conditions.length}),0),s=(0,h.default)(a).call(a,(function(e,t){var n,a;return e+(0,h.default)(n=(0,v.default)(a=t.conditions).call(a,(function(e){return e>0?1:0}))).call(n,(function(e,t){return e+t}),0)}),0),u=0===l?1:s/l,c=(0,h.default)(a).call(a,(function(e,t){return e+t.instructions.length}),0),d=(0,h.default)(a).call(a,(function(e,t){var n,a;return e+(0,h.default)(n=(0,v.default)(a=t.instructions).call(a,(function(e){return e>0?1:0}))).call(n,(function(e,t){return e+t}),0)}),0),f=0===c?1:d/c;return{zone:e.id,actionsTotal:r,actionsCovered:i,actions:o,conditionsTotal:l,conditionsCovered:s,conditions:u,instructionsTotal:c,instructionsCovered:d,instructions:f,total:(o+u+f)/3}}))),this._datapoints}},{key:"row",value:function(e){return WebFun.JSX.render("tr",null,WebFun.JSX.render("td",{className:x(e.total)},"Zone ",e.zone.toString()),WebFun.JSX.render("td",{className:x(e.total)},WebFun.JSX.render("div",{className:"bar-chart"},WebFun.JSX.render("div",{style:{width:(100*e.total).toFixed(2)+"%"}}))),WebFun.JSX.render("td",{className:"center "+x(e.total)},S(e.total)),WebFun.JSX.render("td",{className:"center "+x(e.actions)},S(e.actions)),WebFun.JSX.render("td",{className:"center "+x(e.actions)},C(e.actionsCovered),"/",C(e.actionsTotal)),WebFun.JSX.render("td",{className:"center "+x(e.conditions)},S(e.conditions)),WebFun.JSX.render("td",{className:"center "+x(e.conditions)},C(e.conditionsCovered),"/",C(e.conditionsTotal)),WebFun.JSX.render("td",{className:"center "+x(e.instructions)},S(e.instructions)),WebFun.JSX.render("td",{className:"center "+x(e.instructions)},C(e.instructionsCovered),"/",C(e.instructionsTotal)))}},{key:"sortDescriptor",get:function(){var e=this;return this._invertSortDescriptor?function(t,n){return-1*e._sortDescriptor(t,n)}:this._sortDescriptor},set:function(e){var t;this._sortDescriptor===e?this._invertSortDescriptor=!this._invertSortDescriptor:this._invertSortDescriptor=!1,this._sortDescriptor=e,this._state.store(T,(0,_.default)(t=this._columns).call(t,(function(t){var n=(0,i.default)(t,2),a=(n[0],n[1]);return e===a}))),this._state.store(I,this._invertSortDescriptor),this.rebuild()}},{key:"coverage",get:function(){return this._coverage},set:function(e){this._coverage=e}},{key:"state",get:function(){return this._state},set:function(e){var t,n,a;this._state=e;var r=null!==(t=e.load(T))&&void 0!==t?t:0,i=null!==(n=this._columns[r])&&void 0!==n?n:this._columns.first();this._sortDescriptor=i[1],this._invertSortDescriptor=null!==(a=e.load(I))&&void 0!==a&&a,this.rebuild()}}]),n}(w.Component);W.tagName="wf-editor-source-level-coverage",W.observedAttributes=[],t.default=W},81623:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(94433)),o=r(n(40361)),l=r(n(7583)),s=r(n(18582)),u=r(n(80655)),c=r(n(20497)),d=r(n(75244)),f=r(n(68748)),h=r(n(5459)),v=r(n(7273)),p=r(n(35983)),y=r(n(6978)),m=r(n(67093)),_=r(n(95753)),g=r(n(3350)),w=r(n(47053)),b=r(n(41870));function k(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,c.default)(this,n)}}(0,f.default)(t,"__esModule",{value:!0}),n(25815);var S=n(88607),C=n(83608),x=n(31560),T="sort-column",I="sort-inverted";function W(e){return function(t,n){var a=t[e],r=n[e];return"string"==typeof a?a.localeCompare(r):a-r}}var F=function(e){(0,u.default)(n,e);var t=k(n);function n(){var e;return(0,o.default)(this,n),(e=t.call(this))._state=new x.DiscardingStorage,e._coverage=null,e._invertSortDescriptor=!1,e._columns=[["Type",W("type")],["Opcode",W("opcode")],["Name",W("name")],["Hits",W("hits")],["Description",W("description")]],e._sortDescriptor=e._columns[0][1],e}return(0,l.default)(n,[{key:"connectedCallback",value:function(){(0,s.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this),this.rebuild()}},{key:"disconnectedCallback",value:function(){this.firstElementChild.remove(),this.firstElementChild.remove(),(0,s.default)((0,d.default)(n.prototype),"disconnectedCallback",this).call(this)}},{key:"rebuild",value:function(){this.isConnected&&(this.textContent="",this.appendChild(this.renderOverview()),this.appendChild(this.renderCoverageTable()))}},{key:"renderOverview",value:function(){var e,t;function n(e){return(100*x.clamp(0,e,1)).toFixed(2).replace(".00","")+"%"}function a(e){return e.toString()}var r=(0,h.default)(this.coverage.instructions).length,i=(0,v.default)(e=(0,h.default)(this.coverage.instructions)).call(e,(function(e,t){return e+(t>0?1:0)}),0),o=(0,h.default)(this.coverage.conditions).length,l=(0,v.default)(t=(0,h.default)(this.coverage.conditions)).call(t,(function(e,t){return e+(t>0?1:0)}),0),s=l+i,u=r+l;return WebFun.JSX.render("div",null,WebFun.JSX.render("span",null,WebFun.JSX.render("span",{className:"percentage"},n(s/u))," Total"," ",WebFun.JSX.render("span",{className:"details"},a(s),"/",a(u))),WebFun.JSX.render("span",null,WebFun.JSX.render("span",{className:"percentage"},n(l/o))," Conditions"," ",WebFun.JSX.render("span",{className:"details"},a(l),"/",a(o))),WebFun.JSX.render("span",null,WebFun.JSX.render("span",{className:"percentage"},n(i/r))," ","Instructions"," ",WebFun.JSX.render("span",{className:"details"},a(i),"/",a(r))))}},{key:"renderCoverageTable",value:function(){var e,t,n,a=this;return WebFun.JSX.render("table",null,WebFun.JSX.render("thead",null,WebFun.JSX.render("tr",null,(0,p.default)(e=this._columns).call(e,(function(e){var t=(0,i.default)(e,2),n=t[0],r=t[1];return WebFun.JSX.render("th",{className:""===n?"extend-previous-cell":"",onclick:function(){return a.sortDescriptor=r}},n)})))),WebFun.JSX.render("tbody",null,(0,p.default)(t=(0,y.default)(n=this.datapoints).call(n,this.sortDescriptor)).call(t,(function(e){return a.row(e)}))))}},{key:"datapoints",get:function(){var e,t;if(this._datapoints)return this._datapoints;this._datapoints=[];var n=function(e,t,n){return function(a){var r,o,l=(0,i.default)(a,2),s=l[0],u=l[1];return{type:e,hits:u,opcode:+s,name:(0,m.default)(r=(0,_.default)(t)).call(r,(function(e){return t[e].Opcode===+s})),description:null!==(o=n[+s].Description)&&void 0!==o?o:""}}},a=(0,p.default)(e=(0,g.default)(this._coverage.conditions)).call(e,n("Condition",C.ConditionsByName,C.ConditionsByOpcode)),r=(0,p.default)(t=(0,g.default)(this._coverage.instructions)).call(t,n("Instruction",C.InstructionsByName,C.InstructionsByOpcode));return this._datapoints=(0,w.default)(a).call(a,r)}},{key:"row",value:function(e){var t=this;function n(e){return e>.75?"high":e>.5?"medium":"low"}return WebFun.JSX.render("tr",{onclick:function(){return t.logZonesUsing(e.opcode,e.type)}},WebFun.JSX.render("td",{className:n(e.hits)},e.type),WebFun.JSX.render("td",{className:n(e.hits)},e.opcode.toHex(2)),WebFun.JSX.render("td",{className:n(e.hits)},e.name),WebFun.JSX.render("td",{className:"center "+n(e.hits)},e.hits.toString()),WebFun.JSX.render("td",{className:n(e.hits)},e.description))}},{key:"logZonesUsing",value:function(e,t){}},{key:"sortDescriptor",get:function(){var e=this;return this._invertSortDescriptor?function(t,n){return-1*e._sortDescriptor(t,n)}:this._sortDescriptor},set:function(e){var t;this._sortDescriptor===e?this._invertSortDescriptor=!this._invertSortDescriptor:this._invertSortDescriptor=!1,this._sortDescriptor=e,this._state.store(T,(0,b.default)(t=this._columns).call(t,(function(t){var n=(0,i.default)(t,2),a=(n[0],n[1]);return e===a}))),this._state.store(I,this._invertSortDescriptor),this.rebuild()}},{key:"coverage",get:function(){return this._coverage},set:function(e){this._coverage=e}},{key:"state",get:function(){return this._state},set:function(e){var t,n,a;this._state=e;var r=null!==(t=e.load(T))&&void 0!==t?t:0,i=null!==(n=this._columns[r])&&void 0!==n?n:this._columns.first();this._sortDescriptor=i[1],this._invertSortDescriptor=null!==(a=e.load(I))&&void 0!==a&&a,this.rebuild()}}]),n}(S.Component);F.tagName="wf-editor-symbolic-coverage",F.observedAttributes=[],t.default=F},87853:(e,t,n)=>{"use strict";var a=n(38468),r=a(n(40361)),i=a(n(7583)),o=a(n(68748)),l=a(n(35983)),s=a(n(16825));(0,o.default)(t,"__esModule",{value:!0});var u=function(){function e(){(0,r.default)(this,e),this._cache={}}return(0,i.default)(e,[{key:"prepareListSearch",value:function(e){var t;return(0,l.default)(t=e.split(" ")).call(t,(function(e){return new RegExp(e,"i")}))}},{key:"includeListItem",value:function(e,t){if(!t)return!0;var n=this._stringForTile(t);return(0,s.default)(e).call(e,(function(e){return e.test(n)}))}},{key:"_stringForTile",value:function(e){var t=this._cache[e.id];if(t)return t;for(var n=[e.name,"".concat(e.id)],a=0;a<32;a++)e.attributes&1<<a&&n.push("bit-".concat(a,"."));return this._cache[e.id]=n.join(" ")}}]),e}();t.default=u},16301:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(40361)),o=r(n(7583)),l=r(n(18582)),s=r(n(80655)),u=r(n(20497)),c=r(n(75244));function d(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}(0,r(n(68748)).default)(t,"__esModule",{value:!0}),n(36510);var f=n(5008),h=n(79586),v=function(e){(0,s.default)(n,e);var t=d(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments)).view=WebFun.JSX.render(h.default,null),e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){(0,l.default)((0,c.default)(n.prototype),"connectedCallback",this).call(this),this.appendChild(this.view)}},{key:"disconnectedCallback",value:function(){this.view.remove(),(0,l.default)((0,c.default)(n.prototype),"disconnectedCallback",this).call(this)}},{key:"cloneNode",value:function(e){var t=(0,l.default)((0,c.default)(n.prototype),"cloneNode",this).call(this,e);return t.palette=this.palette,t.onclick=this.onclick,t}},{key:"data",get:function(){return this.view.tile},set:function(e){this.view.tile=e}},{key:"palette",get:function(){return this.view.palette},set:function(e){this.view.palette=e}}]),n}(f.Cell);v.tagName="wf-tile-picker-cell",v.observedAttributes=[],t.default=v},27726:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(40361)),o=r(n(7583)),l=r(n(18582)),s=r(n(80655)),u=r(n(20497)),c=r(n(75244)),d=r(n(68748)),f=r(n(75356)),h=r(n(92915)),v=r(n(31920));function p(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}(0,d.default)(t,"__esModule",{value:!0}),t.Events=void 0,n(32547);var y=n(88607),m=n(87853),_=n(16301),g=n(5008);t.Events={TileDidChange:"TileDidChange"};var w=function(e){(0,s.default)(a,e);var n=p(a);function a(){var e;return(0,i.default)(this,a),(e=n.call(this))._tiles=null,e._tile=null,e._list=WebFun.JSX.render(g.List,{searchDelegate:new m.default,cell:WebFun.JSX.render(_.default,{onclick:function(t){var n=t.currentTarget;return e._cellClicked(n)}})}),e._list.showBar(!0),e}return(0,o.default)(a,[{key:"connectedCallback",value:function(){if((0,l.default)((0,c.default)(a.prototype),"connectedCallback",this).call(this),this.appendChild(this._list),this.tile){var e=this.findCellForTile(this.tile),t=this._list.querySelector(_.default.tagName+".active");if(t&&t.classList.remove("active"),!e)return;this.tile=e.data,e.classList.add("active")}}},{key:"findCellForTile",value:function(e){for(var t=this._list.querySelectorAll(_.default.tagName),n=0,a=t.length;n<a;n++)if(t[n].data===e)return t[n];return null}},{key:"_cellClicked",value:function(e){var t,n=this._list.querySelector(_.default.tagName+".active");n&&n.classList.remove("active"),e&&(this.tile=e.data,this.changeTile(this.tile,(0,f.default)(t=this._list.querySelectorAll(_.default.tagName)).call(t,e)-1),e.classList.add("active"))}},{key:"changeTile",value:function(e,n){this.tile=e,this.dispatchEvent(new CustomEvent(t.Events.TileDidChange,{detail:{tile:e,index:n},bubbles:!0})),this.dispatchEvent(new CustomEvent("change",{detail:{tile:e,index:n},bubbles:!0}))}},{key:"disconnectedCallback",value:function(){this._list.remove(),(0,l.default)((0,c.default)(a.prototype),"disconnectedCallback",this).call(this)}},{key:"tiles",get:function(){return this._tiles},set:function(e){this._tiles=e;var t=(0,h.default)(e).call(e);(0,v.default)(t).call(t,0,0,null),this._list.items=t}},{key:"palette",get:function(){return this._list.cell.palette},set:function(e){this._list.cell.palette=e}},{key:"tile",get:function(){return this._tile},set:function(e){this._tile=e}},{key:"state",get:function(){return this._list.state},set:function(e){this._list.state=e.prefixedWith("list")}},{key:"updateTile",value:function(e){var t=this.findCellForTile(e);t&&(t.data=e)}}]),a}(y.Component);w.tagName="wf-tile-picker",w.observedAttributes=[],t.default=w},26146:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(40361)),o=r(n(7583)),l=r(n(80655)),s=r(n(20497)),u=r(n(75244));function c(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,u.default)(e);if(t){var i=(0,u.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}(0,r(n(68748)).default)(t,"__esModule",{value:!0}),n(18048);var d=function(e){(0,l.default)(n,e);var t=c(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return(0,o.default)(n,[{key:"action",get:function(){return this._action},set:function(e){var t=this;this._action=e,this.title=this._action.name,this.className="fa",this._action.icon&&this.classList.add(this._action.icon),this.onclick=function(){return t._action.command()}}}]),n}(n(88607).Component);d.tagName="wf-zone-editor-action",t.default=d},27434:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(63789)),o=r(n(76108)),l=r(n(61822)),s=r(n(40361)),u=r(n(7583)),c=r(n(80655)),d=r(n(20497)),f=r(n(75244)),h=r(n(68748)),v=r(n(42601)),p=r(n(47053)),y=r(n(35983)),m=r(n(68190));function _(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,f.default)(e);if(t){var i=(0,f.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,d.default)(this,n)}}(0,h.default)(t,"__esModule",{value:!0}),n(24165);var g=n(17766),w=n(88607),b=n(76500),k=n(83722),S=n(48387),C=n(31560),x=n(11251),T=function(e){(0,c.default)(n,e);var t=_(n);function n(){return(0,s.default)(this,n),t.apply(this,arguments)}return(0,u.default)(n,[{key:"connectedCallback",value:function(){this.updater=this.di.get(x.Updater),this.draw()}},{key:"update",value:function(e){this.draw()}},{key:"draw",value:function(){var e,t=this;this._zone&&(this.textContent="",(0,v.default)(e=this._zone.hotspots.groupedBy((function(e){return e.location}))).call(e,(function(e){var n=e.length,a=e[0],r=a.x,i=a.y;return t.appendChild(t.buildNode(new C.Point(r,i),n))})))}},{key:"buildNode",value:function(e,t){return WebFun.JSX.render("div",{className:"wf-hotspot-layer-hotspot",style:{left:"".concat(e.x*g.Tile.WIDTH,"px"),top:"".concat(e.y*g.Tile.HEIGHT,"px")}},t>1?"".concat(t):"")}},{key:"zone",get:function(){return this._zone},set:function(e){this._zone=e,this.style.width=e.size.width*g.Tile.WIDTH+"px",this.style.height=e.size.height*g.Tile.HEIGHT+"px",this.isConnected&&this.draw()}},{key:"getMenuForTile",value:function(e){var t,n=this,a=this._findHotspotsAt(e);return(0,p.default)(t=[{title:"Place hotspot",callback:function(){var t=new b.MutableHotspot;t.id=n.zone.hotspots.length,t.type=b.MutableHotspot.Type.DropQuestItem,t.arg=-1,t.x=e.x,t.y=e.y,n.zone.hotspots.push(t),n.draw()}}]).call(t,(0,l.default)((0,y.default)(a).call(a,(function(e){var t,r,l;return[w.MenuItemSeparator,{title:"".concat(e.id.toString(),": ")+e.type.name+(e.enabled?"":" (disabled)")},{title:(0,p.default)(t="".concat(e.x,"x")).call(t,e.y)},{title:e.arg.toHex(2)},{title:function(){return e.enabled?"Disable":"Enable"},callback:function(){e.enabled=!e.enabled,n.draw()}},{title:"Change Argument",callback:(l=(0,o.default)(i.default.mark((function t(){var n;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,S.ModalPrompt("Set new argument",{defaultValue:e.arg.toHex(2)});case 2:if(null!==(n=t.sent)){t.next=5;break}return t.abrupt("return");case 5:e.arg=+n;case 6:case"end":return t.stop()}}),t)}))),function(){return l.apply(this,arguments)})},{title:"Change Type",callback:(r=(0,o.default)(i.default.mark((function t(){var n,a;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,S.ModalPrompt("Pick new type",{defaultValue:"".concat(e.type.rawValue),options:(0,y.default)(n=g.Hotspot.Type.knownTypes).call(n,(function(e){return{value:"".concat(e.rawValue),label:e.name}}))});case 2:if(null!==(a=t.sent)){t.next=5;break}return t.abrupt("return");case 5:e.type=g.Hotspot.Type.fromNumber(+a);case 6:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})},{title:"remove",callback:function(){n.updater.deleteItem(a[0]),n.draw()}}]})).flatten()))}},{key:"_findHotspotsAt",value:function(e){var t;return(0,m.default)(t=this.zone.hotspots).call(t,(function(t){var n=t.x,a=t.y;return n===e.x&&a===e.y}))}}]),n}(k.default);T.tagName="wf-hotspot-layer",T.observedAttributes=[],t.default=T},12604:(e,t,n)=>{"use strict";(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.MonsterLayerMonster=t.MonsterLayer=t.HotspotLayer=t.Action=t.SidebarLayersCell=t.SidebarLayer=t.SidebarCell=t.Sidebar=t.Window=t.TileLayer=t.View=t.Tool=void 0;var a=n(26146);t.Action=a.default;var r=n(27434);t.HotspotLayer=r.default;var i=n(36952);t.MonsterLayer=i.default;var o=n(9954);t.MonsterLayerMonster=o.default;var l=n(31421);t.Sidebar=l.default;var s=n(46953);t.SidebarCell=s.default;var u=n(51030);t.SidebarLayer=u.default;var c=n(78359);t.SidebarLayersCell=c.default;var d=n(32375);t.Tool=d.default;var f=n(56781);t.View=f.default;var h=n(91552);t.Window=h.default;var v=n(86780);t.TileLayer=v.default},32047:(e,t,n)=>{"use strict";var a=n(38468),r=a(n(40361));(0,a(n(68748)).default)(t,"__esModule",{value:!0});t.default=function e(){(0,r.default)(this,e)}},9954:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(40361)),o=r(n(7583)),l=r(n(18582)),s=r(n(80655)),u=r(n(20497)),c=r(n(75244));function d(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}(0,r(n(68748)).default)(t,"__esModule",{value:!0}),n(53263);var f=n(88607),h=n(78160),v=function(e){(0,s.default)(n,e);var t=d(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments)).canvas=WebFun.JSX.render("canvas",{width:32,height:32,className:"pixelated"}),e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){(0,l.default)((0,c.default)(n.prototype),"connectedCallback",this).call(this),this.character&&(this.appendChild(this.canvas),this.draw())}},{key:"draw",value:function(){var e=this.canvas.getContext("2d"),t=h.drawTileImageData(this.character.frames[0].extensionRight,this.palette);e.putImageData(t,0,0)}},{key:"disconnectedCallback",value:function(){(0,l.default)((0,c.default)(n.prototype),"disconnectedCallback",this).call(this)}}]),n}(f.Component);v.tagName="wf-monster-layer-monster",t.default=v},36952:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(63789)),o=r(n(76108)),l=r(n(61822)),s=r(n(40361)),u=r(n(7583)),c=r(n(80655)),d=r(n(20497)),f=r(n(75244)),h=r(n(68748)),v=r(n(42601)),p=r(n(47053)),y=r(n(35983)),m=r(n(67093)),_=r(n(68190));function g(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,f.default)(e);if(t){var i=(0,f.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,d.default)(this,n)}}(0,h.default)(t,"__esModule",{value:!0}),n(16472);var w=n(17766),b=n(88607),k=n(83722),S=n(48387),C=n(76500),x=n(9954),T=n(31560),I=n(11251),W=function(e){(0,c.default)(n,e);var t=g(n);function n(){var e;return(0,s.default)(this,n),(e=t.apply(this,arguments)).palette=null,e.tiles=[],e.characters=[],e._zone=null,e}return(0,u.default)(n,[{key:"connectedCallback",value:function(){this.updater=this.di.get(I.Updater),this.draw()}},{key:"update",value:function(e){this.draw()}},{key:"draw",value:function(){var e,t=this;this._zone&&(this.textContent="",(0,v.default)(e=this._zone.monsters.groupedBy((function(e){return e.position}))).call(e,(function(e){var n=e.length,a=e[0],r=a.face,i=a.position,o=i.x,l=i.y;return t.appendChild(t.buildNode(new T.Point(o,l),n,1===n?r:null))})))}},{key:"buildNode",value:function(e,t,n){return WebFun.JSX.render(x.default,{className:"wf-monster-layer-monster",style:{left:"".concat(e.x*w.Tile.WIDTH-1,"px"),top:"".concat(e.y*w.Tile.HEIGHT-1,"px")},character:n,palette:this.palette}," ",t>1?"".concat(t):""," ")}},{key:"zone",get:function(){return this._zone},set:function(e){this._zone=e,this.style.width=e.size.width*w.Tile.WIDTH+"px",this.style.height=e.size.height*w.Tile.HEIGHT+"px",this.isConnected&&this.draw()}},{key:"getMenuForTile",value:function(e){var t,n=this,a=this._findMonstersAt(e);return(0,v.default)(a).call(a,(function(e){var t;return console.log(e.id,null===(t=e.face)||void 0===t?void 0:t.name,e.loot,e.dropsLoot,e.waypoints)})),(0,p.default)(t=[{title:"Place Monster",callback:function(){var t=new C.MutableMonster;t.id=n.zone.monsters.length,t.face=n.enemies.first(),t.position=e,t.loot=-1,t.dropsLoot=!1,t.waypoints=[],n.zone.monsters.push(t),n.draw()}}]).call(t,(0,l.default)((0,y.default)(a).call(a,(function(e){var t,r,s,u;return(0,p.default)(t=[b.MenuItemSeparator,{title:"".concat(e.id.toString(),": ")+(null===(r=e.face)||void 0===r?void 0:r.name)+(e.enabled?"":" (disabled)")}]).call(t,(0,l.default)(-1!==e.loot?[{title:"Drops ".concat(e.loot?null===(s=n.tiles[e.loot])||void 0===s?void 0:s.name:"<puzzle item>")}]:[]),[{title:"Change Type",callback:(u=(0,o.default)(i.default.mark((function t(){var a,r,o,l;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,S.ModalPrompt("Pick enemy type:",{defaultValue:null===(a=e.face)||void 0===a?void 0:a.id.toString(),options:(0,y.default)(r=n.enemies).call(r,(function(e){return{label:e.name,value:e.id.toString()}}))});case 2:if(l=t.sent){t.next=5;break}return t.abrupt("return");case 5:e.face=(0,m.default)(o=n.enemies).call(o,(function(e){return e.id===+l})),n.draw();case 7:case"end":return t.stop()}}),t)}))),function(){return u.apply(this,arguments)})},{title:function(){return e.enabled?"Disable":"Enable"},callback:function(){e.enabled=!e.enabled}},{title:"Remove",callback:function(){n.updater.deleteItem(a[0]),n.draw()}}])})).flatten()))}},{key:"_findMonstersAt",value:function(e){var t;return(0,_.default)(t=this.zone.monsters).call(t,(function(t){var n=t.position,a=n.x,r=n.y;return a===e.x&&r===e.y}))}},{key:"enemies",get:function(){return this.characters.withType(w.Char.Type.Enemy)}}]),n}(k.default);W.tagName="wf-monster-layer",W.observedAttributes=[],t.default=W},46953:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(40361)),o=r(n(7583)),l=r(n(6060)),s=r(n(18582)),u=r(n(80655)),c=r(n(20497)),d=r(n(75244));function f(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,c.default)(this,n)}}(0,r(n(68748)).default)(t,"__esModule",{value:!0}),n(60097);var h=n(83722),v=n(24677),p=n(5008),y=function(e){(0,u.default)(n,e);var t=f(n);function n(){var e;return(0,i.default)(this,n),(e=t.call(this))._header=document.createElement("header"),e._header.appendChild(document.createElement("span")),e._expandButton=document.createElement(v.default.tagName),e._expandButton.element=(0,l.default)(e),e._expandButton.ontoggle=function(){return e._state.store("expanded",e.classList.contains("expanded"))},e._header.appendChild(e._expandButton),e._newButton=document.createElement(p.IconButton.tagName),e._newButton.icon="plus-circle",e._newButton.style.display="none",e._newButton.onclick=function(){return e.newItemCallback()},e._header.appendChild(e._newButton),e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){(0,s.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this),this.insertBefore(this._header,this.firstElementChild)}},{key:"disconnectedCallback",value:function(){this._header.remove(),(0,s.default)((0,d.default)(n.prototype),"disconnectedCallback",this).call(this)}},{key:"name",get:function(){return this._header.firstElementChild.textContent},set:function(e){this._header.firstElementChild.textContent=e}},{key:"state",get:function(){return this._state},set:function(e){this._state=e,e.load("expanded")&&this._expandButton.expand()}},{key:"clear",value:function(){this.textContent="",this.appendChild(this._header)}},{key:"newItemCallback",get:function(){return this._newItemCallback},set:function(e){this._newItemCallback=e,this._newButton.style.display=e?"":"none"}}]),n}(h.default);y.tagName="wf-zone-editor-sidebar-cell",t.default=y},51030:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(40361)),o=r(n(7583)),l=r(n(18582)),s=r(n(80655)),u=r(n(20497)),c=r(n(75244));function d(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}(0,r(n(68748)).default)(t,"__esModule",{value:!0}),t.Event=void 0,n(5244);var f=n(18583);t.Event={DidToggleVisibility:"DidToggleVisibility",DidToggleLock:"DidToggleLock"};var h=function(e){(0,s.default)(a,e);var n=d(a);function a(){var e;return(0,i.default)(this,a),(e=n.call(this))._name=document.createElement("span"),e._visible=document.createElement("i"),e._visible.onclick=function(n){e.data.visible=!e.data.visible,e.dispatchEvent(new CustomEvent(t.Event.DidToggleVisibility,{detail:{layer:e.data},bubbles:!0})),e.rebuild(),n.preventDefault(),n.stopImmediatePropagation()},e._locked=document.createElement("i"),e._locked.onclick=function(n){e.dispatchEvent(new CustomEvent(t.Event.DidToggleLock,{detail:{layer:e.data},bubbles:!0})),e.data.locked=!e.data.locked,e.rebuild(),n.preventDefault(),n.stopImmediatePropagation()},e}return(0,o.default)(a,[{key:"connectedCallback",value:function(){(0,l.default)((0,c.default)(a.prototype),"connectedCallback",this).call(this),this.appendChild(this._name),this.appendChild(this._locked),this.appendChild(this._visible),this.rebuild()}},{key:"cloneNode",value:function(e){var t=(0,l.default)((0,c.default)(a.prototype),"cloneNode",this).call(this,e);return t.onclick=this.onclick,t}},{key:"rebuild",value:function(){this._name.textContent=this.data.name,this._visible.className="fa",this.data.visible?this._visible.classList.add("fa-eye"):this._visible.classList.add("fa-eye-slash"),this._locked.className="fa",this.data.locked?this._locked.classList.add("fa-lock"):this._locked.classList.add("fa-unlock-alt")}},{key:"disconnectedCallback",value:function(){(0,l.default)((0,c.default)(a.prototype),"disconnectedCallback",this).call(this),this.textContent=""}}]),a}(f.default);h.Event=t.Event,h.tagName="wf-zone-editor-sidebar-layer",t.default=h},78359:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(40361)),o=r(n(7583)),l=r(n(18582)),s=r(n(80655)),u=r(n(20497)),c=r(n(75244)),d=r(n(68748)),f=r(n(42601));function h(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}(0,d.default)(t,"__esModule",{value:!0}),t.Events=void 0,n(31464);var v=n(83722),p=n(32047),y=n(5008),m=n(15436),_=n(51030),g=n(91552),w=n(17766);t.Events={LayerDidChange:"LayerDidChange"};var b=function(e){(0,s.default)(a,e);var n=h(a);function a(){var e;return(0,i.default)(this,a),(e=n.call(this))._list=document.createElement(y.List.tagName),e._list.cell=document.createElement(_.default.tagName),e._list.cell.onclick=function(t){return e.activateLayerForCell(t.currentTarget)},e._buildLayers(),e._list.items=e._layers,e}return(0,o.default)(a,[{key:"_buildLayers",value:function(){this._layers=[];var e=new p.default;e.id=-1,e.name="Hotspots",e.visible=!0,e.locked=!1,this._layers.push(e);var t=new p.default;t.id=-2,t.name="Monsters",t.visible=!0,t.locked=!1,this._layers.push(t);var n=new p.default;n.id=w.Zone.Layer.Roof,n.name="Roof",n.visible=!0,n.locked=!1,this._layers.push(n);var a=new p.default;a.id=w.Zone.Layer.Object,a.name="Objects",a.visible=!0,a.locked=!1,this._layers.push(a);var r=new p.default;r.id=w.Zone.Layer.Floor,r.name="Floor",r.visible=!0,r.locked=!1,this._layers.push(r)}},{key:"connectedCallback",value:function(){(0,l.default)((0,c.default)(a.prototype),"connectedCallback",this).call(this),this.appendChild(this._list),this._registerShortcuts()}},{key:"disconnectedCallback",value:function(){this._list.remove(),(0,l.default)((0,c.default)(a.prototype),"disconnectedCallback",this).call(this),this._unregisterShortcuts()}},{key:"_registerShortcuts",value:function(){var e=this;this._shortcuts=[];var t=this.closest(g.default.tagName),n=m.default.sharedManager;this._shortcuts.push(n.registerShortcut((function(){return e.activateLayer(4)}),{ctrlKey:!0,keyCode:53,node:t})),this._shortcuts.push(n.registerShortcut((function(){return e.activateLayer(3)}),{ctrlKey:!0,keyCode:52,node:t})),this._shortcuts.push(n.registerShortcut((function(){return e.activateLayer(2)}),{ctrlKey:!0,keyCode:51,node:t})),this._shortcuts.push(n.registerShortcut((function(){return e.activateLayer(1)}),{ctrlKey:!0,keyCode:50,node:t})),this._shortcuts.push(n.registerShortcut((function(){return e.activateLayer(0)}),{ctrlKey:!0,keyCode:49,node:t})),this._shortcuts.push(n.registerShortcut((function(){return e._toggleVisibility()}),{ctrlKey:!0,keyCode:188})),this._shortcuts.push(n.registerShortcut((function(){return e._toggleLock()}),{ctrlKey:!0,keyCode:190}))}},{key:"_unregisterShortcuts",value:function(){var e;(0,f.default)(e=this._shortcuts).call(e,(function(e){return m.default.sharedManager.unregisterShortcut(e)})),this._shortcuts=[]}},{key:"_toggleVisibility",value:function(){this._toggle(["i.fa-eye","i.fa-eye-slash"].join(","))}},{key:"_toggleLock",value:function(){this._toggle(["i.fa-lock","i.fa-unlock-alt"].join(","))}},{key:"_toggle",value:function(e){var t=this.activeLayer;if(t){var n=t.querySelector(e);n&&n.onclick(new MouseEvent("click"))}}},{key:"activeLayer",get:function(){return this.querySelector(_.default.tagName+".active")}},{key:"activateLayer",value:function(e){var t=this._list.querySelectorAll(_.default.tagName)[e];t.classList.contains("active")||this.activateLayerForCell(t)}},{key:"activateLayerForCell",value:function(e){var n=this._list.querySelector(_.default.tagName+".active");n&&n.classList.remove("active"),e.classList.add("active");var a=e.data;this.dispatchEvent(new CustomEvent(t.Events.LayerDidChange,{detail:{layer:a},bubbles:!0}))}}]),a}(v.default);b.tagName="wf-zone-editor-sidebar-layers-cell",t.default=b},31421:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(40361)),o=r(n(7583)),l=r(n(80655)),s=r(n(20497)),u=r(n(75244)),c=r(n(68748)),d=r(n(42601)),f=r(n(68190)),h=r(n(69159));function v(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,u.default)(e);if(t){var i=(0,u.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}(0,c.default)(t,"__esModule",{value:!0}),n(55634);var p=n(83722),y=n(46953),m=function(e){(0,l.default)(n,e);var t=v(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return(0,o.default)(n,[{key:"addEntry",value:function(e,t,n){var a=document.createElement(y.default.tagName);return a.name=t,this.state&&(a.expanded=this.state.load("name")||!1),e instanceof HTMLElement?a.appendChild(e):(0,d.default)(e).call(e,(function(e){return a.appendChild(e)})),n&&(a.newItemCallback=n),this.appendChild(a),a}},{key:"state",get:function(){return this._state},set:function(e){var t,n=this;this._state=e;var a=(0,f.default)(t=(0,h.default)(this.children)).call(t,(function(e){return e instanceof y.default}));(0,d.default)(a).call(a,(function(e){return e.state=n.state.prefixedWith(e.name)}))}}]),n}(p.default);m.tagName="wf-zone-editor-sidebar",t.default=m},86780:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(40361)),o=r(n(7583)),l=r(n(80655)),s=r(n(20497)),u=r(n(75244)),c=r(n(68748)),d=r(n(42601));function f(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,u.default)(e);if(t){var i=(0,u.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}(0,c.default)(t,"__esModule",{value:!0}),n(40986);var h=n(17766),v=function(e){(0,l.default)(n,e);var t=f(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments))._zone=null,e._layer=null,e._canvas=WebFun.JSX.render("canvas",null),e._palette=null,e._imageData=null,e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){this.appendChild(this._canvas),this.draw()}},{key:"draw",value:function(){if(null!==this._layer&&this._zone&&this._palette){var e=this._canvas.getContext("2d");this._imageData||(this._imageData=this.drawLayer()),e.clearRect(0,0,288,288),e.putImageData(this._imageData,0,0)}}},{key:"drawLayer",value:function(){for(var e=this._layer,t=this._zone,n=this._palette,a=h.Tile.WIDTH,r=h.Tile.HEIGHT,i=t.size.width,o=t.size.height,l=new ImageData(i*a,o*r),s=new ArrayBuffer(l.data.length),u=new Uint8Array(s),c=new Uint32Array(s),d=i*a,f=0;f<o;f++)for(var v=0;v<i;v++){var p=t.getTile(v,f,e);if(p)for(var y=p.imageData,m=f*r*d+v*a,_=0;_<r;_++){for(var g=0;g<a;g++){var w=_*a+g;c[m+g]=n[y[w]]}m+=d}}return l.data.set(u),l}},{key:"_updateTile",value:function(e,t){if(this._imageData){for(var n=this._zone,a=this._palette,r=h.Tile.WIDTH,i=h.Tile.HEIGHT,o=n.size.width,l=this._imageData,s=l.data.buffer,u=new Uint8Array(s),c=new Uint32Array(s),d=o*r,f=e?e.imageData:null,v=t.y*i*d+t.x*r,p=0;p<i;p++){for(var y=0;y<r;y++){var m=p*r+y;c[v+y]=a[f?f[m]:0]}v+=d}l.data.set(u)}}},{key:"update",value:function(e){var t=this;if(null!==this._layer&&this._zone){var n=this._zone,a=this._canvas.getContext("2d");(0,d.default)(e).call(e,(function(e){var r=n.getTile(e.x,e.y,t._layer);a.clearRect(e.x,e.y,h.Tile.WIDTH,h.Tile.HEIGHT),t._updateTile(r,e)})),this.draw()}}},{key:"zone",get:function(){return this._zone},set:function(e){this._zone=e,this._canvas.width=e.size.width*h.Tile.WIDTH,this._canvas.height=e.size.height*h.Tile.HEIGHT,this._canvas.style.width=e.size.width*h.Tile.WIDTH+"px",this._canvas.style.height=e.size.height*h.Tile.HEIGHT+"px",this._imageData=null,this.isConnected&&this.draw()}},{key:"layer",get:function(){return this._layer},set:function(e){this._layer=e,this._imageData=null,this.isConnected&&this.draw()}},{key:"palette",get:function(){return this._palette},set:function(e){this._palette=e,this._imageData=null,this.isConnected&&this.draw()}},{key:"getMenuForTile",value:function(e){return[]}}]),n}(n(83722).default);v.tagName="wf-tile-layer",v.observedAttributes=[],t.default=v},32375:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(40361)),o=r(n(7583)),l=r(n(18582)),s=r(n(80655)),u=r(n(20497)),c=r(n(75244)),d=r(n(68748)),f=r(n(20778));function h(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}(0,d.default)(t,"__esModule",{value:!0}),n(8102);var v=n(56018),p=n(83722),y=n(15436),m=n(91552),_=function(e){(0,s.default)(n,e);var t=h(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments))._shortcut=null,e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){var e=this;(0,l.default)((0,c.default)(n.prototype),"connectedCallback",this).call(this);var t=function(){return e.editor.tool=e.tool};if(this.tool&&this.tool.shortcut){var a=this.closest(m.default.tagName),r=(0,f.default)({},{node:a},this.tool.shortcut);this._shortcut=y.default.sharedManager.registerShortcut(t,r)}this.classList.add("fa"),this.onclick=t}},{key:"disconnectedCallback",value:function(){this.onclick=function(){return null},this._shortcut&&y.default.sharedManager.unregisterShortcut(this._shortcut),this._shortcut=null}},{key:"handleEvent",value:function(e){e.type===v.Events.DidDeactivate&&this.removeAttribute("active"),e.type===v.Events.DidActivate&&this.setAttribute("active","")}},{key:"tool",get:function(){return this._tool},set:function(e){this._tool&&(this._tool.icon&&this.classList.remove(this._tool.icon),this._tool.removeEventListener(v.AbstractTool.Event.DidActivate,this),this._tool.removeEventListener(v.AbstractTool.Event.DidDeactivate,this)),this._tool=e,this._tool&&(this._tool.icon&&this.classList.add(this._tool.icon),this._tool.addEventListener(v.AbstractTool.Event.DidActivate,this),this._tool.addEventListener(v.AbstractTool.Event.DidDeactivate,this))}}]),n}(p.default);_.tagName="wf-zone-editor-tool",_.observedAttributes=[],t.default=_},56781:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(40361)),o=r(n(7583)),l=r(n(80655)),s=r(n(20497)),u=r(n(75244)),c=r(n(68748)),d=r(n(42601));function f(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,u.default)(e);if(t){var i=(0,u.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}(0,c.default)(t,"__esModule",{value:!0}),n(32535);var h=n(56018),v=n(83722),p=n(5008),y=n(27434),m=n(86780),_=n(36952),g=n(31560),w=n(17766),b=function(e){(0,l.default)(n,e);var t=f(n);function n(){var e;return(0,i.default)(this,n),(e=t.call(this))._hotspots=WebFun.JSX.render(y.default,null),e._monsters=WebFun.JSX.render(_.default,null),e._floor=WebFun.JSX.render(m.default,{layer:w.Zone.Layer.Floor}),e._objects=WebFun.JSX.render(m.default,{layer:w.Zone.Layer.Object}),e._roof=WebFun.JSX.render(m.default,{layer:w.Zone.Layer.Roof}),e._overlay=WebFun.JSX.render("canvas",{className:"overlay"}),e.tool=new h.NoTool,e}return(0,o.default)(n,[{key:"connectedCallback",value:function(){this.appendChild(this._floor),this.appendChild(this._objects),this.appendChild(this._roof),this.appendChild(this._hotspots),this.appendChild(this._monsters),this.appendChild(this._overlay),this._overlay.addEventListener("contextmenu",this)}},{key:"handleEvent",value:function(e){if("contextmenu"===e.type){e.preventDefault();var t=this.extractTileCoordinates(e);if(!t)return;var n=this.currentLayerNode;if(!n)return;var a=n.getMenuForTile(t);if(0===a.length)return;WebFun.JSX.render(p.ContextMenu,{menu:a}).show(new g.Point(e.clientX,e.clientY))}}},{key:"extractTileCoordinates",value:function(e){var t=this.zone,n=e.offsetIn(this).scaleBy(1/w.Tile.WIDTH).floor();return n.x<0||n.y<0||n.x>=t.size.width||n.y>=t.size.height?null:n}},{key:"disconnectedCallback",value:function(){this._overlay.removeEventListener("contextmenu",this),this._floor.remove(),this._objects.remove(),this._roof.remove(),this._hotspots.remove(),this._monsters.remove(),this._overlay.remove()}},{key:"zone",get:function(){return this._zone},set:function(e){this._tool&&this._tool.deactivate(),this._zone=e,this._floor.zone=e,this._objects.zone=e,this._roof.zone=e,this._hotspots.zone=e,this._monsters.zone=e,this._overlay.style.width=e.size.width*w.Tile.WIDTH+"px",this._overlay.style.height=e.size.height*w.Tile.HEIGHT+"px",this._overlay.width=e.size.width*w.Tile.WIDTH*window.devicePixelRatio,this._overlay.height=e.size.height*w.Tile.HEIGHT*window.devicePixelRatio,this.style.width=2+e.size.width*w.Tile.WIDTH+"px",this.style.height=2+e.size.height*w.Tile.HEIGHT+"px",this._tool&&this._tool.activate(this._zone,this._overlay)}},{key:"tool",get:function(){return this._tool},set:function(e){this._tool&&this._tool.deactivate(),this._tool=e,this._tool&&(this._tool.layer=this._currentLayer,this._tool.activate(this._zone,this._overlay))}},{key:"setLayerVisible",value:function(e,t){this.nodeForLayer(e.id).style.display=t?"":"none"}},{key:"nodeForLayer",value:function(e){return e===w.Zone.Layer.Roof?this._roof:e===w.Zone.Layer.Object?this._objects:e===w.Zone.Layer.Floor?this._floor:-1===e?this._hotspots:-2===e?this._monsters:void console.assert(!1,"Invalid layer encountered")}},{key:"currentLayerNode",get:function(){return this.currentLayer?this.nodeForLayer(this.currentLayer.id):null}},{key:"redraw",value:function(e){var t=this;(0,d.default)(e).call(e,(function(e){return t.nodeForLayer(e.z).update([e])}))}},{key:"currentLayer",get:function(){return this._currentLayer},set:function(e){this._currentLayer=e,this._tool&&(this._tool.layer=e)}},{key:"palette",get:function(){return this._floor.palette},set:function(e){this._hotspots.palette=e,this._monsters.palette=e,this._floor.palette=e,this._roof.palette=e,this._objects.palette=e}},{key:"characters",get:function(){return this._monsters.characters},set:function(e){this._monsters.characters=e}},{key:"tiles",get:function(){return this._monsters.tiles},set:function(e){this._monsters.tiles=e}},{key:"di",get:function(){return this._monsters.di},set:function(e){this._monsters.di=e,this._hotspots.di=e}}]),n}(v.default);b.tagName="wf-zone-editor-view",b.observedAttributes=[],t.default=b},91552:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(61822)),o=r(n(40361)),l=r(n(7583)),s=r(n(18582)),u=r(n(80655)),c=r(n(20497)),d=r(n(75244)),f=r(n(68748)),h=r(n(35983)),v=r(n(47053)),p=r(n(42601)),y=r(n(68190));function m(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,c.default)(this,n)}}(0,f.default)(t,"__esModule",{value:!0}),n(66554);var _=n(5008),g=n(56018),w=n(78359),b=n(65847),k=n(26146),S=n(64730),C=n(12139),x=n(31421),T=n(51030),I=n(32375),W=n(56781),F=n(7872),E=function(e){(0,u.default)(n,e);var t=m(n);function n(){var e;return(0,o.default)(this,n),(e=t.call(this))._editor=WebFun.JSX.render(W.default,null),e._sidebar=WebFun.JSX.render(x.default,null),e.pinnable=!0,e._setupSidebar(),e._editor.tool=e._tools[0],e}return(0,l.default)(n,[{key:"_setupSidebar",value:function(){var e,t,n,a=this;this._sidebar.addEventListener(T.default.Event.DidToggleVisibility,(function(e){var t=e.detail.layer;a._editor.setLayerVisible(t,t.visible)}));var r=WebFun.JSX.render(w.default,null);r.addEventListener(w.Events.LayerDidChange,(function(e){return a._editor.currentLayer=e.detail.layer})),this._sidebar.addEntry(r,"Layers"),this._tools=[new g.NoTool,new g.PencilTool,new g.RectangleTool,new g.PaintBucketTool];var o=(0,h.default)(e=this._tools).call(e,(function(e){return a._buildToolItem(e)})),l=(0,h.default)(t=[{name:"Edit Scripts",icon:"fa-code",command:function(){return a._editActions()}}]).call(t,(function(e){return a._buildActionItem(e)}));this._tilePicker=WebFun.JSX.render(C.default,{onchange:function(e){a._tilePickerTileChanged(),e.stopImmediatePropagation(),e.preventDefault()},tile:null}),this._sidebar.addEntry(WebFun.JSX.render("div",{style:{display:"flex",alignItems:"center"}},(0,v.default)(n=[this._tilePicker]).call(n,(0,i.default)(o),(0,i.default)(l))),"Tools"),this._sidebar.addEntry(WebFun.JSX.render("div",{className:"items",style:{display:"flex",flexDirection:"column"}},WebFun.JSX.render("div",null,WebFun.JSX.render("label",null,"Provided"),WebFun.JSX.render("div",null)),WebFun.JSX.render("div",null,WebFun.JSX.render("label",null,"Required"),WebFun.JSX.render("div",null,[])),WebFun.JSX.render("div",null,WebFun.JSX.render("label",null,"Goal"),WebFun.JSX.render("div",null,[])),WebFun.JSX.render("div",null,WebFun.JSX.render("label",null,"NPCs"),WebFun.JSX.render("div",null,[]))),"Items")}},{key:"connectedCallback",value:function(){(0,s.default)((0,d.default)(n.prototype),"connectedCallback",this).call(this),this.content.appendChild(this._sidebar),this.content.appendChild(this._editor)}},{key:"_tilePickerTileChanged",value:function(){var e,t,n=this._tilePicker.tile;(0,p.default)(e=(0,y.default)(t=this._tools).call(t,(function(e){return e instanceof b.default}))).call(e,(function(e){return e.tile=n}))}},{key:"show",value:function(){this._state.store("visible",!0),this.manager.showWindow(this)}},{key:"close",value:function(){(0,s.default)((0,d.default)(n.prototype),"close",this).call(this),this._state.store("visible",!1)}},{key:"canBeReused",value:function(){return!this.pinned}},{key:"_editActions",value:function(){if(!this._actionsWindow){var e=WebFun.JSX.render(_.Panel,{style:{width:"480px",maxHeight:"630px"}});e.content.appendChild(WebFun.JSX.render(S.Editor,null)),this._actionsWindow=e}var t=this._actionsWindow.content.firstElementChild;t.data=this._data.currentData,t.zone=this.zone,this._actionsWindow.title="Zone ".concat(this.zone.id,": Actions"),this.manager.showWindow(this._actionsWindow)}},{key:"_buildToolItem",value:function(e){var t=this,n=WebFun.JSX.render(I.default,{tool:e,editor:this._editor});return e.addEventListener(g.AbstractTool.Event.ChangedTiles,(function(e){return t._editor.redraw(e.affectedPoints)})),n}},{key:"_buildActionItem",value:function(e){return WebFun.JSX.render(k.default,{action:e})}},{key:"state",get:function(){return this._state},set:function(e){var t=this;this._state=e,this.pinned=e.load("pinned"),this.autosaveName=e.load("window-name")||e.store("window-name",String.UUID()),this.onpin=function(){return t._state.store("pinned",t.pinned)},this._sidebar.state=e.prefixedWith("sidebar"),e.load("visible")&&this.show()}},{key:"zone",get:function(){return this._zone},set:function(e){var t,n;this.title=(0,v.default)(t=(0,v.default)(n="Zone ".concat(e.id," (")).call(n,e.type.name,", ")).call(t,e.planet.name,")"),this.content.style.width=162+32*e.size.width+"px",this.content.style.height=2+32*e.size.height+"px",this._zone=e,this._editor.zone=e,this.rebuildItems()}},{key:"rebuildItems",value:function(){var e,t,n,a,r=this,i=this._sidebar.querySelectorAll(".items label+div");i.length&&this.zone&&(i[0].replaceWith(WebFun.JSX.render("div",null,(0,h.default)(e=this.zone.providedItems).call(e,(function(e){return WebFun.JSX.render(F.TileView,{tile:e,palette:r._editor.palette})})))),i[1].replaceWith(WebFun.JSX.render("div",null,(0,h.default)(t=this.zone.requiredItems).call(t,(function(e){return WebFun.JSX.render(F.TileView,{tile:e,palette:r._editor.palette})})))),i[2].replaceWith(WebFun.JSX.render("div",null,(0,h.default)(n=this.zone.goalItems).call(n,(function(e){return WebFun.JSX.render(F.TileView,{tile:e,palette:r._editor.palette})})))),i[3].replaceWith(WebFun.JSX.render("div",null,(0,h.default)(a=this.zone.npcs).call(a,(function(e){return WebFun.JSX.render(F.TileView,{tile:e,palette:r._editor.palette})})))))}},{key:"data",get:function(){return this._data},set:function(e){this._data=e,this._editor.palette=e.palette,this._editor.characters=e.currentData.characters,this._editor.tiles=e.currentData.tiles,this._tilePicker.palette=this._data.palette,this._tilePicker.tiles=this._data.currentData.tiles}},{key:"di",get:function(){return this._di},set:function(e){this._di=e,this._editor.di=this.di}}]),n}(_.AbstractPanel);E.tagName="wf-zone-editor-window",t.default=E},18150:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(40361)),o=r(n(7583)),l=r(n(18582)),s=r(n(80655)),u=r(n(20497)),c=r(n(75244)),d=r(n(68748)),f=r(n(35983));function h(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}(0,d.default)(t,"__esModule",{value:!0}),n(97219);var v=n(5008),p=n(17766),y=n(79586),m={RevealReferences:"RevealReferences",RemoveZone:"RemoveZone",ChangeType:"ChangeType",ChangePlanet:"ChangePlanet"},_=function(e){(0,s.default)(n,e);var t=h(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return(0,o.default)(n,[{key:"connectedCallback",value:function(){var e,t=this,n=this._tileForType(this.data.type);this.appendChild(WebFun.JSX.render(y.default,{palette:this.palette,tile:n})),this.appendChild(WebFun.JSX.render("div",{className:"content"},WebFun.JSX.render("span",{className:"id"},this.data.id.toString()),WebFun.JSX.render(v.InlineSelector,{className:"type",onchange:function(e){return t.dispatchEvent(new CustomEvent(m.ChangeType,{detail:{type:e.target.value,zone:t.data},bubbles:!0}))},options:(0,f.default)(e=[p.Zone.Type.None,p.Zone.Type.Empty,p.Zone.Type.BlockadeNorth,p.Zone.Type.BlockadeSouth,p.Zone.Type.BlockadeEast,p.Zone.Type.BlockadeWest,p.Zone.Type.UnknownIndyOnly,p.Zone.Type.TravelStart,p.Zone.Type.TravelEnd,p.Zone.Type.Room,p.Zone.Type.Load,p.Zone.Type.Goal,p.Zone.Type.Town,p.Zone.Type.Win,p.Zone.Type.Lose,p.Zone.Type.Trade,p.Zone.Type.Use,p.Zone.Type.Find,p.Zone.Type.FindUniqueWeapon]).call(e,(function(e){return{value:e,label:e===p.Zone.Type.Empty&&t.data.hasTeleporter?"Teleporter":e.name}})),value:this.data.type}),WebFun.JSX.render(v.InlineSelector,{className:"planet",onchange:function(e){return t.dispatchEvent(new CustomEvent(m.ChangePlanet,{detail:{planet:e.target.value,zone:t.data},bubbles:!0}))},options:[{label:"None",value:p.Zone.Planet.None},{label:"Tatooine",value:p.Zone.Planet.Tatooine},{label:"Endor",value:p.Zone.Planet.Endor},{label:"Hoth",value:p.Zone.Planet.Hoth},{label:"Dagobah",value:p.Zone.Planet.Dagobah}],value:this.data.planet}),WebFun.JSX.render("span",null,WebFun.JSX.render("i",{className:"fa fa-search",onclick:function(e){t.dispatchEvent(new CustomEvent(m.RevealReferences,{detail:{zone:t.data},bubbles:!0})),e.stopPropagation()}}),WebFun.JSX.render("i",{className:"fa fa-remove",onclick:function(e){t.dispatchEvent(new CustomEvent(m.RemoveZone,{detail:{zone:t.data},bubbles:!0})),e.stopPropagation()}})),WebFun.JSX.render("span",{className:"size"},this.data.size.width,"x",this.data.size.height)))}},{key:"_tileForType",value:function(e){var t=this.tileIdForZoneType(e);return-1===t?null:this.tiles[t]}},{key:"tileIdForZoneType",value:function(e){switch(e){case p.Zone.Type.Town:return 829;case p.Zone.Type.Goal:return 830;case p.Zone.Type.BlockadeWest:return 827;case p.Zone.Type.BlockadeEast:return 823;case p.Zone.Type.BlockadeNorth:return 821;case p.Zone.Type.BlockadeSouth:return 825;case p.Zone.Type.Find:case p.Zone.Type.FindUniqueWeapon:case p.Zone.Type.Trade:case p.Zone.Type.Use:return 818;case p.Zone.Type.TravelStart:case p.Zone.Type.TravelEnd:return 820;case p.Zone.Type.Empty:return this.data.hasTeleporter?834:832;case p.Zone.Type.Room:return 835;case p.Zone.Type.None:case p.Zone.Type.Load:return 836}return-1}},{key:"cloneNode",value:function(e){var t=(0,l.default)((0,c.default)(n.prototype),"cloneNode",this).call(this,e);return t.palette=this.palette,t.tiles=this.tiles,t.onclick=this.onclick,t.oncontextmenu=this.oncontextmenu,t}},{key:"disconnectedCallback",value:function(){this.textContent=""}}]),n}(v.Cell);_.Events=m,_.tagName="wf-zone-inspector-cell",_.observedAttributes=[],t.default=_},76503:(e,t,n)=>{"use strict";var a=n(38468),r=a(n(40361)),i=a(n(7583));(0,a(n(68748)).default)(t,"__esModule",{value:!0});var o=function(){function e(t,n,a){(0,r.default)(this,e),this._currentData=t.copy(),this._palette=n,this._type=a}return(0,i.default)(e,[{key:"currentData",get:function(){return this._currentData}},{key:"palette",get:function(){return this._palette}},{key:"type",get:function(){return this._type}},{key:"state",get:function(){return this._state},set:function(e){this._state=e}},{key:"stateData",get:function(){return this._stateData},set:function(e){this._stateData=e}}]),e}();t.default=o},19705:(e,t,n)=>{"use strict";var a=n(38468),r=a(n(63789)),i=a(n(76108)),o=a(n(40361)),l=a(n(7583)),s=a(n(68748)),u=a(n(23982));(0,s.default)(t,"__esModule",{value:!0});var c=n(20779),d=n(31560),f=n(46e3),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:JSON.parse('[{"title":"Yoda Stories from archive.org","variant":"yoda","sfx-format":"wav","exe":"https://cors.archive.org/download/Star_Wars_-_Yoda_Stories_1997_LucasArts/Star%20Wars%20-%20Yoda%20Stories%20%281997%29%28LucasArts%29.iso/Yoda%2FYodesk.exe","sfx":"https://cors.archive.org/download/Star_Wars_-_Yoda_Stories_1997_LucasArts/Star%20Wars%20-%20Yoda%20Stories%20%281997%29%28LucasArts%29.iso/Yoda%2Fsfx%2F","data":"https://cors.archive.org/download/Star_Wars_-_Yoda_Stories_1997_LucasArts/Star%20Wars%20-%20Yoda%20Stories%20%281997%29%28LucasArts%29.iso/Yoda%2Fyodesk.dta","help":"https://cors.archive.org/download/Star_Wars_-_Yoda_Stories_1997_LucasArts/Star%20Wars%20-%20Yoda%20Stories%20%281997%29%28LucasArts%29.iso/Yoda%2FYodesk.hlp"},{"title":"Yoda Stories Demo (archive.org)","variant":"yoda-demo","sfx-format":"wav","exe":"https://cors.archive.org/download/StarWarsYodaStories_1020/YodaDemo.zip/YodaDemo%2FYodaDemo.exe","sfx":"https://archive.org/download/StarWarsYodaStories_1020/YodaDemo.zip/YodaDemo%2Fsfx%2F","data":"https://cors.archive.org/download/StarWarsYodaStories_1020/YodaDemo.zip/YodaDemo%2FYodaDemo.dta","help":"https://cors.archive.org/download/StarWarsYodaStories_1020/YodaDemo.zip/YodaDemo%2FYodaDemo.hlp"}]')[0].data,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:JSON.parse('[{"title":"Yoda Stories from archive.org","variant":"yoda","sfx-format":"wav","exe":"https://cors.archive.org/download/Star_Wars_-_Yoda_Stories_1997_LucasArts/Star%20Wars%20-%20Yoda%20Stories%20%281997%29%28LucasArts%29.iso/Yoda%2FYodesk.exe","sfx":"https://cors.archive.org/download/Star_Wars_-_Yoda_Stories_1997_LucasArts/Star%20Wars%20-%20Yoda%20Stories%20%281997%29%28LucasArts%29.iso/Yoda%2Fsfx%2F","data":"https://cors.archive.org/download/Star_Wars_-_Yoda_Stories_1997_LucasArts/Star%20Wars%20-%20Yoda%20Stories%20%281997%29%28LucasArts%29.iso/Yoda%2Fyodesk.dta","help":"https://cors.archive.org/download/Star_Wars_-_Yoda_Stories_1997_LucasArts/Star%20Wars%20-%20Yoda%20Stories%20%281997%29%28LucasArts%29.iso/Yoda%2FYodesk.hlp"},{"title":"Yoda Stories Demo (archive.org)","variant":"yoda-demo","sfx-format":"wav","exe":"https://cors.archive.org/download/StarWarsYodaStories_1020/YodaDemo.zip/YodaDemo%2FYodaDemo.exe","sfx":"https://archive.org/download/StarWarsYodaStories_1020/YodaDemo.zip/YodaDemo%2Fsfx%2F","data":"https://cors.archive.org/download/StarWarsYodaStories_1020/YodaDemo.zip/YodaDemo%2FYodaDemo.dta","help":"https://cors.archive.org/download/StarWarsYodaStories_1020/YodaDemo.zip/YodaDemo%2FYodaDemo.hlp"}]')[4].data;(0,o.default)(this,e),this.url=new u.default,this.url.set(f.Yoda,t),this.url.set(f.Indy,n)}var t;return(0,l.default)(e,[{key:"provide",value:(t=(0,i.default)(r.default.mark((function e(t){var n,a,i;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.url.get(t),e.next=3,d.FileLoader.loadAsStream(n);case 3:return a=e.sent,i=c.readGameDataFile(a,t),e.abrupt("return",new c.GameData(i));case 6:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}();t.default=h},24325:(e,t,n)=>{"use strict";(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.PaletteProvider=t.DataProvider=void 0;var a=n(19705);t.DataProvider=a.default;var r=n(64208);t.PaletteProvider=r.default},64208:(e,t,n)=>{"use strict";var a=n(38468),r=a(n(63789)),i=a(n(76108)),o=a(n(40361)),l=a(n(7583)),s=a(n(68748)),u=a(n(67093));(0,s.default)(t,"__esModule",{value:!0});var c=n(66102),d=n(95748),f=n(20779),h=n(31560),v=n(46e3),p=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:'[{"title":"Yoda Stories from archive.org","variant":"yoda","sfx-format":"wav","exe":"https://cors.archive.org/download/Star_Wars_-_Yoda_Stories_1997_LucasArts/Star%20Wars%20-%20Yoda%20Stories%20%281997%29%28LucasArts%29.iso/Yoda%2FYodesk.exe","sfx":"https://cors.archive.org/download/Star_Wars_-_Yoda_Stories_1997_LucasArts/Star%20Wars%20-%20Yoda%20Stories%20%281997%29%28LucasArts%29.iso/Yoda%2Fsfx%2F","data":"https://cors.archive.org/download/Star_Wars_-_Yoda_Stories_1997_LucasArts/Star%20Wars%20-%20Yoda%20Stories%20%281997%29%28LucasArts%29.iso/Yoda%2Fyodesk.dta","help":"https://cors.archive.org/download/Star_Wars_-_Yoda_Stories_1997_LucasArts/Star%20Wars%20-%20Yoda%20Stories%20%281997%29%28LucasArts%29.iso/Yoda%2FYodesk.hlp"},{"title":"Yoda Stories Demo (archive.org)","variant":"yoda-demo","sfx-format":"wav","exe":"https://cors.archive.org/download/StarWarsYodaStories_1020/YodaDemo.zip/YodaDemo%2FYodaDemo.exe","sfx":"https://archive.org/download/StarWarsYodaStories_1020/YodaDemo.zip/YodaDemo%2Fsfx%2F","data":"https://cors.archive.org/download/StarWarsYodaStories_1020/YodaDemo.zip/YodaDemo%2FYodaDemo.dta","help":"https://cors.archive.org/download/StarWarsYodaStories_1020/YodaDemo.zip/YodaDemo%2FYodaDemo.hlp"}]';(0,o.default)(this,e),this.sources=JSON.parse(t)}var t,n;return(0,l.default)(e,[{key:"provide",value:(n=(0,i.default)(r.default.mark((function e(t){var n,a,i;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=(0,u.default)(n=this.sources).call(n,(function(e){var n=e.variant;return!((t!==v.Yoda&&t!==v.YodaDemo||"yoda"!==n&&"yoda-demo"!==n)&&(t!==v.Indy&&t!==v.IndyDemo||"indy"!==n&&"indy-demo"!==n))}))){e.next=3;break}throw new Error("Could not find a datasource to load palette for ".concat(t===v.Indy||t===v.IndyDemo?"indy":"yoda"," variant."));case 3:return e.next=5,h.FileLoader.loadAsStream(a.exe);case 5:return i=e.sent,e.abrupt("return",this.readPalette(i));case 7:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"readPalette",value:(t=(0,i.default)(r.default.mark((function e(t){var n,a,i,o,l,s,h,v;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=new d.default,a=n.parse(t),i=a.sections,o=(0,u.default)(i).call(i,(function(e){return".data"===e.name})),l=new c.default,s=l.extractFromDataSection(o,t),e.abrupt("return",f.ColorPalette.FromBGR8(s));case 10:if(e.prev=10,e.t0=e.catch(0),e.t0 instanceof d.PortaleExecutableFileFormatError){e.next=14;break}throw e.t0;case 14:return h=new c.default,v=h.extractFromBinary(t),e.abrupt("return",f.ColorPalette.FromBGR8(v));case 17:case"end":return e.stop()}}),e,null,[[0,10]])}))),function(e){return t.apply(this,arguments)})}]),e}();t.default=p},51828:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(63789)),o=r(n(94433)),l=r(n(76108)),s=r(n(40361)),u=r(n(7583)),c=r(n(6060)),d=r(n(80655)),f=r(n(20497)),h=r(n(75244)),v=r(n(68748)),p=r(n(5459));function y(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,h.default)(e);if(t){var i=(0,h.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,f.default)(this,n)}}(0,v.default)(t,"__esModule",{value:!0}),n(32157);var m=n(31560),_=n(88607),g=n(13398),w=n(65119),b=n(56231),k=n(20779),S=n(46652),C=n(17766),x=function(e){(0,d.default)(v,e);var t,n,a,r,f,h=y(v);function v(){var e;return(0,s.default)(this,v),(e=h.call(this))._inspectors={},e._windowManager||(e._windowManager=new S.default((0,c.default)(e))),e}return(0,u.default)(v,[{key:"addInspector",value:function(e,t){t.windowManager=this._windowManager,this._inspectors[e]=t}},{key:"show",value:function(e){this._inspectors[e].show()}},{key:"save",value:function(){var e=new w.default,t=new m.DiscardingOutputStream;e.serialize(this.data.currentData,t);var n=new m.OutputStream(t.offset);return e.serialize(this.data.currentData,n),m.download(n.buffer,"yoda.data")}},{key:"load",value:(f=(0,l.default)(i.default.mark((function e(){var t,n,a,r;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new g.default,e.next=3,t.pickFile();case 3:if(n=e.sent,a=(0,o.default)(n,1),r=a[0]){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,this.loadFile(r);case 10:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"loadFile",value:(r=(0,l.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"loadSaveGame",value:(a=(0,l.default)(i.default.mark((function e(){var t,n,a,r;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new g.default,e.next=3,t.pickFile();case 3:if(n=e.sent,a=(0,o.default)(n,1),r=a[0]){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,this.loadSaveGameFile(r);case 10:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"loadSaveGameFile",value:(n=(0,l.default)(i.default.mark((function e(t){var n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.provideInputStream();case 2:return n=e.sent,e.next=5,this.loadSaveGameStream(n);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"loadSaveGameStream",value:(t=(0,l.default)(i.default.mark((function e(t){var n,a,r,o,l,s,u;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=k.SaveGameReader.build(t),a=n.type,r=n.read,a===this.data.type){e.next=4;break}return console.log("Save game does not match current game type!"),e.abrupt("return");case 4:o=this.data.currentData,(l=new k.AssetManager).populate(C.Zone,o.zones),l.populate(C.Tile,o.tiles),l.populate(C.Puzzle,o.puzzles),l.populate(C.Char,o.characters),l.populate(C.Sound,o.sounds),s=r(l),u=new b.SaveGameInspector(this.state.prefixedWith("save-game"),this.di),this.addInspector("save-game",u),this.data.state=s,u.data=this.data,this.show("save-game");case 17:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"data",get:function(){return this._data},set:function(e){this._data=e,this._inspectors.each((function(t,n){n.data=e}))}},{key:"inspectors",get:function(){return(0,p.default)(this._inspectors)}},{key:"windowManager",get:function(){return this._windowManager}}]),v}(_.Component);x.tagName="wf-editor-view",t.default=x},38476:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(63789)),o=r(n(76108)),l=r(n(40361)),s=r(n(7583)),u=r(n(18582)),c=r(n(80655)),d=r(n(20497)),f=r(n(75244)),h=r(n(68748)),v=r(n(75356));function p(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,f.default)(e);if(t){var i=(0,f.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,d.default)(this,n)}}(0,h.default)(t,"__esModule",{value:!0}),n(21502);var y=n(5008),m=n(20779),_=n(88607),g=n(46e3),w=n(13809),b=n(76503),k=n(51828),S=n(14961),C=n(24325),x=n(77298),T=n(58320),I=n(30522),W=n(90487),F=n(18226),E=n(62944),D=n(98320),z=n(11251),L=function(e){(0,c.default)(d,e);var t,n,a,r=p(d);function d(){var e;return(0,l.default)(this,d),(e=r.call(this))._progressIndicator=WebFun.JSX.render(y.ProgressIndicator,null),e._editor=null,e.title="Resource Editor",e}return(0,s.default)(d,[{key:"connectedCallback",value:function(){(0,u.default)((0,f.default)(d.prototype),"connectedCallback",this).call(this),this.content.appendChild(this._progressIndicator)}},{key:"loadFile",value:(a=(0,o.default)(i.default.mark((function e(t){var n,a,r;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.provideInputStream();case 2:return a=e.sent,r=-1===(0,v.default)(n=t.name.toLowerCase()).call(n,"yod")?g.Indy:g.Yoda,e.next=6,this.loadStream(a,r);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"loadStream",value:(n=(0,o.default)(i.default.mark((function e(t,n){var a,r;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=m.readGameDataFile(t,n),(r=new m.GameData(a))._type=n,this.di.register(m.GameData,r),e.next=6,this.loadGameData(r);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"loadGameData",value:(t=(0,o.default)(i.default.mark((function e(t){var n,a,r,o,l;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new C.PaletteProvider).provide(t.type);case 2:n=e.sent,a=this.di,r=new b.default(t,n,t.type),a.register(b.default,r),a.register(m.GameData,r.currentData),a.register(m.ColorPalette,n),a.register(z.Updater,new z.Updater(r.currentData)),a.register(z.Resolver,new z.Resolver(r.currentData)),this._gotoFullscreen(),o=document.createElement(k.default.tagName),l=localStorage.prefixedWith("editor"),o.di=a,o.addInspector("tile",new W.default(l.prefixedWith("tile"),a)),o.addInspector("zone",new F.default(l.prefixedWith("zone"),a)),o.addInspector("sound",new I.default(l.prefixedWith("sound"),a)),o.addInspector("puzzle",new x.default(l.prefixedWith("puzzle"),a)),o.addInspector("character",new w.default(l.prefixedWith("character"),a)),o.addInspector("startup-image",new T.default(l.prefixedWith("startup-image"),a)),o.addInspector("palette",new S.default(l.prefixedWith("palette"),a)),o.addInspector("coverage",new E.default(l.prefixedWith("coverage"),a)),o.data=r,o.state=l,this._showMenu(o),this.content.textContent="",this.content.appendChild(o),this._editor=o;case 28:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"_gotoFullscreen",value:function(){this.closable=!1,this.movable=!1,this.style.top="",this.style.left="",this.classList.add("fullsize"),this.content.classList.add("fullsize")}},{key:"_showMenu",value:function(e){var t=D.default(e,this);t.push(new _.WindowMenuItem(e.windowManager)),this.menu=new _.Menu(t)}},{key:"editor",get:function(){return this._editor}}]),d}(y.AbstractWindow);L.tagName="wf-resource-editor-window",t.default=L},43633:(e,t,n)=>{"use strict";var a=n(38468),r=a(n(63789)),i=a(n(94433)),o=a(n(76108)),l=a(n(40361)),s=a(n(7583));(0,a(n(68748)).default)(t,"__esModule",{value:!0});var u=n(26341),c=n(88607),d=n(38476),f=function(){function e(){(0,l.default)(this,e)}var t;return(0,s.default)(e,[{key:"run",value:(t=(0,o.default)(r.default.mark((function e(){var t,n,a,o,l,s=arguments;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=s.length>0&&void 0!==s[0]?s[0]:null,n=new c.WindowManager(document.body),this.container=new u.default,this.container.register(u.default,this.container),this.container.register(c.WindowManager,n),this.container.register(Document,document),e.prev=6,this.window=document.createElement(d.default.tagName),this.window.di=this.container,n.showWindow(this.window),this.window.center(),!t){e.next=17;break}return e.next=14,this.window.loadGameData(t);case 14:return e.abrupt("return",e.sent);case 17:return e.next=19,c.FilePicker.Pick({allowedTypes:["data","dta"]});case 19:return a=e.sent,o=(0,i.default)(a,1),(l=o[0])||this.window.close(),e.next=25,this.window.loadFile(l);case 25:return e.abrupt("return",e.sent);case 26:e.next=33;break;case 28:e.prev=28,e.t0=e.catch(6),console.error("Closing editor because of error!"),console.error(e.t0),this.stop();case 33:case"end":return e.stop()}}),e,this,[[6,28]])}))),function(){return t.apply(this,arguments)})},{key:"stop",value:function(){this.window&&(this.window.close(),this.window=null)}}]),e}();t.default=f},65119:(e,t,n)=>{"use strict";var a=n(38468),r=a(n(40361)),i=a(n(7583)),o=a(n(68748)),l=a(n(7273)),s=a(n(35983)),u=a(n(42601)),c=a(n(39694)),d=a(n(69159)),f=a(n(68190));(0,o.default)(t,"__esModule",{value:!0});var h=n(17766),v=n(31560),p=n(46e3),y=function(){function e(){(0,r.default)(this,e)}return(0,i.default)(e,[{key:"serialize",value:function(e,t){this.writeVersion(e,t),this.writeStartupImage(e,t),this.writeSounds(e,t),this.writeTiles(e,t),this.writeZones(e,t),this.writePuzzles(e,t),this.writeCharacters(e,t),this.writeCharacterWeapons(e,t),this.writeCharacterAuxiliary(e,t),this.writeTileNames(e,t),this.writeEndOfFile(t)}},{key:"writeVersion",value:function(e,t){t.writeCharacters("VERS"),t.writeUint32(512)}},{key:"writeStartupImage",value:function(e,t){t.writeCharacters("STUP"),t.writeUint32(82944),t.writeUint8Array(e.startupImageData)}},{key:"writeSounds",value:function(e,t){var n,a,r;t.writeCharacters("SNDS");var i=(0,l.default)(n=(0,s.default)(a=e.sounds).call(a,(function(e){return 2+e.file.length+1}))).call(n,v.add,0);t.writeUint32(2+i),t.writeUint16(-e.sounds.length),(0,u.default)(r=e.sounds).call(r,(function(e){return t.writeLengthPrefixedNullTerminatedString(e.file)}))}},{key:"writeTiles",value:function(e,t){var n;t.writeCharacters("TILE"),t.writeUint32(1028*e.tiles.length),(0,u.default)(n=e.tiles).call(n,(function(e){t.writeUint32(e.attributes),t.writeUint8Array(e.imageData)}))}},{key:"writeZones",value:function(e,t){var n;t.writeCharacters("ZONE"),t.writeUint16(e.zones.length),(0,u.default)(n=e.zones).call(n,(function(e,n){var a,r,i,o,f,p,y,m,_,g=12+44*e.monsters.length+2+2*e.requiredItems.length+2+2*e.goalItems.length,w=10+2*e.providedItems.length,b=10+2*e.npcs.length,k=function(e){var t,n,a,r;return(0,l.default)(t=(0,s.default)(n=e.conditions).call(n,(function(e){return 14+e.text.length}))).call(t,v.add,2)+(0,l.default)(a=(0,s.default)(r=e.instructions).call(r,(function(e){return 14+e.text.length}))).call(a,v.add,2)},S=20+e.size.height*e.size.width*h.Zone.LAYERS*2,C=S+g+w+b+2+12*e.hotspots.length+((0,l.default)(a=(0,s.default)(r=e.actions).call(r,k)).call(a,v.add,0)+8*e.actions.length)+14;t.writeUint16(e.planet.rawValue),t.writeUint32(C),t.writeUint16(n),t.writeCharacters("IZON"),t.writeUint32(S),t.writeUint16(e.size.width),t.writeUint16(e.size.height),t.writeUint32(e.type.rawValue),t.writeInt16(-1),t.writeUint16(e.planet.rawValue);for(var x=0;x<e.size.height;x++)for(var T=0;T<e.size.width;T++)for(var I=0;I<h.Zone.LAYERS;I++){var W=e.getTile(T,x,I);W?t.writeUint16(W.id):t.writeUint16(-1)}t.writeUint16(e.hotspots.length),(0,u.default)(i=e.hotspots).call(i,(function(e){t.writeUint32(e.type.rawValue),t.writeUint16(e.x),t.writeUint16(e.y),t.writeUint16(1),t.writeInt16(e.arg)})),t.writeCharacters("IZAX"),t.writeUint32(g),t.writeUint16(e.izaxUnknown),t.writeUint16(e.monsters.length),(0,u.default)(o=e.monsters).call(o,(function(e){for(var n=new Int32Array(8),a=0;a<e.waypoints.length;a++){var r=e.waypoints[a];n[2*a+0]=r.x,n[2*a+1]=r.y}for(var i=e.waypoints.length;i<4;i++)n[2*i+0]=-1,n[2*i+1]=-1;t.writeUint16(e.face.id),t.writeUint16(e.position.x),t.writeUint16(e.position.y),t.writeInt16(e.loot),t.writeInt32(+e.dropsLoot),t.writeInt32Array(n)})),t.writeUint16(e.requiredItems.length),t.writeUint16Array((0,s.default)(f=e.requiredItems).call(f,(function(e){return e.id}))),t.writeUint16(e.goalItems.length),t.writeUint16Array((0,s.default)(p=e.goalItems).call(p,(function(e){return e.id}))),t.writeCharacters("IZX2"),t.writeUint32(w),t.writeUint16(e.providedItems.length),t.writeUint16Array((0,s.default)(y=e.providedItems).call(y,(function(e){return e.id}))),t.writeCharacters("IZX3"),t.writeUint32(b),t.writeUint16(e.npcs.length),t.writeUint16Array((0,s.default)(m=e.npcs).call(m,(function(e){return e.id}))),t.writeCharacters("IZX4"),t.writeUint32(2),t.writeUint16(e.izx4Unknown),t.writeUint16(e.actions.length),(0,u.default)(_=e.actions).call(_,(function(e){var n,a;t.writeCharacters("IACT"),t.writeUint32(k(e)),t.writeUint16(e.conditions.length),(0,u.default)(n=e.conditions).call(n,(function(e){var n;t.writeUint16(e.opcode),t.writeInt16Array((0,c.default)(n=(0,d.default)(e.arguments)).call(n,5,0)),t.writeLengthPrefixedString(e.text)})),t.writeUint16(e.instructions.length),(0,u.default)(a=e.instructions).call(a,(function(e){var n;t.writeUint16(e.opcode),t.writeInt16Array((0,c.default)(n=(0,d.default)(e.arguments)).call(n,5,0)),t.writeLengthPrefixedString(e.text)}))}))}))}},{key:"writePuzzles",value:function(e,t){var n,a,r;t.writeCharacters("PUZ2"),t.writeUint32(28*e.puzzles.length+(0,l.default)(n=(0,s.default)(a=e.puzzles).call(a,(function(e){var t,n;return(0,l.default)(t=(0,s.default)(n=e.strings).call(n,(function(e){return 2+e.length}))).call(t,v.add,0)}))).call(n,v.add,0)+2),(0,u.default)(r=e.puzzles).call(r,(function(e,n){var a,r,i,o,c,d,f;t.writeUint16(n),t.writeCharacters("IPUZ"),t.writeUint32(18+(0,l.default)(a=(0,s.default)(r=e.strings).call(r,(function(e){return 2+e.length}))).call(a,v.add,0)),n===p.Yoda.goalIDs.RESCUE_YODA||n===p.Yoda.goalIDs.CAR?t.writeUint32(h.Puzzle.Type.End.rawValue):t.writeUint32(e.type.rawValue),t.writeUint32(e.item1Class.rawValue),t.writeUint32(e.item2Class.rawValue),t.writeUint16(e.unknown3),(0,u.default)(i=e.strings).call(i,(function(e){t.writeLengthPrefixedString(e)})),t.writeUint16(null!==(o=null===(c=e.item1)||void 0===c?void 0:c.id)&&void 0!==o?o:-1),t.writeUint16(null!==(d=null===(f=e.item2)||void 0===f?void 0:f.id)&&void 0!==d?d:-1)})),t.writeUint16(-1)}},{key:"writeCharacters",value:function(e,t){var n;t.writeCharacters("CHAR"),t.writeUint32(2+84*e.characters.length),(0,u.default)(n=e.characters).call(n,(function(e,n){var a,r;t.writeUint16(n),t.writeCharacters("ICHA"),t.writeUint32(26+2*e.frames.length*8),t.writeNullTerminatedString((0,c.default)(a=e.name).call(a,15,"\0")),t.writeUint16(e.type.rawValue),t.writeUint16(e.movementType.rawValue),t.writeUint16(e.garbage1),t.writeUint32(e.garbage2),(0,u.default)(r=e.frames).call(r,(function(e){var n;t.writeUint16Array((0,s.default)(n=e.tiles).call(n,(function(e){return e?e.id:-1})))}))})),t.writeUint16(-1)}},{key:"writeCharacterWeapons",value:function(e,t){var n;t.writeCharacters("CHWP"),t.writeUint32(6*e.characters.length+2),(0,u.default)(n=e.characters).call(n,(function(e,n){t.writeUint16(n),t.writeUint16(e.reference),t.writeUint16(e.health)})),t.writeUint16(-1)}},{key:"writeCharacterAuxiliary",value:function(e,t){var n;t.writeCharacters("CAUX"),t.writeUint32(4*e.characters.length+2),(0,u.default)(n=e.characters).call(n,(function(e,n){t.writeUint16(n),t.writeUint16(e.damage)})),t.writeUint16(-1)}},{key:"writeTileNames",value:function(e,t){var n,a=(0,f.default)(n=e.tiles).call(n,(function(e){return e.name}));t.writeCharacters("TNAM"),t.writeUint32(26*a.length+2),(0,u.default)(a).call(a,(function(e){var n;t.writeUint16(e.id),t.writeCharacters((0,c.default)(n=e.name).call(n,24,"\0"))})),t.writeUint16(-1)}},{key:"writeEndOfFile",value:function(e){e.writeCharacters("ENDF"),e.writeUint32(0)}}]),e}();t.default=y},9857:(e,t,n)=>{"use strict";(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.DataManager=t.Editor=t.main=t.Reference=t.Inspectors=t.Tools=t.Data=t.Components=void 0;var a=n(76503);t.DataManager=a.default;var r=n(43633);t.Editor=r.default;var i=n(67279);t.main=i.default;var o=n(99670);t.Components=o;var l=n(24325);t.Data=l;var s=n(56231);t.Inspectors=s;var u=n(11251);t.Reference=u;var c=n(56018);t.Tools=c},28474:(e,t,n)=>{"use strict";(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var a=n(88607),r=n(99670),i=n(38476),o=n(51828);t.default=function(){var e=a.ComponentRegistry.sharedRegistry;e.contains(i.default)||(e.registerComponents(r),e.registerComponent(i.default),e.registerComponent(o.default))}},88958:(e,t,n)=>{"use strict";var a=n(38468),r=a(n(40361)),i=a(n(7583)),o=a(n(68748)),l=a(n(73035));(0,o.default)(t,"__esModule",{value:!0});var s=n(5008),u=function(){function e(t,n){var a=this;(0,r.default)(this,e),this.di=n,this.window=document.createElement(s.Panel.tagName),this._handlers={windowDidClose:function(){return a.state.store("visible",!1)}},this.di=n,this.state=t,this.window.addEventListener(s.Window.Event.DidClose,this._handlers.windowDidClose)}return(0,i.default)(e,[{key:"show",value:function(){this.state.store("visible",!0),this.windowManager.showWindow(this.window)}},{key:"data",get:function(){return this._data},set:function(e){this._data=e,this.build(),this.restoreState()}},{key:"stateDidChange",value:function(){var e=this;this._stateUpdateDelay||(this._stateUpdateDelay=(0,l.default)((function(){return e.updateState()}),1))}},{key:"updateState",value:function(){this._stateUpdateDelay&&clearTimeout(this._stateUpdateDelay),this._stateUpdateDelay=null}},{key:"restoreState",value:function(){this.state.load("visible")&&this.show()}}]),e}();t.default=u},13809:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(40361)),o=r(n(7583)),l=r(n(6060)),s=r(n(80655)),u=r(n(20497)),c=r(n(75244)),d=r(n(68748)),f=r(n(75356)),h=r(n(47053)),v=r(n(35983)),p=r(n(68190)),y=r(n(16825));function m(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}(0,d.default)(t,"__esModule",{value:!0});var _=n(17766),g=n(99670),w=n(5008),b=n(88958),k=n(76500),S=n(11251),C=function(e){(0,s.default)(n,e);var t=m(n);function n(e,a){var r;return(0,i.default)(this,n),(r=t.call(this,e,a)).updater=r.di.get(S.Updater),r.window.title="Characters",r.window.autosaveName="character-inspector",r.window.style.width="416px",r.window.content.style.height="280px",r.window.addTitlebarButton(WebFun.JSX.render(w.IconButton,{icon:"plus",title:"Add new character",onclick:function(){return r.addCharacter()}})),r._list=WebFun.JSX.render(w.List,{state:e.prefixedWith("list")}),r._list.cell=WebFun.JSX.render(g.CharacterInspectorCell,{className:"character-inspector-list",searchDelegate:(0,l.default)(r),onclick:function(e){return r._onCellClicked(e.currentTarget)},onchange:function(e){return r.renameCharacter(e.detail.cell.data,e.detail.name)},onremove:function(e){return r.removeCharacter(e.detail.cell.data)}}),r.window.content.appendChild(r._list),r._details=WebFun.JSX.render(g.CharacterDetails,null),r.window.content.appendChild(r._details),r}return(0,o.default)(n,[{key:"_onCellClicked",value:function(e){var t=this._list.querySelector("[selected]");t&&t.removeAttribute("selected"),e.setAttribute("selected",""),this._details.character=e.data}},{key:"addCharacter",value:function(){var e=new k.MutableChar(this.data.currentData.characters.last());e.name="New Character",e.id=this.data.currentData.characters.length,this.data.currentData.characters.push(e),this._list.items=this.data.currentData.characters}},{key:"renameCharacter",value:function(e,t){e.name=t}},{key:"removeCharacter",value:function(e){var t,n;-1!==(0,f.default)(t=this.data.currentData.characters).call(t,e)&&confirm((0,h.default)(n="Delete character ".concat(e.id," (")).call(n,e.name,")?"))&&(this.updater.deleteItem(e),this._list.items=this.data.currentData.characters)}},{key:"build",value:function(){var e,t;this._details.palette=this.data.palette,this._details.sounds=(0,v.default)(e=this.data.currentData.sounds).call(e,(function(e){return e.file})),this._details.weapons=(0,p.default)(t=this.data.currentData.characters).call(t,(function(e){return e.type===_.Char.Type.Weapon})),this._details.tiles=this.data.currentData.tiles,this._details.palette=this.data.palette,this._list.cell.palette=this.data.palette,this._list.items=this.data.currentData.characters}},{key:"prepareListSearch",value:function(e,t){var n;return this.stateDidChange(),(0,v.default)(n=e.split(" ")).call(n,(function(e){return new RegExp(e,"i")}))}},{key:"includeListItem",value:function(e,t,n,a){var r=[t.id,t.name,t.movementType.name];if(t.isWeapon()){var i=this.data.currentData.sounds[t.reference];i&&r.push(i.file)}else{var o=this.data.currentData.characters[t.reference];o&&r.push(o.name)}var l=r.join(" ");return(0,y.default)(e).call(e,(function(e){return e.test(l)}))}}]),n}(b.default);t.default=C},62944:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(63789)),o=r(n(76108)),l=r(n(40361)),s=r(n(7583)),u=r(n(80655)),c=r(n(20497)),d=r(n(75244)),f=r(n(68748)),h=r(n(79302));function v(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,c.default)(this,n)}}(0,f.default)(t,"__esModule",{value:!0});var p=n(88958),y=n(5008);n(95266);var m,_=n(99670);!function(e){e[e.SourceLevel=0]="SourceLevel",e[e.Symbolic=1]="Symbolic"}(m||(m={}));var g="view-mode",w=function(e){(0,u.default)(r,e);var t,n,a=v(r);function r(e,t){var n;return(0,l.default)(this,r),(n=a.call(this,e,t)).coverageLoaded=!1,n._sourceLevelCoverage=WebFun.JSX.render(_.SourceLevelCoverage,null),n._symbolicCoverage=WebFun.JSX.render(_.SymbolicCoverage,null),n._viewModeSelector=WebFun.JSX.render(y.InlineSelector,{options:[{label:"Source level",value:m.SourceLevel},{label:"By symbol",value:m.Symbolic}],onchange:function(){return n.build()}}),n.window.title="Coverage",n.window.autosaveName="coverage-inspector",n.window.content.style.height="604px",n.window.content.style.flexDirection="column",n.window.classList.add("wf-coverage-inspector"),n.window.addTitlebarButton(n._viewModeSelector),n._sourceLevelCoverage.state=e.prefixedWith("source-level"),n._symbolicCoverage.state=e.prefixedWith("symbolic"),n._viewModeSelector.value=+e.load(g)||n._viewModeSelector.options[0].value,n}return(0,s.default)(r,[{key:"build",value:(n=(0,o.default)(i.default.mark((function e(){var t;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.coverageLoaded){e.next=16;break}return this.window.content.textContent="",this.window.content.appendChild(WebFun.JSX.render(y.ProgressIndicator,null)),e.t0=JSON,e.next=6,this.loadCoverage();case 6:e.t1=e.sent,t=e.t0.parse.call(e.t0,e.t1),this._sourceLevelCoverage.data=this.data,this._sourceLevelCoverage.coverage=t,this._symbolicCoverage.data=this.data,this._symbolicCoverage.coverage=t,this.coverageLoaded=!0,this.build(),e.next=19;break;case 16:this.state.store(g,this._viewModeSelector.value),this.window.content.textContent="",this.window.content.appendChild(this.currentView);case 19:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"currentView",get:function(){switch(this._viewModeSelector.value){case m.SourceLevel:return this._sourceLevelCoverage;case m.Symbolic:return this._symbolicCoverage}}},{key:"loadCoverage",value:(t=(0,o.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new h.default((function(e,t){var n=new XMLHttpRequest;n.open("GET","assets/ingame-coverage.json"),n.onload=function(t){return e(n.response)},n.onerror=function(e){return t(e)},n.send(void 0)})));case 1:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})}]),r}(p.default);t.default=w},56231:(e,t,n)=>{"use strict";(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.CoverageInspector=t.SaveGameInspector=t.PaletteInspector=t.ZoneInspector=t.TileInspector=t.SoundInspector=t.StartupImageInspector=t.PuzzleInspector=t.CharacterInspector=t.AbstractInspector=void 0;var a=n(88958);t.AbstractInspector=a.default;var r=n(13809);t.CharacterInspector=r.default;var i=n(77298);t.PuzzleInspector=i.default;var o=n(58320);t.StartupImageInspector=o.default;var l=n(30522);t.SoundInspector=l.default;var s=n(90487);t.TileInspector=s.default;var u=n(18226);t.ZoneInspector=u.default;var c=n(14961);t.PaletteInspector=c.default;var d=n(49753);t.SaveGameInspector=d.default;var f=n(62944);t.CoverageInspector=f.default},14961:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(63789)),o=r(n(76108)),l=r(n(40361)),s=r(n(7583)),u=r(n(80655)),c=r(n(20497)),d=r(n(75244)),f=r(n(68748)),h=r(n(47053)),v=r(n(49710));function p(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,c.default)(this,n)}}(0,f.default)(t,"__esModule",{value:!0});var y=n(31560),m=n(99670),_=n(88958),g=n(5008),w=n(48387),b=n(32115),k=n(46e3),S=function(e){(0,u.default)(a,e);var t,n=p(a);function a(e,t){var r;return(0,l.default)(this,a),(r=n.call(this,e,t))._paletteView=WebFun.JSX.render(m.PaletteColorPicker,{size:new y.Size(16,16),style:{width:"194px",height:"194px"},onchange:function(){return r.editColor(r._paletteView.color)}}),r._colorPicker=WebFun.JSX.render(m.ColorPicker,{style:{height:"184px",minWidth:"182px",marginLeft:"12px",marginTop:"10px"},color:r.state.load("color")||y.rgba(0,0,0,0),onchange:function(){return r._paletteView.updateCurrentColor(r._colorPicker.color)}}),r._download=WebFun.JSX.render(g.IconButton,{icon:"download",onclick:function(){return r.downloadPalette()}}),r._animate=WebFun.JSX.render(g.IconButton,{icon:"play",onclick:function(){return r.togglePaletteAnimation()}}),r._animator=null,r.window.title="Palette",r.window.autosaveName="palette-inspector",r.window.style.width="398px",r.window.content.style.height="204px",r.window.content.style.flexDirection="row",r.window.content.appendChild(r._paletteView),r.window.content.appendChild(r._colorPicker),r.window.addTitlebarButton(r._download),r.window.addTitlebarButton(r._animate),r}return(0,s.default)(a,[{key:"downloadPalette",value:(t=(0,o.default)(i.default.mark((function e(){var t,n,a;return i.default.wrap((function(e){for(var r;;)switch(e.prev=e.next){case 0:return e.next=2,w.ModalPrompt("Pick file format:",{defaultValue:"gpl",options:[{label:"GIMP Palette",value:"gpl"},{label:"Adobe Color Table",value:"act"}]});case 2:if(null!==(t=e.sent)){e.next=5;break}return e.abrupt("return");case 5:n="Yoda Stories",a="gpl"===t?this._paletteView.palette.toGIMP(n):this._paletteView.palette.toAdobeColorTable(),y.download(a,(0,h.default)(r="".concat(n,".")).call(r,t));case 8:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"editColor",value:function(e){this._colorPicker.color=e,this.state.store("color",this._colorPicker.color)}},{key:"build",value:function(){this._paletteView.palette=this.data.palette,this._paletteView.color=this.state.load("color")||y.rgba(0,0,0,0),this._paletteView.redraw()}},{key:"togglePaletteAnimation",value:function(){var e=this;this._animator||(this._animator=new b.default(this.data.palette,k.Yoda.fastColorCycles,k.Yoda.slowColorCycles)),"stop"===this._animate.icon?(this._animate.icon="play",clearInterval(this._animation),this._animator.reset(),this._paletteView.palette=this._animator.current,this._animator=null):(this._animate.icon="stop",this._animation=(0,v.default)((function(){e._animator.step(),e._paletteView.palette=e._animator.current}),100))}}]),a}(_.default);t.default=S},77298:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(40361)),o=r(n(7583)),l=r(n(6060)),s=r(n(80655)),u=r(n(20497)),c=r(n(75244)),d=r(n(68748)),f=r(n(35983)),h=r(n(16825));function v(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}(0,d.default)(t,"__esModule",{value:!0});var p=n(88958),y=n(5008),m=n(99670),_=function(e){(0,s.default)(n,e);var t=v(n);function n(e,a){var r;return(0,i.default)(this,n),(r=t.call(this,e,a)).window.title="Puzzles",r.window.autosaveName="puzzle-inspector",r.window.style.width="300px",r.window.content.style.height="396px",r.window.content.style.flexDirection="column",r._list=document.createElement(y.List.tagName),r._list.state=e.prefixedWith("list"),r._list.cell=document.createElement(m.PuzzleInspectorCell.tagName),r._list.searchDelegate=(0,l.default)(r),r._list.state=e.prefixedWith("list"),r.window.content.appendChild(r._list),r}return(0,o.default)(n,[{key:"build",value:function(){var e=this._list.cell;e.tiles=this.data.currentData.tiles,e.palette=this.data.palette,this._list.items=this.data.currentData.puzzles}},{key:"prepareListSearch",value:function(e,t){var n;return this.stateDidChange(),(0,f.default)(n=e.split(" ")).call(n,(function(e){return new RegExp(e,"i")}))}},{key:"includeListItem",value:function(e,t,n,a){var r,i,o=t.id+" "+t.type.name+" "+t.name;return t.strings.join(" "),null===(r=t.item1)||void 0===r?void 0:r.name,null===(i=t.item2)||void 0===i?void 0:i.name,(0,h.default)(e).call(e,(function(e){return e.test(o)}))}}]),n}(p.default);t.default=_},49753:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(40361)),o=r(n(7583)),l=r(n(80655)),s=r(n(20497)),u=r(n(75244)),c=r(n(68748)),d=r(n(92915)),f=r(n(42601)),h=r(n(69159));function v(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,u.default)(e);if(t){var i=(0,u.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}(0,c.default)(t,"__esModule",{value:!0}),n(91316);var p=n(31560),y=n(88958),m=n(70945),_=n(53260),g=n(5008),w=n(93651),b=n(23754),k=n(95451),S=n(20779),C=n(17766),x=n(46e3),T=n(78256),I=n(50177),W=function(e){(0,l.default)(n,e);var t=v(n);function n(e,a){var r;return(0,i.default)(this,n),(r=t.call(this,e,a))._editorView=WebFun.JSX.render(m.EditorView,{state:r.state.prefixedWith("editor-view")}),r.window.title="Save Game Inspector",r.window.autosaveName="save-game-inspector",r.window.content.style.flexDirection="column",r.window.classList.add("wf-resource-editor-save-game-inspector"),r.window.addTitlebarButton(WebFun.JSX.render(g.IconButton,{icon:"download",title:"Download modified save game",onclick:function(){return r.downloadSaveGame()}})),r.window.addTitlebarButton(WebFun.JSX.render(g.IconButton,{icon:"play",title:"Load and play this save game",onclick:function(){return r.playSaveGame()}})),r}return(0,o.default)(n,[{key:"build",value:function(){this._editorView.presentState(this.data.state,this.data.currentData,this.data.palette),this.window.content.appendChild(this._editorView)}},{key:"downloadSaveGame",value:function(){var e=this._editorView.saveGame,t=this._editorView.data,n=new S.AssetManager;n.populate(C.Zone,t.zones),n.populate(C.Tile,t.tiles),n.populate(C.Puzzle,t.puzzles),n.populate(C.Char,t.characters),n.populate(C.Sound,t.sounds);var a=new k.Writer(n),r=new p.DiscardingOutputStream;a.write(e,r);var i=new p.OutputStream(r.offset);a.write(e,i),p.download(i.buffer,"savegame.wld")}},{key:"playSaveGame",value:function(){var e,t,n=JSON.parse('[{"title":"Yoda Stories from archive.org","variant":"yoda","sfx-format":"wav","exe":"https://cors.archive.org/download/Star_Wars_-_Yoda_Stories_1997_LucasArts/Star%20Wars%20-%20Yoda%20Stories%20%281997%29%28LucasArts%29.iso/Yoda%2FYodesk.exe","sfx":"https://cors.archive.org/download/Star_Wars_-_Yoda_Stories_1997_LucasArts/Star%20Wars%20-%20Yoda%20Stories%20%281997%29%28LucasArts%29.iso/Yoda%2Fsfx%2F","data":"https://cors.archive.org/download/Star_Wars_-_Yoda_Stories_1997_LucasArts/Star%20Wars%20-%20Yoda%20Stories%20%281997%29%28LucasArts%29.iso/Yoda%2Fyodesk.dta","help":"https://cors.archive.org/download/Star_Wars_-_Yoda_Stories_1997_LucasArts/Star%20Wars%20-%20Yoda%20Stories%20%281997%29%28LucasArts%29.iso/Yoda%2FYodesk.hlp"},{"title":"Yoda Stories Demo (archive.org)","variant":"yoda-demo","sfx-format":"wav","exe":"https://cors.archive.org/download/StarWarsYodaStories_1020/YodaDemo.zip/YodaDemo%2FYodaDemo.exe","sfx":"https://archive.org/download/StarWarsYodaStories_1020/YodaDemo.zip/YodaDemo%2Fsfx%2F","data":"https://cors.archive.org/download/StarWarsYodaStories_1020/YodaDemo.zip/YodaDemo%2FYodaDemo.dta","help":"https://cors.archive.org/download/StarWarsYodaStories_1020/YodaDemo.zip/YodaDemo%2FYodaDemo.hlp"}]')[0],a=new _.default(x.Yoda,n,p.observable(I.defaultSettings));a.data=this.data.currentData.copy(),a.palette=(0,d.default)(e=this.data.palette).call(e);var r=a.data,i=a.engine,o=this.data.state,l=new w.default(o.seed,o.planet,T.WorldSize.Medium);l.world=this._createWorld(o.world),l.dagobah=this._createWorld(o.dagobah),i.inventory.removeAllItems(),(0,f.default)(t=(0,h.default)(o.inventoryIDs)).call(t,(function(e){return i.inventory.addItem(r.tiles[e])})),i.hero.ammo=o.currentAmmo,i.hero.weapon=-1!==o.currentWeapon?r.characters[o.currentWeapon]:null,i.hero.location=o.positionOnZone,i.hero.health=100*(4-o.livesLost)-o.damageTaken,i.currentWorld=o.onDagobah?l.dagobah:l.world,i.story=l,i.assets.populate(C.Zone,r.zones),i.assets.populate(C.Tile,r.tiles),i.assets.populate(C.Puzzle,r.puzzles),i.assets.populate(C.Char,r.characters),i.assets.populate(C.Sound,r.sounds),a.show(this.window.manager),a.jumpStartEngine(a.data.zones[o.currentZoneID])}},{key:"_createWorld",value:function(e){var t=this._editorView.data,n=new S.AssetManager;n.populate(C.Zone,t.zones),n.populate(C.Tile,t.tiles),n.populate(C.Puzzle,t.puzzles),n.populate(C.Char,t.characters),n.populate(C.Sound,t.sounds);for(var a=new b.default(n),r=0;r<10;r++)for(var i=0;i<10;i++){var o=e.at(i,r),l=a.at(i,r);l.zone=o.zone,l.additionalRequiredItem=o.additionalRequiredItem,l.findItem=o.findItem,l.npc=o.npc,l.requiredItem=o.requiredItem,l.zoneType=o.zoneType,l.zone.visited=o.visited,l.solved1=o.solved1,l.solved2=o.solved2,l.solved3=o.solved3,l.solved4=o.solved4,l.visited=o.visited,l.additionalGainItem=o.additionalGainItem,l.puzzleIndex=o.puzzleIndex,l.isGoal=o.isGoal}return a}}]),n}(y.default);t.default=W},30522:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(40361)),o=r(n(7583)),l=r(n(6060)),s=r(n(80655)),u=r(n(20497)),c=r(n(75244)),d=r(n(68748)),f=r(n(75356)),h=r(n(47053)),v=r(n(31920)),p=r(n(67093)),y=r(n(35983)),m=r(n(16825));function _(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}(0,d.default)(t,"__esModule",{value:!0});var g=n(5008),w=n(8775),b=n(88958),k=n(11251),S=n(17766),C=function(e){(0,s.default)(n,e);var t=_(n);function n(e,a){var r;return(0,i.default)(this,n),(r=t.call(this,e,a)).updater=r.di.get(k.Updater),r.resolver=r.di.get(k.Resolver),r.window.title="Sounds",r.window.autosaveName="sound-inspector",r.window.style.width="200px",r.window.content.style.height="450px",r.window.content.style.flexDirection="column",r.window.addTitlebarButton(WebFun.JSX.render(g.IconButton,{icon:"plus",title:"Add new sound",onclick:function(){return r.addSound()}})),r._list=WebFun.JSX.render(g.List,{state:e.prefixedWith("list"),cell:WebFun.JSX.render(w.default,{onrevealreferences:function(e){return r.revealReferences(e.detail.sound)},onchange:function(e){return r.renameSound(e.detail.sound,e.detail.label)},onremove:function(e){return r.removeSound(e.detail.sound)}}),searchDelegate:(0,l.default)(r)}),r.window.content.appendChild(r._list),r}return(0,o.default)(n,[{key:"build",value:function(){this._list.items=this.data.currentData.sounds}},{key:"addSound",value:function(){this.data.currentData.sounds.push(new S.Sound(this.data.currentData.sounds.length,"New Sound")),this.build()}},{key:"removeSound",value:function(e){var t,n;-1!==(0,f.default)(t=this._list.items).call(t,e)&&confirm((0,h.default)(n="Do you really want to delete sound ".concat(e.id," (")).call(n,e.file,")"))&&(this.updater.deleteItem(e),this.build())}},{key:"renameSound",value:function(e,t){var n,a,r=(0,f.default)(n=this._list.items).call(n,e);-1!==r&&((0,v.default)(a=this.data.currentData.sounds).call(a,r,1,new S.Sound(r,t)),this.build())}},{key:"revealReferences",value:function(e){var t,n=(0,p.default)(t=this.resolver).call(t,e);console.log("references",n)}},{key:"prepareListSearch",value:function(e,t){var n;return this.stateDidChange(),(0,y.default)(n=e.split(" ")).call(n,(function(e){return new RegExp(e,"i")}))}},{key:"includeListItem",value:function(e,t,n,a){var r=t.id+" "+t.file;return(0,m.default)(e).call(e,(function(e){return e.test(r)}))}}]),n}(b.default);t.default=C},58320:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(63789)),o=r(n(94433)),l=r(n(76108)),s=r(n(40361)),u=r(n(7583)),c=r(n(80655)),d=r(n(20497)),f=r(n(75244)),h=r(n(68748)),v=r(n(23982)),p=r(n(6978)),y=r(n(92915));function m(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,f.default)(e);if(t){var i=(0,f.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,d.default)(this,n)}}(0,h.default)(t,"__esModule",{value:!0});var _=n(99670),g=n(31560),w=n(88958),b=n(5008),k=n(88607),S=function(e){(0,c.default)(a,e);var t,n=m(a);function a(e,t){var r;return(0,s.default)(this,a),(r=n.call(this,e,t))._imageEditor=WebFun.JSX.render(_.PaletteImageEditor,{size:new g.Size(288,288),style:{width:"288px",height:"288px",display:"inline-block"}}),r._colorPicker=WebFun.JSX.render(_.PaletteColorPicker,{size:new g.Size(16,16),style:{width:"128px",height:"128px","margin-left":"20px",display:"inline-block"},onchange:function(){return r._imageEditor.colorIndex=r._colorPicker.colorIndex}}),r.window.title="Startup Image",r.window.autosaveName="startup-image-inspector",r.window.style.width="438px",r.window.content.style.height="331px",r.window.content.style.flexDirection="column",r.window.content.appendChild(WebFun.JSX.render("div",null,r._imageEditor,r._colorPicker)),r.window.content.appendChild(WebFun.JSX.render("div",null,WebFun.JSX.render(b.Button,{label:"Read from file",onclick:function(){return r.loadImage()}}),WebFun.JSX.render(b.Button,{label:"Download",onclick:function(){return r.saveImage()}}))),r}return(0,u.default)(a,[{key:"saveImage",value:function(){g.downloadImage(this._imageEditor.renderedImage,"startup-image.png","png")}},{key:"loadImage",value:(t=(0,l.default)(i.default.mark((function e(){var t,n,a,r,l,s,u,c,d,f,h,p,y,m,_,g;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.FilePicker.Pick();case 2:return t=e.sent,n=(0,o.default)(t,1),a=n[0],e.next=7,a.readAsImage();case 7:for(r=e.sent,document.body.appendChild(r),l=r.toImageData(),s=l.width*l.height,u=new Uint8Array(s),c=this._imageEditor.palette,d=new v.default,f=0;f<s;f++)h=4*f,p=[l.data[h+0],l.data[h+1],l.data[h+2],l.data[h+3]],y=p[0],m=p[1],_=p[2],g=p[3],u[f]=this.findColor(c,y,m,_,g,d);this._imageEditor.image=u,this.data.currentData._startup=u,this._imageEditor.redraw();case 18:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"findColor",value:function(e,t,n,a,r,i){var o,l,s=t<<24|n<<16|a<<8|r;if(i.has(s))return i.get(s);var u=r<64?0:(0,p.default)(o=(0,y.default)(l=e.mapArray((function(e,r){return[Math.pow(t-(e>>0&255),2)+Math.pow(n-(e>>8&255),2)+Math.pow(a-(e>>16&255),2),r]}))).call(l,1)).call(o,(function(e,t){return e[0]-t[0]})).first()[1];return i.set(s,u),u}},{key:"build",value:function(){this._colorPicker.palette=this.data.palette,this._imageEditor.palette=this.data.palette,this._imageEditor.image=this.data.currentData.startupImageData,this._imageEditor.redraw()}}]),a}(w.default);t.default=S},55335:(e,t,n)=>{"use strict";(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var a=n(17766);t.default=function(e,t){switch(1<<e){case a.Tile.Attributes.Transparent:return"Transparent";case a.Tile.Attributes.Floor:return"Floor";case a.Tile.Attributes.Object:return"Object";case a.Tile.Attributes.Draggable:return"Draggable";case a.Tile.Attributes.Roof:return"Roof";case a.Tile.Attributes.Locator:return"Locator";case a.Tile.Attributes.Weapon:return"Weapon";case a.Tile.Attributes.Item:return"Item";case a.Tile.Attributes.Character:return"Character"}if(t&a.Tile.Attributes.Floor)switch(1<<e|a.Tile.Attributes.Floor){case a.Tile.Attributes.Doorway:return"Doorway"}if(t&a.Tile.Attributes.Locator&&a.Tile.Attributes.Locator,t&a.Tile.Attributes.Weapon)switch(1<<e|a.Tile.Attributes.Weapon){case a.Tile.Attributes.BlasterLow:return"Blaster Low";case a.Tile.Attributes.BlasterHigh:return"Blaster High";case a.Tile.Attributes.Lightsaber:return"Lightsaber";case a.Tile.Attributes.TheForce:return"The Force"}if(t&a.Tile.Attributes.Item)switch(1<<e|a.Tile.Attributes.Item){case a.Tile.Attributes.Map:return"Map";case a.Tile.Attributes.Keycard:return"Keycard";case a.Tile.Attributes.Tool:return"Tool";case a.Tile.Attributes.Part:return"Part";case a.Tile.Attributes.Valuable:return"Valuable";case a.Tile.Attributes.Edible:return"Edible"}if(t&a.Tile.Attributes.Character)switch(1<<e|a.Tile.Attributes.Character){case a.Tile.Attributes.Hero:return"Hero";case a.Tile.Attributes.Enemy:return"Enemy";case a.Tile.Attributes.NPC:return"NPC"}return null}},90487:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(63789)),o=r(n(94433)),l=r(n(76108)),s=r(n(40361)),u=r(n(7583)),c=r(n(80655)),d=r(n(20497)),f=r(n(75244)),h=r(n(68748)),v=r(n(23982)),p=r(n(35983)),y=r(n(61399)),m=r(n(47053)),_=r(n(92915)),g=r(n(6978));function w(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,f.default)(e);if(t){var i=(0,f.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,d.default)(this,n)}}(0,h.default)(t,"__esModule",{value:!0}),n(33723);var b=n(88958),k=n(5008),S=n(99670),C=n(17766),x=n(5008),T=n(55335),I=n(88607),W=n(96288),F=n(31560),E=n(17725),D=function(e){(0,c.default)(r,e);var t,n,a=w(r);function r(e,t){var n;return(0,s.default)(this,r),(n=a.call(this,e,t)).tile=null,n.window.title="Tiles",n.window.autosaveName="tile-inspector",n.window.style.width="532px",n.window.content.style.maxHeight="300px",n.window.content.style.flexDirection="column",n.window.addTitlebarButton(WebFun.JSX.render(k.IconButton,{icon:"plus",title:"Add new tile"})),n.window.addTitlebarButton(WebFun.JSX.render(k.IconButton,{icon:"upload",onclick:function(){return n.uploadTileset()},title:"Upload Tileset"})),n.window.addTitlebarButton(WebFun.JSX.render(k.IconButton,{icon:"download",onclick:function(){return n.downloadTileset()},title:"Download Tileset"})),n}return(0,u.default)(r,[{key:"build",value:function(){var e,t=this,n=this.data.currentData.tiles,a=this.data.palette,r=this.state.load("last-tile");this.tile=null!==(e=n[r])&&void 0!==e?e:null,this.window.content.appendChild(WebFun.JSX.render("div",{className:"wf-tile-inspector"},WebFun.JSX.render(S.TilePicker,{palette:a,tiles:n,tile:this.tile,state:this.state.prefixedWith("popover-tile-picker"),onchange:function(e){return t.changeTile(e)}}),this.buildDetailsForTile(this.tile)))}},{key:"changeTile",value:function(e){var t;this.tile=e.target.tile,this.state.store("last-tile",null===(t=this.tile)||void 0===t?void 0:t.id),this.rebuild()}},{key:"rebuild",value:function(){this.window.content.querySelector(".detail:last-child").replaceWith(this.buildDetailsForTile(this.tile))}},{key:"buildDetailsForTile",value:function(e){var t=this;return e?WebFun.JSX.render("div",{className:"detail"},WebFun.JSX.render("span",{className:"title"},WebFun.JSX.render("span",{className:"tile-id",title:e.id.toString()},e.id.toHex()),":",WebFun.JSX.render(x.Label,{maxLength:23,onchange:function(t){return e.name=t.target.textContent}},e.name.length?"".concat(e.name):"")),WebFun.JSX.render("div",{className:"attributes"},this.formatAttributes(e)),WebFun.JSX.render("div",{className:"actions"},WebFun.JSX.render(x.Button,{onclick:function(){return t.clearImage()}},"Clear Image"),WebFun.JSX.render(x.Button,{onclick:function(){return t.loadImageFromFile()}},"Replace Image"))):WebFun.JSX.render("div",{className:"detail"},"no selection")}},{key:"loadImageFromFile",value:(n=(0,l.default)(i.default.mark((function e(){var t,n,a,r,l,s,u,c,d,f,h,p,y,m,_,g,w,b;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.FilePicker.Pick({});case 2:if(t=e.sent,n=(0,o.default)(t,1),a=n[0]){e.next=7;break}return e.abrupt("return");case 7:return e.prev=7,e.next=10,a.provideInputStream();case 10:return r=e.sent,l=(new W.Reader).read(r),s=(0,o.default)(l,2),u=s[1],this.tile.imageData=u,this.updatePicker(),e.abrupt("return");case 17:e.prev=17,e.t0=e.catch(7);case 19:return c=new Uint8Array(new ArrayBuffer(1024)),e.next=22,a.readAsImage();case 22:for(d=e.sent,f=d.toImageData(),h=new v.default,p=0;p<32;p++)for(y=0;y<32;y++)m=f.data[32*p*4+4*y+0],_=f.data[32*p*4+4*y+1],g=f.data[32*p*4+4*y+2],w=f.data[32*p*4+4*y+3],b=m<<24|_<<16|g<<8|w,c[p*C.Tile.WIDTH+y]=this.findClosestColor(b,h);this.tile.imageData=c,this.updatePicker();case 28:case"end":return e.stop()}}),e,this,[[7,17]])}))),function(){return n.apply(this,arguments)})},{key:"clearImage",value:function(){this.tile.imageData=new Uint8Array(new ArrayBuffer(C.Tile.WIDTH*C.Tile.HEIGHT)),this.updatePicker()}},{key:"updatePicker",value:function(){this.window.content.querySelector(S.TilePicker.tagName).updateTile(this.tile)}},{key:"formatAttributes",value:function(e){var t,n,a=this;return(0,p.default)(t=(0,y.default)(n=e.attributes.toString(2)).call(n,32,"0").split("")).call(t,(function(t,n){var r,i;return WebFun.JSX.render("code",{title:(0,m.default)(r="Bit ".concat(31-n,": ")).call(r,null!==(i=T.default(31-n,e.attributes))&&void 0!==i?i:"<unknown>"),onclick:function(){return a.toggleAttribute(31-n)}},t)}))}},{key:"downloadTileset",value:function(){for(var e=this.data.currentData.tiles,t=E.ceil(e.length/21),n=new F.Size(21,t).scaleBy(C.Tile.WIDTH),a=new F.OutputStream(n.width*n.height),r=new Uint8Array(C.Tile.WIDTH),i=0;i<t;i++)for(var o=0;o<C.Tile.HEIGHT;o++)for(var l=0;l<21;l++){var s,u=null===(s=e[21*i+l])||void 0===s?void 0:s.imageData,c=u?(0,_.default)(u).call(u,o*C.Tile.WIDTH,(o+1)*C.Tile.WIDTH):r;a.writeUint8Array(c)}var d=new Uint8Array(a.buffer),f=(new W.Writer).write(d,this.data.palette,n);F.download(f,"Tileset.bmp")}},{key:"uploadTileset",value:(t=(0,l.default)(i.default.mark((function e(){var t,n,a,r,l,s,u,c,d,f,h,p,y,m,_,g,w,b,k,x;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.FilePicker.Pick();case 2:if(t=e.sent,n=(0,o.default)(t,1),a=n[0]){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,a.readAsImage();case 9:r=e.sent,l=r.toImageData(),s=l.width/C.Tile.WIDTH,u=l.height/C.Tile.HEIGHT,c=new v.default,d=0;case 15:if(!(d<u)){e.next=29;break}f=0;case 17:if(!(f<s)){e.next=26;break}if(h=this.data.currentData.tiles[d*s+f]){e.next=21;break}return e.abrupt("continue",23);case 21:for(p=4*(d*C.Tile.HEIGHT*l.width+f*C.Tile.WIDTH),y=0;y<C.Tile.HEIGHT;y++)for(m=0;m<C.Tile.WIDTH;m++)_=p+4*(y*l.width+m),g=255&l.data[_+0],w=255&l.data[_+1],b=255&l.data[_+2],k=255&l.data[_+3],x=g<<24|w<<16|b<<8|k,h.imageData[y*C.Tile.WIDTH+m]=this.findClosestColor(x,c);case 23:f++,e.next=17;break;case 26:d++,e.next=15;break;case 29:this.window.content.querySelector(S.TilePicker.tagName).tiles=this.data.currentData.tiles;case 31:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"findClosestColor",value:function(e){var t,n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new v.default;if(a.has(e))return a.get(e);var r=e>>24&255,i=e>>16&255,o=e>>8&255,l=e>>0&255,s=l<64?0:(0,g.default)(t=(0,_.default)(n=this.data.palette.mapArray((function(e,t){return[Math.pow(r-(e>>0&255),2)+Math.pow(i-(e>>8&255),2)+Math.pow(o-(e>>16&255),2),t]}))).call(n,1)).call(t,(function(e,t){return e[0]-t[0]})).first()[1];return a.set(e,s),s}},{key:"toggleAttribute",value:function(e){this.tile.attributes^=1<<e,this.rebuild()}}]),r}(b.default);t.default=D},18226:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(63789)),o=r(n(94433)),l=r(n(76108)),s=r(n(40361)),u=r(n(7583)),c=r(n(6060)),d=r(n(80655)),f=r(n(20497)),h=r(n(75244)),v=r(n(68748)),p=r(n(68190)),y=r(n(67093)),m=r(n(47053)),_=r(n(35983)),g=r(n(42601)),w=r(n(16825));function b(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,h.default)(e);if(t){var i=(0,h.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,f.default)(this,n)}}(0,v.default)(t,"__esModule",{value:!0});var k=n(5008),S=n(31560),C=n(88958),x=n(88607),T=n(48387),I=n(76500),W=n(11251),F=n(91552),E=n(99670),D=n(17725),z=function(e){(0,d.default)(n,e);var t=b(n);function n(e,a){var r;return(0,s.default)(this,n),(r=t.call(this,e,a))._controllers=[],r._state=e,r.window.title="Zones",r.window.autosaveName="zone-inspector",r.window.style.width="326px",r.window.content.style.maxHeight="300px",r.window.content.style.flexDirection="column",r.window.addTitlebarButton(WebFun.JSX.render(k.IconButton,{icon:"plus",title:"Add new zone",onclick:function(){return r.addZone()}})),r._list=WebFun.JSX.render(k.List,{state:e.prefixedWith("list"),searchDelegate:(0,c.default)(r)}),r._list.cell=WebFun.JSX.render(E.ZoneInspectorCell,{onclick:function(e){return r._onCellClicked(e.currentTarget)},oncontextmenu:function(e){return r._onCellContextMenu(e)}}),r._list.addEventListener(E.ZoneInspectorCell.Events.RevealReferences,(function(e){return r._revealReferences(e.detail.zone)})),r._list.addEventListener(E.ZoneInspectorCell.Events.RemoveZone,(function(e){var t,n=e.detail.zone,a=new W.Resolver(r.data.currentData),i=(0,p.default)(t=(0,y.default)(a).call(a,n)).call(t,(function(e){return"id"!==e.via[0]}));(console.log(i),confirm("Remove zone ".concat(e.detail.zone.id,"?")+(i.length?"\nIt is still used in ".concat(i.length," places"):"")))&&new W.Updater(r.data.currentData).deleteItem(e.detail.zone);r.build()})),r._list.addEventListener(E.ZoneInspectorCell.Events.ChangeType,(function(e){e.detail.zone.type=e.detail.type,r.build()})),r._list.addEventListener(E.ZoneInspectorCell.Events.ChangePlanet,(function(e){e.detail.zone.planet=e.detail.planet,r.build()})),r.window.content.appendChild(r._list),r}return(0,u.default)(n,[{key:"_onCellClicked",value:function(e){var t,n=(0,y.default)(t=this._controllers).call(t,(function(e){return e.canBeReused()}));n||((n=document.createElement(F.default.tagName)).di=this.di,n.data=this.data,n.state=this._state.prefixedWith("editor-"+this._controllers.length),this._controllers.push(n)),n.zone=e.data,n.manager=this.windowManager,n.show(),this._storeZones()}},{key:"_onCellContextMenu",value:function(e){var t,n=e.currentTarget.data;WebFun.JSX.render(k.ContextMenu,{menu:new x.Menu([{title:"Resize",callback:(t=(0,l.default)(i.default.mark((function e(){var t,a,r,l,s,u,c,d,f,h,v,p,y,g,w,b,k;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.ModalPrompt("",{defaultValue:(0,m.default)(t="".concat(n.size.width,"x")).call(t,n.size.height)});case 2:if(r=e.sent){e.next=5;break}return e.abrupt("return");case 5:if(l=r.split("x"),s=(0,o.default)(l,2),u=s[0],c=s[1],u&&c){e.next=8;break}return e.abrupt("return");case 8:if(d=u.parseInt(),f=c.parseInt(),!isNaN(d)&&!isNaN(f)){e.next=12;break}return e.abrupt("return");case 12:for(h=n.tileIDs,v=n.size,p=new S.Size(d,f),n.size=p,n.tileIDs=(0,_.default)(a=new Int16Array(3*p.area)).call(a,(function(e){return-1})),y=0;y<D.min(v.height,p.height);y++)for(g=0;g<D.min(v.width,p.width);g++)for(w=0;w<3;w++)b=3*y*v.width+3*g+w,k=n.tileStore[h[b]]||null,n.setTile(k,g,y,w);case 18:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})}])}).show(new S.Point(e.clientX,e.clientY)),e.preventDefault(),e.stopPropagation()}},{key:"_revealReferences",value:function(e){var t=new W.Resolver(this.data.currentData);console.log("references",(0,y.default)(t).call(t,e))}},{key:"_storeZones",value:function(){var e;this._state.store("zones",(0,_.default)(e=this._controllers).call(e,(function(e){return e.zone.id})))}},{key:"build",value:function(){var e=this,t=this._list.cell;t.palette=this.data.palette,t.tiles=this.data.currentData.tiles,this._list.items=this.data.currentData.zones;var n=this._state.load("zones")||[];(0,g.default)(n).call(n,(function(t){if(e.data.currentData.zones[t]){var n=document.createElement(F.default.tagName);n.di=e.di,n.manager=e.windowManager,n.data=e.data,n.zone=e.data.currentData.zones[t],n.state=e._state.prefixedWith("editor-"+e._controllers.length),e._controllers.push(n)}else console.warn("inspector for zone ".concat(t.toHex(4)," could not be restored."))}))}},{key:"addZone",value:function(){var e=this.data.currentData.zones.last(),t=new I.MutableZone;t.id=this.data.currentData.zones.length,t.type=e.type,t.size=e.size,t.name="New Zone",t.planet=e.planet,t.monsters=e.monsters,t.goalItems=e.goalItems,t.requiredItems=e.requiredItems,t.providedItems=e.providedItems,t.npcs=e.npcs,t.izaxUnknown=e.izaxUnknown,t.izx4Unknown=e.izx4Unknown,t.actions=e.actions,t.hotspots=e.hotspots,t.visited=e.visited,t.actionsInitialized=e.actionsInitialized,t.counter=e.counter,t.random=e.random,t.sectorCounter=e.sectorCounter,t.tileIDs=e.tileIDs,t.tileStore=this.data.currentData.tiles,t.zoneStore=this.data.currentData.zones,this.data.currentData.zones.push(t),this._list.items=this.data.currentData.zones,this._list.firstElementChild.lastElementChild.scrollIntoView()}},{key:"prepareListSearch",value:function(e,t){var n;return this.stateDidChange(),(0,_.default)(n=e.split(" ")).call(n,(function(e){return new RegExp(e,"i")}))}},{key:"includeListItem",value:function(e,t,n,a){var r=[t.id,t.size.width+"x"+t.size.height,t.hasTeleporter?"Teleporter":t.type.name,t.planet.name].join(" ");return(0,w.default)(e).call(e,(function(e){return e.test(r)}))}}]),n}(C.default);t.default=z},67279:(e,t,n)=>{"use strict";var a=n(38468),r=a(n(63789)),i=a(n(76108));(0,a(n(68748)).default)(t,"__esModule",{value:!0});var o=n(28474),l=n(43633);t.default=(0,i.default)(r.default.mark((function e(){var t,n,a=arguments;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:null,o.default(),n=new l.default,e.next=5,n.run(t);case 5:return e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})))},98320:(e,t,n)=>{"use strict";(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0});var a=n(88607),r=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return{title:e,callback:t,enabled:n}};t.default=function(e,t){return[{title:"Editor",mnemonic:0,submenu:[r("Load Data",(function(){return e.load()})),r("Save Data",(function(){return e.save()})),r("Load Save Game",(function(){return e.loadSaveGame()})),a.MenuItemSeparator,r("Close",(function(){return t.close()}))]},{title:"Views",mnemonic:0,submenu:[r("Tiles",(function(){return e.show("tile")})),r("Zones",(function(){return e.show("zone")})),r("Sound",(function(){return e.show("sound")})),r("Chars",(function(){return e.show("character")})),r("Puzzles",(function(){return e.show("puzzle")})),r("Sound",(function(){return e.show("sound")})),r("Startup Image",(function(){return e.show("startup-image")})),r("Palette",(function(){return e.show("palette")})),r("Save Game",(function(){return e.show("save-game")}),(function(){return!!e.data.state})),r("Coverage",(function(){return e.show("coverage")}))]}]}},93651:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(40361)),o=r(n(7583)),l=r(n(80655)),s=r(n(20497)),u=r(n(75244));function c(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,u.default)(e);if(t){var i=(0,u.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}(0,r(n(68748)).default)(t,"__esModule",{value:!0});var d=function(e){(0,l.default)(n,e);var t=c(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return(0,o.default)(n,[{key:"world",get:function(){return this._world},set:function(e){this._world=e}},{key:"dagobah",get:function(){return this._dagobah},set:function(e){this._dagobah=e}},{key:"puzzles",get:function(){return this._puzzles},set:function(e){this._puzzles=e}}]),n}(n(20779).Story);t.default=d},11251:(e,t,n)=>{"use strict";(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.Updater=t.Resolver=void 0;var a=n(26789);t.Resolver=a.default;var r=n(85676);t.Updater=r.default},26789:(e,t,n)=>{"use strict";var a=n(38468),r=a(n(40361)),i=a(n(7583)),o=a(n(68748)),l=a(n(23982)),s=a(n(67093));(0,o.default)(t,"__esModule",{value:!0});var u=n(17766),c=n(64230),d=n(40761),f=function(){function e(t){(0,r.default)(this,e),this.resolvers=new l.default,this.resolvers.set(u.Zone,new d.ZoneResolver(t)),this.resolvers.set(u.Hotspot,new d.HotspotResolver(t)),this.resolvers.set(u.Monster,new d.MonsterResolver(t)),this.resolvers.set(u.Sound,new d.SoundResolver(t)),this.resolvers.set(u.Tile,new d.TileResolver(t)),this.resolvers.set(u.Char,new d.CharResolver(t))}return(0,i.default)(e,[{key:"find",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.equal,n=this.determineResolver(e);return n?n.resolve(e,t):[]}},{key:"determineResolver",value:function(e){var t=[u.Zone,u.Tile,u.Hotspot,u.Char,u.Sound,u.Monster],n=(0,s.default)(t).call(t,(function(t){return e instanceof t}));return this.resolvers.get(n)}}]),e}();t.default=f},33008:(e,t,n)=>{"use strict";var a=n(92915),r=n(69159),i=n(67986),o=n(13037),l=n(29689),s=n(38468),u=s(n(40361)),c=s(n(7583));function d(e,t){var n=void 0!==i&&o(e)||e["@@iterator"];if(!n){if(l(e)||(n=function(e,t){var n;if(!e)return;if("string"==typeof e)return f(e,t);var i=a(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return r(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return f(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var s=0,u=function(){};return{s:u,n:function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}},e:function(e){throw e},f:u}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,d=!0,h=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return d=e.done,e},e:function(e){h=!0,c=e},f:function(){try{d||null==n.return||n.return()}finally{if(h)throw c}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}(0,s(n(68748)).default)(t,"__esModule",{value:!0});var h=n(64230),v=function(){function e(t){(0,u.default)(this,e),this.data=t}return(0,c.default)(e,[{key:"resolve",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h.equal,a=[],r=d(this.data.characters);try{for(r.s();!(t=r.n()).done;){var i=t.value;n(i.id,e.id)&&a.push({from:i,to:i,via:["id"]}),!i.isWeapon()&&-1!==i.reference&&n(i.reference,e.id)&&a.push({from:i,to:e,via:["weapon"]})}}catch(e){r.e(e)}finally{r.f()}var o,l=d(this.data.zones);try{for(l.s();!(o=l.n()).done;){var s,u=o.value,c=d(u.monsters);try{for(c.s();!(s=c.n()).done;){var f=s.value;n(f.face.id,e.id)&&a.push({from:f,to:e,via:[u]})}}catch(e){c.e(e)}finally{c.f()}}}catch(e){l.e(e)}finally{l.f()}return a}}]),e}();t.default=v},88439:(e,t,n)=>{"use strict";var a=n(92915),r=n(69159),i=n(67986),o=n(13037),l=n(29689),s=n(38468),u=s(n(40361)),c=s(n(7583)),d=s(n(68748)),f=s(n(7478));function h(e,t){var n=void 0!==i&&o(e)||e["@@iterator"];if(!n){if(l(e)||(n=function(e,t){var n;if(!e)return;if("string"==typeof e)return v(e,t);var i=a(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return r(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return v(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var s=0,u=function(){};return{s:u,n:function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}},e:function(e){throw e},f:u}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,d=!0,f=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return d=e.done,e},e:function(e){f=!0,c=e},f:function(){try{d||null==n.return||n.return()}finally{if(f)throw c}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}(0,d.default)(t,"__esModule",{value:!0});var p=n(14100),y=n(14367),m=n(64230),_=function(){function e(t){(0,u.default)(this,e),this.data=t}return(0,c.default)(e,[{key:"resolve",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m.equal,a=[],r=h(this.data.zones);try{for(r.s();!(t=r.n()).done;){var i,o=t.value;if((0,f.default)(i=o.hotspots).call(i,e)){var l,s=h(o.hotspots);try{for(s.s();!(l=s.n()).done;){var u=l.value;n(u.id,e.id)&&(a.push({from:u,to:u,via:["id"]}),a.push({from:o,to:u,via:[]}))}}catch(e){s.e(e)}finally{s.f()}var c,d=h(o.actions);try{for(d.s();!(c=d.n()).done;){var v,_=c.value,g=h(_.instructions);try{for(g.s();!(v=g.n()).done;){var w=v.value;w.opcode===p.default.Opcode&&n(w.arguments[0],e.id)&&a.push({from:w,to:e,via:[o,_,0]}),w.opcode===y.default.Opcode&&n(w.arguments[0],e.id)&&a.push({from:w,to:e,via:[o,_,0]})}}catch(e){g.e(e)}finally{g.f()}}}catch(e){d.e(e)}finally{d.f()}}}}catch(e){r.e(e)}finally{r.f()}return a}}]),e}();t.default=_},40761:(e,t,n)=>{"use strict";(0,n(38468)(n(68748)).default)(t,"__esModule",{value:!0}),t.ZoneResolver=t.TileResolver=t.SoundResolver=t.MonsterResolver=t.HotspotResolver=t.CharResolver=void 0;var a=n(33008);t.CharResolver=a.default;var r=n(88439);t.HotspotResolver=r.default;var i=n(74350);t.MonsterResolver=i.default;var o=n(74732);t.SoundResolver=o.default;var l=n(43593);t.TileResolver=l.default;var s=n(82793);t.ZoneResolver=s.default},74350:(e,t,n)=>{"use strict";var a=n(92915),r=n(69159),i=n(67986),o=n(13037),l=n(29689),s=n(38468),u=s(n(40361)),c=s(n(7583)),d=s(n(68748)),f=s(n(7478));function h(e,t){var n=void 0!==i&&o(e)||e["@@iterator"];if(!n){if(l(e)||(n=function(e,t){var n;if(!e)return;if("string"==typeof e)return v(e,t);var i=a(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return r(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return v(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var s=0,u=function(){};return{s:u,n:function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}},e:function(e){throw e},f:u}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,d=!0,f=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return d=e.done,e},e:function(e){f=!0,c=e},f:function(){try{d||null==n.return||n.return()}finally{if(f)throw c}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}(0,d.default)(t,"__esModule",{value:!0});var p=n(64230),y=n(48674),m=n(60584),_=n(35153),g=function(){function e(t){(0,u.default)(this,e),this.data=t}return(0,c.default)(e,[{key:"resolve",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p.equal,a=[],r=h(this.data.zones);try{for(r.s();!(t=r.n()).done;){var i,o=t.value;if((0,f.default)(i=o.monsters).call(i,e)){var l,s=h(o.monsters);try{for(s.s();!(l=s.n()).done;){var u=l.value;n(u.id,e.id)&&(a.push({from:u,to:u,via:["id"]}),a.push({from:o,to:u,via:[]}))}}catch(e){s.e(e)}finally{s.f()}var c,d=h(o.actions);try{for(d.s();!(c=d.n()).done;){var v,g=c.value,w=h(g.conditions);try{for(w.s();!(v=w.n()).done;){var b=v.value;b.opcode===_.default.Opcode&&n(b.arguments[0],e.id)&&a.push({from:b,to:e,via:[o,g,0]})}}catch(e){w.e(e)}finally{w.f()}var k,S=h(g.instructions);try{for(S.s();!(k=S.n()).done;){var C=k.value;C.opcode===y.default.Opcode&&n(C.arguments[0],e.id)&&a.push({from:C,to:e,via:[o,g,0]}),C.opcode===m.default.Opcode&&n(C.arguments[0],e.id)&&a.push({from:C,to:e,via:[o,g,0]})}}catch(e){S.e(e)}finally{S.f()}}}catch(e){d.e(e)}finally{d.f()}}}}catch(e){r.e(e)}finally{r.f()}return a}}]),e}();t.default=g},74732:(e,t,n)=>{"use strict";var a=n(92915),r=n(69159),i=n(67986),o=n(13037),l=n(29689),s=n(38468),u=s(n(40361)),c=s(n(7583));function d(e,t){var n=void 0!==i&&o(e)||e["@@iterator"];if(!n){if(l(e)||(n=function(e,t){var n;if(!e)return;if("string"==typeof e)return f(e,t);var i=a(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return r(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return f(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var s=0,u=function(){};return{s:u,n:function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}},e:function(e){throw e},f:u}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,d=!0,h=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return d=e.done,e},e:function(e){h=!0,c=e},f:function(){try{d||null==n.return||n.return()}finally{if(h)throw c}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}(0,s(n(68748)).default)(t,"__esModule",{value:!0});var h=n(17766),v=n(64230),p=n(98598),y=n(90202),m=function(){function e(t){(0,u.default)(this,e),this.data=t}return(0,c.default)(e,[{key:"resolve",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v.equal,a=[],r=d(this.data.sounds);try{for(r.s();!(t=r.n()).done;){var i=t.value;n(i.id,e.id)&&a.push({from:i,to:i,via:["id"]})}}catch(e){r.e(e)}finally{r.f()}var o,l=d(this.data.zones);try{for(l.s();!(o=l.n()).done;){var s,u=o.value,c=d(u.actions);try{for(c.s();!(s=c.n()).done;){var f,m=s.value,_=d(m.instructions);try{for(_.s();!(f=_.n()).done;){var g=f.value;g.opcode===p.default.Opcode&&-1!==g.arguments[0]&&n(g.arguments[0],e.id)&&a.push({from:g,to:e,via:[u,m,0]}),g.opcode===y.default.Opcode&&-1!==g.arguments[0]&&n(g.arguments[0],e.id)&&a.push({from:g,to:e,via:[u,m,0]})}}catch(e){_.e(e)}finally{_.f()}}}catch(e){c.e(e)}finally{c.f()}}}catch(e){l.e(e)}finally{l.f()}var w,b=d(this.data.characters);try{for(b.s();!(w=b.n()).done;){var k=w.value;k.type===h.Char.Type.Weapon&&-1!==k.reference&&n(k.reference,e.id)&&a.push({from:k,to:e,via:[]})}}catch(e){b.e(e)}finally{b.f()}return a}}]),e}();t.default=m},43593:(e,t,n)=>{"use strict";var a=n(92915),r=n(69159),i=n(67986),o=n(13037),l=n(29689),s=n(38468),u=s(n(94433)),c=s(n(40361)),d=s(n(7583)),f=s(n(68748)),h=s(n(7478));function v(e,t){var n=void 0!==i&&o(e)||e["@@iterator"];if(!n){if(l(e)||(n=function(e,t){var n;if(!e)return;if("string"==typeof e)return p(e,t);var i=a(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return r(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return p(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var s=0,u=function(){};return{s:u,n:function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}},e:function(e){throw e},f:u}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,d=!0,f=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return d=e.done,e},e:function(e){f=!0,c=e},f:function(){try{d||null==n.return||n.return()}finally{if(f)throw c}}}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}(0,f.default)(t,"__esModule",{value:!0});var y=n(17766),m=n(64230),_=n(47590),g=n(35288),w=function(){function e(t){(0,c.default)(this,e),this.data=t}return(0,d.default)(e,[{key:"resolve",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m.equal,a=[],r=v(this.data.tiles);try{for(r.s();!(t=r.n()).done;){var i=t.value;n(i.id,e.id)&&a.push({from:i,to:i,via:["id"]})}}catch(e){r.e(e)}finally{r.f()}var o,l=v(this.data.zones);try{for(l.s();!(o=l.n()).done;){var s,c=o.value,d=v(c.requiredItems);try{for(d.s();!(s=d.n()).done;){var f=s.value;n(f.id,e.id)&&a.push({from:c,to:e,via:["requiredItems"]})}}catch(e){d.e(e)}finally{d.f()}var p,w=v(c.providedItems);try{for(w.s();!(p=w.n()).done;){var b=p.value;n(b.id,e.id)&&a.push({from:c,to:e,via:["providedItems"]})}}catch(e){w.e(e)}finally{w.f()}var k,S=v(c.goalItems);try{for(S.s();!(k=S.n()).done;){var C=k.value;n(C.id,e.id)&&a.push({from:c,to:e,via:["goalItems"]})}}catch(e){S.e(e)}finally{S.f()}var x,T=v(c.npcs);try{for(T.s();!(x=T.n()).done;){var I=x.value;n(I.id,e.id)&&a.push({from:c,to:e,via:["npcs"]})}}catch(e){T.e(e)}finally{T.f()}for(var W=0;W<c.tileIDs.length;W++)n(c.tileIDs[W],e.id)&&a.push({from:c,to:e,via:["tileIDs",W]});var F,E=v(c.hotspots);try{for(E.s();!(F=E.n()).done;){var D=F.value,z=[y.Hotspot.Type.DropItem,y.Hotspot.Type.DropQuestItem,y.Hotspot.Type.DropUniqueWeapon,y.Hotspot.Type.DropMap];(0,h.default)(z).call(z,D.type)&&-1!==D.arg&&n(D.arg,e.id)&&a.push({from:D,to:e,via:[c]})}}catch(e){E.e(e)}finally{E.f()}var L,P=v(c.actions);try{for(P.s();!(L=P.n()).done;){var A,N=L.value,B=v(N.conditions);try{for(B.s();!(A=B.n()).done;)for(var X=A.value,M=[[_.ConditionsByName.Bump.Opcode,2],[_.ConditionsByName.FindItemIs.Opcode,0],[_.ConditionsByName.HasItem.Opcode,0],[_.ConditionsByName.PlacedItemIs.Opcode,3],[_.ConditionsByName.PlacedItemIs.Opcode,4],[_.ConditionsByName.PlacedItemIsNot.Opcode,3],[_.ConditionsByName.PlacedItemIsNot.Opcode,4],[_.ConditionsByName.StandingOn.Opcode,2],[_.ConditionsByName.TileAtIs.Opcode,0]],J=0,R=M;J<R.length;J++){var Y=(0,u.default)(R[J],2),U=Y[0],O=Y[1];X.opcode===U&&-1!==X.arguments[O]&&n(X.arguments[O],e.id)&&a.push({from:X,to:e,via:[c,N,O]})}}catch(e){B.e(e)}finally{B.f()}var Z,H=v(N.instructions);try{for(H.s();!(Z=H.n()).done;)for(var V=Z.value,G=[[g.InstructionsByName.AddItem.Opcode,0],[g.InstructionsByName.DropItem.Opcode,0],[g.InstructionsByName.PlaceTile.Opcode,3],[g.InstructionsByName.RemoveItem.Opcode,0]],j=0,q=G;j<q.length;j++){var K=(0,u.default)(q[j],2),$=K[0],Q=K[1];V.opcode===$&&-1!==V.arguments[Q]&&n(V.arguments[Q],e.id)&&a.push({from:V,to:e,via:[c,N,Q]})}}catch(e){H.e(e)}finally{H.f()}}}catch(e){P.e(e)}finally{P.f()}}}catch(e){l.e(e)}finally{l.f()}var ee,te=v(this.data.characters);try{for(te.s();!(ee=te.n()).done;)for(var ne=ee.value,ae=0;ae<ne.frames.length;ae++)for(var re=ne.frames[ae],ie=0;ie<re.tiles.length;ie++){var oe=re.tiles[ie];oe&&n(oe.id,e.id)&&a.push({from:ne,to:e,via:[ae,ie]})}}catch(e){te.e(e)}finally{te.f()}var le,se=v(this.data.puzzles);try{for(se.s();!(le=se.n()).done;){var ue=le.value;ue.item1&&n(ue.item1.id,e.id)&&a.push({from:ue,to:e,via:["item1"]}),ue.item2&&n(ue.item2.id,e.id)&&a.push({from:ue,to:e,via:["item2"]})}}catch(e){se.e(e)}finally{se.f()}return a}}]),e}();t.default=w},82793:(e,t,n)=>{"use strict";var a=n(92915),r=n(69159),i=n(67986),o=n(13037),l=n(29689),s=n(38468),u=s(n(40361)),c=s(n(7583));function d(e,t){var n=void 0!==i&&o(e)||e["@@iterator"];if(!n){if(l(e)||(n=function(e,t){var n;if(!e)return;if("string"==typeof e)return f(e,t);var i=a(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return r(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return f(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var s=0,u=function(){};return{s:u,n:function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}},e:function(e){throw e},f:u}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,d=!0,h=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return d=e.done,e},e:function(e){h=!0,c=e},f:function(){try{d||null==n.return||n.return()}finally{if(h)throw c}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}(0,s(n(68748)).default)(t,"__esModule",{value:!0});var h=n(38461),v=n(17766),p=n(64230),y=function(){function e(t){(0,u.default)(this,e),this.data=t}return(0,c.default)(e,[{key:"resolve",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p.equal,a=[],r=d(this.data.zones);try{for(r.s();!(t=r.n()).done;){var i=t.value;n(i.id,e.id)&&a.push({from:i,to:i,via:["id"]});var o,l=d(i.hotspots);try{for(l.s();!(o=l.n()).done;){var s=o.value;s.type===v.Hotspot.Type.DoorIn&&n(s.arg,e.id)&&a.push({from:s,to:e,via:[i]}),s.type===v.Hotspot.Type.DoorOut&&n(s.arg,e.id)&&a.push({from:s,to:e,via:[i]}),s.type===v.Hotspot.Type.ShipFromPlanet&&n(s.arg,e.id)&&a.push({from:s,to:e,via:[i]}),s.type===v.Hotspot.Type.ShipToPlanet&&n(s.arg,e.id)&&a.push({from:s,to:e,via:[i]}),s.type===v.Hotspot.Type.VehicleTo&&n(s.arg,e.id)&&a.push({from:s,to:e,via:[i]}),s.type===v.Hotspot.Type.VehicleBack&&n(s.arg,e.id)&&a.push({from:s,to:e,via:[i]})}}catch(e){l.e(e)}finally{l.f()}var u,c=d(i.actions);try{for(c.s();!(u=c.n()).done;){var f,y=u.value,m=d(y.instructions);try{for(m.s();!(f=m.n()).done;){var _=f.value;_.opcode===h.default.Opcode&&n(_.arguments[0],e.id)&&a.push({to:e,from:_,via:[i,y,0]})}}catch(e){m.e(e)}finally{m.f()}}}catch(e){c.e(e)}finally{c.f()}}}catch(e){r.e(e)}finally{r.f()}return a}}]),e}();t.default=y},85676:(e,t,n)=>{"use strict";var a=n(38468),r=a(n(40361)),i=a(n(7583)),o=a(n(68748)),l=a(n(67093)),s=a(n(42601)),u=a(n(6978)),c=a(n(35983)),d=a(n(31920)),f=a(n(68190)),h=a(n(5459)),v=a(n(7478)),p=a(n(75356));(0,o.default)(t,"__esModule",{value:!0});var y=n(17766),m=n(26789),_=n(64230),g=n(46e3),w=n(76500),b=n(31560),k=function(){function e(t){(0,r.default)(this,e),this.data=t}return(0,i.default)(e,[{key:"deleteItem",value:function(e){var t=this,n=new m.default(this.data),a=(0,l.default)(n).call(n,e),r=(0,l.default)(n).call(n,e,_.greaterThan);if((0,s.default)(a).call(a,(function(e){return t.deleteReference(e)})),this.removeTopLevelReference(e),(0,s.default)(r).call(r,(function(e){return t.updateReference(e,t.determineUpdater(e))})),e instanceof y.Zone){var i;(0,u.default)(i=this.data.zones).call(i,(function(e,t){return e.id-t.id}));for(var o=0;o<this.data.zones.length;o++)if(this.data.zones[o].id!==o){var f,h,v=new w.MutableZone;v.id=o,v.planet=y.Zone.Planet.None,v.type=y.Zone.Type.None,v.size=new b.Size(9,9),v.tileIDs=new Int16Array(3*v.size.area),v.tileIDs=(0,c.default)(f=v.tileIDs).call(f,(function(e){return-1})),(0,d.default)(h=this.data.zones).call(h,o,0,v)}}if(e instanceof y.Tile){var p;(0,u.default)(p=this.data.tiles).call(p,(function(e,t){return e.id-t.id}));for(var g=0;g<this.data.tiles.length;g++)if(this.data.tiles[g].id!==g){var k,S=new w.MutableTile;S.id=g,S.imageData=new Uint8Array(y.Tile.WIDTH*y.Tile.HEIGHT),(0,d.default)(k=this.data.tiles).call(k,g,0,S)}}}},{key:"removeTopLevelReference",value:function(e){e instanceof y.Zone&&this.removeItemFrom(e,this.data.zones),e instanceof y.Tile&&this.removeItemFrom(e,this.data.tiles),e instanceof y.Sound&&this.removeItemFrom(e,this.data.sounds),e instanceof y.Char&&this.removeItemFrom(e,this.data.characters)}},{key:"determineUpdater",value:function(e){var t,n,a=e.to,r=(0,f.default)(t=(0,h.default)(g.Yoda.zoneIDs)).call(t,(function(e){return"number"==typeof e})),i=(0,f.default)(n=(0,h.default)(g.Yoda.tileIDs)).call(n,(function(e){return"number"==typeof e}));return a instanceof y.Zone?function(e){if((0,v.default)(r).call(r,e))return e;for(var t=e-1;(0,v.default)(r).call(r,t);)t-=1;return t}:a instanceof y.Tile?function(e){if((0,v.default)(i).call(i,e))return e;for(var t=e-1;(0,v.default)(i).call(i,t);)t-=1;return t}:function(e){return e-1}}},{key:"deleteReference",value:function(e){var t=e.from,n=e.to,a=e.via;"id"!==a[0]&&("isCondition"in t&&a[1]instanceof y.Action?this.removeItemFrom(t,a[1].conditions):"isInstruction"in t&&a[1]instanceof y.Action?this.removeItemFrom(t,a[1].instructions):n instanceof y.Zone&&t instanceof y.Hotspot?this.deleteItem(t):n instanceof y.Hotspot&&t instanceof y.Zone?this.removeItemFrom(n,t.hotspots):n instanceof y.Monster&&t instanceof y.Zone?this.removeItemFrom(n,t.monsters):n instanceof y.Sound&&t instanceof y.Char||n instanceof y.Char&&t instanceof y.Char&&"weapon"===a[0]?t.reference=-1:n instanceof y.Char&&t instanceof y.Monster||n instanceof y.Tile&&t instanceof y.Hotspot?this.deleteItem(t):n instanceof y.Tile&&t instanceof y.Puzzle?"item1"===a[0]?t.item1=null:t.item2=null:console.assert(!1,"Don't know how to clear reference",e))}},{key:"removeItemFrom",value:function(e,t){var n=(0,p.default)(t).call(t,e);console.assert(n>=0),(0,d.default)(t).call(t,n,1)}},{key:"updateReference",value:function(e,t){var n=e.from,a=e.to,r=e.via;if("isInstruction"in n){var i=r[2];n.arguments[i]=t(n.arguments[i])}else if("isCondition"in n){var o=r[2];n.arguments[o]=t(n.arguments[o])}else if(a instanceof y.Char&&n instanceof y.Char&&"weapon"===r[0])n.reference=t(n.reference);else if("id"!==r[0]){if(a instanceof y.Zone&&n instanceof y.Hotspot)n.arg=t(n.arg);else if(!(a instanceof y.Char&&n instanceof y.Monster||n instanceof y.Zone&&a instanceof y.Hotspot||n instanceof y.Zone&&a instanceof y.Monster))if(n instanceof y.Zone&&a instanceof y.Tile&&"tileIDs"===r[0]){var l=r[1];n.tileIDs[l]=t(n.tileIDs[l])}else n instanceof y.Zone&&a instanceof y.Tile&&"npcs"===r[0]||n instanceof y.Zone&&a instanceof y.Tile&&"providedItems"===r[0]||n instanceof y.Zone&&a instanceof y.Tile&&"requiredItems"===r[0]||n instanceof y.Zone&&a instanceof y.Tile&&"goalItems"===r[0]||a instanceof y.Tile&&n instanceof y.Char&&"number"==typeof r[0]&&"number"==typeof r[1]||(a instanceof y.Tile&&n instanceof y.Hotspot?n.arg=t(n.arg):a instanceof y.Tile&&n instanceof y.Puzzle||console.assert(!1,"Don't know how to update reference",e))}else a.id=t(a.id)}}]),e}();t.default=k},26341:(e,t,n)=>{"use strict";var a=n(38468),r=a(n(40361)),i=a(n(7583)),o=a(n(68748)),l=a(n(23982));(0,o.default)(t,"__esModule",{value:!0});var s=function(){function e(){(0,r.default)(this,e),this._services=new l.default}return(0,i.default)(e,[{key:"register",value:function(e,t){this._services.set(e,t)}},{key:"get",value:function(e){return this._services.get(e)}},{key:"unregister",value:function(e,t){this._services.delete(e)}}]),e}();t.default=s},65847:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(40361)),o=r(n(7583)),l=r(n(18582)),s=r(n(80655)),u=r(n(20497)),c=r(n(75244));function d(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}(0,r(n(68748)).default)(t,"__esModule",{value:!0});var f=n(57953),h=n(31560),v=n(17766),p=function(e){(0,s.default)(n,e);var t=d(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments))._currentTile=new h.Point(-1,-1),e._tile=null,e._isApplying=!1,e}return(0,o.default)(n,[{key:"activate",value:function(e,t){(0,l.default)((0,c.default)(n.prototype),"activate",this).call(this,e,t),this._ctx=t.getContext("2d"),this._ctx.save(),this._ctx.setTransform(window.devicePixelRatio*v.Tile.WIDTH,0,0,window.devicePixelRatio*v.Tile.HEIGHT,0,0),this.canvas.addEventListener("mousedown",this),this.canvas.addEventListener("mousemove",this),this.canvas.addEventListener("mouseenter",this),this.canvas.addEventListener("mouseleave",this)}},{key:"deactivate",value:function(){this.zone&&this._ctx.clearRect(0,0,this.zone.size.width,this.zone.size.height),this._ctx.restore(),this.canvas.removeEventListener("mousedown",this),this.canvas.removeEventListener("mousemove",this),this.canvas.removeEventListener("mouseenter",this),this.canvas.removeEventListener("mouseleave",this),document.removeEventListener("mousemove",this),document.removeEventListener("mouseup",this),this._isApplying=!1,(0,l.default)((0,c.default)(n.prototype),"deactivate",this).call(this)}},{key:"_drawPreview",value:function(e){this._ctx.clearRect(0,0,this.zone.size.width,this.zone.size.height),this.drawPreview(e)}},{key:"_applyTo",value:function(e,t){this._ctx.clearRect(0,0,this.zone.size.width,this.zone.size.height),this.applyTo(e,t)}},{key:"finalize",value:function(e){}},{key:"handleEvent",value:function(e){"mouseup"!==e.type?"mousedown"!==e.type?this._mouseMoved(e):this._mousePressed(e):this._mouseReleased(e)}},{key:"_mousePressed",value:function(e){var t=this.extractTileCoordinates(e);t&&(this._currentTile=t,this._isApplying=!0,this._applyTo(t,!1),document.addEventListener("mousemove",this),document.addEventListener("mouseup",this),e.preventDefault(),e.stopImmediatePropagation())}},{key:"_mouseMoved",value:function(e){var t=this.extractTileCoordinates(e);t&&(this._currentTile.isEqualTo(t)||(this._currentTile=t,this._isApplying?this._applyTo(t,!0):this._drawPreview(t),e.preventDefault(),e.stopImmediatePropagation()))}},{key:"_mouseReleased",value:function(e){this.finalize(this._currentTile),this._isApplying=!1,document.removeEventListener("mousemove",this),document.removeEventListener("mouseup",this),this._drawPreview(this._currentTile),e.preventDefault(),e.stopImmediatePropagation()}},{key:"extractTileCoordinates",value:function(e){var t=this.zone,n=e.offsetIn(this.canvas).scaleBy(1/v.Tile.WIDTH).floor();return n.x<0||n.y<0||n.x>=t.size.width||n.y>=t.size.height?null:n}},{key:"tile",get:function(){return this._tile},set:function(e){this._tile=e}}]),n}(f.default);t.default=p},57953:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(40361)),o=r(n(7583)),l=r(n(80655)),s=r(n(20497)),u=r(n(75244));function c(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,u.default)(e);if(t){var i=(0,u.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}(0,r(n(68748)).default)(t,"__esModule",{value:!0}),t.Events=void 0;var d=n(31560);t.Events={DidActivate:"DidActivate",WillActivate:"WillActivate",DidDeactivate:"DidDeactivate",WillDeactivate:"WillDeactivate",ChangedTiles:"ChangedTiles"};var f=function(e){(0,l.default)(a,e);var n=c(a);function a(){return(0,i.default)(this,a),n.apply(this,arguments)}return(0,o.default)(a,[{key:"activate",value:function(e,n){this.dispatchEvent(new CustomEvent(t.Events.WillActivate)),this.zone=e,this.canvas=n,this.dispatchEvent(new CustomEvent(t.Events.DidActivate))}},{key:"deactivate",value:function(){this.dispatchEvent(new CustomEvent(t.Events.WillDeactivate)),this.dispatchEvent(new CustomEvent(t.Events.DidDeactivate))}}]),a}(d.EventTarget);f.Event=t.Events,t.default=f},56018:(e,t,n)=>{"use strict";var a=n(38468)(n(68748));(0,a.default)(t,"__esModule",{value:!0}),t.TileChangeEvent=t.PaintBucketTool=t.RectangleTool=t.PencilTool=t.NoTool=t.AbstractTool=t.Events=void 0;var r=n(57953);t.AbstractTool=r.default,(0,a.default)(t,"Events",{enumerable:!0,get:function(){return r.Events}});var i=n(12947);t.NoTool=i.default;var o=n(92750);t.PencilTool=o.default;var l=n(43609);t.RectangleTool=l.default;var s=n(93896);t.PaintBucketTool=s.default;var u=n(12144);(0,a.default)(t,"TileChangeEvent",{enumerable:!0,get:function(){return u.TileChangeEvent}})},12947:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(40361)),o=r(n(7583)),l=r(n(18582)),s=r(n(80655)),u=r(n(20497)),c=r(n(75244)),d=r(n(68748)),f=r(n(47053)),h=r(n(42601));function v(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}(0,d.default)(t,"__esModule",{value:!0});var p=n(17766),y=n(57953),m=n(31560),_=function(e){(0,s.default)(n,e);var t=v(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments)).name="None",e.icon="",e}return(0,o.default)(n,[{key:"activate",value:function(e,t){(0,l.default)((0,c.default)(n.prototype),"activate",this).call(this,e,t),this.canvas.addEventListener("mousemove",this),this.canvas.addEventListener("mouseenter",this),this.canvas.addEventListener("mouseleave",this),this._ctx=t.getContext("2d"),this._ctx.save(),this._ctx.globalCompositeOperation="source-over",this._ctx.textAlign="left",this._ctx.shadowColor="black",this._ctx.shadowBlur=1,this._ctx.shadowOffsetX=0,this._ctx.shadowOffsetY=1,this._ctx.font="".concat(13*window.devicePixelRatio,'px "Anonymous Pro", monospace'),this._ctx.fillStyle="white"}},{key:"handleEvent",value:function(e){var t,n,a=this,r=this.extractTileCoordinates(e);if(r){this._ctx.clearRect(0,0,this.canvas.width,this.canvas.height);var i=(0,f.default)(t="".concat(r.x,"x")).call(t,r.y);this.renderText(i,new m.Point(10,10)),(0,h.default)(n=[this.zone.getTile(r.x,r.y,2),this.zone.getTile(r.x,r.y,1),this.zone.getTile(r.x,r.y,0)]).call(n,(function(e,t){var n=p.Zone.Layer[t];a.renderText("".concat(n,": ")+(e?"".concat(e.id):""),new m.Point(20,40+20*t))}))}}},{key:"renderText",value:function(e,t){this._ctx.fillText(e,t.x,t.y+6.5)}},{key:"extractTileCoordinates",value:function(e){var t=this.zone,n=e.offsetIn(this.canvas).scaleBy(1/p.Tile.WIDTH).floor();return n.x<0||n.y<0||n.x>=t.size.width||n.y>=t.size.height?null:n}},{key:"deactivate",value:function(){this.canvas.removeEventListener("mousemove",this),this.canvas.removeEventListener("mouseenter",this),this.canvas.removeEventListener("mouseleave",this),this._ctx.restore(),this._ctx=null,(0,l.default)((0,c.default)(n.prototype),"deactivate",this).call(this)}}]),n}(y.default);t.default=_},93896:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(61822)),o=r(n(40361)),l=r(n(7583)),s=r(n(80655)),u=r(n(20497)),c=r(n(75244)),d=r(n(68748)),f=r(n(42601)),h=r(n(36687)),v=r(n(55903)),p=r(n(41870)),y=r(n(55933)),m=r(n(31920));function _(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}(0,d.default)(t,"__esModule",{value:!0});var g=n(31560),w=n(65847),b=n(12144),k=g.rgba(255,0,0,.3),S=function(e){(0,s.default)(n,e);var t=_(n);function n(){var e;return(0,o.default)(this,n),(e=t.apply(this,arguments)).name="Paint Bucket",e.icon="",e.shortcut={keyCode:71},e}return(0,l.default)(n,[{key:"applyTo",value:function(e,t){var n=this;if(!t&&!this.layer.locked&&this.zone.bounds.contains(e)){var a=this.findConnectedPoints(e);(0,f.default)(a).call(a,(function(e){n.zone.setTile(n.tile,e)}));var r=new b.default({affectedPoints:a});this.dispatchEvent(r)}}},{key:"drawPreview",value:function(e){var t,n=this;this._ctx.fillStyle=k,(0,f.default)(t=this.findConnectedPoints(e)).call(t,(function(e){n._ctx.fillRect(e.x,e.y,1,1)}))}},{key:"findConnectedPoints",value:function(e){for(var t=this.layer.id,n=this.zone.getTile(e.x,e.y,t),a=[],r=new h.default([new g.Point(e.x,e.y,t)]),o=0;o<this.zone.size.height;o++)for(var l=0;l<this.zone.size.width;l++)l===e.x&&o===e.y||this.zone.getTile(l,o,t)===n&&a.push(new h.default([new g.Point(l,o,t)]));for(;;){var s=(0,p.default)(a).call(a,(function(e){return t=r,n=e,(0,v.default)(t).call(t,(function(e){return(0,v.default)(n).call(n,(function(t){return 1===e.distanceTo(t)}))}));var t,n}));if(-1===s)return(0,i.default)((0,y.default)(r).call(r));var u=(0,m.default)(a).call(a,s,1)[0];(0,f.default)(u).call(u,(function(e){return r.add(e)}))}}}]),n}(w.default);t.default=S},92750:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(40361)),o=r(n(7583)),l=r(n(18582)),s=r(n(80655)),u=r(n(20497)),c=r(n(75244));function d(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}(0,r(n(68748)).default)(t,"__esModule",{value:!0});var f=n(65847),h=n(76013),v=n(12144),p=n(31560),y=p.rgba(255,0,0,.3),m=function(e){(0,s.default)(n,e);var t=d(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments)).name="Pencil",e.icon="fa-pencil",e.shortcut={keyCode:66},e}return(0,o.default)(n,[{key:"activate",value:function(e,t){(0,l.default)((0,c.default)(n.prototype),"activate",this).call(this,e,t),this._ctx.fillStyle=y}},{key:"applyTo",value:function(e,t){if(!this.layer.locked){this._ctx.fillStyle=p.rgba(0,255,0,.3),this._ctx.fillRect(e.x,e.y,1,1);var n=new h.default(e.x,e.y,this.layer.id);this.zone.bounds.contains(n)&&(this.zone.setTile(this.tile,n),this.dispatchEvent(new v.default({affectedPoints:[n]})))}}},{key:"drawPreview",value:function(e){this._ctx.fillStyle=y,this._ctx.fillRect(e.x,e.y,1,1)}}]),n}(f.default);t.default=m},43609:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(40361)),o=r(n(7583)),l=r(n(80655)),s=r(n(20497)),u=r(n(75244));function c(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,u.default)(e);if(t){var i=(0,u.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}(0,r(n(68748)).default)(t,"__esModule",{value:!0});var d=n(31560),f=n(65847),h=n(12144),v=d.rgba(255,0,0,.3),p=function(e){(0,l.default)(n,e);var t=c(n);function n(){var e;return(0,i.default)(this,n),(e=t.apply(this,arguments)).name="Rectangle",e.icon="icon-unknown-2",e.shortcut={keyCode:85},e._startingPoint=null,e}return(0,o.default)(n,[{key:"applyTo",value:function(e,t){if(this.zone.bounds.contains(e)){this._startingPoint||(this._startingPoint=e);var n=this.calculateRectFromStartTo(e);this._ctx.fillStyle=v,this._ctx.fillRect(n.minX,n.minY,n.size.width,n.size.height)}}},{key:"finalize",value:function(e){if(this.layer.locked)this._startingPoint=null;else{for(var t=this.calculateRectFromStartTo(e),n=this.layer.id,a=[],r=t.minY;r<t.maxY;r++)for(var i=t.minX;i<t.maxX;i++){var o=new d.Point(i,r,n);this.zone.setTile(this.tile,o),a.push(o)}var l=new h.default({affectedPoints:a});this.dispatchEvent(l),this._startingPoint=null}}},{key:"drawPreview",value:function(e){this._startingPoint=e,this._ctx.fillStyle=v,this._ctx.fillRect(e.x,e.y,1,1)}},{key:"calculateRectFromStartTo",value:function(e){var t=new d.Point(Math.min(e.x,this._startingPoint.x),Math.min(e.y,this._startingPoint.y)),n=new d.Point(Math.max(e.x,this._startingPoint.x),Math.max(e.y,this._startingPoint.y));return new d.Rectangle(t,new d.Size(n.x-t.x+1,n.y-t.y+1))}}]),n}(f.default);t.default=p},12144:(e,t,n)=>{"use strict";var a=n(79406),r=n(38468),i=r(n(40361)),o=r(n(80655)),l=r(n(20497)),s=r(n(75244));function u(e){var t=function(){if("undefined"==typeof Reflect||!a)return!1;if(a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(a(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=a(r,arguments,i)}else n=r.apply(this,arguments);return(0,l.default)(this,n)}}(0,r(n(68748)).default)(t,"__esModule",{value:!0}),t.TileChangeEvent=void 0;var c=n(31560),d=n(57953),f=function(e){(0,o.default)(n,e);var t=u(n);function n(e){var a;return(0,i.default)(this,n),(a=t.call(this,d.Events.ChangedTiles,e)).affectedPoints=(e?e.affectedPoints:[])||[],a}return n}(c.Event);t.TileChangeEvent=f,t.default=f},39146:(e,t,n)=>{"use strict";n.r(t)},44556:(e,t,n)=>{"use strict";n.r(t)},6604:(e,t,n)=>{"use strict";n.r(t)},15961:(e,t,n)=>{"use strict";n.r(t)},82027:(e,t,n)=>{"use strict";n.r(t)},94742:(e,t,n)=>{"use strict";n.r(t)},39906:(e,t,n)=>{"use strict";n.r(t)},78719:(e,t,n)=>{"use strict";n.r(t)},3532:(e,t,n)=>{"use strict";n.r(t)},24744:(e,t,n)=>{"use strict";n.r(t)},86568:(e,t,n)=>{"use strict";n.r(t)},64969:(e,t,n)=>{"use strict";n.r(t)},14713:(e,t,n)=>{"use strict";n.r(t)},14109:(e,t,n)=>{"use strict";n.r(t)},51850:(e,t,n)=>{"use strict";n.r(t)},82388:(e,t,n)=>{"use strict";n.r(t)},99302:(e,t,n)=>{"use strict";n.r(t)},25815:(e,t,n)=>{"use strict";n.r(t)},36510:(e,t,n)=>{"use strict";n.r(t)},32547:(e,t,n)=>{"use strict";n.r(t)},18048:(e,t,n)=>{"use strict";n.r(t)},24165:(e,t,n)=>{"use strict";n.r(t)},53263:(e,t,n)=>{"use strict";n.r(t)},16472:(e,t,n)=>{"use strict";n.r(t)},60097:(e,t,n)=>{"use strict";n.r(t)},5244:(e,t,n)=>{"use strict";n.r(t)},31464:(e,t,n)=>{"use strict";n.r(t)},55634:(e,t,n)=>{"use strict";n.r(t)},40986:(e,t,n)=>{"use strict";n.r(t)},8102:(e,t,n)=>{"use strict";n.r(t)},32535:(e,t,n)=>{"use strict";n.r(t)},66554:(e,t,n)=>{"use strict";n.r(t)},97219:(e,t,n)=>{"use strict";n.r(t)},32157:(e,t,n)=>{"use strict";n.r(t)},21502:(e,t,n)=>{"use strict";n.r(t)},95266:(e,t,n)=>{"use strict";n.r(t)},91316:(e,t,n)=>{"use strict";n.r(t)},33723:(e,t,n)=>{"use strict";n.r(t)}}]);