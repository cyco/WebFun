<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Color Palette - WebFun</title>
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="../favicon.svg">
        
        
        <link rel="shortcut icon" href="../favicon.png">
        
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        
        <link rel="stylesheet" href="../css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="../fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
        <link rel="stylesheet" href="../open-in.css">
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../architecture/index.html"><strong aria-hidden="true">2.</strong> Project Architecture</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../architecture/getting-started.html"><strong aria-hidden="true">2.1.</strong> Getting Started</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.2.</strong> Code</div></li><li class="chapter-item expanded "><a href="../architecture/build-system.html"><strong aria-hidden="true">2.3.</strong> Build System</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.4.</strong> Project Layout</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.5.</strong> Modules</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.6.</strong> Testing</div></li><li class="chapter-item expanded "><a href="../architecture/documentation.html"><strong aria-hidden="true">2.7.</strong> Documentation</a></li></ol></li><li class="chapter-item expanded "><a href="../gameplay/index.html"><strong aria-hidden="true">3.</strong> Gameplay</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../gameplay/main-window.html"><strong aria-hidden="true">3.1.</strong> Main Window</a></li><li class="chapter-item expanded "><a href="../gameplay/color-palette.html" class="active"><strong aria-hidden="true">3.2.</strong> Color Palette</a></li><li class="chapter-item expanded "><a href="../gameplay/tiles.html"><strong aria-hidden="true">3.3.</strong> Tiles</a></li><li class="chapter-item expanded "><a href="../gameplay/zones.html"><strong aria-hidden="true">3.4.</strong> Zones</a></li><li class="chapter-item expanded "><a href="../scripting/index.html"><strong aria-hidden="true">3.5.</strong> Scripting</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../scripting/conditions.html"><strong aria-hidden="true">3.5.1.</strong> Conditions</a></li><li class="chapter-item expanded "><a href="../scripting/instructions.html"><strong aria-hidden="true">3.5.2.</strong> Instructions</a></li></ol></li><li class="chapter-item expanded "><a href="../gameplay/score.html"><strong aria-hidden="true">3.6.</strong> Score</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.7.</strong> Settings</div></li><li class="chapter-item expanded "><a href="../gameplay/map-screen.html"><strong aria-hidden="true">3.8.</strong> Map Screen</a></li><li class="chapter-item expanded "><a href="../gameplay/r2d2-help.html"><strong aria-hidden="true">3.9.</strong> R2D2 Help</a></li><li class="chapter-item expanded "><a href="../gameplay/cheats.html"><strong aria-hidden="true">3.10.</strong> Cheats</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.11.</strong> Debug Mode</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.</strong> World Generation</div></li><li class="chapter-item expanded "><a href="../files/index.html"><strong aria-hidden="true">5.</strong> Files</a></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">5.1.</strong> DTA / DAW</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">5.2.</strong> Save Games</div></li><li class="chapter-item expanded "><a href="../files/yodesk-ini.html"><strong aria-hidden="true">5.3.</strong> Yodesk.ini</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">5.4.</strong> Strings</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.</strong> Indy's Desktop Adventures</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">6.1.</strong> The Demo</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.2.</strong> The Patch</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">7.</strong> Yoda Stories</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../yoda/releases.html"><strong aria-hidden="true">7.1.</strong> Releases</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">7.2.</strong> The Demo</div></li><li class="chapter-item expanded "><a href="../yoda/patch/index.html"><strong aria-hidden="true">7.3.</strong> The Patch</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../yoda/patch/zone-072.html"><strong aria-hidden="true">7.3.1.</strong> Zone 72</a></li><li class="chapter-item expanded "><a href="../yoda/patch/zone-236.html"><strong aria-hidden="true">7.3.2.</strong> Zone 236</a></li><li class="chapter-item expanded "><a href="../yoda/patch/zone-407.html"><strong aria-hidden="true">7.3.3.</strong> Zone 407</a></li><li class="chapter-item expanded "><a href="../yoda/patch/zone-474.html"><strong aria-hidden="true">7.3.4.</strong> Zone 474</a></li><li class="chapter-item expanded "><a href="../yoda/patch/zone-572.html"><strong aria-hidden="true">7.3.5.</strong> Zone 572</a></li></ol></li><li class="chapter-item expanded "><a href="../yoda/trivia.html"><strong aria-hidden="true">7.4.</strong> Trivia</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><a href="../appendix/yodesk.html">Yodesk.ksy</a></li><li class="chapter-item expanded affix "><a href="../appendix/deskadv.html">Deskadv.ksy</a></li><li class="chapter-item expanded affix "><a href="../appendix/yodasav.html">Yodasav.ksy</a></li><li class="chapter-item expanded affix "><a href="../appendix/list-of-game-files.html">List of game files</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">WebFun</h1>

                    <div class="right-buttons">
                        
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                        <a href="https://github.com/cyco/webfun/" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="color-palette"><a class="header" href="#color-palette">Color Palette</a></h1>
<table><thead><tr><th align="center"></th></tr></thead><tbody>
<tr><td align="center"><img src="../images/palette-anim-swamp.gif" alt="" /> <img src="../images/palette-anim-tele.gif" alt="" /> <img src="../images/palette-anim-water.gif" alt="" /></td></tr>
<tr><td align="center"><em>Color cycling effects in Yoda Stories</em></td></tr>
</tbody></table>
<p>Like many older games, the <em>Desktop Adventures</em> engine uses a color palette for rendering. That means the colors you see on the screen are not specified directly by supplying values for the three components red, green and blue, but rather by choosing one of several pre-defined colors from a color palette.</p>
<p>This has two major advantages. First, the amount of data needed to store an image is drastically reduced. Instead of giving three values for each pixel of an image, only one value is enough.</p>
<p>Second, and more interesting nowadays, changing a color in the palette affects all pixels on screen. This allows for very efficient animations and the results for cleverly composed images can be pretty impressive. Check out <a href="http://www.effectgames.com/effect/article-Old_School_Color_Cycling_with_HTML5.html">this site</a> as well as Mark Ferrari's excellent talk <em><a href="https://www.youtube.com/watch?v=aMcJ1Jvtef0">8 Bit &amp; '8 Bitish' Graphics-Outside the Box</a></em> to see what can be done with palette animations.</p>
<table><thead><tr><th align="center"></th></tr></thead><tbody>
<tr><td align="center"><img src="../images/palette-layout.svg" alt="Layout of the color palette" /></td></tr>
<tr><td align="center"><em>Layout of the color palette in a hex editor</em></td></tr>
</tbody></table>
<p>The <em>Desktop Adventures</em> engine uses a palette composed of 256 <code>24</code>-bit BGR colors, each represented as a <code>32</code>-bit integer, totaling <code>1024</code> bytes. By convention, the color at index <code>0</code> is interpreted as transparent.</p>
<p>Here are the color palettes used by <em>Yoda Stories</em> and <em>Indiana Jones and His Desktop Adventures</em>:</p>
<table><thead><tr><th> <em>Indy's Desktop Adventures</em></th><th> <em>Yoda Stories</em></th></tr></thead><tbody>
<tr><td><img src="../images/palette-indy.png" alt="Color palette used by Indiana Jones and His Desktop Adventures" /></td><td><img src="../images/palette-yoda.png" alt="Color palette used by Yoda Stories" /></td></tr>
</tbody></table>
<p>As described in the links above, the <em>Desktop Adventures</em> engine allows for color cycling animations to make the static environments more lively. Each game has a hard-coded set of regions in the palette that shifted to make animations. Each run is either advanced every frame (fast animations) or every other frame (slower animations).</p>
<p>Consult the following tables for a description of the animated regions in each game:</p>
<h4 id="color-cycles-in-yoda-stories"><a class="header" href="#color-cycles-in-yoda-stories">Color Cycles in Yoda Stories</a></h4>
<table><thead><tr><th>Start</th><th>End</th><th>Length</th><th>Speed</th></tr></thead><tbody>
<tr><td>0A</td><td>0F</td><td>6</td><td>fast</td></tr>
<tr><td>C6</td><td>C6</td><td>2</td><td>slow</td></tr>
<tr><td>C8</td><td>C9</td><td>2</td><td>slow</td></tr>
<tr><td>CA</td><td>CB</td><td>2</td><td>fast</td></tr>
<tr><td>CC</td><td>CD</td><td>2</td><td>fast</td></tr>
<tr><td>CE</td><td>CF</td><td>2</td><td>fast</td></tr>
<tr><td>D7</td><td>DF</td><td>9</td><td>slow</td></tr>
<tr><td>E0</td><td>E4</td><td>5</td><td>fast</td></tr>
<tr><td>E5</td><td>ED</td><td>9</td><td>slow</td></tr>
<tr><td>EE</td><td>F3</td><td>6</td><td>fast</td></tr>
<tr><td>F4</td><td>F5</td><td>2</td><td>slow</td></tr>
</tbody></table>
<h4 id="color-cycles-in-indys-desktop-adventures"><a class="header" href="#color-cycles-in-indys-desktop-adventures">Color Cycles in Indy's Desktop Adventures</a></h4>
<table><thead><tr><th>Start</th><th>End</th><th>Length</th><th>Speed</th></tr></thead><tbody>
<tr><td>A0</td><td>A7</td><td>8</td><td>fast</td></tr>
<tr><td>E0</td><td>E4</td><td>5</td><td>fast</td></tr>
<tr><td>E5</td><td>ED</td><td>9</td><td>fast</td></tr>
<tr><td>EE</td><td>F3</td><td>6</td><td>slow</td></tr>
<tr><td>F4</td><td>F5</td><td>2</td><td>slow</td></tr>
</tbody></table>
<p>Here are some renderings of the animations in the color palette:</p>
<table><thead><tr><th> <em>Indy's Desktop Adventures</em></th><th> <em>Yoda Stories</em></th></tr></thead><tbody>
<tr><td><img src="../images/palette-anim-indy.gif" alt="Color palette with animations used by Indiana Jones and His Desktop Adventures" /></td><td><img src="../images/palette-anim-yoda.gif" alt="Color palette with animations used by Yoda Stories" /></td></tr>
</tbody></table>
<h2 id="extracting-the-color-palette"><a class="header" href="#extracting-the-color-palette">Extracting the color palette</a></h2>
<p>The color palette is contained in the <code>.data</code> section of the game's executable <code>Yodesk.exe</code> as well as the demo <code>YodaDemo.exe</code>. Since the exact offset might differ depending on the specific version or language of the game, the easiest way to find it is to locate the string <code>CDeskcppDoc\0</code> and extract the next 1024 bytes from there. In most versions the palette seems to start at offset <code>0x550F0</code>.</p>
<p>For <em>Indy's Desktop Adventures</em> a reliable way to extract the color palette is to search for the ASCII string <code>sss</code>, move back <code>103</code> bytes and read <code>0x400</code> bytes from there.</p>
<h2 id="free-colors"><a class="header" href="#free-colors">&quot;Free&quot; colors</a></h2>
<p>The following colors are not referenced by any tile in <em>Yoda Stories</em> and could be used for UI elements in restricted environments (e.g. ScummVM or gaming console).</p>
<p><code>3, 4, 5, 6, 7, 8, 196, 197, 198, 199, 206, 246, 247, 248, 249, 250, 251, 252, 253, 254</code></p>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/cyco/webfun//edit/master/docs/src/gameplay/color-palette.md">Edit this file on GitHub.</a></footer>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../gameplay/main-window.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../gameplay/tiles.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="../gameplay/main-window.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="../gameplay/tiles.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
