<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Build System - WebFun</title>
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="../favicon.svg">
        
        
        <link rel="shortcut icon" href="../favicon.png">
        
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        
        <link rel="stylesheet" href="../css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="../fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
        <link rel="stylesheet" href="../open-in.css">
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../related-projects.html"><strong aria-hidden="true">2.</strong> Related Projects</a></li><li class="chapter-item expanded "><a href="../architecture/index.html"><strong aria-hidden="true">3.</strong> Project Architecture</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../architecture/getting-started.html"><strong aria-hidden="true">3.1.</strong> Getting Started</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.2.</strong> Code</div></li><li class="chapter-item expanded "><a href="../architecture/build-system.html" class="active"><strong aria-hidden="true">3.3.</strong> Build System</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.4.</strong> Project Layout</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.5.</strong> Modules</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.6.</strong> Testing</div></li><li class="chapter-item expanded "><a href="../architecture/documentation.html"><strong aria-hidden="true">3.7.</strong> Documentation</a></li><li class="chapter-item expanded "><a href="../architecture/deployment.html"><strong aria-hidden="true">3.8.</strong> Deployment</a></li></ol></li><li class="chapter-item expanded "><a href="../gameplay/index.html"><strong aria-hidden="true">4.</strong> Gameplay</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../gameplay/main-window.html"><strong aria-hidden="true">4.1.</strong> Main Window</a></li><li class="chapter-item expanded "><a href="../gameplay/color-palette.html"><strong aria-hidden="true">4.2.</strong> Color Palette</a></li><li class="chapter-item expanded "><a href="../gameplay/tiles.html"><strong aria-hidden="true">4.3.</strong> Tiles</a></li><li class="chapter-item expanded "><a href="../gameplay/zones.html"><strong aria-hidden="true">4.4.</strong> Zones</a></li><li class="chapter-item expanded "><a href="../scripting/index.html"><strong aria-hidden="true">4.5.</strong> Scripting</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../scripting/conditions.html"><strong aria-hidden="true">4.5.1.</strong> Conditions</a></li><li class="chapter-item expanded "><a href="../scripting/instructions.html"><strong aria-hidden="true">4.5.2.</strong> Instructions</a></li></ol></li><li class="chapter-item expanded "><a href="../gameplay/score.html"><strong aria-hidden="true">4.6.</strong> Score</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.7.</strong> Settings</div></li><li class="chapter-item expanded "><a href="../gameplay/map-screen.html"><strong aria-hidden="true">4.8.</strong> Map Screen</a></li><li class="chapter-item expanded "><a href="../gameplay/r2d2-help.html"><strong aria-hidden="true">4.9.</strong> R2D2 Help</a></li><li class="chapter-item expanded "><a href="../gameplay/cheats.html"><strong aria-hidden="true">4.10.</strong> Cheats</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.11.</strong> Debug Mode</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">5.</strong> World Generation</div></li><li class="chapter-item expanded "><a href="../files/index.html"><strong aria-hidden="true">6.</strong> Files</a></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">6.1.</strong> DTA / DAW</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.2.</strong> Save Games</div></li><li class="chapter-item expanded "><a href="../files/yodesk-ini.html"><strong aria-hidden="true">6.3.</strong> Yodesk.ini</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.4.</strong> Strings</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">7.</strong> Indy's Desktop Adventures</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">7.1.</strong> The Demo</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">7.2.</strong> The Patch</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">8.</strong> Yoda Stories</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../yoda/releases.html"><strong aria-hidden="true">8.1.</strong> Releases</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">8.2.</strong> The Demo</div></li><li class="chapter-item expanded "><a href="../yoda/patch/index.html"><strong aria-hidden="true">8.3.</strong> The Patch</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../yoda/patch/zone-072.html"><strong aria-hidden="true">8.3.1.</strong> Zone 72</a></li><li class="chapter-item expanded "><a href="../yoda/patch/zone-236.html"><strong aria-hidden="true">8.3.2.</strong> Zone 236</a></li><li class="chapter-item expanded "><a href="../yoda/patch/zone-407.html"><strong aria-hidden="true">8.3.3.</strong> Zone 407</a></li><li class="chapter-item expanded "><a href="../yoda/patch/zone-474.html"><strong aria-hidden="true">8.3.4.</strong> Zone 474</a></li><li class="chapter-item expanded "><a href="../yoda/patch/zone-572.html"><strong aria-hidden="true">8.3.5.</strong> Zone 572</a></li></ol></li><li class="chapter-item expanded "><a href="../yoda/trivia.html"><strong aria-hidden="true">8.4.</strong> Trivia</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><a href="../appendix/yodesk.html">Yodesk.ksy</a></li><li class="chapter-item expanded affix "><a href="../appendix/deskadv.html">Deskadv.ksy</a></li><li class="chapter-item expanded affix "><a href="../appendix/yodasav.html">Yodasav.ksy</a></li><li class="chapter-item expanded affix "><a href="../appendix/list-of-game-files.html">List of game files</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">WebFun</h1>

                    <div class="right-buttons">
                        
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                        <a href="https://github.com/cyco/webfun/" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="build-system"><a class="header" href="#build-system">Build System</a></h1>
<p><em>WebFun</em> uses the package manager <a href="https://yarnpkg.com">yarn</a> to manage dependencies and run build scripts.</p>
<p>The following tasks are defined in <code>package.json</code> and can be started using <code>yarn &lt;task-name&gt;</code> on the command line.</p>
<p><strong>start</strong> -- Start a local web server for development.</p>
<p>By default this starts the server on <code>localhost</code> port <code>8080</code>. You can change the hostname to listen on with the environment variable <code>host</code>. Some features like the service worker might require an HTTPS connection to work properly. If you place a self-signed certificate under <code>config/ssl.key</code> and <code>config/ssl.pem</code> the server will accept HTTPS connections.</p>
<p>Assuming you have mapped <code>webfun.local</code> to <code>127.0.0.1</code> in your hosts file (like <code>echo &quot;127.0.0.1 webfun.local&quot; &gt;&gt; /etc/hosts</code>), you can use <a href="https://github.com/FiloSottile/mkcert">mkcert</a> to generate certificates that will be valid on your system like this:</p>
<pre><code class="language-bash"># change to the project directory
$ cd webfun
# create a certificate
$ mkcert -cert-file config/ssl.pem -key-file config/ssl.key webfun.local localhost 127.0.0.1 ::1

# start the development server with the proper hostname
$ host=webfun.local yarn start
</code></pre>
<p><strong>format</strong> -- Format source code files using <a href="https://eslint.org">eslint</a> &amp; <a href="https://prettier.io">prettier</a>. You should always run this task before committing a code change to make sure everything is properly formatted and adheres es to the coding standards.</p>
<p><strong>test</strong> -- Run basic test suite once without collecting code coverage.</p>
<p><strong>test:cont</strong> -- Run unit test whenever a change is detected. This task does not collect collect code coverage for performance reasons.</p>
<p><strong>test:full</strong> -- Run all tests and collect code coverage.</p>
<p><strong>test:unit</strong> -- Run unit tests with code coverage enabled.</p>
<p><strong>test:unit:cont</strong> -- Run unit tests with code coverage whenever a change is detected</p>
<p><strong>build</strong> -- Clear <code>build</code> directory and run a fresh build suitable for production.</p>
<p><strong>build:docs</strong> -- Build this documentation. This script requires <code>mdbook</code> to be installed, see <a href="documentation.html">documentation</a> for details.</p>
<h2 id="webpack"><a class="header" href="#webpack">Webpack</a></h2>
<p><a href="https://webpack.js.org">Webpack</a> is used to bundle scripts and prepare other assets like css stylesheets, fonts and copy static files in production builds. The following configuration files are used for various tasks, all of them are located in the <code>config</code> directory:</p>
<p><strong>webpack.commmon.js</strong> -- A shared configuration that is used as a base for the dev and test configurations.</p>
<p><strong>webpack.dev.js</strong> -- Configuration for the development task, the development web server with hot module reloading is defined here.</p>
<p><strong>webpack.test.js</strong> -- Used for running tests</p>
<p><strong>webpack.prod.js</strong> -- Defines the production build</p>
<p><strong>webpack.service-worker.js</strong> -- Defines the production build for the service worker script. This is in a separate file because splitting the service worker code via chunks does not produce a file that runs in the service worker context.</p>
<h3 id="custom-plugins"><a class="header" href="#custom-plugins">Custom Plugins</a></h3>
<p>WebFun uses a few custom webpack plugins. These are all single-file scripts found in the <code>config</code> directory.</p>
<p><strong>file-list-webpack-plugin</strong> -- Creates a list of files produce during a production build and stores it in a json file. This file is used to pre-load assets when the service worker is installed.</p>
<p><strong>spy-on-imports-webpack-plugin</strong> -- This plugin rewrites imports created by Webpack so <code>jasmine.spy</code> can be used on wildcard module imports to mock dependencies during test execution:</p>
<pre><code class="language-javascript">import * as UtilModule from &quot;src/util&quot;;

describe(&quot;some test&quot;, () =&gt; {
	beforeEach(() =&gt; spyOn(UtilModule, &quot;download&quot;));

	it(&quot;starts a download&quot;, () =&gt; {
		subject.doYourThing();

		expect(UtilModule.download).toHaveBeenCalled();
	});
});
</code></pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/cyco/webfun//edit/master/docs/src/architecture/build-system.md">Edit this file on GitHub.</a></footer>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../architecture/getting-started.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../architecture/documentation.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="../architecture/getting-started.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="../architecture/documentation.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
